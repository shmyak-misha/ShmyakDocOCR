var Fm=n=>{throw TypeError(n)};var f0=(n,t,e)=>t.has(n)||Fm("Cannot "+e);var Ce=(n,t,e)=>(f0(n,t,"read from private field"),e?e.call(n):t.get(n)),qn=(n,t,e)=>t.has(n)?Fm("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),Hi=(n,t,e,i)=>(f0(n,t,"write to private field"),i?i.call(n,e):t.set(n,e),e),Wn=(n,t,e)=>(f0(n,t,"access private method"),e);var km=(n,t,e,i)=>({set _(s){Hi(n,t,s,e)},get _(){return Ce(n,t,i)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(s){if(s.ep)return;s.ep=!0;const l=e(s);fetch(s.href,l)}})();function z2(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var d0={exports:{}},to={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pm;function G2(){if(Pm)return to;Pm=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(i,s,l){var o=null;if(l!==void 0&&(o=""+l),s.key!==void 0&&(o=""+s.key),"key"in s){l={};for(var u in s)u!=="key"&&(l[u]=s[u])}else l=s;return s=l.ref,{$$typeof:n,type:i,key:o,ref:s!==void 0?s:null,props:l}}return to.Fragment=t,to.jsx=e,to.jsxs=e,to}var Bm;function V2(){return Bm||(Bm=1,d0.exports=G2()),d0.exports}var Le=V2(),p0={exports:{}},Wt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Im;function j2(){if(Im)return Wt;Im=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.iterator;function v(M){return M===null||typeof M!="object"?null:(M=m&&M[m]||M["@@iterator"],typeof M=="function"?M:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,y={};function E(M,q,D){this.props=M,this.context=q,this.refs=y,this.updater=D||_}E.prototype.isReactComponent={},E.prototype.setState=function(M,q){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,q,"setState")},E.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function T(){}T.prototype=E.prototype;function b(M,q,D){this.props=M,this.context=q,this.refs=y,this.updater=D||_}var w=b.prototype=new T;w.constructor=b,A(w,E.prototype),w.isPureReactComponent=!0;var O=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},z=Object.prototype.hasOwnProperty;function L(M,q,D,k,U,j){return D=j.ref,{$$typeof:n,type:M,key:q,ref:D!==void 0?D:null,props:j}}function G(M,q){return L(M.type,q,void 0,void 0,void 0,M.props)}function V(M){return typeof M=="object"&&M!==null&&M.$$typeof===n}function Q(M){var q={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(D){return q[D]})}var K=/\/+/g;function ut(M,q){return typeof M=="object"&&M!==null&&M.key!=null?Q(""+M.key):q.toString(36)}function ht(){}function bt(M){switch(M.status){case"fulfilled":return M.value;case"rejected":throw M.reason;default:switch(typeof M.status=="string"?M.then(ht,ht):(M.status="pending",M.then(function(q){M.status==="pending"&&(M.status="fulfilled",M.value=q)},function(q){M.status==="pending"&&(M.status="rejected",M.reason=q)})),M.status){case"fulfilled":return M.value;case"rejected":throw M.reason}}throw M}function Et(M,q,D,k,U){var j=typeof M;(j==="undefined"||j==="boolean")&&(M=null);var J=!1;if(M===null)J=!0;else switch(j){case"bigint":case"string":case"number":J=!0;break;case"object":switch(M.$$typeof){case n:case t:J=!0;break;case p:return J=M._init,Et(J(M._payload),q,D,k,U)}}if(J)return U=U(M),J=k===""?"."+ut(M,0):k,O(U)?(D="",J!=null&&(D=J.replace(K,"$&/")+"/"),Et(U,q,D,"",function(vt){return vt})):U!=null&&(V(U)&&(U=G(U,D+(U.key==null||M&&M.key===U.key?"":(""+U.key).replace(K,"$&/")+"/")+J)),q.push(U)),1;J=0;var _t=k===""?".":k+":";if(O(M))for(var At=0;At<M.length;At++)k=M[At],j=_t+ut(k,At),J+=Et(k,q,D,j,U);else if(At=v(M),typeof At=="function")for(M=At.call(M),At=0;!(k=M.next()).done;)k=k.value,j=_t+ut(k,At++),J+=Et(k,q,D,j,U);else if(j==="object"){if(typeof M.then=="function")return Et(bt(M),q,D,k,U);throw q=String(M),Error("Objects are not valid as a React child (found: "+(q==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":q)+"). If you meant to render a collection of children, use an array instead.")}return J}function Y(M,q,D){if(M==null)return M;var k=[],U=0;return Et(M,k,"","",function(j){return q.call(D,j,U++)}),k}function nt(M){if(M._status===-1){var q=M._result;q=q(),q.then(function(D){(M._status===0||M._status===-1)&&(M._status=1,M._result=D)},function(D){(M._status===0||M._status===-1)&&(M._status=2,M._result=D)}),M._status===-1&&(M._status=0,M._result=q)}if(M._status===1)return M._result.default;throw M._result}var Tt=typeof reportError=="function"?reportError:function(M){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof M=="object"&&M!==null&&typeof M.message=="string"?String(M.message):String(M),error:M});if(!window.dispatchEvent(q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",M);return}console.error(M)};function st(){}return Wt.Children={map:Y,forEach:function(M,q,D){Y(M,function(){q.apply(this,arguments)},D)},count:function(M){var q=0;return Y(M,function(){q++}),q},toArray:function(M){return Y(M,function(q){return q})||[]},only:function(M){if(!V(M))throw Error("React.Children.only expected to receive a single React element child.");return M}},Wt.Component=E,Wt.Fragment=e,Wt.Profiler=s,Wt.PureComponent=b,Wt.StrictMode=i,Wt.Suspense=f,Wt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,Wt.__COMPILER_RUNTIME={__proto__:null,c:function(M){return F.H.useMemoCache(M)}},Wt.cache=function(M){return function(){return M.apply(null,arguments)}},Wt.cloneElement=function(M,q,D){if(M==null)throw Error("The argument must be a React element, but you passed "+M+".");var k=A({},M.props),U=M.key,j=void 0;if(q!=null)for(J in q.ref!==void 0&&(j=void 0),q.key!==void 0&&(U=""+q.key),q)!z.call(q,J)||J==="key"||J==="__self"||J==="__source"||J==="ref"&&q.ref===void 0||(k[J]=q[J]);var J=arguments.length-2;if(J===1)k.children=D;else if(1<J){for(var _t=Array(J),At=0;At<J;At++)_t[At]=arguments[At+2];k.children=_t}return L(M.type,U,void 0,void 0,j,k)},Wt.createContext=function(M){return M={$$typeof:o,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null},M.Provider=M,M.Consumer={$$typeof:l,_context:M},M},Wt.createElement=function(M,q,D){var k,U={},j=null;if(q!=null)for(k in q.key!==void 0&&(j=""+q.key),q)z.call(q,k)&&k!=="key"&&k!=="__self"&&k!=="__source"&&(U[k]=q[k]);var J=arguments.length-2;if(J===1)U.children=D;else if(1<J){for(var _t=Array(J),At=0;At<J;At++)_t[At]=arguments[At+2];U.children=_t}if(M&&M.defaultProps)for(k in J=M.defaultProps,J)U[k]===void 0&&(U[k]=J[k]);return L(M,j,void 0,void 0,null,U)},Wt.createRef=function(){return{current:null}},Wt.forwardRef=function(M){return{$$typeof:u,render:M}},Wt.isValidElement=V,Wt.lazy=function(M){return{$$typeof:p,_payload:{_status:-1,_result:M},_init:nt}},Wt.memo=function(M,q){return{$$typeof:d,type:M,compare:q===void 0?null:q}},Wt.startTransition=function(M){var q=F.T,D={};F.T=D;try{var k=M(),U=F.S;U!==null&&U(D,k),typeof k=="object"&&k!==null&&typeof k.then=="function"&&k.then(st,Tt)}catch(j){Tt(j)}finally{F.T=q}},Wt.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},Wt.use=function(M){return F.H.use(M)},Wt.useActionState=function(M,q,D){return F.H.useActionState(M,q,D)},Wt.useCallback=function(M,q){return F.H.useCallback(M,q)},Wt.useContext=function(M){return F.H.useContext(M)},Wt.useDebugValue=function(){},Wt.useDeferredValue=function(M,q){return F.H.useDeferredValue(M,q)},Wt.useEffect=function(M,q,D){var k=F.H;if(typeof D=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return k.useEffect(M,q)},Wt.useId=function(){return F.H.useId()},Wt.useImperativeHandle=function(M,q,D){return F.H.useImperativeHandle(M,q,D)},Wt.useInsertionEffect=function(M,q){return F.H.useInsertionEffect(M,q)},Wt.useLayoutEffect=function(M,q){return F.H.useLayoutEffect(M,q)},Wt.useMemo=function(M,q){return F.H.useMemo(M,q)},Wt.useOptimistic=function(M,q){return F.H.useOptimistic(M,q)},Wt.useReducer=function(M,q,D){return F.H.useReducer(M,q,D)},Wt.useRef=function(M){return F.H.useRef(M)},Wt.useState=function(M){return F.H.useState(M)},Wt.useSyncExternalStore=function(M,q,D){return F.H.useSyncExternalStore(M,q,D)},Wt.useTransition=function(){return F.H.useTransition()},Wt.version="19.1.1",Wt}var Um;function md(){return Um||(Um=1,p0.exports=j2()),p0.exports}var _r=md(),g0={exports:{}},eo={},m0={exports:{}},v0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hm;function X2(){return Hm||(Hm=1,(function(n){function t(Y,nt){var Tt=Y.length;Y.push(nt);t:for(;0<Tt;){var st=Tt-1>>>1,M=Y[st];if(0<s(M,nt))Y[st]=nt,Y[Tt]=M,Tt=st;else break t}}function e(Y){return Y.length===0?null:Y[0]}function i(Y){if(Y.length===0)return null;var nt=Y[0],Tt=Y.pop();if(Tt!==nt){Y[0]=Tt;t:for(var st=0,M=Y.length,q=M>>>1;st<q;){var D=2*(st+1)-1,k=Y[D],U=D+1,j=Y[U];if(0>s(k,Tt))U<M&&0>s(j,k)?(Y[st]=j,Y[U]=Tt,st=U):(Y[st]=k,Y[D]=Tt,st=D);else if(U<M&&0>s(j,Tt))Y[st]=j,Y[U]=Tt,st=U;else break t}}return nt}function s(Y,nt){var Tt=Y.sortIndex-nt.sortIndex;return Tt!==0?Tt:Y.id-nt.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var o=Date,u=o.now();n.unstable_now=function(){return o.now()-u}}var f=[],d=[],p=1,m=null,v=3,_=!1,A=!1,y=!1,E=!1,T=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;function O(Y){for(var nt=e(d);nt!==null;){if(nt.callback===null)i(d);else if(nt.startTime<=Y)i(d),nt.sortIndex=nt.expirationTime,t(f,nt);else break;nt=e(d)}}function F(Y){if(y=!1,O(Y),!A)if(e(f)!==null)A=!0,z||(z=!0,ut());else{var nt=e(d);nt!==null&&Et(F,nt.startTime-Y)}}var z=!1,L=-1,G=5,V=-1;function Q(){return E?!0:!(n.unstable_now()-V<G)}function K(){if(E=!1,z){var Y=n.unstable_now();V=Y;var nt=!0;try{t:{A=!1,y&&(y=!1,b(L),L=-1),_=!0;var Tt=v;try{e:{for(O(Y),m=e(f);m!==null&&!(m.expirationTime>Y&&Q());){var st=m.callback;if(typeof st=="function"){m.callback=null,v=m.priorityLevel;var M=st(m.expirationTime<=Y);if(Y=n.unstable_now(),typeof M=="function"){m.callback=M,O(Y),nt=!0;break e}m===e(f)&&i(f),O(Y)}else i(f);m=e(f)}if(m!==null)nt=!0;else{var q=e(d);q!==null&&Et(F,q.startTime-Y),nt=!1}}break t}finally{m=null,v=Tt,_=!1}nt=void 0}}finally{nt?ut():z=!1}}}var ut;if(typeof w=="function")ut=function(){w(K)};else if(typeof MessageChannel<"u"){var ht=new MessageChannel,bt=ht.port2;ht.port1.onmessage=K,ut=function(){bt.postMessage(null)}}else ut=function(){T(K,0)};function Et(Y,nt){L=T(function(){Y(n.unstable_now())},nt)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Y){Y.callback=null},n.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<Y?Math.floor(1e3/Y):5},n.unstable_getCurrentPriorityLevel=function(){return v},n.unstable_next=function(Y){switch(v){case 1:case 2:case 3:var nt=3;break;default:nt=v}var Tt=v;v=nt;try{return Y()}finally{v=Tt}},n.unstable_requestPaint=function(){E=!0},n.unstable_runWithPriority=function(Y,nt){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var Tt=v;v=Y;try{return nt()}finally{v=Tt}},n.unstable_scheduleCallback=function(Y,nt,Tt){var st=n.unstable_now();switch(typeof Tt=="object"&&Tt!==null?(Tt=Tt.delay,Tt=typeof Tt=="number"&&0<Tt?st+Tt:st):Tt=st,Y){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=Tt+M,Y={id:p++,callback:nt,priorityLevel:Y,startTime:Tt,expirationTime:M,sortIndex:-1},Tt>st?(Y.sortIndex=Tt,t(d,Y),e(f)===null&&Y===e(d)&&(y?(b(L),L=-1):y=!0,Et(F,Tt-st))):(Y.sortIndex=M,t(f,Y),A||_||(A=!0,z||(z=!0,ut()))),Y},n.unstable_shouldYield=Q,n.unstable_wrapCallback=function(Y){var nt=v;return function(){var Tt=v;v=nt;try{return Y.apply(this,arguments)}finally{v=Tt}}}})(v0)),v0}var zm;function Y2(){return zm||(zm=1,m0.exports=X2()),m0.exports}var x0={exports:{}},Si={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gm;function q2(){if(Gm)return Si;Gm=1;var n=md();function t(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var i={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},s=Symbol.for("react.portal");function l(f,d,p){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:m==null?null:""+m,children:f,containerInfo:d,implementation:p}}var o=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Si.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Si.createPortal=function(f,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return l(f,d,null,p)},Si.flushSync=function(f){var d=o.T,p=i.p;try{if(o.T=null,i.p=2,f)return f()}finally{o.T=d,i.p=p,i.d.f()}},Si.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,i.d.C(f,d))},Si.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},Si.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var p=d.as,m=u(p,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,_=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?i.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:m,integrity:v,fetchPriority:_}):p==="script"&&i.d.X(f,{crossOrigin:m,integrity:v,fetchPriority:_,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Si.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=u(d.as,d.crossOrigin);i.d.M(f,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&i.d.M(f)},Si.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,m=u(p,d.crossOrigin);i.d.L(f,p,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Si.preloadModule=function(f,d){if(typeof f=="string")if(d){var p=u(d.as,d.crossOrigin);i.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else i.d.m(f)},Si.requestFormReset=function(f){i.d.r(f)},Si.unstable_batchedUpdates=function(f,d){return f(d)},Si.useFormState=function(f,d,p){return o.H.useFormState(f,d,p)},Si.useFormStatus=function(){return o.H.useHostTransitionStatus()},Si.version="19.1.1",Si}var Vm;function W2(){if(Vm)return x0.exports;Vm=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),x0.exports=q2(),x0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jm;function $2(){if(jm)return eo;jm=1;var n=Y2(),t=md(),e=W2();function i(r){var a="https://react.dev/errors/"+r;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)a+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var a=r,c=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(c=a.return),r=a.return;while(r)}return a.tag===3?c:null}function o(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function u(r){if(l(r)!==r)throw Error(i(188))}function f(r){var a=r.alternate;if(!a){if(a=l(r),a===null)throw Error(i(188));return a!==r?null:r}for(var c=r,h=a;;){var g=c.return;if(g===null)break;var x=g.alternate;if(x===null){if(h=g.return,h!==null){c=h;continue}break}if(g.child===x.child){for(x=g.child;x;){if(x===c)return u(g),r;if(x===h)return u(g),a;x=x.sibling}throw Error(i(188))}if(c.return!==h.return)c=g,h=x;else{for(var S=!1,R=g.child;R;){if(R===c){S=!0,c=g,h=x;break}if(R===h){S=!0,h=g,c=x;break}R=R.sibling}if(!S){for(R=x.child;R;){if(R===c){S=!0,c=x,h=g;break}if(R===h){S=!0,h=x,c=g;break}R=R.sibling}if(!S)throw Error(i(189))}}if(c.alternate!==h)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?r:a}function d(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r;for(r=r.child;r!==null;){if(a=d(r),a!==null)return a;r=r.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),b=Symbol.for("react.consumer"),w=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),V=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),K=Symbol.iterator;function ut(r){return r===null||typeof r!="object"?null:(r=K&&r[K]||r["@@iterator"],typeof r=="function"?r:null)}var ht=Symbol.for("react.client.reference");function bt(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===ht?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case A:return"Fragment";case E:return"Profiler";case y:return"StrictMode";case F:return"Suspense";case z:return"SuspenseList";case V:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case _:return"Portal";case w:return(r.displayName||"Context")+".Provider";case b:return(r._context.displayName||"Context")+".Consumer";case O:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case L:return a=r.displayName||null,a!==null?a:bt(r.type)||"Memo";case G:a=r._payload,r=r._init;try{return bt(r(a))}catch{}}return null}var Et=Array.isArray,Y=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,nt=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Tt={pending:!1,data:null,method:null,action:null},st=[],M=-1;function q(r){return{current:r}}function D(r){0>M||(r.current=st[M],st[M]=null,M--)}function k(r,a){M++,st[M]=r.current,r.current=a}var U=q(null),j=q(null),J=q(null),_t=q(null);function At(r,a){switch(k(J,a),k(j,r),k(U,null),a.nodeType){case 9:case 11:r=(r=a.documentElement)&&(r=r.namespaceURI)?om(r):0;break;default:if(r=a.tagName,a=a.namespaceURI)a=om(a),r=cm(a,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}D(U),k(U,r)}function vt(){D(U),D(j),D(J)}function gt(r){r.memoizedState!==null&&k(_t,r);var a=U.current,c=cm(a,r.type);a!==c&&(k(j,r),k(U,c))}function Pt(r){j.current===r&&(D(U),D(j)),_t.current===r&&(D(_t),$l._currentValue=Tt)}var It=Object.prototype.hasOwnProperty,ee=n.unstable_scheduleCallback,jt=n.unstable_cancelCallback,ln=n.unstable_shouldYield,pe=n.unstable_requestPaint,Ot=n.unstable_now,ki=n.unstable_getCurrentPriorityLevel,on=n.unstable_ImmediatePriority,Un=n.unstable_UserBlockingPriority,Cn=n.unstable_NormalPriority,jo=n.unstable_LowPriority,$s=n.unstable_IdlePriority,cn=n.log,Ks=n.unstable_setDisableYieldValue,nr=null,li=null;function Ai(r){if(typeof cn=="function"&&Ks(r),li&&typeof li.setStrictMode=="function")try{li.setStrictMode(nr,r)}catch{}}var bi=Math.clz32?Math.clz32:qo,Xo=Math.log,Yo=Math.LN2;function qo(r){return r>>>=0,r===0?32:31-(Xo(r)/Yo|0)|0}var us=256,hs=4194304;function Hn(r){var a=r&42;if(a!==0)return a;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Qs(r,a,c){var h=r.pendingLanes;if(h===0)return 0;var g=0,x=r.suspendedLanes,S=r.pingedLanes;r=r.warmLanes;var R=h&134217727;return R!==0?(h=R&~x,h!==0?g=Hn(h):(S&=R,S!==0?g=Hn(S):c||(c=R&~r,c!==0&&(g=Hn(c))))):(R=h&~x,R!==0?g=Hn(R):S!==0?g=Hn(S):c||(c=h&~r,c!==0&&(g=Hn(c)))),g===0?0:a!==0&&a!==g&&(a&x)===0&&(x=g&-g,c=a&-a,x>=c||x===32&&(c&4194048)!==0)?a:g}function fs(r,a){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&a)===0}function Wo(r,a){switch(r){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function il(){var r=us;return us<<=1,(us&4194048)===0&&(us=256),r}function nl(){var r=hs;return hs<<=1,(hs&62914560)===0&&(hs=4194304),r}function rl(r){for(var a=[],c=0;31>c;c++)a.push(r);return a}function ds(r,a){r.pendingLanes|=a,a!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Zs(r,a,c,h,g,x){var S=r.pendingLanes;r.pendingLanes=c,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=c,r.entangledLanes&=c,r.errorRecoveryDisabledLanes&=c,r.shellSuspendCounter=0;var R=r.entanglements,X=r.expirationTimes,it=r.hiddenUpdates;for(c=S&~c;0<c;){var pt=31-bi(c),xt=1<<pt;R[pt]=0,X[pt]=-1;var lt=it[pt];if(lt!==null)for(it[pt]=null,pt=0;pt<lt.length;pt++){var ct=lt[pt];ct!==null&&(ct.lane&=-536870913)}c&=~xt}h!==0&&$o(r,h,0),x!==0&&g===0&&r.tag!==0&&(r.suspendedLanes|=x&~(S&~a))}function $o(r,a,c){r.pendingLanes|=a,r.suspendedLanes&=~a;var h=31-bi(a);r.entangledLanes|=a,r.entanglements[h]=r.entanglements[h]|1073741824|c&4194090}function Ko(r,a){var c=r.entangledLanes|=a;for(r=r.entanglements;c;){var h=31-bi(c),g=1<<h;g&a|r[h]&a&&(r[h]|=a),c&=~g}}function sl(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function al(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Qo(){var r=nt.p;return r!==0?r:(r=window.event,r===void 0?32:Rm(r.type))}function ah(r,a){var c=nt.p;try{return nt.p=r,a()}finally{nt.p=c}}var zn=Math.random().toString(36).slice(2),Ze="__reactFiber$"+zn,Je="__reactProps$"+zn,Dr="__reactContainer$"+zn,ll="__reactEvents$"+zn,lh="__reactListeners$"+zn,C="__reactHandles$"+zn,I="__reactResources$"+zn,N="__reactMarker$"+zn;function P(r){delete r[Ze],delete r[Je],delete r[ll],delete r[lh],delete r[C]}function B(r){var a=r[Ze];if(a)return a;for(var c=r.parentNode;c;){if(a=c[Dr]||c[Ze]){if(c=a.alternate,a.child!==null||c!==null&&c.child!==null)for(r=dm(r);r!==null;){if(c=r[Ze])return c;r=dm(r)}return a}r=c,c=r.parentNode}return null}function H(r){if(r=r[Ze]||r[Dr]){var a=r.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return r}return null}function rt(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r.stateNode;throw Error(i(33))}function ft(r){var a=r[I];return a||(a=r[I]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function tt(r){r[N]=!0}var at=new Set,ot={};function St(r,a){Ct(r,a),Ct(r+"Capture",a)}function Ct(r,a){for(ot[r]=a,r=0;r<a.length;r++)at.add(a[r])}var Nt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),wt={},Mt={};function Yt(r){return It.call(Mt,r)?!0:It.call(wt,r)?!1:Nt.test(r)?Mt[r]=!0:(wt[r]=!0,!1)}function ge(r,a,c){if(Yt(a))if(c===null)r.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":r.removeAttribute(a);return;case"boolean":var h=a.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){r.removeAttribute(a);return}}r.setAttribute(a,""+c)}}function me(r,a,c){if(c===null)r.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(a);return}r.setAttribute(a,""+c)}}function Se(r,a,c,h){if(h===null)r.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(c);return}r.setAttributeNS(a,c,""+h)}}var rr,Or;function un(r){if(rr===void 0)try{throw Error()}catch(c){var a=c.stack.trim().match(/\n( *(at )?)/);rr=a&&a[1]||"",Or=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+rr+r+Or}var Rn=!1;function ps(r,a){if(!r||Rn)return"";Rn=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(a){var xt=function(){throw Error()};if(Object.defineProperty(xt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xt,[])}catch(ct){var lt=ct}Reflect.construct(r,[],xt)}else{try{xt.call()}catch(ct){lt=ct}r.call(xt.prototype)}}else{try{throw Error()}catch(ct){lt=ct}(xt=r())&&typeof xt.catch=="function"&&xt.catch(function(){})}}catch(ct){if(ct&&lt&&typeof ct.stack=="string")return[ct.stack,lt.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=h.DetermineComponentFrameRoot(),S=x[0],R=x[1];if(S&&R){var X=S.split(`
`),it=R.split(`
`);for(g=h=0;h<X.length&&!X[h].includes("DetermineComponentFrameRoot");)h++;for(;g<it.length&&!it[g].includes("DetermineComponentFrameRoot");)g++;if(h===X.length||g===it.length)for(h=X.length-1,g=it.length-1;1<=h&&0<=g&&X[h]!==it[g];)g--;for(;1<=h&&0<=g;h--,g--)if(X[h]!==it[g]){if(h!==1||g!==1)do if(h--,g--,0>g||X[h]!==it[g]){var pt=`
`+X[h].replace(" at new "," at ");return r.displayName&&pt.includes("<anonymous>")&&(pt=pt.replace("<anonymous>",r.displayName)),pt}while(1<=h&&0<=g);break}}}finally{Rn=!1,Error.prepareStackTrace=c}return(c=r?r.displayName||r.name:"")?un(c):""}function Dn(r){switch(r.tag){case 26:case 27:case 5:return un(r.type);case 16:return un("Lazy");case 13:return un("Suspense");case 19:return un("SuspenseList");case 0:case 15:return ps(r.type,!1);case 11:return ps(r.type.render,!1);case 1:return ps(r.type,!0);case 31:return un("Activity");default:return""}}function ip(r){try{var a="";do a+=Dn(r),r=r.return;while(r);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function hn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function np(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Py(r){var a=np(r)?"checked":"value",c=Object.getOwnPropertyDescriptor(r.constructor.prototype,a),h=""+r[a];if(!r.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var g=c.get,x=c.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return g.call(this)},set:function(S){h=""+S,x.call(this,S)}}),Object.defineProperty(r,a,{enumerable:c.enumerable}),{getValue:function(){return h},setValue:function(S){h=""+S},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function Zo(r){r._valueTracker||(r._valueTracker=Py(r))}function rp(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var c=a.getValue(),h="";return r&&(h=np(r)?r.checked?"true":"false":r.value),r=h,r!==c?(a.setValue(r),!0):!1}function Jo(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var By=/[\n"\\]/g;function fn(r){return r.replace(By,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function oh(r,a,c,h,g,x,S,R){r.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?r.type=S:r.removeAttribute("type"),a!=null?S==="number"?(a===0&&r.value===""||r.value!=a)&&(r.value=""+hn(a)):r.value!==""+hn(a)&&(r.value=""+hn(a)):S!=="submit"&&S!=="reset"||r.removeAttribute("value"),a!=null?ch(r,S,hn(a)):c!=null?ch(r,S,hn(c)):h!=null&&r.removeAttribute("value"),g==null&&x!=null&&(r.defaultChecked=!!x),g!=null&&(r.checked=g&&typeof g!="function"&&typeof g!="symbol"),R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?r.name=""+hn(R):r.removeAttribute("name")}function sp(r,a,c,h,g,x,S,R){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(r.type=x),a!=null||c!=null){if(!(x!=="submit"&&x!=="reset"||a!=null))return;c=c!=null?""+hn(c):"",a=a!=null?""+hn(a):c,R||a===r.value||(r.value=a),r.defaultValue=a}h=h??g,h=typeof h!="function"&&typeof h!="symbol"&&!!h,r.checked=R?r.checked:!!h,r.defaultChecked=!!h,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(r.name=S)}function ch(r,a,c){a==="number"&&Jo(r.ownerDocument)===r||r.defaultValue===""+c||(r.defaultValue=""+c)}function Js(r,a,c,h){if(r=r.options,a){a={};for(var g=0;g<c.length;g++)a["$"+c[g]]=!0;for(c=0;c<r.length;c++)g=a.hasOwnProperty("$"+r[c].value),r[c].selected!==g&&(r[c].selected=g),g&&h&&(r[c].defaultSelected=!0)}else{for(c=""+hn(c),a=null,g=0;g<r.length;g++){if(r[g].value===c){r[g].selected=!0,h&&(r[g].defaultSelected=!0);return}a!==null||r[g].disabled||(a=r[g])}a!==null&&(a.selected=!0)}}function ap(r,a,c){if(a!=null&&(a=""+hn(a),a!==r.value&&(r.value=a),c==null)){r.defaultValue!==a&&(r.defaultValue=a);return}r.defaultValue=c!=null?""+hn(c):""}function lp(r,a,c,h){if(a==null){if(h!=null){if(c!=null)throw Error(i(92));if(Et(h)){if(1<h.length)throw Error(i(93));h=h[0]}c=h}c==null&&(c=""),a=c}c=hn(a),r.defaultValue=c,h=r.textContent,h===c&&h!==""&&h!==null&&(r.value=h)}function ta(r,a){if(a){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=a;return}}r.textContent=a}var Iy=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function op(r,a,c){var h=a.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?r.setProperty(a,""):a==="float"?r.cssFloat="":r[a]="":h?r.setProperty(a,c):typeof c!="number"||c===0||Iy.has(a)?a==="float"?r.cssFloat=c:r[a]=(""+c).trim():r[a]=c+"px"}function cp(r,a,c){if(a!=null&&typeof a!="object")throw Error(i(62));if(r=r.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||a!=null&&a.hasOwnProperty(h)||(h.indexOf("--")===0?r.setProperty(h,""):h==="float"?r.cssFloat="":r[h]="");for(var g in a)h=a[g],a.hasOwnProperty(g)&&c[g]!==h&&op(r,g,h)}else for(var x in a)a.hasOwnProperty(x)&&op(r,x,a[x])}function uh(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Uy=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Hy=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function tc(r){return Hy.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var hh=null;function fh(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var ea=null,ia=null;function up(r){var a=H(r);if(a&&(r=a.stateNode)){var c=r[Je]||null;t:switch(r=a.stateNode,a.type){case"input":if(oh(r,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),a=c.name,c.type==="radio"&&a!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+fn(""+a)+'"][type="radio"]'),a=0;a<c.length;a++){var h=c[a];if(h!==r&&h.form===r.form){var g=h[Je]||null;if(!g)throw Error(i(90));oh(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(a=0;a<c.length;a++)h=c[a],h.form===r.form&&rp(h)}break t;case"textarea":ap(r,c.value,c.defaultValue);break t;case"select":a=c.value,a!=null&&Js(r,!!c.multiple,a,!1)}}}var dh=!1;function hp(r,a,c){if(dh)return r(a,c);dh=!0;try{var h=r(a);return h}finally{if(dh=!1,(ea!==null||ia!==null)&&(Uc(),ea&&(a=ea,r=ia,ia=ea=null,up(a),r)))for(a=0;a<r.length;a++)up(r[a])}}function ol(r,a){var c=r.stateNode;if(c===null)return null;var h=c[Je]||null;if(h===null)return null;c=h[a];t:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break t;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(i(231,a,typeof c));return c}var sr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ph=!1;if(sr)try{var cl={};Object.defineProperty(cl,"passive",{get:function(){ph=!0}}),window.addEventListener("test",cl,cl),window.removeEventListener("test",cl,cl)}catch{ph=!1}var Mr=null,gh=null,ec=null;function fp(){if(ec)return ec;var r,a=gh,c=a.length,h,g="value"in Mr?Mr.value:Mr.textContent,x=g.length;for(r=0;r<c&&a[r]===g[r];r++);var S=c-r;for(h=1;h<=S&&a[c-h]===g[x-h];h++);return ec=g.slice(r,1<h?1-h:void 0)}function ic(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function nc(){return!0}function dp(){return!1}function Pi(r){function a(c,h,g,x,S){this._reactName=c,this._targetInst=g,this.type=h,this.nativeEvent=x,this.target=S,this.currentTarget=null;for(var R in r)r.hasOwnProperty(R)&&(c=r[R],this[R]=c?c(x):x[R]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?nc:dp,this.isPropagationStopped=dp,this}return p(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=nc)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=nc)},persist:function(){},isPersistent:nc}),a}var gs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rc=Pi(gs),ul=p({},gs,{view:0,detail:0}),zy=Pi(ul),mh,vh,hl,sc=p({},ul,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_h,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==hl&&(hl&&r.type==="mousemove"?(mh=r.screenX-hl.screenX,vh=r.screenY-hl.screenY):vh=mh=0,hl=r),mh)},movementY:function(r){return"movementY"in r?r.movementY:vh}}),pp=Pi(sc),Gy=p({},sc,{dataTransfer:0}),Vy=Pi(Gy),jy=p({},ul,{relatedTarget:0}),xh=Pi(jy),Xy=p({},gs,{animationName:0,elapsedTime:0,pseudoElement:0}),Yy=Pi(Xy),qy=p({},gs,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Wy=Pi(qy),$y=p({},gs,{data:0}),gp=Pi($y),Ky={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Zy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Jy(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=Zy[r])?!!a[r]:!1}function _h(){return Jy}var tA=p({},ul,{key:function(r){if(r.key){var a=Ky[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=ic(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Qy[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_h,charCode:function(r){return r.type==="keypress"?ic(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?ic(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),eA=Pi(tA),iA=p({},sc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mp=Pi(iA),nA=p({},ul,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_h}),rA=Pi(nA),sA=p({},gs,{propertyName:0,elapsedTime:0,pseudoElement:0}),aA=Pi(sA),lA=p({},sc,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),oA=Pi(lA),cA=p({},gs,{newState:0,oldState:0}),uA=Pi(cA),hA=[9,13,27,32],yh=sr&&"CompositionEvent"in window,fl=null;sr&&"documentMode"in document&&(fl=document.documentMode);var fA=sr&&"TextEvent"in window&&!fl,vp=sr&&(!yh||fl&&8<fl&&11>=fl),xp=" ",_p=!1;function yp(r,a){switch(r){case"keyup":return hA.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ap(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var na=!1;function dA(r,a){switch(r){case"compositionend":return Ap(a);case"keypress":return a.which!==32?null:(_p=!0,xp);case"textInput":return r=a.data,r===xp&&_p?null:r;default:return null}}function pA(r,a){if(na)return r==="compositionend"||!yh&&yp(r,a)?(r=fp(),ec=gh=Mr=null,na=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return vp&&a.locale!=="ko"?null:a.data;default:return null}}var gA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ep(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!gA[r.type]:a==="textarea"}function Sp(r,a,c,h){ea?ia?ia.push(h):ia=[h]:ea=h,a=Xc(a,"onChange"),0<a.length&&(c=new rc("onChange","change",null,c,h),r.push({event:c,listeners:a}))}var dl=null,pl=null;function mA(r){nm(r,0)}function ac(r){var a=rt(r);if(rp(a))return r}function Tp(r,a){if(r==="change")return a}var wp=!1;if(sr){var Ah;if(sr){var Eh="oninput"in document;if(!Eh){var bp=document.createElement("div");bp.setAttribute("oninput","return;"),Eh=typeof bp.oninput=="function"}Ah=Eh}else Ah=!1;wp=Ah&&(!document.documentMode||9<document.documentMode)}function Cp(){dl&&(dl.detachEvent("onpropertychange",Rp),pl=dl=null)}function Rp(r){if(r.propertyName==="value"&&ac(pl)){var a=[];Sp(a,pl,r,fh(r)),hp(mA,a)}}function vA(r,a,c){r==="focusin"?(Cp(),dl=a,pl=c,dl.attachEvent("onpropertychange",Rp)):r==="focusout"&&Cp()}function xA(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return ac(pl)}function _A(r,a){if(r==="click")return ac(a)}function yA(r,a){if(r==="input"||r==="change")return ac(a)}function AA(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var Yi=typeof Object.is=="function"?Object.is:AA;function gl(r,a){if(Yi(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var c=Object.keys(r),h=Object.keys(a);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var g=c[h];if(!It.call(a,g)||!Yi(r[g],a[g]))return!1}return!0}function Dp(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Op(r,a){var c=Dp(r);r=0;for(var h;c;){if(c.nodeType===3){if(h=r+c.textContent.length,r<=a&&h>=a)return{node:c,offset:a-r};r=h}t:{for(;c;){if(c.nextSibling){c=c.nextSibling;break t}c=c.parentNode}c=void 0}c=Dp(c)}}function Mp(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?Mp(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function Np(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var a=Jo(r.document);a instanceof r.HTMLIFrameElement;){try{var c=typeof a.contentWindow.location.href=="string"}catch{c=!1}if(c)r=a.contentWindow;else break;a=Jo(r.document)}return a}function Sh(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}var EA=sr&&"documentMode"in document&&11>=document.documentMode,ra=null,Th=null,ml=null,wh=!1;function Lp(r,a,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;wh||ra==null||ra!==Jo(h)||(h=ra,"selectionStart"in h&&Sh(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),ml&&gl(ml,h)||(ml=h,h=Xc(Th,"onSelect"),0<h.length&&(a=new rc("onSelect","select",null,a,c),r.push({event:a,listeners:h}),a.target=ra)))}function ms(r,a){var c={};return c[r.toLowerCase()]=a.toLowerCase(),c["Webkit"+r]="webkit"+a,c["Moz"+r]="moz"+a,c}var sa={animationend:ms("Animation","AnimationEnd"),animationiteration:ms("Animation","AnimationIteration"),animationstart:ms("Animation","AnimationStart"),transitionrun:ms("Transition","TransitionRun"),transitionstart:ms("Transition","TransitionStart"),transitioncancel:ms("Transition","TransitionCancel"),transitionend:ms("Transition","TransitionEnd")},bh={},Fp={};sr&&(Fp=document.createElement("div").style,"AnimationEvent"in window||(delete sa.animationend.animation,delete sa.animationiteration.animation,delete sa.animationstart.animation),"TransitionEvent"in window||delete sa.transitionend.transition);function vs(r){if(bh[r])return bh[r];if(!sa[r])return r;var a=sa[r],c;for(c in a)if(a.hasOwnProperty(c)&&c in Fp)return bh[r]=a[c];return r}var kp=vs("animationend"),Pp=vs("animationiteration"),Bp=vs("animationstart"),SA=vs("transitionrun"),TA=vs("transitionstart"),wA=vs("transitioncancel"),Ip=vs("transitionend"),Up=new Map,Ch="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ch.push("scrollEnd");function On(r,a){Up.set(r,a),St(a,[r])}var Hp=new WeakMap;function dn(r,a){if(typeof r=="object"&&r!==null){var c=Hp.get(r);return c!==void 0?c:(a={value:r,source:a,stack:ip(a)},Hp.set(r,a),a)}return{value:r,source:a,stack:ip(a)}}var pn=[],aa=0,Rh=0;function lc(){for(var r=aa,a=Rh=aa=0;a<r;){var c=pn[a];pn[a++]=null;var h=pn[a];pn[a++]=null;var g=pn[a];pn[a++]=null;var x=pn[a];if(pn[a++]=null,h!==null&&g!==null){var S=h.pending;S===null?g.next=g:(g.next=S.next,S.next=g),h.pending=g}x!==0&&zp(c,g,x)}}function oc(r,a,c,h){pn[aa++]=r,pn[aa++]=a,pn[aa++]=c,pn[aa++]=h,Rh|=h,r.lanes|=h,r=r.alternate,r!==null&&(r.lanes|=h)}function Dh(r,a,c,h){return oc(r,a,c,h),cc(r)}function la(r,a){return oc(r,null,null,a),cc(r)}function zp(r,a,c){r.lanes|=c;var h=r.alternate;h!==null&&(h.lanes|=c);for(var g=!1,x=r.return;x!==null;)x.childLanes|=c,h=x.alternate,h!==null&&(h.childLanes|=c),x.tag===22&&(r=x.stateNode,r===null||r._visibility&1||(g=!0)),r=x,x=x.return;return r.tag===3?(x=r.stateNode,g&&a!==null&&(g=31-bi(c),r=x.hiddenUpdates,h=r[g],h===null?r[g]=[a]:h.push(a),a.lane=c|536870912),x):null}function cc(r){if(50<zl)throw zl=0,Pf=null,Error(i(185));for(var a=r.return;a!==null;)r=a,a=r.return;return r.tag===3?r.stateNode:null}var oa={};function bA(r,a,c,h){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qi(r,a,c,h){return new bA(r,a,c,h)}function Oh(r){return r=r.prototype,!(!r||!r.isReactComponent)}function ar(r,a){var c=r.alternate;return c===null?(c=qi(r.tag,a,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=a,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&65011712,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,a=r.dependencies,c.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c.refCleanup=r.refCleanup,c}function Gp(r,a){r.flags&=65011714;var c=r.alternate;return c===null?(r.childLanes=0,r.lanes=a,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=c.childLanes,r.lanes=c.lanes,r.child=c.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=c.memoizedProps,r.memoizedState=c.memoizedState,r.updateQueue=c.updateQueue,r.type=c.type,a=c.dependencies,r.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),r}function uc(r,a,c,h,g,x){var S=0;if(h=r,typeof r=="function")Oh(r)&&(S=1);else if(typeof r=="string")S=R2(r,c,U.current)?26:r==="html"||r==="head"||r==="body"?27:5;else t:switch(r){case V:return r=qi(31,c,a,g),r.elementType=V,r.lanes=x,r;case A:return xs(c.children,g,x,a);case y:S=8,g|=24;break;case E:return r=qi(12,c,a,g|2),r.elementType=E,r.lanes=x,r;case F:return r=qi(13,c,a,g),r.elementType=F,r.lanes=x,r;case z:return r=qi(19,c,a,g),r.elementType=z,r.lanes=x,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case T:case w:S=10;break t;case b:S=9;break t;case O:S=11;break t;case L:S=14;break t;case G:S=16,h=null;break t}S=29,c=Error(i(130,r===null?"null":typeof r,"")),h=null}return a=qi(S,c,a,g),a.elementType=r,a.type=h,a.lanes=x,a}function xs(r,a,c,h){return r=qi(7,r,h,a),r.lanes=c,r}function Mh(r,a,c){return r=qi(6,r,null,a),r.lanes=c,r}function Nh(r,a,c){return a=qi(4,r.children!==null?r.children:[],r.key,a),a.lanes=c,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}var ca=[],ua=0,hc=null,fc=0,gn=[],mn=0,_s=null,lr=1,or="";function ys(r,a){ca[ua++]=fc,ca[ua++]=hc,hc=r,fc=a}function Vp(r,a,c){gn[mn++]=lr,gn[mn++]=or,gn[mn++]=_s,_s=r;var h=lr;r=or;var g=32-bi(h)-1;h&=~(1<<g),c+=1;var x=32-bi(a)+g;if(30<x){var S=g-g%5;x=(h&(1<<S)-1).toString(32),h>>=S,g-=S,lr=1<<32-bi(a)+g|c<<g|h,or=x+r}else lr=1<<x|c<<g|h,or=r}function Lh(r){r.return!==null&&(ys(r,1),Vp(r,1,0))}function Fh(r){for(;r===hc;)hc=ca[--ua],ca[ua]=null,fc=ca[--ua],ca[ua]=null;for(;r===_s;)_s=gn[--mn],gn[mn]=null,or=gn[--mn],gn[mn]=null,lr=gn[--mn],gn[mn]=null}var Ci=null,Me=null,ae=!1,As=null,Gn=!1,kh=Error(i(519));function Es(r){var a=Error(i(418,""));throw _l(dn(a,r)),kh}function jp(r){var a=r.stateNode,c=r.type,h=r.memoizedProps;switch(a[Ze]=r,a[Je]=h,c){case"dialog":te("cancel",a),te("close",a);break;case"iframe":case"object":case"embed":te("load",a);break;case"video":case"audio":for(c=0;c<Vl.length;c++)te(Vl[c],a);break;case"source":te("error",a);break;case"img":case"image":case"link":te("error",a),te("load",a);break;case"details":te("toggle",a);break;case"input":te("invalid",a),sp(a,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0),Zo(a);break;case"select":te("invalid",a);break;case"textarea":te("invalid",a),lp(a,h.value,h.defaultValue,h.children),Zo(a)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||a.textContent===""+c||h.suppressHydrationWarning===!0||lm(a.textContent,c)?(h.popover!=null&&(te("beforetoggle",a),te("toggle",a)),h.onScroll!=null&&te("scroll",a),h.onScrollEnd!=null&&te("scrollend",a),h.onClick!=null&&(a.onclick=Yc),a=!0):a=!1,a||Es(r)}function Xp(r){for(Ci=r.return;Ci;)switch(Ci.tag){case 5:case 13:Gn=!1;return;case 27:case 3:Gn=!0;return;default:Ci=Ci.return}}function vl(r){if(r!==Ci)return!1;if(!ae)return Xp(r),ae=!0,!1;var a=r.tag,c;if((c=a!==3&&a!==27)&&((c=a===5)&&(c=r.type,c=!(c!=="form"&&c!=="button")||Zf(r.type,r.memoizedProps)),c=!c),c&&Me&&Es(r),Xp(r),a===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));t:{for(r=r.nextSibling,a=0;r;){if(r.nodeType===8)if(c=r.data,c==="/$"){if(a===0){Me=Nn(r.nextSibling);break t}a--}else c!=="$"&&c!=="$!"&&c!=="$?"||a++;r=r.nextSibling}Me=null}}else a===27?(a=Me,qr(r.type)?(r=i0,i0=null,Me=r):Me=a):Me=Ci?Nn(r.stateNode.nextSibling):null;return!0}function xl(){Me=Ci=null,ae=!1}function Yp(){var r=As;return r!==null&&(Ui===null?Ui=r:Ui.push.apply(Ui,r),As=null),r}function _l(r){As===null?As=[r]:As.push(r)}var Ph=q(null),Ss=null,cr=null;function Nr(r,a,c){k(Ph,a._currentValue),a._currentValue=c}function ur(r){r._currentValue=Ph.current,D(Ph)}function Bh(r,a,c){for(;r!==null;){var h=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,h!==null&&(h.childLanes|=a)):h!==null&&(h.childLanes&a)!==a&&(h.childLanes|=a),r===c)break;r=r.return}}function Ih(r,a,c,h){var g=r.child;for(g!==null&&(g.return=r);g!==null;){var x=g.dependencies;if(x!==null){var S=g.child;x=x.firstContext;t:for(;x!==null;){var R=x;x=g;for(var X=0;X<a.length;X++)if(R.context===a[X]){x.lanes|=c,R=x.alternate,R!==null&&(R.lanes|=c),Bh(x.return,c,r),h||(S=null);break t}x=R.next}}else if(g.tag===18){if(S=g.return,S===null)throw Error(i(341));S.lanes|=c,x=S.alternate,x!==null&&(x.lanes|=c),Bh(S,c,r),S=null}else S=g.child;if(S!==null)S.return=g;else for(S=g;S!==null;){if(S===r){S=null;break}if(g=S.sibling,g!==null){g.return=S.return,S=g;break}S=S.return}g=S}}function yl(r,a,c,h){r=null;for(var g=a,x=!1;g!==null;){if(!x){if((g.flags&524288)!==0)x=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var S=g.alternate;if(S===null)throw Error(i(387));if(S=S.memoizedProps,S!==null){var R=g.type;Yi(g.pendingProps.value,S.value)||(r!==null?r.push(R):r=[R])}}else if(g===_t.current){if(S=g.alternate,S===null)throw Error(i(387));S.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(r!==null?r.push($l):r=[$l])}g=g.return}r!==null&&Ih(a,r,c,h),a.flags|=262144}function dc(r){for(r=r.firstContext;r!==null;){if(!Yi(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Ts(r){Ss=r,cr=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Ei(r){return qp(Ss,r)}function pc(r,a){return Ss===null&&Ts(r),qp(r,a)}function qp(r,a){var c=a._currentValue;if(a={context:a,memoizedValue:c,next:null},cr===null){if(r===null)throw Error(i(308));cr=a,r.dependencies={lanes:0,firstContext:a},r.flags|=524288}else cr=cr.next=a;return c}var CA=typeof AbortController<"u"?AbortController:function(){var r=[],a=this.signal={aborted:!1,addEventListener:function(c,h){r.push(h)}};this.abort=function(){a.aborted=!0,r.forEach(function(c){return c()})}},RA=n.unstable_scheduleCallback,DA=n.unstable_NormalPriority,$e={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Uh(){return{controller:new CA,data:new Map,refCount:0}}function Al(r){r.refCount--,r.refCount===0&&RA(DA,function(){r.controller.abort()})}var El=null,Hh=0,ha=0,fa=null;function OA(r,a){if(El===null){var c=El=[];Hh=0,ha=Vf(),fa={status:"pending",value:void 0,then:function(h){c.push(h)}}}return Hh++,a.then(Wp,Wp),a}function Wp(){if(--Hh===0&&El!==null){fa!==null&&(fa.status="fulfilled");var r=El;El=null,ha=0,fa=null;for(var a=0;a<r.length;a++)(0,r[a])()}}function MA(r,a){var c=[],h={status:"pending",value:null,reason:null,then:function(g){c.push(g)}};return r.then(function(){h.status="fulfilled",h.value=a;for(var g=0;g<c.length;g++)(0,c[g])(a)},function(g){for(h.status="rejected",h.reason=g,g=0;g<c.length;g++)(0,c[g])(void 0)}),h}var $p=Y.S;Y.S=function(r,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&OA(r,a),$p!==null&&$p(r,a)};var ws=q(null);function zh(){var r=ws.current;return r!==null?r:Te.pooledCache}function gc(r,a){a===null?k(ws,ws.current):k(ws,a.pool)}function Kp(){var r=zh();return r===null?null:{parent:$e._currentValue,pool:r}}var Sl=Error(i(460)),Qp=Error(i(474)),mc=Error(i(542)),Gh={then:function(){}};function Zp(r){return r=r.status,r==="fulfilled"||r==="rejected"}function vc(){}function Jp(r,a,c){switch(c=r[c],c===void 0?r.push(a):c!==a&&(a.then(vc,vc),a=c),a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,eg(r),r;default:if(typeof a.status=="string")a.then(vc,vc);else{if(r=Te,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=a,r.status="pending",r.then(function(h){if(a.status==="pending"){var g=a;g.status="fulfilled",g.value=h}},function(h){if(a.status==="pending"){var g=a;g.status="rejected",g.reason=h}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,eg(r),r}throw Tl=a,Sl}}var Tl=null;function tg(){if(Tl===null)throw Error(i(459));var r=Tl;return Tl=null,r}function eg(r){if(r===Sl||r===mc)throw Error(i(483))}var Lr=!1;function Vh(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function jh(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Fr(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function kr(r,a,c){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(oe&2)!==0){var g=h.pending;return g===null?a.next=a:(a.next=g.next,g.next=a),h.pending=a,a=cc(r),zp(r,null,c),a}return oc(r,h,a,c),cc(r)}function wl(r,a,c){if(a=a.updateQueue,a!==null&&(a=a.shared,(c&4194048)!==0)){var h=a.lanes;h&=r.pendingLanes,c|=h,a.lanes=c,Ko(r,c)}}function Xh(r,a){var c=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var g=null,x=null;if(c=c.firstBaseUpdate,c!==null){do{var S={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};x===null?g=x=S:x=x.next=S,c=c.next}while(c!==null);x===null?g=x=a:x=x.next=a}else g=x=a;c={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:x,shared:h.shared,callbacks:h.callbacks},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=a:r.next=a,c.lastBaseUpdate=a}var Yh=!1;function bl(){if(Yh){var r=fa;if(r!==null)throw r}}function Cl(r,a,c,h){Yh=!1;var g=r.updateQueue;Lr=!1;var x=g.firstBaseUpdate,S=g.lastBaseUpdate,R=g.shared.pending;if(R!==null){g.shared.pending=null;var X=R,it=X.next;X.next=null,S===null?x=it:S.next=it,S=X;var pt=r.alternate;pt!==null&&(pt=pt.updateQueue,R=pt.lastBaseUpdate,R!==S&&(R===null?pt.firstBaseUpdate=it:R.next=it,pt.lastBaseUpdate=X))}if(x!==null){var xt=g.baseState;S=0,pt=it=X=null,R=x;do{var lt=R.lane&-536870913,ct=lt!==R.lane;if(ct?(ne&lt)===lt:(h&lt)===lt){lt!==0&&lt===ha&&(Yh=!0),pt!==null&&(pt=pt.next={lane:0,tag:R.tag,payload:R.payload,callback:null,next:null});t:{var Vt=r,Ht=R;lt=a;var _e=c;switch(Ht.tag){case 1:if(Vt=Ht.payload,typeof Vt=="function"){xt=Vt.call(_e,xt,lt);break t}xt=Vt;break t;case 3:Vt.flags=Vt.flags&-65537|128;case 0:if(Vt=Ht.payload,lt=typeof Vt=="function"?Vt.call(_e,xt,lt):Vt,lt==null)break t;xt=p({},xt,lt);break t;case 2:Lr=!0}}lt=R.callback,lt!==null&&(r.flags|=64,ct&&(r.flags|=8192),ct=g.callbacks,ct===null?g.callbacks=[lt]:ct.push(lt))}else ct={lane:lt,tag:R.tag,payload:R.payload,callback:R.callback,next:null},pt===null?(it=pt=ct,X=xt):pt=pt.next=ct,S|=lt;if(R=R.next,R===null){if(R=g.shared.pending,R===null)break;ct=R,R=ct.next,ct.next=null,g.lastBaseUpdate=ct,g.shared.pending=null}}while(!0);pt===null&&(X=xt),g.baseState=X,g.firstBaseUpdate=it,g.lastBaseUpdate=pt,x===null&&(g.shared.lanes=0),Vr|=S,r.lanes=S,r.memoizedState=xt}}function ig(r,a){if(typeof r!="function")throw Error(i(191,r));r.call(a)}function ng(r,a){var c=r.callbacks;if(c!==null)for(r.callbacks=null,r=0;r<c.length;r++)ig(c[r],a)}var da=q(null),xc=q(0);function rg(r,a){r=vr,k(xc,r),k(da,a),vr=r|a.baseLanes}function qh(){k(xc,vr),k(da,da.current)}function Wh(){vr=xc.current,D(da),D(xc)}var Pr=0,Kt=null,ve=null,He=null,_c=!1,pa=!1,bs=!1,yc=0,Rl=0,ga=null,NA=0;function Pe(){throw Error(i(321))}function $h(r,a){if(a===null)return!1;for(var c=0;c<a.length&&c<r.length;c++)if(!Yi(r[c],a[c]))return!1;return!0}function Kh(r,a,c,h,g,x){return Pr=x,Kt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Y.H=r===null||r.memoizedState===null?zg:Gg,bs=!1,x=c(h,g),bs=!1,pa&&(x=ag(a,c,h,g)),sg(r),x}function sg(r){Y.H=bc;var a=ve!==null&&ve.next!==null;if(Pr=0,He=ve=Kt=null,_c=!1,Rl=0,ga=null,a)throw Error(i(300));r===null||ti||(r=r.dependencies,r!==null&&dc(r)&&(ti=!0))}function ag(r,a,c,h){Kt=r;var g=0;do{if(pa&&(ga=null),Rl=0,pa=!1,25<=g)throw Error(i(301));if(g+=1,He=ve=null,r.updateQueue!=null){var x=r.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}Y.H=UA,x=a(c,h)}while(pa);return x}function LA(){var r=Y.H,a=r.useState()[0];return a=typeof a.then=="function"?Dl(a):a,r=r.useState()[0],(ve!==null?ve.memoizedState:null)!==r&&(Kt.flags|=1024),a}function Qh(){var r=yc!==0;return yc=0,r}function Zh(r,a,c){a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~c}function Jh(r){if(_c){for(r=r.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}_c=!1}Pr=0,He=ve=Kt=null,pa=!1,Rl=yc=0,ga=null}function Bi(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return He===null?Kt.memoizedState=He=r:He=He.next=r,He}function ze(){if(ve===null){var r=Kt.alternate;r=r!==null?r.memoizedState:null}else r=ve.next;var a=He===null?Kt.memoizedState:He.next;if(a!==null)He=a,ve=r;else{if(r===null)throw Kt.alternate===null?Error(i(467)):Error(i(310));ve=r,r={memoizedState:ve.memoizedState,baseState:ve.baseState,baseQueue:ve.baseQueue,queue:ve.queue,next:null},He===null?Kt.memoizedState=He=r:He=He.next=r}return He}function tf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Dl(r){var a=Rl;return Rl+=1,ga===null&&(ga=[]),r=Jp(ga,r,a),a=Kt,(He===null?a.memoizedState:He.next)===null&&(a=a.alternate,Y.H=a===null||a.memoizedState===null?zg:Gg),r}function Ac(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Dl(r);if(r.$$typeof===w)return Ei(r)}throw Error(i(438,String(r)))}function ef(r){var a=null,c=Kt.updateQueue;if(c!==null&&(a=c.memoCache),a==null){var h=Kt.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(a={data:h.data.map(function(g){return g.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),c===null&&(c=tf(),Kt.updateQueue=c),c.memoCache=a,c=a.data[a.index],c===void 0)for(c=a.data[a.index]=Array(r),h=0;h<r;h++)c[h]=Q;return a.index++,c}function hr(r,a){return typeof a=="function"?a(r):a}function Ec(r){var a=ze();return nf(a,ve,r)}function nf(r,a,c){var h=r.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=c;var g=r.baseQueue,x=h.pending;if(x!==null){if(g!==null){var S=g.next;g.next=x.next,x.next=S}a.baseQueue=g=x,h.pending=null}if(x=r.baseState,g===null)r.memoizedState=x;else{a=g.next;var R=S=null,X=null,it=a,pt=!1;do{var xt=it.lane&-536870913;if(xt!==it.lane?(ne&xt)===xt:(Pr&xt)===xt){var lt=it.revertLane;if(lt===0)X!==null&&(X=X.next={lane:0,revertLane:0,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null}),xt===ha&&(pt=!0);else if((Pr&lt)===lt){it=it.next,lt===ha&&(pt=!0);continue}else xt={lane:0,revertLane:it.revertLane,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null},X===null?(R=X=xt,S=x):X=X.next=xt,Kt.lanes|=lt,Vr|=lt;xt=it.action,bs&&c(x,xt),x=it.hasEagerState?it.eagerState:c(x,xt)}else lt={lane:xt,revertLane:it.revertLane,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null},X===null?(R=X=lt,S=x):X=X.next=lt,Kt.lanes|=xt,Vr|=xt;it=it.next}while(it!==null&&it!==a);if(X===null?S=x:X.next=R,!Yi(x,r.memoizedState)&&(ti=!0,pt&&(c=fa,c!==null)))throw c;r.memoizedState=x,r.baseState=S,r.baseQueue=X,h.lastRenderedState=x}return g===null&&(h.lanes=0),[r.memoizedState,h.dispatch]}function rf(r){var a=ze(),c=a.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=r;var h=c.dispatch,g=c.pending,x=a.memoizedState;if(g!==null){c.pending=null;var S=g=g.next;do x=r(x,S.action),S=S.next;while(S!==g);Yi(x,a.memoizedState)||(ti=!0),a.memoizedState=x,a.baseQueue===null&&(a.baseState=x),c.lastRenderedState=x}return[x,h]}function lg(r,a,c){var h=Kt,g=ze(),x=ae;if(x){if(c===void 0)throw Error(i(407));c=c()}else c=a();var S=!Yi((ve||g).memoizedState,c);S&&(g.memoizedState=c,ti=!0),g=g.queue;var R=ug.bind(null,h,g,r);if(Ol(2048,8,R,[r]),g.getSnapshot!==a||S||He!==null&&He.memoizedState.tag&1){if(h.flags|=2048,ma(9,Sc(),cg.bind(null,h,g,c,a),null),Te===null)throw Error(i(349));x||(Pr&124)!==0||og(h,a,c)}return c}function og(r,a,c){r.flags|=16384,r={getSnapshot:a,value:c},a=Kt.updateQueue,a===null?(a=tf(),Kt.updateQueue=a,a.stores=[r]):(c=a.stores,c===null?a.stores=[r]:c.push(r))}function cg(r,a,c,h){a.value=c,a.getSnapshot=h,hg(a)&&fg(r)}function ug(r,a,c){return c(function(){hg(a)&&fg(r)})}function hg(r){var a=r.getSnapshot;r=r.value;try{var c=a();return!Yi(r,c)}catch{return!0}}function fg(r){var a=la(r,2);a!==null&&Zi(a,r,2)}function sf(r){var a=Bi();if(typeof r=="function"){var c=r;if(r=c(),bs){Ai(!0);try{c()}finally{Ai(!1)}}}return a.memoizedState=a.baseState=r,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:r},a}function dg(r,a,c,h){return r.baseState=c,nf(r,ve,typeof h=="function"?h:hr)}function FA(r,a,c,h,g){if(wc(r))throw Error(i(485));if(r=a.action,r!==null){var x={payload:g,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){x.listeners.push(S)}};Y.T!==null?c(!0):x.isTransition=!1,h(x),c=a.pending,c===null?(x.next=a.pending=x,pg(a,x)):(x.next=c.next,a.pending=c.next=x)}}function pg(r,a){var c=a.action,h=a.payload,g=r.state;if(a.isTransition){var x=Y.T,S={};Y.T=S;try{var R=c(g,h),X=Y.S;X!==null&&X(S,R),gg(r,a,R)}catch(it){af(r,a,it)}finally{Y.T=x}}else try{x=c(g,h),gg(r,a,x)}catch(it){af(r,a,it)}}function gg(r,a,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){mg(r,a,h)},function(h){return af(r,a,h)}):mg(r,a,c)}function mg(r,a,c){a.status="fulfilled",a.value=c,vg(a),r.state=c,a=r.pending,a!==null&&(c=a.next,c===a?r.pending=null:(c=c.next,a.next=c,pg(r,c)))}function af(r,a,c){var h=r.pending;if(r.pending=null,h!==null){h=h.next;do a.status="rejected",a.reason=c,vg(a),a=a.next;while(a!==h)}r.action=null}function vg(r){r=r.listeners;for(var a=0;a<r.length;a++)(0,r[a])()}function xg(r,a){return a}function _g(r,a){if(ae){var c=Te.formState;if(c!==null){t:{var h=Kt;if(ae){if(Me){e:{for(var g=Me,x=Gn;g.nodeType!==8;){if(!x){g=null;break e}if(g=Nn(g.nextSibling),g===null){g=null;break e}}x=g.data,g=x==="F!"||x==="F"?g:null}if(g){Me=Nn(g.nextSibling),h=g.data==="F!";break t}}Es(h)}h=!1}h&&(a=c[0])}}return c=Bi(),c.memoizedState=c.baseState=a,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xg,lastRenderedState:a},c.queue=h,c=Ig.bind(null,Kt,h),h.dispatch=c,h=sf(!1),x=hf.bind(null,Kt,!1,h.queue),h=Bi(),g={state:a,dispatch:null,action:r,pending:null},h.queue=g,c=FA.bind(null,Kt,g,x,c),g.dispatch=c,h.memoizedState=r,[a,c,!1]}function yg(r){var a=ze();return Ag(a,ve,r)}function Ag(r,a,c){if(a=nf(r,a,xg)[0],r=Ec(hr)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var h=Dl(a)}catch(S){throw S===Sl?mc:S}else h=a;a=ze();var g=a.queue,x=g.dispatch;return c!==a.memoizedState&&(Kt.flags|=2048,ma(9,Sc(),kA.bind(null,g,c),null)),[h,x,r]}function kA(r,a){r.action=a}function Eg(r){var a=ze(),c=ve;if(c!==null)return Ag(a,c,r);ze(),a=a.memoizedState,c=ze();var h=c.queue.dispatch;return c.memoizedState=r,[a,h,!1]}function ma(r,a,c,h){return r={tag:r,create:c,deps:h,inst:a,next:null},a=Kt.updateQueue,a===null&&(a=tf(),Kt.updateQueue=a),c=a.lastEffect,c===null?a.lastEffect=r.next=r:(h=c.next,c.next=r,r.next=h,a.lastEffect=r),r}function Sc(){return{destroy:void 0,resource:void 0}}function Sg(){return ze().memoizedState}function Tc(r,a,c,h){var g=Bi();h=h===void 0?null:h,Kt.flags|=r,g.memoizedState=ma(1|a,Sc(),c,h)}function Ol(r,a,c,h){var g=ze();h=h===void 0?null:h;var x=g.memoizedState.inst;ve!==null&&h!==null&&$h(h,ve.memoizedState.deps)?g.memoizedState=ma(a,x,c,h):(Kt.flags|=r,g.memoizedState=ma(1|a,x,c,h))}function Tg(r,a){Tc(8390656,8,r,a)}function wg(r,a){Ol(2048,8,r,a)}function bg(r,a){return Ol(4,2,r,a)}function Cg(r,a){return Ol(4,4,r,a)}function Rg(r,a){if(typeof a=="function"){r=r();var c=a(r);return function(){typeof c=="function"?c():a(null)}}if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function Dg(r,a,c){c=c!=null?c.concat([r]):null,Ol(4,4,Rg.bind(null,a,r),c)}function lf(){}function Og(r,a){var c=ze();a=a===void 0?null:a;var h=c.memoizedState;return a!==null&&$h(a,h[1])?h[0]:(c.memoizedState=[r,a],r)}function Mg(r,a){var c=ze();a=a===void 0?null:a;var h=c.memoizedState;if(a!==null&&$h(a,h[1]))return h[0];if(h=r(),bs){Ai(!0);try{r()}finally{Ai(!1)}}return c.memoizedState=[h,a],h}function of(r,a,c){return c===void 0||(Pr&1073741824)!==0?r.memoizedState=a:(r.memoizedState=c,r=F1(),Kt.lanes|=r,Vr|=r,c)}function Ng(r,a,c,h){return Yi(c,a)?c:da.current!==null?(r=of(r,c,h),Yi(r,a)||(ti=!0),r):(Pr&42)===0?(ti=!0,r.memoizedState=c):(r=F1(),Kt.lanes|=r,Vr|=r,a)}function Lg(r,a,c,h,g){var x=nt.p;nt.p=x!==0&&8>x?x:8;var S=Y.T,R={};Y.T=R,hf(r,!1,a,c);try{var X=g(),it=Y.S;if(it!==null&&it(R,X),X!==null&&typeof X=="object"&&typeof X.then=="function"){var pt=MA(X,h);Ml(r,a,pt,Qi(r))}else Ml(r,a,h,Qi(r))}catch(xt){Ml(r,a,{then:function(){},status:"rejected",reason:xt},Qi())}finally{nt.p=x,Y.T=S}}function PA(){}function cf(r,a,c,h){if(r.tag!==5)throw Error(i(476));var g=Fg(r).queue;Lg(r,g,a,Tt,c===null?PA:function(){return kg(r),c(h)})}function Fg(r){var a=r.memoizedState;if(a!==null)return a;a={memoizedState:Tt,baseState:Tt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:Tt},next:null};var c={};return a.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:c},next:null},r.memoizedState=a,r=r.alternate,r!==null&&(r.memoizedState=a),a}function kg(r){var a=Fg(r).next.queue;Ml(r,a,{},Qi())}function uf(){return Ei($l)}function Pg(){return ze().memoizedState}function Bg(){return ze().memoizedState}function BA(r){for(var a=r.return;a!==null;){switch(a.tag){case 24:case 3:var c=Qi();r=Fr(c);var h=kr(a,r,c);h!==null&&(Zi(h,a,c),wl(h,a,c)),a={cache:Uh()},r.payload=a;return}a=a.return}}function IA(r,a,c){var h=Qi();c={lane:h,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},wc(r)?Ug(a,c):(c=Dh(r,a,c,h),c!==null&&(Zi(c,r,h),Hg(c,a,h)))}function Ig(r,a,c){var h=Qi();Ml(r,a,c,h)}function Ml(r,a,c,h){var g={lane:h,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(wc(r))Ug(a,g);else{var x=r.alternate;if(r.lanes===0&&(x===null||x.lanes===0)&&(x=a.lastRenderedReducer,x!==null))try{var S=a.lastRenderedState,R=x(S,c);if(g.hasEagerState=!0,g.eagerState=R,Yi(R,S))return oc(r,a,g,0),Te===null&&lc(),!1}catch{}finally{}if(c=Dh(r,a,g,h),c!==null)return Zi(c,r,h),Hg(c,a,h),!0}return!1}function hf(r,a,c,h){if(h={lane:2,revertLane:Vf(),action:h,hasEagerState:!1,eagerState:null,next:null},wc(r)){if(a)throw Error(i(479))}else a=Dh(r,c,h,2),a!==null&&Zi(a,r,2)}function wc(r){var a=r.alternate;return r===Kt||a!==null&&a===Kt}function Ug(r,a){pa=_c=!0;var c=r.pending;c===null?a.next=a:(a.next=c.next,c.next=a),r.pending=a}function Hg(r,a,c){if((c&4194048)!==0){var h=a.lanes;h&=r.pendingLanes,c|=h,a.lanes=c,Ko(r,c)}}var bc={readContext:Ei,use:Ac,useCallback:Pe,useContext:Pe,useEffect:Pe,useImperativeHandle:Pe,useLayoutEffect:Pe,useInsertionEffect:Pe,useMemo:Pe,useReducer:Pe,useRef:Pe,useState:Pe,useDebugValue:Pe,useDeferredValue:Pe,useTransition:Pe,useSyncExternalStore:Pe,useId:Pe,useHostTransitionStatus:Pe,useFormState:Pe,useActionState:Pe,useOptimistic:Pe,useMemoCache:Pe,useCacheRefresh:Pe},zg={readContext:Ei,use:Ac,useCallback:function(r,a){return Bi().memoizedState=[r,a===void 0?null:a],r},useContext:Ei,useEffect:Tg,useImperativeHandle:function(r,a,c){c=c!=null?c.concat([r]):null,Tc(4194308,4,Rg.bind(null,a,r),c)},useLayoutEffect:function(r,a){return Tc(4194308,4,r,a)},useInsertionEffect:function(r,a){Tc(4,2,r,a)},useMemo:function(r,a){var c=Bi();a=a===void 0?null:a;var h=r();if(bs){Ai(!0);try{r()}finally{Ai(!1)}}return c.memoizedState=[h,a],h},useReducer:function(r,a,c){var h=Bi();if(c!==void 0){var g=c(a);if(bs){Ai(!0);try{c(a)}finally{Ai(!1)}}}else g=a;return h.memoizedState=h.baseState=g,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:g},h.queue=r,r=r.dispatch=IA.bind(null,Kt,r),[h.memoizedState,r]},useRef:function(r){var a=Bi();return r={current:r},a.memoizedState=r},useState:function(r){r=sf(r);var a=r.queue,c=Ig.bind(null,Kt,a);return a.dispatch=c,[r.memoizedState,c]},useDebugValue:lf,useDeferredValue:function(r,a){var c=Bi();return of(c,r,a)},useTransition:function(){var r=sf(!1);return r=Lg.bind(null,Kt,r.queue,!0,!1),Bi().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,a,c){var h=Kt,g=Bi();if(ae){if(c===void 0)throw Error(i(407));c=c()}else{if(c=a(),Te===null)throw Error(i(349));(ne&124)!==0||og(h,a,c)}g.memoizedState=c;var x={value:c,getSnapshot:a};return g.queue=x,Tg(ug.bind(null,h,x,r),[r]),h.flags|=2048,ma(9,Sc(),cg.bind(null,h,x,c,a),null),c},useId:function(){var r=Bi(),a=Te.identifierPrefix;if(ae){var c=or,h=lr;c=(h&~(1<<32-bi(h)-1)).toString(32)+c,a="«"+a+"R"+c,c=yc++,0<c&&(a+="H"+c.toString(32)),a+="»"}else c=NA++,a="«"+a+"r"+c.toString(32)+"»";return r.memoizedState=a},useHostTransitionStatus:uf,useFormState:_g,useActionState:_g,useOptimistic:function(r){var a=Bi();a.memoizedState=a.baseState=r;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=c,a=hf.bind(null,Kt,!0,c),c.dispatch=a,[r,a]},useMemoCache:ef,useCacheRefresh:function(){return Bi().memoizedState=BA.bind(null,Kt)}},Gg={readContext:Ei,use:Ac,useCallback:Og,useContext:Ei,useEffect:wg,useImperativeHandle:Dg,useInsertionEffect:bg,useLayoutEffect:Cg,useMemo:Mg,useReducer:Ec,useRef:Sg,useState:function(){return Ec(hr)},useDebugValue:lf,useDeferredValue:function(r,a){var c=ze();return Ng(c,ve.memoizedState,r,a)},useTransition:function(){var r=Ec(hr)[0],a=ze().memoizedState;return[typeof r=="boolean"?r:Dl(r),a]},useSyncExternalStore:lg,useId:Pg,useHostTransitionStatus:uf,useFormState:yg,useActionState:yg,useOptimistic:function(r,a){var c=ze();return dg(c,ve,r,a)},useMemoCache:ef,useCacheRefresh:Bg},UA={readContext:Ei,use:Ac,useCallback:Og,useContext:Ei,useEffect:wg,useImperativeHandle:Dg,useInsertionEffect:bg,useLayoutEffect:Cg,useMemo:Mg,useReducer:rf,useRef:Sg,useState:function(){return rf(hr)},useDebugValue:lf,useDeferredValue:function(r,a){var c=ze();return ve===null?of(c,r,a):Ng(c,ve.memoizedState,r,a)},useTransition:function(){var r=rf(hr)[0],a=ze().memoizedState;return[typeof r=="boolean"?r:Dl(r),a]},useSyncExternalStore:lg,useId:Pg,useHostTransitionStatus:uf,useFormState:Eg,useActionState:Eg,useOptimistic:function(r,a){var c=ze();return ve!==null?dg(c,ve,r,a):(c.baseState=r,[r,c.queue.dispatch])},useMemoCache:ef,useCacheRefresh:Bg},va=null,Nl=0;function Cc(r){var a=Nl;return Nl+=1,va===null&&(va=[]),Jp(va,r,a)}function Ll(r,a){a=a.props.ref,r.ref=a!==void 0?a:null}function Rc(r,a){throw a.$$typeof===m?Error(i(525)):(r=Object.prototype.toString.call(a),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r)))}function Vg(r){var a=r._init;return a(r._payload)}function jg(r){function a(Z,W){if(r){var et=Z.deletions;et===null?(Z.deletions=[W],Z.flags|=16):et.push(W)}}function c(Z,W){if(!r)return null;for(;W!==null;)a(Z,W),W=W.sibling;return null}function h(Z){for(var W=new Map;Z!==null;)Z.key!==null?W.set(Z.key,Z):W.set(Z.index,Z),Z=Z.sibling;return W}function g(Z,W){return Z=ar(Z,W),Z.index=0,Z.sibling=null,Z}function x(Z,W,et){return Z.index=et,r?(et=Z.alternate,et!==null?(et=et.index,et<W?(Z.flags|=67108866,W):et):(Z.flags|=67108866,W)):(Z.flags|=1048576,W)}function S(Z){return r&&Z.alternate===null&&(Z.flags|=67108866),Z}function R(Z,W,et,mt){return W===null||W.tag!==6?(W=Mh(et,Z.mode,mt),W.return=Z,W):(W=g(W,et),W.return=Z,W)}function X(Z,W,et,mt){var Ft=et.type;return Ft===A?pt(Z,W,et.props.children,mt,et.key):W!==null&&(W.elementType===Ft||typeof Ft=="object"&&Ft!==null&&Ft.$$typeof===G&&Vg(Ft)===W.type)?(W=g(W,et.props),Ll(W,et),W.return=Z,W):(W=uc(et.type,et.key,et.props,null,Z.mode,mt),Ll(W,et),W.return=Z,W)}function it(Z,W,et,mt){return W===null||W.tag!==4||W.stateNode.containerInfo!==et.containerInfo||W.stateNode.implementation!==et.implementation?(W=Nh(et,Z.mode,mt),W.return=Z,W):(W=g(W,et.children||[]),W.return=Z,W)}function pt(Z,W,et,mt,Ft){return W===null||W.tag!==7?(W=xs(et,Z.mode,mt,Ft),W.return=Z,W):(W=g(W,et),W.return=Z,W)}function xt(Z,W,et){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=Mh(""+W,Z.mode,et),W.return=Z,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case v:return et=uc(W.type,W.key,W.props,null,Z.mode,et),Ll(et,W),et.return=Z,et;case _:return W=Nh(W,Z.mode,et),W.return=Z,W;case G:var mt=W._init;return W=mt(W._payload),xt(Z,W,et)}if(Et(W)||ut(W))return W=xs(W,Z.mode,et,null),W.return=Z,W;if(typeof W.then=="function")return xt(Z,Cc(W),et);if(W.$$typeof===w)return xt(Z,pc(Z,W),et);Rc(Z,W)}return null}function lt(Z,W,et,mt){var Ft=W!==null?W.key:null;if(typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint")return Ft!==null?null:R(Z,W,""+et,mt);if(typeof et=="object"&&et!==null){switch(et.$$typeof){case v:return et.key===Ft?X(Z,W,et,mt):null;case _:return et.key===Ft?it(Z,W,et,mt):null;case G:return Ft=et._init,et=Ft(et._payload),lt(Z,W,et,mt)}if(Et(et)||ut(et))return Ft!==null?null:pt(Z,W,et,mt,null);if(typeof et.then=="function")return lt(Z,W,Cc(et),mt);if(et.$$typeof===w)return lt(Z,W,pc(Z,et),mt);Rc(Z,et)}return null}function ct(Z,W,et,mt,Ft){if(typeof mt=="string"&&mt!==""||typeof mt=="number"||typeof mt=="bigint")return Z=Z.get(et)||null,R(W,Z,""+mt,Ft);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case v:return Z=Z.get(mt.key===null?et:mt.key)||null,X(W,Z,mt,Ft);case _:return Z=Z.get(mt.key===null?et:mt.key)||null,it(W,Z,mt,Ft);case G:var Qt=mt._init;return mt=Qt(mt._payload),ct(Z,W,et,mt,Ft)}if(Et(mt)||ut(mt))return Z=Z.get(et)||null,pt(W,Z,mt,Ft,null);if(typeof mt.then=="function")return ct(Z,W,et,Cc(mt),Ft);if(mt.$$typeof===w)return ct(Z,W,et,pc(W,mt),Ft);Rc(W,mt)}return null}function Vt(Z,W,et,mt){for(var Ft=null,Qt=null,Bt=W,zt=W=0,ii=null;Bt!==null&&zt<et.length;zt++){Bt.index>zt?(ii=Bt,Bt=null):ii=Bt.sibling;var re=lt(Z,Bt,et[zt],mt);if(re===null){Bt===null&&(Bt=ii);break}r&&Bt&&re.alternate===null&&a(Z,Bt),W=x(re,W,zt),Qt===null?Ft=re:Qt.sibling=re,Qt=re,Bt=ii}if(zt===et.length)return c(Z,Bt),ae&&ys(Z,zt),Ft;if(Bt===null){for(;zt<et.length;zt++)Bt=xt(Z,et[zt],mt),Bt!==null&&(W=x(Bt,W,zt),Qt===null?Ft=Bt:Qt.sibling=Bt,Qt=Bt);return ae&&ys(Z,zt),Ft}for(Bt=h(Bt);zt<et.length;zt++)ii=ct(Bt,Z,zt,et[zt],mt),ii!==null&&(r&&ii.alternate!==null&&Bt.delete(ii.key===null?zt:ii.key),W=x(ii,W,zt),Qt===null?Ft=ii:Qt.sibling=ii,Qt=ii);return r&&Bt.forEach(function(Zr){return a(Z,Zr)}),ae&&ys(Z,zt),Ft}function Ht(Z,W,et,mt){if(et==null)throw Error(i(151));for(var Ft=null,Qt=null,Bt=W,zt=W=0,ii=null,re=et.next();Bt!==null&&!re.done;zt++,re=et.next()){Bt.index>zt?(ii=Bt,Bt=null):ii=Bt.sibling;var Zr=lt(Z,Bt,re.value,mt);if(Zr===null){Bt===null&&(Bt=ii);break}r&&Bt&&Zr.alternate===null&&a(Z,Bt),W=x(Zr,W,zt),Qt===null?Ft=Zr:Qt.sibling=Zr,Qt=Zr,Bt=ii}if(re.done)return c(Z,Bt),ae&&ys(Z,zt),Ft;if(Bt===null){for(;!re.done;zt++,re=et.next())re=xt(Z,re.value,mt),re!==null&&(W=x(re,W,zt),Qt===null?Ft=re:Qt.sibling=re,Qt=re);return ae&&ys(Z,zt),Ft}for(Bt=h(Bt);!re.done;zt++,re=et.next())re=ct(Bt,Z,zt,re.value,mt),re!==null&&(r&&re.alternate!==null&&Bt.delete(re.key===null?zt:re.key),W=x(re,W,zt),Qt===null?Ft=re:Qt.sibling=re,Qt=re);return r&&Bt.forEach(function(H2){return a(Z,H2)}),ae&&ys(Z,zt),Ft}function _e(Z,W,et,mt){if(typeof et=="object"&&et!==null&&et.type===A&&et.key===null&&(et=et.props.children),typeof et=="object"&&et!==null){switch(et.$$typeof){case v:t:{for(var Ft=et.key;W!==null;){if(W.key===Ft){if(Ft=et.type,Ft===A){if(W.tag===7){c(Z,W.sibling),mt=g(W,et.props.children),mt.return=Z,Z=mt;break t}}else if(W.elementType===Ft||typeof Ft=="object"&&Ft!==null&&Ft.$$typeof===G&&Vg(Ft)===W.type){c(Z,W.sibling),mt=g(W,et.props),Ll(mt,et),mt.return=Z,Z=mt;break t}c(Z,W);break}else a(Z,W);W=W.sibling}et.type===A?(mt=xs(et.props.children,Z.mode,mt,et.key),mt.return=Z,Z=mt):(mt=uc(et.type,et.key,et.props,null,Z.mode,mt),Ll(mt,et),mt.return=Z,Z=mt)}return S(Z);case _:t:{for(Ft=et.key;W!==null;){if(W.key===Ft)if(W.tag===4&&W.stateNode.containerInfo===et.containerInfo&&W.stateNode.implementation===et.implementation){c(Z,W.sibling),mt=g(W,et.children||[]),mt.return=Z,Z=mt;break t}else{c(Z,W);break}else a(Z,W);W=W.sibling}mt=Nh(et,Z.mode,mt),mt.return=Z,Z=mt}return S(Z);case G:return Ft=et._init,et=Ft(et._payload),_e(Z,W,et,mt)}if(Et(et))return Vt(Z,W,et,mt);if(ut(et)){if(Ft=ut(et),typeof Ft!="function")throw Error(i(150));return et=Ft.call(et),Ht(Z,W,et,mt)}if(typeof et.then=="function")return _e(Z,W,Cc(et),mt);if(et.$$typeof===w)return _e(Z,W,pc(Z,et),mt);Rc(Z,et)}return typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint"?(et=""+et,W!==null&&W.tag===6?(c(Z,W.sibling),mt=g(W,et),mt.return=Z,Z=mt):(c(Z,W),mt=Mh(et,Z.mode,mt),mt.return=Z,Z=mt),S(Z)):c(Z,W)}return function(Z,W,et,mt){try{Nl=0;var Ft=_e(Z,W,et,mt);return va=null,Ft}catch(Bt){if(Bt===Sl||Bt===mc)throw Bt;var Qt=qi(29,Bt,null,Z.mode);return Qt.lanes=mt,Qt.return=Z,Qt}finally{}}}var xa=jg(!0),Xg=jg(!1),vn=q(null),Vn=null;function Br(r){var a=r.alternate;k(Ke,Ke.current&1),k(vn,r),Vn===null&&(a===null||da.current!==null||a.memoizedState!==null)&&(Vn=r)}function Yg(r){if(r.tag===22){if(k(Ke,Ke.current),k(vn,r),Vn===null){var a=r.alternate;a!==null&&a.memoizedState!==null&&(Vn=r)}}else Ir()}function Ir(){k(Ke,Ke.current),k(vn,vn.current)}function fr(r){D(vn),Vn===r&&(Vn=null),D(Ke)}var Ke=q(0);function Dc(r){for(var a=r;a!==null;){if(a.tag===13){var c=a.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||e0(c)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function ff(r,a,c,h){a=r.memoizedState,c=c(h,a),c=c==null?a:p({},a,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var df={enqueueSetState:function(r,a,c){r=r._reactInternals;var h=Qi(),g=Fr(h);g.payload=a,c!=null&&(g.callback=c),a=kr(r,g,h),a!==null&&(Zi(a,r,h),wl(a,r,h))},enqueueReplaceState:function(r,a,c){r=r._reactInternals;var h=Qi(),g=Fr(h);g.tag=1,g.payload=a,c!=null&&(g.callback=c),a=kr(r,g,h),a!==null&&(Zi(a,r,h),wl(a,r,h))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var c=Qi(),h=Fr(c);h.tag=2,a!=null&&(h.callback=a),a=kr(r,h,c),a!==null&&(Zi(a,r,c),wl(a,r,c))}};function qg(r,a,c,h,g,x,S){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,x,S):a.prototype&&a.prototype.isPureReactComponent?!gl(c,h)||!gl(g,x):!0}function Wg(r,a,c,h){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,h),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,h),a.state!==r&&df.enqueueReplaceState(a,a.state,null)}function Cs(r,a){var c=a;if("ref"in a){c={};for(var h in a)h!=="ref"&&(c[h]=a[h])}if(r=r.defaultProps){c===a&&(c=p({},c));for(var g in r)c[g]===void 0&&(c[g]=r[g])}return c}var Oc=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function $g(r){Oc(r)}function Kg(r){console.error(r)}function Qg(r){Oc(r)}function Mc(r,a){try{var c=r.onUncaughtError;c(a.value,{componentStack:a.stack})}catch(h){setTimeout(function(){throw h})}}function Zg(r,a,c){try{var h=r.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function pf(r,a,c){return c=Fr(c),c.tag=3,c.payload={element:null},c.callback=function(){Mc(r,a)},c}function Jg(r){return r=Fr(r),r.tag=3,r}function t1(r,a,c,h){var g=c.type.getDerivedStateFromError;if(typeof g=="function"){var x=h.value;r.payload=function(){return g(x)},r.callback=function(){Zg(a,c,h)}}var S=c.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(r.callback=function(){Zg(a,c,h),typeof g!="function"&&(jr===null?jr=new Set([this]):jr.add(this));var R=h.stack;this.componentDidCatch(h.value,{componentStack:R!==null?R:""})})}function HA(r,a,c,h,g){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(a=c.alternate,a!==null&&yl(a,c,g,!0),c=vn.current,c!==null){switch(c.tag){case 13:return Vn===null?If():c.alternate===null&&Ne===0&&(Ne=3),c.flags&=-257,c.flags|=65536,c.lanes=g,h===Gh?c.flags|=16384:(a=c.updateQueue,a===null?c.updateQueue=new Set([h]):a.add(h),Hf(r,h,g)),!1;case 22:return c.flags|=65536,h===Gh?c.flags|=16384:(a=c.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=a):(c=a.retryQueue,c===null?a.retryQueue=new Set([h]):c.add(h)),Hf(r,h,g)),!1}throw Error(i(435,c.tag))}return Hf(r,h,g),If(),!1}if(ae)return a=vn.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=g,h!==kh&&(r=Error(i(422),{cause:h}),_l(dn(r,c)))):(h!==kh&&(a=Error(i(423),{cause:h}),_l(dn(a,c))),r=r.current.alternate,r.flags|=65536,g&=-g,r.lanes|=g,h=dn(h,c),g=pf(r.stateNode,h,g),Xh(r,g),Ne!==4&&(Ne=2)),!1;var x=Error(i(520),{cause:h});if(x=dn(x,c),Hl===null?Hl=[x]:Hl.push(x),Ne!==4&&(Ne=2),a===null)return!0;h=dn(h,c),c=a;do{switch(c.tag){case 3:return c.flags|=65536,r=g&-g,c.lanes|=r,r=pf(c.stateNode,h,r),Xh(c,r),!1;case 1:if(a=c.type,x=c.stateNode,(c.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(jr===null||!jr.has(x))))return c.flags|=65536,g&=-g,c.lanes|=g,g=Jg(g),t1(g,r,c,h),Xh(c,g),!1}c=c.return}while(c!==null);return!1}var e1=Error(i(461)),ti=!1;function oi(r,a,c,h){a.child=r===null?Xg(a,null,c,h):xa(a,r.child,c,h)}function i1(r,a,c,h,g){c=c.render;var x=a.ref;if("ref"in h){var S={};for(var R in h)R!=="ref"&&(S[R]=h[R])}else S=h;return Ts(a),h=Kh(r,a,c,S,x,g),R=Qh(),r!==null&&!ti?(Zh(r,a,g),dr(r,a,g)):(ae&&R&&Lh(a),a.flags|=1,oi(r,a,h,g),a.child)}function n1(r,a,c,h,g){if(r===null){var x=c.type;return typeof x=="function"&&!Oh(x)&&x.defaultProps===void 0&&c.compare===null?(a.tag=15,a.type=x,r1(r,a,x,h,g)):(r=uc(c.type,null,h,a,a.mode,g),r.ref=a.ref,r.return=a,a.child=r)}if(x=r.child,!Ef(r,g)){var S=x.memoizedProps;if(c=c.compare,c=c!==null?c:gl,c(S,h)&&r.ref===a.ref)return dr(r,a,g)}return a.flags|=1,r=ar(x,h),r.ref=a.ref,r.return=a,a.child=r}function r1(r,a,c,h,g){if(r!==null){var x=r.memoizedProps;if(gl(x,h)&&r.ref===a.ref)if(ti=!1,a.pendingProps=h=x,Ef(r,g))(r.flags&131072)!==0&&(ti=!0);else return a.lanes=r.lanes,dr(r,a,g)}return gf(r,a,c,h,g)}function s1(r,a,c){var h=a.pendingProps,g=h.children,x=r!==null?r.memoizedState:null;if(h.mode==="hidden"){if((a.flags&128)!==0){if(h=x!==null?x.baseLanes|c:c,r!==null){for(g=a.child=r.child,x=0;g!==null;)x=x|g.lanes|g.childLanes,g=g.sibling;a.childLanes=x&~h}else a.childLanes=0,a.child=null;return a1(r,a,h,c)}if((c&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},r!==null&&gc(a,x!==null?x.cachePool:null),x!==null?rg(a,x):qh(),Yg(a);else return a.lanes=a.childLanes=536870912,a1(r,a,x!==null?x.baseLanes|c:c,c)}else x!==null?(gc(a,x.cachePool),rg(a,x),Ir(),a.memoizedState=null):(r!==null&&gc(a,null),qh(),Ir());return oi(r,a,g,c),a.child}function a1(r,a,c,h){var g=zh();return g=g===null?null:{parent:$e._currentValue,pool:g},a.memoizedState={baseLanes:c,cachePool:g},r!==null&&gc(a,null),qh(),Yg(a),r!==null&&yl(r,a,h,!0),null}function Nc(r,a){var c=a.ref;if(c===null)r!==null&&r.ref!==null&&(a.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(r===null||r.ref!==c)&&(a.flags|=4194816)}}function gf(r,a,c,h,g){return Ts(a),c=Kh(r,a,c,h,void 0,g),h=Qh(),r!==null&&!ti?(Zh(r,a,g),dr(r,a,g)):(ae&&h&&Lh(a),a.flags|=1,oi(r,a,c,g),a.child)}function l1(r,a,c,h,g,x){return Ts(a),a.updateQueue=null,c=ag(a,h,c,g),sg(r),h=Qh(),r!==null&&!ti?(Zh(r,a,x),dr(r,a,x)):(ae&&h&&Lh(a),a.flags|=1,oi(r,a,c,x),a.child)}function o1(r,a,c,h,g){if(Ts(a),a.stateNode===null){var x=oa,S=c.contextType;typeof S=="object"&&S!==null&&(x=Ei(S)),x=new c(h,x),a.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=df,a.stateNode=x,x._reactInternals=a,x=a.stateNode,x.props=h,x.state=a.memoizedState,x.refs={},Vh(a),S=c.contextType,x.context=typeof S=="object"&&S!==null?Ei(S):oa,x.state=a.memoizedState,S=c.getDerivedStateFromProps,typeof S=="function"&&(ff(a,c,S,h),x.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(S=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),S!==x.state&&df.enqueueReplaceState(x,x.state,null),Cl(a,h,x,g),bl(),x.state=a.memoizedState),typeof x.componentDidMount=="function"&&(a.flags|=4194308),h=!0}else if(r===null){x=a.stateNode;var R=a.memoizedProps,X=Cs(c,R);x.props=X;var it=x.context,pt=c.contextType;S=oa,typeof pt=="object"&&pt!==null&&(S=Ei(pt));var xt=c.getDerivedStateFromProps;pt=typeof xt=="function"||typeof x.getSnapshotBeforeUpdate=="function",R=a.pendingProps!==R,pt||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(R||it!==S)&&Wg(a,x,h,S),Lr=!1;var lt=a.memoizedState;x.state=lt,Cl(a,h,x,g),bl(),it=a.memoizedState,R||lt!==it||Lr?(typeof xt=="function"&&(ff(a,c,xt,h),it=a.memoizedState),(X=Lr||qg(a,c,X,h,lt,it,S))?(pt||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(a.flags|=4194308)):(typeof x.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=h,a.memoizedState=it),x.props=h,x.state=it,x.context=S,h=X):(typeof x.componentDidMount=="function"&&(a.flags|=4194308),h=!1)}else{x=a.stateNode,jh(r,a),S=a.memoizedProps,pt=Cs(c,S),x.props=pt,xt=a.pendingProps,lt=x.context,it=c.contextType,X=oa,typeof it=="object"&&it!==null&&(X=Ei(it)),R=c.getDerivedStateFromProps,(it=typeof R=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(S!==xt||lt!==X)&&Wg(a,x,h,X),Lr=!1,lt=a.memoizedState,x.state=lt,Cl(a,h,x,g),bl();var ct=a.memoizedState;S!==xt||lt!==ct||Lr||r!==null&&r.dependencies!==null&&dc(r.dependencies)?(typeof R=="function"&&(ff(a,c,R,h),ct=a.memoizedState),(pt=Lr||qg(a,c,pt,h,lt,ct,X)||r!==null&&r.dependencies!==null&&dc(r.dependencies))?(it||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(h,ct,X),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(h,ct,X)),typeof x.componentDidUpdate=="function"&&(a.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof x.componentDidUpdate!="function"||S===r.memoizedProps&&lt===r.memoizedState||(a.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&lt===r.memoizedState||(a.flags|=1024),a.memoizedProps=h,a.memoizedState=ct),x.props=h,x.state=ct,x.context=X,h=pt):(typeof x.componentDidUpdate!="function"||S===r.memoizedProps&&lt===r.memoizedState||(a.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&lt===r.memoizedState||(a.flags|=1024),h=!1)}return x=h,Nc(r,a),h=(a.flags&128)!==0,x||h?(x=a.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:x.render(),a.flags|=1,r!==null&&h?(a.child=xa(a,r.child,null,g),a.child=xa(a,null,c,g)):oi(r,a,c,g),a.memoizedState=x.state,r=a.child):r=dr(r,a,g),r}function c1(r,a,c,h){return xl(),a.flags|=256,oi(r,a,c,h),a.child}var mf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function vf(r){return{baseLanes:r,cachePool:Kp()}}function xf(r,a,c){return r=r!==null?r.childLanes&~c:0,a&&(r|=xn),r}function u1(r,a,c){var h=a.pendingProps,g=!1,x=(a.flags&128)!==0,S;if((S=x)||(S=r!==null&&r.memoizedState===null?!1:(Ke.current&2)!==0),S&&(g=!0,a.flags&=-129),S=(a.flags&32)!==0,a.flags&=-33,r===null){if(ae){if(g?Br(a):Ir(),ae){var R=Me,X;if(X=R){t:{for(X=R,R=Gn;X.nodeType!==8;){if(!R){R=null;break t}if(X=Nn(X.nextSibling),X===null){R=null;break t}}R=X}R!==null?(a.memoizedState={dehydrated:R,treeContext:_s!==null?{id:lr,overflow:or}:null,retryLane:536870912,hydrationErrors:null},X=qi(18,null,null,0),X.stateNode=R,X.return=a,a.child=X,Ci=a,Me=null,X=!0):X=!1}X||Es(a)}if(R=a.memoizedState,R!==null&&(R=R.dehydrated,R!==null))return e0(R)?a.lanes=32:a.lanes=536870912,null;fr(a)}return R=h.children,h=h.fallback,g?(Ir(),g=a.mode,R=Lc({mode:"hidden",children:R},g),h=xs(h,g,c,null),R.return=a,h.return=a,R.sibling=h,a.child=R,g=a.child,g.memoizedState=vf(c),g.childLanes=xf(r,S,c),a.memoizedState=mf,h):(Br(a),_f(a,R))}if(X=r.memoizedState,X!==null&&(R=X.dehydrated,R!==null)){if(x)a.flags&256?(Br(a),a.flags&=-257,a=yf(r,a,c)):a.memoizedState!==null?(Ir(),a.child=r.child,a.flags|=128,a=null):(Ir(),g=h.fallback,R=a.mode,h=Lc({mode:"visible",children:h.children},R),g=xs(g,R,c,null),g.flags|=2,h.return=a,g.return=a,h.sibling=g,a.child=h,xa(a,r.child,null,c),h=a.child,h.memoizedState=vf(c),h.childLanes=xf(r,S,c),a.memoizedState=mf,a=g);else if(Br(a),e0(R)){if(S=R.nextSibling&&R.nextSibling.dataset,S)var it=S.dgst;S=it,h=Error(i(419)),h.stack="",h.digest=S,_l({value:h,source:null,stack:null}),a=yf(r,a,c)}else if(ti||yl(r,a,c,!1),S=(c&r.childLanes)!==0,ti||S){if(S=Te,S!==null&&(h=c&-c,h=(h&42)!==0?1:sl(h),h=(h&(S.suspendedLanes|c))!==0?0:h,h!==0&&h!==X.retryLane))throw X.retryLane=h,la(r,h),Zi(S,r,h),e1;R.data==="$?"||If(),a=yf(r,a,c)}else R.data==="$?"?(a.flags|=192,a.child=r.child,a=null):(r=X.treeContext,Me=Nn(R.nextSibling),Ci=a,ae=!0,As=null,Gn=!1,r!==null&&(gn[mn++]=lr,gn[mn++]=or,gn[mn++]=_s,lr=r.id,or=r.overflow,_s=a),a=_f(a,h.children),a.flags|=4096);return a}return g?(Ir(),g=h.fallback,R=a.mode,X=r.child,it=X.sibling,h=ar(X,{mode:"hidden",children:h.children}),h.subtreeFlags=X.subtreeFlags&65011712,it!==null?g=ar(it,g):(g=xs(g,R,c,null),g.flags|=2),g.return=a,h.return=a,h.sibling=g,a.child=h,h=g,g=a.child,R=r.child.memoizedState,R===null?R=vf(c):(X=R.cachePool,X!==null?(it=$e._currentValue,X=X.parent!==it?{parent:it,pool:it}:X):X=Kp(),R={baseLanes:R.baseLanes|c,cachePool:X}),g.memoizedState=R,g.childLanes=xf(r,S,c),a.memoizedState=mf,h):(Br(a),c=r.child,r=c.sibling,c=ar(c,{mode:"visible",children:h.children}),c.return=a,c.sibling=null,r!==null&&(S=a.deletions,S===null?(a.deletions=[r],a.flags|=16):S.push(r)),a.child=c,a.memoizedState=null,c)}function _f(r,a){return a=Lc({mode:"visible",children:a},r.mode),a.return=r,r.child=a}function Lc(r,a){return r=qi(22,r,null,a),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function yf(r,a,c){return xa(a,r.child,null,c),r=_f(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function h1(r,a,c){r.lanes|=a;var h=r.alternate;h!==null&&(h.lanes|=a),Bh(r.return,a,c)}function Af(r,a,c,h,g){var x=r.memoizedState;x===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:g}:(x.isBackwards=a,x.rendering=null,x.renderingStartTime=0,x.last=h,x.tail=c,x.tailMode=g)}function f1(r,a,c){var h=a.pendingProps,g=h.revealOrder,x=h.tail;if(oi(r,a,h.children,c),h=Ke.current,(h&2)!==0)h=h&1|2,a.flags|=128;else{if(r!==null&&(r.flags&128)!==0)t:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&h1(r,c,a);else if(r.tag===19)h1(r,c,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break t;for(;r.sibling===null;){if(r.return===null||r.return===a)break t;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}switch(k(Ke,h),g){case"forwards":for(c=a.child,g=null;c!==null;)r=c.alternate,r!==null&&Dc(r)===null&&(g=c),c=c.sibling;c=g,c===null?(g=a.child,a.child=null):(g=c.sibling,c.sibling=null),Af(a,!1,g,c,x);break;case"backwards":for(c=null,g=a.child,a.child=null;g!==null;){if(r=g.alternate,r!==null&&Dc(r)===null){a.child=g;break}r=g.sibling,g.sibling=c,c=g,g=r}Af(a,!0,c,null,x);break;case"together":Af(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function dr(r,a,c){if(r!==null&&(a.dependencies=r.dependencies),Vr|=a.lanes,(c&a.childLanes)===0)if(r!==null){if(yl(r,a,c,!1),(c&a.childLanes)===0)return null}else return null;if(r!==null&&a.child!==r.child)throw Error(i(153));if(a.child!==null){for(r=a.child,c=ar(r,r.pendingProps),a.child=c,c.return=a;r.sibling!==null;)r=r.sibling,c=c.sibling=ar(r,r.pendingProps),c.return=a;c.sibling=null}return a.child}function Ef(r,a){return(r.lanes&a)!==0?!0:(r=r.dependencies,!!(r!==null&&dc(r)))}function zA(r,a,c){switch(a.tag){case 3:At(a,a.stateNode.containerInfo),Nr(a,$e,r.memoizedState.cache),xl();break;case 27:case 5:gt(a);break;case 4:At(a,a.stateNode.containerInfo);break;case 10:Nr(a,a.type,a.memoizedProps.value);break;case 13:var h=a.memoizedState;if(h!==null)return h.dehydrated!==null?(Br(a),a.flags|=128,null):(c&a.child.childLanes)!==0?u1(r,a,c):(Br(a),r=dr(r,a,c),r!==null?r.sibling:null);Br(a);break;case 19:var g=(r.flags&128)!==0;if(h=(c&a.childLanes)!==0,h||(yl(r,a,c,!1),h=(c&a.childLanes)!==0),g){if(h)return f1(r,a,c);a.flags|=128}if(g=a.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),k(Ke,Ke.current),h)break;return null;case 22:case 23:return a.lanes=0,s1(r,a,c);case 24:Nr(a,$e,r.memoizedState.cache)}return dr(r,a,c)}function d1(r,a,c){if(r!==null)if(r.memoizedProps!==a.pendingProps)ti=!0;else{if(!Ef(r,c)&&(a.flags&128)===0)return ti=!1,zA(r,a,c);ti=(r.flags&131072)!==0}else ti=!1,ae&&(a.flags&1048576)!==0&&Vp(a,fc,a.index);switch(a.lanes=0,a.tag){case 16:t:{r=a.pendingProps;var h=a.elementType,g=h._init;if(h=g(h._payload),a.type=h,typeof h=="function")Oh(h)?(r=Cs(h,r),a.tag=1,a=o1(null,a,h,r,c)):(a.tag=0,a=gf(null,a,h,r,c));else{if(h!=null){if(g=h.$$typeof,g===O){a.tag=11,a=i1(null,a,h,r,c);break t}else if(g===L){a.tag=14,a=n1(null,a,h,r,c);break t}}throw a=bt(h)||h,Error(i(306,a,""))}}return a;case 0:return gf(r,a,a.type,a.pendingProps,c);case 1:return h=a.type,g=Cs(h,a.pendingProps),o1(r,a,h,g,c);case 3:t:{if(At(a,a.stateNode.containerInfo),r===null)throw Error(i(387));h=a.pendingProps;var x=a.memoizedState;g=x.element,jh(r,a),Cl(a,h,null,c);var S=a.memoizedState;if(h=S.cache,Nr(a,$e,h),h!==x.cache&&Ih(a,[$e],c,!0),bl(),h=S.element,x.isDehydrated)if(x={element:h,isDehydrated:!1,cache:S.cache},a.updateQueue.baseState=x,a.memoizedState=x,a.flags&256){a=c1(r,a,h,c);break t}else if(h!==g){g=dn(Error(i(424)),a),_l(g),a=c1(r,a,h,c);break t}else{switch(r=a.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Me=Nn(r.firstChild),Ci=a,ae=!0,As=null,Gn=!0,c=Xg(a,null,h,c),a.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(xl(),h===g){a=dr(r,a,c);break t}oi(r,a,h,c)}a=a.child}return a;case 26:return Nc(r,a),r===null?(c=vm(a.type,null,a.pendingProps,null))?a.memoizedState=c:ae||(c=a.type,r=a.pendingProps,h=qc(J.current).createElement(c),h[Ze]=a,h[Je]=r,ui(h,c,r),tt(h),a.stateNode=h):a.memoizedState=vm(a.type,r.memoizedProps,a.pendingProps,r.memoizedState),null;case 27:return gt(a),r===null&&ae&&(h=a.stateNode=pm(a.type,a.pendingProps,J.current),Ci=a,Gn=!0,g=Me,qr(a.type)?(i0=g,Me=Nn(h.firstChild)):Me=g),oi(r,a,a.pendingProps.children,c),Nc(r,a),r===null&&(a.flags|=4194304),a.child;case 5:return r===null&&ae&&((g=h=Me)&&(h=g2(h,a.type,a.pendingProps,Gn),h!==null?(a.stateNode=h,Ci=a,Me=Nn(h.firstChild),Gn=!1,g=!0):g=!1),g||Es(a)),gt(a),g=a.type,x=a.pendingProps,S=r!==null?r.memoizedProps:null,h=x.children,Zf(g,x)?h=null:S!==null&&Zf(g,S)&&(a.flags|=32),a.memoizedState!==null&&(g=Kh(r,a,LA,null,null,c),$l._currentValue=g),Nc(r,a),oi(r,a,h,c),a.child;case 6:return r===null&&ae&&((r=c=Me)&&(c=m2(c,a.pendingProps,Gn),c!==null?(a.stateNode=c,Ci=a,Me=null,r=!0):r=!1),r||Es(a)),null;case 13:return u1(r,a,c);case 4:return At(a,a.stateNode.containerInfo),h=a.pendingProps,r===null?a.child=xa(a,null,h,c):oi(r,a,h,c),a.child;case 11:return i1(r,a,a.type,a.pendingProps,c);case 7:return oi(r,a,a.pendingProps,c),a.child;case 8:return oi(r,a,a.pendingProps.children,c),a.child;case 12:return oi(r,a,a.pendingProps.children,c),a.child;case 10:return h=a.pendingProps,Nr(a,a.type,h.value),oi(r,a,h.children,c),a.child;case 9:return g=a.type._context,h=a.pendingProps.children,Ts(a),g=Ei(g),h=h(g),a.flags|=1,oi(r,a,h,c),a.child;case 14:return n1(r,a,a.type,a.pendingProps,c);case 15:return r1(r,a,a.type,a.pendingProps,c);case 19:return f1(r,a,c);case 31:return h=a.pendingProps,c=a.mode,h={mode:h.mode,children:h.children},r===null?(c=Lc(h,c),c.ref=a.ref,a.child=c,c.return=a,a=c):(c=ar(r.child,h),c.ref=a.ref,a.child=c,c.return=a,a=c),a;case 22:return s1(r,a,c);case 24:return Ts(a),h=Ei($e),r===null?(g=zh(),g===null&&(g=Te,x=Uh(),g.pooledCache=x,x.refCount++,x!==null&&(g.pooledCacheLanes|=c),g=x),a.memoizedState={parent:h,cache:g},Vh(a),Nr(a,$e,g)):((r.lanes&c)!==0&&(jh(r,a),Cl(a,null,null,c),bl()),g=r.memoizedState,x=a.memoizedState,g.parent!==h?(g={parent:h,cache:h},a.memoizedState=g,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=g),Nr(a,$e,h)):(h=x.cache,Nr(a,$e,h),h!==g.cache&&Ih(a,[$e],c,!0))),oi(r,a,a.pendingProps.children,c),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function pr(r){r.flags|=4}function p1(r,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Em(a)){if(a=vn.current,a!==null&&((ne&4194048)===ne?Vn!==null:(ne&62914560)!==ne&&(ne&536870912)===0||a!==Vn))throw Tl=Gh,Qp;r.flags|=8192}}function Fc(r,a){a!==null&&(r.flags|=4),r.flags&16384&&(a=r.tag!==22?nl():536870912,r.lanes|=a,Ea|=a)}function Fl(r,a){if(!ae)switch(r.tailMode){case"hidden":a=r.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function De(r){var a=r.alternate!==null&&r.alternate.child===r.child,c=0,h=0;if(a)for(var g=r.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags&65011712,h|=g.flags&65011712,g.return=r,g=g.sibling;else for(g=r.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=r,g=g.sibling;return r.subtreeFlags|=h,r.childLanes=c,a}function GA(r,a,c){var h=a.pendingProps;switch(Fh(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return De(a),null;case 1:return De(a),null;case 3:return c=a.stateNode,h=null,r!==null&&(h=r.memoizedState.cache),a.memoizedState.cache!==h&&(a.flags|=2048),ur($e),vt(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(r===null||r.child===null)&&(vl(a)?pr(a):r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Yp())),De(a),null;case 26:return c=a.memoizedState,r===null?(pr(a),c!==null?(De(a),p1(a,c)):(De(a),a.flags&=-16777217)):c?c!==r.memoizedState?(pr(a),De(a),p1(a,c)):(De(a),a.flags&=-16777217):(r.memoizedProps!==h&&pr(a),De(a),a.flags&=-16777217),null;case 27:Pt(a),c=J.current;var g=a.type;if(r!==null&&a.stateNode!=null)r.memoizedProps!==h&&pr(a);else{if(!h){if(a.stateNode===null)throw Error(i(166));return De(a),null}r=U.current,vl(a)?jp(a):(r=pm(g,h,c),a.stateNode=r,pr(a))}return De(a),null;case 5:if(Pt(a),c=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==h&&pr(a);else{if(!h){if(a.stateNode===null)throw Error(i(166));return De(a),null}if(r=U.current,vl(a))jp(a);else{switch(g=qc(J.current),r){case 1:r=g.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:r=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":r=g.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":r=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":r=g.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof h.is=="string"?g.createElement("select",{is:h.is}):g.createElement("select"),h.multiple?r.multiple=!0:h.size&&(r.size=h.size);break;default:r=typeof h.is=="string"?g.createElement(c,{is:h.is}):g.createElement(c)}}r[Ze]=a,r[Je]=h;t:for(g=a.child;g!==null;){if(g.tag===5||g.tag===6)r.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===a)break t;for(;g.sibling===null;){if(g.return===null||g.return===a)break t;g=g.return}g.sibling.return=g.return,g=g.sibling}a.stateNode=r;t:switch(ui(r,c,h),c){case"button":case"input":case"select":case"textarea":r=!!h.autoFocus;break t;case"img":r=!0;break t;default:r=!1}r&&pr(a)}}return De(a),a.flags&=-16777217,null;case 6:if(r&&a.stateNode!=null)r.memoizedProps!==h&&pr(a);else{if(typeof h!="string"&&a.stateNode===null)throw Error(i(166));if(r=J.current,vl(a)){if(r=a.stateNode,c=a.memoizedProps,h=null,g=Ci,g!==null)switch(g.tag){case 27:case 5:h=g.memoizedProps}r[Ze]=a,r=!!(r.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||lm(r.nodeValue,c)),r||Es(a)}else r=qc(r).createTextNode(h),r[Ze]=a,a.stateNode=r}return De(a),null;case 13:if(h=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(g=vl(a),h!==null&&h.dehydrated!==null){if(r===null){if(!g)throw Error(i(318));if(g=a.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[Ze]=a}else xl(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;De(a),g=!1}else g=Yp(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=g),g=!0;if(!g)return a.flags&256?(fr(a),a):(fr(a),null)}if(fr(a),(a.flags&128)!==0)return a.lanes=c,a;if(c=h!==null,r=r!==null&&r.memoizedState!==null,c){h=a.child,g=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(g=h.alternate.memoizedState.cachePool.pool);var x=null;h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(x=h.memoizedState.cachePool.pool),x!==g&&(h.flags|=2048)}return c!==r&&c&&(a.child.flags|=8192),Fc(a,a.updateQueue),De(a),null;case 4:return vt(),r===null&&qf(a.stateNode.containerInfo),De(a),null;case 10:return ur(a.type),De(a),null;case 19:if(D(Ke),g=a.memoizedState,g===null)return De(a),null;if(h=(a.flags&128)!==0,x=g.rendering,x===null)if(h)Fl(g,!1);else{if(Ne!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(x=Dc(r),x!==null){for(a.flags|=128,Fl(g,!1),r=x.updateQueue,a.updateQueue=r,Fc(a,r),a.subtreeFlags=0,r=c,c=a.child;c!==null;)Gp(c,r),c=c.sibling;return k(Ke,Ke.current&1|2),a.child}r=r.sibling}g.tail!==null&&Ot()>Bc&&(a.flags|=128,h=!0,Fl(g,!1),a.lanes=4194304)}else{if(!h)if(r=Dc(x),r!==null){if(a.flags|=128,h=!0,r=r.updateQueue,a.updateQueue=r,Fc(a,r),Fl(g,!0),g.tail===null&&g.tailMode==="hidden"&&!x.alternate&&!ae)return De(a),null}else 2*Ot()-g.renderingStartTime>Bc&&c!==536870912&&(a.flags|=128,h=!0,Fl(g,!1),a.lanes=4194304);g.isBackwards?(x.sibling=a.child,a.child=x):(r=g.last,r!==null?r.sibling=x:a.child=x,g.last=x)}return g.tail!==null?(a=g.tail,g.rendering=a,g.tail=a.sibling,g.renderingStartTime=Ot(),a.sibling=null,r=Ke.current,k(Ke,h?r&1|2:r&1),a):(De(a),null);case 22:case 23:return fr(a),Wh(),h=a.memoizedState!==null,r!==null?r.memoizedState!==null!==h&&(a.flags|=8192):h&&(a.flags|=8192),h?(c&536870912)!==0&&(a.flags&128)===0&&(De(a),a.subtreeFlags&6&&(a.flags|=8192)):De(a),c=a.updateQueue,c!==null&&Fc(a,c.retryQueue),c=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),h=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),h!==c&&(a.flags|=2048),r!==null&&D(ws),null;case 24:return c=null,r!==null&&(c=r.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),ur($e),De(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function VA(r,a){switch(Fh(a),a.tag){case 1:return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return ur($e),vt(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 26:case 27:case 5:return Pt(a),null;case 13:if(fr(a),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(i(340));xl()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return D(Ke),null;case 4:return vt(),null;case 10:return ur(a.type),null;case 22:case 23:return fr(a),Wh(),r!==null&&D(ws),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 24:return ur($e),null;case 25:return null;default:return null}}function g1(r,a){switch(Fh(a),a.tag){case 3:ur($e),vt();break;case 26:case 27:case 5:Pt(a);break;case 4:vt();break;case 13:fr(a);break;case 19:D(Ke);break;case 10:ur(a.type);break;case 22:case 23:fr(a),Wh(),r!==null&&D(ws);break;case 24:ur($e)}}function kl(r,a){try{var c=a.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var g=h.next;c=g;do{if((c.tag&r)===r){h=void 0;var x=c.create,S=c.inst;h=x(),S.destroy=h}c=c.next}while(c!==g)}}catch(R){Ee(a,a.return,R)}}function Ur(r,a,c){try{var h=a.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var x=g.next;h=x;do{if((h.tag&r)===r){var S=h.inst,R=S.destroy;if(R!==void 0){S.destroy=void 0,g=a;var X=c,it=R;try{it()}catch(pt){Ee(g,X,pt)}}}h=h.next}while(h!==x)}}catch(pt){Ee(a,a.return,pt)}}function m1(r){var a=r.updateQueue;if(a!==null){var c=r.stateNode;try{ng(a,c)}catch(h){Ee(r,r.return,h)}}}function v1(r,a,c){c.props=Cs(r.type,r.memoizedProps),c.state=r.memoizedState;try{c.componentWillUnmount()}catch(h){Ee(r,a,h)}}function Pl(r,a){try{var c=r.ref;if(c!==null){switch(r.tag){case 26:case 27:case 5:var h=r.stateNode;break;case 30:h=r.stateNode;break;default:h=r.stateNode}typeof c=="function"?r.refCleanup=c(h):c.current=h}}catch(g){Ee(r,a,g)}}function jn(r,a){var c=r.ref,h=r.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(g){Ee(r,a,g)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(g){Ee(r,a,g)}else c.current=null}function x1(r){var a=r.type,c=r.memoizedProps,h=r.stateNode;try{t:switch(a){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break t;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(g){Ee(r,r.return,g)}}function Sf(r,a,c){try{var h=r.stateNode;u2(h,r.type,c,a),h[Je]=a}catch(g){Ee(r,r.return,g)}}function _1(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&qr(r.type)||r.tag===4}function Tf(r){t:for(;;){for(;r.sibling===null;){if(r.return===null||_1(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&qr(r.type)||r.flags&2||r.child===null||r.tag===4)continue t;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function wf(r,a,c){var h=r.tag;if(h===5||h===6)r=r.stateNode,a?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(r,a):(a=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,a.appendChild(r),c=c._reactRootContainer,c!=null||a.onclick!==null||(a.onclick=Yc));else if(h!==4&&(h===27&&qr(r.type)&&(c=r.stateNode,a=null),r=r.child,r!==null))for(wf(r,a,c),r=r.sibling;r!==null;)wf(r,a,c),r=r.sibling}function kc(r,a,c){var h=r.tag;if(h===5||h===6)r=r.stateNode,a?c.insertBefore(r,a):c.appendChild(r);else if(h!==4&&(h===27&&qr(r.type)&&(c=r.stateNode),r=r.child,r!==null))for(kc(r,a,c),r=r.sibling;r!==null;)kc(r,a,c),r=r.sibling}function y1(r){var a=r.stateNode,c=r.memoizedProps;try{for(var h=r.type,g=a.attributes;g.length;)a.removeAttributeNode(g[0]);ui(a,h,c),a[Ze]=r,a[Je]=c}catch(x){Ee(r,r.return,x)}}var gr=!1,Be=!1,bf=!1,A1=typeof WeakSet=="function"?WeakSet:Set,ei=null;function jA(r,a){if(r=r.containerInfo,Kf=Jc,r=Np(r),Sh(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else t:{c=(c=r.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var g=h.anchorOffset,x=h.focusNode;h=h.focusOffset;try{c.nodeType,x.nodeType}catch{c=null;break t}var S=0,R=-1,X=-1,it=0,pt=0,xt=r,lt=null;e:for(;;){for(var ct;xt!==c||g!==0&&xt.nodeType!==3||(R=S+g),xt!==x||h!==0&&xt.nodeType!==3||(X=S+h),xt.nodeType===3&&(S+=xt.nodeValue.length),(ct=xt.firstChild)!==null;)lt=xt,xt=ct;for(;;){if(xt===r)break e;if(lt===c&&++it===g&&(R=S),lt===x&&++pt===h&&(X=S),(ct=xt.nextSibling)!==null)break;xt=lt,lt=xt.parentNode}xt=ct}c=R===-1||X===-1?null:{start:R,end:X}}else c=null}c=c||{start:0,end:0}}else c=null;for(Qf={focusedElem:r,selectionRange:c},Jc=!1,ei=a;ei!==null;)if(a=ei,r=a.child,(a.subtreeFlags&1024)!==0&&r!==null)r.return=a,ei=r;else for(;ei!==null;){switch(a=ei,x=a.alternate,r=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&x!==null){r=void 0,c=a,g=x.memoizedProps,x=x.memoizedState,h=c.stateNode;try{var Vt=Cs(c.type,g,c.elementType===c.type);r=h.getSnapshotBeforeUpdate(Vt,x),h.__reactInternalSnapshotBeforeUpdate=r}catch(Ht){Ee(c,c.return,Ht)}}break;case 3:if((r&1024)!==0){if(r=a.stateNode.containerInfo,c=r.nodeType,c===9)t0(r);else if(c===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":t0(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=a.sibling,r!==null){r.return=a.return,ei=r;break}ei=a.return}}function E1(r,a,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:Hr(r,c),h&4&&kl(5,c);break;case 1:if(Hr(r,c),h&4)if(r=c.stateNode,a===null)try{r.componentDidMount()}catch(S){Ee(c,c.return,S)}else{var g=Cs(c.type,a.memoizedProps);a=a.memoizedState;try{r.componentDidUpdate(g,a,r.__reactInternalSnapshotBeforeUpdate)}catch(S){Ee(c,c.return,S)}}h&64&&m1(c),h&512&&Pl(c,c.return);break;case 3:if(Hr(r,c),h&64&&(r=c.updateQueue,r!==null)){if(a=null,c.child!==null)switch(c.child.tag){case 27:case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}try{ng(r,a)}catch(S){Ee(c,c.return,S)}}break;case 27:a===null&&h&4&&y1(c);case 26:case 5:Hr(r,c),a===null&&h&4&&x1(c),h&512&&Pl(c,c.return);break;case 12:Hr(r,c);break;case 13:Hr(r,c),h&4&&w1(r,c),h&64&&(r=c.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(c=JA.bind(null,c),v2(r,c))));break;case 22:if(h=c.memoizedState!==null||gr,!h){a=a!==null&&a.memoizedState!==null||Be,g=gr;var x=Be;gr=h,(Be=a)&&!x?zr(r,c,(c.subtreeFlags&8772)!==0):Hr(r,c),gr=g,Be=x}break;case 30:break;default:Hr(r,c)}}function S1(r){var a=r.alternate;a!==null&&(r.alternate=null,S1(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&P(a)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var be=null,Ii=!1;function mr(r,a,c){for(c=c.child;c!==null;)T1(r,a,c),c=c.sibling}function T1(r,a,c){if(li&&typeof li.onCommitFiberUnmount=="function")try{li.onCommitFiberUnmount(nr,c)}catch{}switch(c.tag){case 26:Be||jn(c,a),mr(r,a,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Be||jn(c,a);var h=be,g=Ii;qr(c.type)&&(be=c.stateNode,Ii=!1),mr(r,a,c),Xl(c.stateNode),be=h,Ii=g;break;case 5:Be||jn(c,a);case 6:if(h=be,g=Ii,be=null,mr(r,a,c),be=h,Ii=g,be!==null)if(Ii)try{(be.nodeType===9?be.body:be.nodeName==="HTML"?be.ownerDocument.body:be).removeChild(c.stateNode)}catch(x){Ee(c,a,x)}else try{be.removeChild(c.stateNode)}catch(x){Ee(c,a,x)}break;case 18:be!==null&&(Ii?(r=be,fm(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,c.stateNode),Jl(r)):fm(be,c.stateNode));break;case 4:h=be,g=Ii,be=c.stateNode.containerInfo,Ii=!0,mr(r,a,c),be=h,Ii=g;break;case 0:case 11:case 14:case 15:Be||Ur(2,c,a),Be||Ur(4,c,a),mr(r,a,c);break;case 1:Be||(jn(c,a),h=c.stateNode,typeof h.componentWillUnmount=="function"&&v1(c,a,h)),mr(r,a,c);break;case 21:mr(r,a,c);break;case 22:Be=(h=Be)||c.memoizedState!==null,mr(r,a,c),Be=h;break;default:mr(r,a,c)}}function w1(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Jl(r)}catch(c){Ee(a,a.return,c)}}function XA(r){switch(r.tag){case 13:case 19:var a=r.stateNode;return a===null&&(a=r.stateNode=new A1),a;case 22:return r=r.stateNode,a=r._retryCache,a===null&&(a=r._retryCache=new A1),a;default:throw Error(i(435,r.tag))}}function Cf(r,a){var c=XA(r);a.forEach(function(h){var g=t2.bind(null,r,h);c.has(h)||(c.add(h),h.then(g,g))})}function Wi(r,a){var c=a.deletions;if(c!==null)for(var h=0;h<c.length;h++){var g=c[h],x=r,S=a,R=S;t:for(;R!==null;){switch(R.tag){case 27:if(qr(R.type)){be=R.stateNode,Ii=!1;break t}break;case 5:be=R.stateNode,Ii=!1;break t;case 3:case 4:be=R.stateNode.containerInfo,Ii=!0;break t}R=R.return}if(be===null)throw Error(i(160));T1(x,S,g),be=null,Ii=!1,x=g.alternate,x!==null&&(x.return=null),g.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)b1(a,r),a=a.sibling}var Mn=null;function b1(r,a){var c=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Wi(a,r),$i(r),h&4&&(Ur(3,r,r.return),kl(3,r),Ur(5,r,r.return));break;case 1:Wi(a,r),$i(r),h&512&&(Be||c===null||jn(c,c.return)),h&64&&gr&&(r=r.updateQueue,r!==null&&(h=r.callbacks,h!==null&&(c=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var g=Mn;if(Wi(a,r),$i(r),h&512&&(Be||c===null||jn(c,c.return)),h&4){var x=c!==null?c.memoizedState:null;if(h=r.memoizedState,c===null)if(h===null)if(r.stateNode===null){t:{h=r.type,c=r.memoizedProps,g=g.ownerDocument||g;e:switch(h){case"title":x=g.getElementsByTagName("title")[0],(!x||x[N]||x[Ze]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=g.createElement(h),g.head.insertBefore(x,g.querySelector("head > title"))),ui(x,h,c),x[Ze]=r,tt(x),h=x;break t;case"link":var S=ym("link","href",g).get(h+(c.href||""));if(S){for(var R=0;R<S.length;R++)if(x=S[R],x.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&x.getAttribute("rel")===(c.rel==null?null:c.rel)&&x.getAttribute("title")===(c.title==null?null:c.title)&&x.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){S.splice(R,1);break e}}x=g.createElement(h),ui(x,h,c),g.head.appendChild(x);break;case"meta":if(S=ym("meta","content",g).get(h+(c.content||""))){for(R=0;R<S.length;R++)if(x=S[R],x.getAttribute("content")===(c.content==null?null:""+c.content)&&x.getAttribute("name")===(c.name==null?null:c.name)&&x.getAttribute("property")===(c.property==null?null:c.property)&&x.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&x.getAttribute("charset")===(c.charSet==null?null:c.charSet)){S.splice(R,1);break e}}x=g.createElement(h),ui(x,h,c),g.head.appendChild(x);break;default:throw Error(i(468,h))}x[Ze]=r,tt(x),h=x}r.stateNode=h}else Am(g,r.type,r.stateNode);else r.stateNode=_m(g,h,r.memoizedProps);else x!==h?(x===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):x.count--,h===null?Am(g,r.type,r.stateNode):_m(g,h,r.memoizedProps)):h===null&&r.stateNode!==null&&Sf(r,r.memoizedProps,c.memoizedProps)}break;case 27:Wi(a,r),$i(r),h&512&&(Be||c===null||jn(c,c.return)),c!==null&&h&4&&Sf(r,r.memoizedProps,c.memoizedProps);break;case 5:if(Wi(a,r),$i(r),h&512&&(Be||c===null||jn(c,c.return)),r.flags&32){g=r.stateNode;try{ta(g,"")}catch(ct){Ee(r,r.return,ct)}}h&4&&r.stateNode!=null&&(g=r.memoizedProps,Sf(r,g,c!==null?c.memoizedProps:g)),h&1024&&(bf=!0);break;case 6:if(Wi(a,r),$i(r),h&4){if(r.stateNode===null)throw Error(i(162));h=r.memoizedProps,c=r.stateNode;try{c.nodeValue=h}catch(ct){Ee(r,r.return,ct)}}break;case 3:if(Kc=null,g=Mn,Mn=Wc(a.containerInfo),Wi(a,r),Mn=g,$i(r),h&4&&c!==null&&c.memoizedState.isDehydrated)try{Jl(a.containerInfo)}catch(ct){Ee(r,r.return,ct)}bf&&(bf=!1,C1(r));break;case 4:h=Mn,Mn=Wc(r.stateNode.containerInfo),Wi(a,r),$i(r),Mn=h;break;case 12:Wi(a,r),$i(r);break;case 13:Wi(a,r),$i(r),r.child.flags&8192&&r.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Lf=Ot()),h&4&&(h=r.updateQueue,h!==null&&(r.updateQueue=null,Cf(r,h)));break;case 22:g=r.memoizedState!==null;var X=c!==null&&c.memoizedState!==null,it=gr,pt=Be;if(gr=it||g,Be=pt||X,Wi(a,r),Be=pt,gr=it,$i(r),h&8192)t:for(a=r.stateNode,a._visibility=g?a._visibility&-2:a._visibility|1,g&&(c===null||X||gr||Be||Rs(r)),c=null,a=r;;){if(a.tag===5||a.tag===26){if(c===null){X=c=a;try{if(x=X.stateNode,g)S=x.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{R=X.stateNode;var xt=X.memoizedProps.style,lt=xt!=null&&xt.hasOwnProperty("display")?xt.display:null;R.style.display=lt==null||typeof lt=="boolean"?"":(""+lt).trim()}}catch(ct){Ee(X,X.return,ct)}}}else if(a.tag===6){if(c===null){X=a;try{X.stateNode.nodeValue=g?"":X.memoizedProps}catch(ct){Ee(X,X.return,ct)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===r)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break t;for(;a.sibling===null;){if(a.return===null||a.return===r)break t;c===a&&(c=null),a=a.return}c===a&&(c=null),a.sibling.return=a.return,a=a.sibling}h&4&&(h=r.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,Cf(r,c))));break;case 19:Wi(a,r),$i(r),h&4&&(h=r.updateQueue,h!==null&&(r.updateQueue=null,Cf(r,h)));break;case 30:break;case 21:break;default:Wi(a,r),$i(r)}}function $i(r){var a=r.flags;if(a&2){try{for(var c,h=r.return;h!==null;){if(_1(h)){c=h;break}h=h.return}if(c==null)throw Error(i(160));switch(c.tag){case 27:var g=c.stateNode,x=Tf(r);kc(r,x,g);break;case 5:var S=c.stateNode;c.flags&32&&(ta(S,""),c.flags&=-33);var R=Tf(r);kc(r,R,S);break;case 3:case 4:var X=c.stateNode.containerInfo,it=Tf(r);wf(r,it,X);break;default:throw Error(i(161))}}catch(pt){Ee(r,r.return,pt)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function C1(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var a=r;C1(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),r=r.sibling}}function Hr(r,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)E1(r,a.alternate,a),a=a.sibling}function Rs(r){for(r=r.child;r!==null;){var a=r;switch(a.tag){case 0:case 11:case 14:case 15:Ur(4,a,a.return),Rs(a);break;case 1:jn(a,a.return);var c=a.stateNode;typeof c.componentWillUnmount=="function"&&v1(a,a.return,c),Rs(a);break;case 27:Xl(a.stateNode);case 26:case 5:jn(a,a.return),Rs(a);break;case 22:a.memoizedState===null&&Rs(a);break;case 30:Rs(a);break;default:Rs(a)}r=r.sibling}}function zr(r,a,c){for(c=c&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var h=a.alternate,g=r,x=a,S=x.flags;switch(x.tag){case 0:case 11:case 15:zr(g,x,c),kl(4,x);break;case 1:if(zr(g,x,c),h=x,g=h.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(it){Ee(h,h.return,it)}if(h=x,g=h.updateQueue,g!==null){var R=h.stateNode;try{var X=g.shared.hiddenCallbacks;if(X!==null)for(g.shared.hiddenCallbacks=null,g=0;g<X.length;g++)ig(X[g],R)}catch(it){Ee(h,h.return,it)}}c&&S&64&&m1(x),Pl(x,x.return);break;case 27:y1(x);case 26:case 5:zr(g,x,c),c&&h===null&&S&4&&x1(x),Pl(x,x.return);break;case 12:zr(g,x,c);break;case 13:zr(g,x,c),c&&S&4&&w1(g,x);break;case 22:x.memoizedState===null&&zr(g,x,c),Pl(x,x.return);break;case 30:break;default:zr(g,x,c)}a=a.sibling}}function Rf(r,a){var c=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),r=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(r=a.memoizedState.cachePool.pool),r!==c&&(r!=null&&r.refCount++,c!=null&&Al(c))}function Df(r,a){r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&Al(r))}function Xn(r,a,c,h){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)R1(r,a,c,h),a=a.sibling}function R1(r,a,c,h){var g=a.flags;switch(a.tag){case 0:case 11:case 15:Xn(r,a,c,h),g&2048&&kl(9,a);break;case 1:Xn(r,a,c,h);break;case 3:Xn(r,a,c,h),g&2048&&(r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&Al(r)));break;case 12:if(g&2048){Xn(r,a,c,h),r=a.stateNode;try{var x=a.memoizedProps,S=x.id,R=x.onPostCommit;typeof R=="function"&&R(S,a.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(X){Ee(a,a.return,X)}}else Xn(r,a,c,h);break;case 13:Xn(r,a,c,h);break;case 23:break;case 22:x=a.stateNode,S=a.alternate,a.memoizedState!==null?x._visibility&2?Xn(r,a,c,h):Bl(r,a):x._visibility&2?Xn(r,a,c,h):(x._visibility|=2,_a(r,a,c,h,(a.subtreeFlags&10256)!==0)),g&2048&&Rf(S,a);break;case 24:Xn(r,a,c,h),g&2048&&Df(a.alternate,a);break;default:Xn(r,a,c,h)}}function _a(r,a,c,h,g){for(g=g&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var x=r,S=a,R=c,X=h,it=S.flags;switch(S.tag){case 0:case 11:case 15:_a(x,S,R,X,g),kl(8,S);break;case 23:break;case 22:var pt=S.stateNode;S.memoizedState!==null?pt._visibility&2?_a(x,S,R,X,g):Bl(x,S):(pt._visibility|=2,_a(x,S,R,X,g)),g&&it&2048&&Rf(S.alternate,S);break;case 24:_a(x,S,R,X,g),g&&it&2048&&Df(S.alternate,S);break;default:_a(x,S,R,X,g)}a=a.sibling}}function Bl(r,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var c=r,h=a,g=h.flags;switch(h.tag){case 22:Bl(c,h),g&2048&&Rf(h.alternate,h);break;case 24:Bl(c,h),g&2048&&Df(h.alternate,h);break;default:Bl(c,h)}a=a.sibling}}var Il=8192;function ya(r){if(r.subtreeFlags&Il)for(r=r.child;r!==null;)D1(r),r=r.sibling}function D1(r){switch(r.tag){case 26:ya(r),r.flags&Il&&r.memoizedState!==null&&O2(Mn,r.memoizedState,r.memoizedProps);break;case 5:ya(r);break;case 3:case 4:var a=Mn;Mn=Wc(r.stateNode.containerInfo),ya(r),Mn=a;break;case 22:r.memoizedState===null&&(a=r.alternate,a!==null&&a.memoizedState!==null?(a=Il,Il=16777216,ya(r),Il=a):ya(r));break;default:ya(r)}}function O1(r){var a=r.alternate;if(a!==null&&(r=a.child,r!==null)){a.child=null;do a=r.sibling,r.sibling=null,r=a;while(r!==null)}}function Ul(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var h=a[c];ei=h,N1(h,r)}O1(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)M1(r),r=r.sibling}function M1(r){switch(r.tag){case 0:case 11:case 15:Ul(r),r.flags&2048&&Ur(9,r,r.return);break;case 3:Ul(r);break;case 12:Ul(r);break;case 22:var a=r.stateNode;r.memoizedState!==null&&a._visibility&2&&(r.return===null||r.return.tag!==13)?(a._visibility&=-3,Pc(r)):Ul(r);break;default:Ul(r)}}function Pc(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var h=a[c];ei=h,N1(h,r)}O1(r)}for(r=r.child;r!==null;){switch(a=r,a.tag){case 0:case 11:case 15:Ur(8,a,a.return),Pc(a);break;case 22:c=a.stateNode,c._visibility&2&&(c._visibility&=-3,Pc(a));break;default:Pc(a)}r=r.sibling}}function N1(r,a){for(;ei!==null;){var c=ei;switch(c.tag){case 0:case 11:case 15:Ur(8,c,a);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Al(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,ei=h;else t:for(c=r;ei!==null;){h=ei;var g=h.sibling,x=h.return;if(S1(h),h===c){ei=null;break t}if(g!==null){g.return=x,ei=g;break t}ei=x}}}var YA={getCacheForType:function(r){var a=Ei($e),c=a.data.get(r);return c===void 0&&(c=r(),a.data.set(r,c)),c}},qA=typeof WeakMap=="function"?WeakMap:Map,oe=0,Te=null,Jt=null,ne=0,ce=0,Ki=null,Gr=!1,Aa=!1,Of=!1,vr=0,Ne=0,Vr=0,Ds=0,Mf=0,xn=0,Ea=0,Hl=null,Ui=null,Nf=!1,Lf=0,Bc=1/0,Ic=null,jr=null,ci=0,Xr=null,Sa=null,Ta=0,Ff=0,kf=null,L1=null,zl=0,Pf=null;function Qi(){if((oe&2)!==0&&ne!==0)return ne&-ne;if(Y.T!==null){var r=ha;return r!==0?r:Vf()}return Qo()}function F1(){xn===0&&(xn=(ne&536870912)===0||ae?il():536870912);var r=vn.current;return r!==null&&(r.flags|=32),xn}function Zi(r,a,c){(r===Te&&(ce===2||ce===9)||r.cancelPendingCommit!==null)&&(wa(r,0),Yr(r,ne,xn,!1)),ds(r,c),((oe&2)===0||r!==Te)&&(r===Te&&((oe&2)===0&&(Ds|=c),Ne===4&&Yr(r,ne,xn,!1)),Yn(r))}function k1(r,a,c){if((oe&6)!==0)throw Error(i(327));var h=!c&&(a&124)===0&&(a&r.expiredLanes)===0||fs(r,a),g=h?KA(r,a):Uf(r,a,!0),x=h;do{if(g===0){Aa&&!h&&Yr(r,a,0,!1);break}else{if(c=r.current.alternate,x&&!WA(c)){g=Uf(r,a,!1),x=!1;continue}if(g===2){if(x=a,r.errorRecoveryDisabledLanes&x)var S=0;else S=r.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){a=S;t:{var R=r;g=Hl;var X=R.current.memoizedState.isDehydrated;if(X&&(wa(R,S).flags|=256),S=Uf(R,S,!1),S!==2){if(Of&&!X){R.errorRecoveryDisabledLanes|=x,Ds|=x,g=4;break t}x=Ui,Ui=g,x!==null&&(Ui===null?Ui=x:Ui.push.apply(Ui,x))}g=S}if(x=!1,g!==2)continue}}if(g===1){wa(r,0),Yr(r,a,0,!0);break}t:{switch(h=r,x=g,x){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Yr(h,a,xn,!Gr);break t;case 2:Ui=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(g=Lf+300-Ot(),10<g)){if(Yr(h,a,xn,!Gr),Qs(h,0,!0)!==0)break t;h.timeoutHandle=um(P1.bind(null,h,c,Ui,Ic,Nf,a,xn,Ds,Ea,Gr,x,2,-0,0),g);break t}P1(h,c,Ui,Ic,Nf,a,xn,Ds,Ea,Gr,x,0,-0,0)}}break}while(!0);Yn(r)}function P1(r,a,c,h,g,x,S,R,X,it,pt,xt,lt,ct){if(r.timeoutHandle=-1,xt=a.subtreeFlags,(xt&8192||(xt&16785408)===16785408)&&(Wl={stylesheets:null,count:0,unsuspend:D2},D1(a),xt=M2(),xt!==null)){r.cancelPendingCommit=xt(V1.bind(null,r,a,x,c,h,g,S,R,X,pt,1,lt,ct)),Yr(r,x,S,!it);return}V1(r,a,x,c,h,g,S,R,X)}function WA(r){for(var a=r;;){var c=a.tag;if((c===0||c===11||c===15)&&a.flags&16384&&(c=a.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var g=c[h],x=g.getSnapshot;g=g.value;try{if(!Yi(x(),g))return!1}catch{return!1}}if(c=a.child,a.subtreeFlags&16384&&c!==null)c.return=a,a=c;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Yr(r,a,c,h){a&=~Mf,a&=~Ds,r.suspendedLanes|=a,r.pingedLanes&=~a,h&&(r.warmLanes|=a),h=r.expirationTimes;for(var g=a;0<g;){var x=31-bi(g),S=1<<x;h[x]=-1,g&=~S}c!==0&&$o(r,c,a)}function Uc(){return(oe&6)===0?(Gl(0),!1):!0}function Bf(){if(Jt!==null){if(ce===0)var r=Jt.return;else r=Jt,cr=Ss=null,Jh(r),va=null,Nl=0,r=Jt;for(;r!==null;)g1(r.alternate,r),r=r.return;Jt=null}}function wa(r,a){var c=r.timeoutHandle;c!==-1&&(r.timeoutHandle=-1,f2(c)),c=r.cancelPendingCommit,c!==null&&(r.cancelPendingCommit=null,c()),Bf(),Te=r,Jt=c=ar(r.current,null),ne=a,ce=0,Ki=null,Gr=!1,Aa=fs(r,a),Of=!1,Ea=xn=Mf=Ds=Vr=Ne=0,Ui=Hl=null,Nf=!1,(a&8)!==0&&(a|=a&32);var h=r.entangledLanes;if(h!==0)for(r=r.entanglements,h&=a;0<h;){var g=31-bi(h),x=1<<g;a|=r[g],h&=~x}return vr=a,lc(),c}function B1(r,a){Kt=null,Y.H=bc,a===Sl||a===mc?(a=tg(),ce=3):a===Qp?(a=tg(),ce=4):ce=a===e1?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Ki=a,Jt===null&&(Ne=1,Mc(r,dn(a,r.current)))}function I1(){var r=Y.H;return Y.H=bc,r===null?bc:r}function U1(){var r=Y.A;return Y.A=YA,r}function If(){Ne=4,Gr||(ne&4194048)!==ne&&vn.current!==null||(Aa=!0),(Vr&134217727)===0&&(Ds&134217727)===0||Te===null||Yr(Te,ne,xn,!1)}function Uf(r,a,c){var h=oe;oe|=2;var g=I1(),x=U1();(Te!==r||ne!==a)&&(Ic=null,wa(r,a)),a=!1;var S=Ne;t:do try{if(ce!==0&&Jt!==null){var R=Jt,X=Ki;switch(ce){case 8:Bf(),S=6;break t;case 3:case 2:case 9:case 6:vn.current===null&&(a=!0);var it=ce;if(ce=0,Ki=null,ba(r,R,X,it),c&&Aa){S=0;break t}break;default:it=ce,ce=0,Ki=null,ba(r,R,X,it)}}$A(),S=Ne;break}catch(pt){B1(r,pt)}while(!0);return a&&r.shellSuspendCounter++,cr=Ss=null,oe=h,Y.H=g,Y.A=x,Jt===null&&(Te=null,ne=0,lc()),S}function $A(){for(;Jt!==null;)H1(Jt)}function KA(r,a){var c=oe;oe|=2;var h=I1(),g=U1();Te!==r||ne!==a?(Ic=null,Bc=Ot()+500,wa(r,a)):Aa=fs(r,a);t:do try{if(ce!==0&&Jt!==null){a=Jt;var x=Ki;e:switch(ce){case 1:ce=0,Ki=null,ba(r,a,x,1);break;case 2:case 9:if(Zp(x)){ce=0,Ki=null,z1(a);break}a=function(){ce!==2&&ce!==9||Te!==r||(ce=7),Yn(r)},x.then(a,a);break t;case 3:ce=7;break t;case 4:ce=5;break t;case 7:Zp(x)?(ce=0,Ki=null,z1(a)):(ce=0,Ki=null,ba(r,a,x,7));break;case 5:var S=null;switch(Jt.tag){case 26:S=Jt.memoizedState;case 5:case 27:var R=Jt;if(!S||Em(S)){ce=0,Ki=null;var X=R.sibling;if(X!==null)Jt=X;else{var it=R.return;it!==null?(Jt=it,Hc(it)):Jt=null}break e}}ce=0,Ki=null,ba(r,a,x,5);break;case 6:ce=0,Ki=null,ba(r,a,x,6);break;case 8:Bf(),Ne=6;break t;default:throw Error(i(462))}}QA();break}catch(pt){B1(r,pt)}while(!0);return cr=Ss=null,Y.H=h,Y.A=g,oe=c,Jt!==null?0:(Te=null,ne=0,lc(),Ne)}function QA(){for(;Jt!==null&&!ln();)H1(Jt)}function H1(r){var a=d1(r.alternate,r,vr);r.memoizedProps=r.pendingProps,a===null?Hc(r):Jt=a}function z1(r){var a=r,c=a.alternate;switch(a.tag){case 15:case 0:a=l1(c,a,a.pendingProps,a.type,void 0,ne);break;case 11:a=l1(c,a,a.pendingProps,a.type.render,a.ref,ne);break;case 5:Jh(a);default:g1(c,a),a=Jt=Gp(a,vr),a=d1(c,a,vr)}r.memoizedProps=r.pendingProps,a===null?Hc(r):Jt=a}function ba(r,a,c,h){cr=Ss=null,Jh(a),va=null,Nl=0;var g=a.return;try{if(HA(r,g,a,c,ne)){Ne=1,Mc(r,dn(c,r.current)),Jt=null;return}}catch(x){if(g!==null)throw Jt=g,x;Ne=1,Mc(r,dn(c,r.current)),Jt=null;return}a.flags&32768?(ae||h===1?r=!0:Aa||(ne&536870912)!==0?r=!1:(Gr=r=!0,(h===2||h===9||h===3||h===6)&&(h=vn.current,h!==null&&h.tag===13&&(h.flags|=16384))),G1(a,r)):Hc(a)}function Hc(r){var a=r;do{if((a.flags&32768)!==0){G1(a,Gr);return}r=a.return;var c=GA(a.alternate,a,vr);if(c!==null){Jt=c;return}if(a=a.sibling,a!==null){Jt=a;return}Jt=a=r}while(a!==null);Ne===0&&(Ne=5)}function G1(r,a){do{var c=VA(r.alternate,r);if(c!==null){c.flags&=32767,Jt=c;return}if(c=r.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!a&&(r=r.sibling,r!==null)){Jt=r;return}Jt=r=c}while(r!==null);Ne=6,Jt=null}function V1(r,a,c,h,g,x,S,R,X){r.cancelPendingCommit=null;do zc();while(ci!==0);if((oe&6)!==0)throw Error(i(327));if(a!==null){if(a===r.current)throw Error(i(177));if(x=a.lanes|a.childLanes,x|=Rh,Zs(r,c,x,S,R,X),r===Te&&(Jt=Te=null,ne=0),Sa=a,Xr=r,Ta=c,Ff=x,kf=g,L1=h,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,e2(Cn,function(){return W1(),null})):(r.callbackNode=null,r.callbackPriority=0),h=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||h){h=Y.T,Y.T=null,g=nt.p,nt.p=2,S=oe,oe|=4;try{jA(r,a,c)}finally{oe=S,nt.p=g,Y.T=h}}ci=1,j1(),X1(),Y1()}}function j1(){if(ci===1){ci=0;var r=Xr,a=Sa,c=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||c){c=Y.T,Y.T=null;var h=nt.p;nt.p=2;var g=oe;oe|=4;try{b1(a,r);var x=Qf,S=Np(r.containerInfo),R=x.focusedElem,X=x.selectionRange;if(S!==R&&R&&R.ownerDocument&&Mp(R.ownerDocument.documentElement,R)){if(X!==null&&Sh(R)){var it=X.start,pt=X.end;if(pt===void 0&&(pt=it),"selectionStart"in R)R.selectionStart=it,R.selectionEnd=Math.min(pt,R.value.length);else{var xt=R.ownerDocument||document,lt=xt&&xt.defaultView||window;if(lt.getSelection){var ct=lt.getSelection(),Vt=R.textContent.length,Ht=Math.min(X.start,Vt),_e=X.end===void 0?Ht:Math.min(X.end,Vt);!ct.extend&&Ht>_e&&(S=_e,_e=Ht,Ht=S);var Z=Op(R,Ht),W=Op(R,_e);if(Z&&W&&(ct.rangeCount!==1||ct.anchorNode!==Z.node||ct.anchorOffset!==Z.offset||ct.focusNode!==W.node||ct.focusOffset!==W.offset)){var et=xt.createRange();et.setStart(Z.node,Z.offset),ct.removeAllRanges(),Ht>_e?(ct.addRange(et),ct.extend(W.node,W.offset)):(et.setEnd(W.node,W.offset),ct.addRange(et))}}}}for(xt=[],ct=R;ct=ct.parentNode;)ct.nodeType===1&&xt.push({element:ct,left:ct.scrollLeft,top:ct.scrollTop});for(typeof R.focus=="function"&&R.focus(),R=0;R<xt.length;R++){var mt=xt[R];mt.element.scrollLeft=mt.left,mt.element.scrollTop=mt.top}}Jc=!!Kf,Qf=Kf=null}finally{oe=g,nt.p=h,Y.T=c}}r.current=a,ci=2}}function X1(){if(ci===2){ci=0;var r=Xr,a=Sa,c=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||c){c=Y.T,Y.T=null;var h=nt.p;nt.p=2;var g=oe;oe|=4;try{E1(r,a.alternate,a)}finally{oe=g,nt.p=h,Y.T=c}}ci=3}}function Y1(){if(ci===4||ci===3){ci=0,pe();var r=Xr,a=Sa,c=Ta,h=L1;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?ci=5:(ci=0,Sa=Xr=null,q1(r,r.pendingLanes));var g=r.pendingLanes;if(g===0&&(jr=null),al(c),a=a.stateNode,li&&typeof li.onCommitFiberRoot=="function")try{li.onCommitFiberRoot(nr,a,void 0,(a.current.flags&128)===128)}catch{}if(h!==null){a=Y.T,g=nt.p,nt.p=2,Y.T=null;try{for(var x=r.onRecoverableError,S=0;S<h.length;S++){var R=h[S];x(R.value,{componentStack:R.stack})}}finally{Y.T=a,nt.p=g}}(Ta&3)!==0&&zc(),Yn(r),g=r.pendingLanes,(c&4194090)!==0&&(g&42)!==0?r===Pf?zl++:(zl=0,Pf=r):zl=0,Gl(0)}}function q1(r,a){(r.pooledCacheLanes&=a)===0&&(a=r.pooledCache,a!=null&&(r.pooledCache=null,Al(a)))}function zc(r){return j1(),X1(),Y1(),W1()}function W1(){if(ci!==5)return!1;var r=Xr,a=Ff;Ff=0;var c=al(Ta),h=Y.T,g=nt.p;try{nt.p=32>c?32:c,Y.T=null,c=kf,kf=null;var x=Xr,S=Ta;if(ci=0,Sa=Xr=null,Ta=0,(oe&6)!==0)throw Error(i(331));var R=oe;if(oe|=4,M1(x.current),R1(x,x.current,S,c),oe=R,Gl(0,!1),li&&typeof li.onPostCommitFiberRoot=="function")try{li.onPostCommitFiberRoot(nr,x)}catch{}return!0}finally{nt.p=g,Y.T=h,q1(r,a)}}function $1(r,a,c){a=dn(c,a),a=pf(r.stateNode,a,2),r=kr(r,a,2),r!==null&&(ds(r,2),Yn(r))}function Ee(r,a,c){if(r.tag===3)$1(r,r,c);else for(;a!==null;){if(a.tag===3){$1(a,r,c);break}else if(a.tag===1){var h=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(jr===null||!jr.has(h))){r=dn(c,r),c=Jg(2),h=kr(a,c,2),h!==null&&(t1(c,h,a,r),ds(h,2),Yn(h));break}}a=a.return}}function Hf(r,a,c){var h=r.pingCache;if(h===null){h=r.pingCache=new qA;var g=new Set;h.set(a,g)}else g=h.get(a),g===void 0&&(g=new Set,h.set(a,g));g.has(c)||(Of=!0,g.add(c),r=ZA.bind(null,r,a,c),a.then(r,r))}function ZA(r,a,c){var h=r.pingCache;h!==null&&h.delete(a),r.pingedLanes|=r.suspendedLanes&c,r.warmLanes&=~c,Te===r&&(ne&c)===c&&(Ne===4||Ne===3&&(ne&62914560)===ne&&300>Ot()-Lf?(oe&2)===0&&wa(r,0):Mf|=c,Ea===ne&&(Ea=0)),Yn(r)}function K1(r,a){a===0&&(a=nl()),r=la(r,a),r!==null&&(ds(r,a),Yn(r))}function JA(r){var a=r.memoizedState,c=0;a!==null&&(c=a.retryLane),K1(r,c)}function t2(r,a){var c=0;switch(r.tag){case 13:var h=r.stateNode,g=r.memoizedState;g!==null&&(c=g.retryLane);break;case 19:h=r.stateNode;break;case 22:h=r.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(a),K1(r,c)}function e2(r,a){return ee(r,a)}var Gc=null,Ca=null,zf=!1,Vc=!1,Gf=!1,Os=0;function Yn(r){r!==Ca&&r.next===null&&(Ca===null?Gc=Ca=r:Ca=Ca.next=r),Vc=!0,zf||(zf=!0,n2())}function Gl(r,a){if(!Gf&&Vc){Gf=!0;do for(var c=!1,h=Gc;h!==null;){if(r!==0){var g=h.pendingLanes;if(g===0)var x=0;else{var S=h.suspendedLanes,R=h.pingedLanes;x=(1<<31-bi(42|r)+1)-1,x&=g&~(S&~R),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(c=!0,tm(h,x))}else x=ne,x=Qs(h,h===Te?x:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(x&3)===0||fs(h,x)||(c=!0,tm(h,x));h=h.next}while(c);Gf=!1}}function i2(){Q1()}function Q1(){Vc=zf=!1;var r=0;Os!==0&&(h2()&&(r=Os),Os=0);for(var a=Ot(),c=null,h=Gc;h!==null;){var g=h.next,x=Z1(h,a);x===0?(h.next=null,c===null?Gc=g:c.next=g,g===null&&(Ca=c)):(c=h,(r!==0||(x&3)!==0)&&(Vc=!0)),h=g}Gl(r)}function Z1(r,a){for(var c=r.suspendedLanes,h=r.pingedLanes,g=r.expirationTimes,x=r.pendingLanes&-62914561;0<x;){var S=31-bi(x),R=1<<S,X=g[S];X===-1?((R&c)===0||(R&h)!==0)&&(g[S]=Wo(R,a)):X<=a&&(r.expiredLanes|=R),x&=~R}if(a=Te,c=ne,c=Qs(r,r===a?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),h=r.callbackNode,c===0||r===a&&(ce===2||ce===9)||r.cancelPendingCommit!==null)return h!==null&&h!==null&&jt(h),r.callbackNode=null,r.callbackPriority=0;if((c&3)===0||fs(r,c)){if(a=c&-c,a===r.callbackPriority)return a;switch(h!==null&&jt(h),al(c)){case 2:case 8:c=Un;break;case 32:c=Cn;break;case 268435456:c=$s;break;default:c=Cn}return h=J1.bind(null,r),c=ee(c,h),r.callbackPriority=a,r.callbackNode=c,a}return h!==null&&h!==null&&jt(h),r.callbackPriority=2,r.callbackNode=null,2}function J1(r,a){if(ci!==0&&ci!==5)return r.callbackNode=null,r.callbackPriority=0,null;var c=r.callbackNode;if(zc()&&r.callbackNode!==c)return null;var h=ne;return h=Qs(r,r===Te?h:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),h===0?null:(k1(r,h,a),Z1(r,Ot()),r.callbackNode!=null&&r.callbackNode===c?J1.bind(null,r):null)}function tm(r,a){if(zc())return null;k1(r,a,!0)}function n2(){d2(function(){(oe&6)!==0?ee(on,i2):Q1()})}function Vf(){return Os===0&&(Os=il()),Os}function em(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:tc(""+r)}function im(r,a){var c=a.ownerDocument.createElement("input");return c.name=a.name,c.value=a.value,r.id&&c.setAttribute("form",r.id),a.parentNode.insertBefore(c,a),r=new FormData(r),c.parentNode.removeChild(c),r}function r2(r,a,c,h,g){if(a==="submit"&&c&&c.stateNode===g){var x=em((g[Je]||null).action),S=h.submitter;S&&(a=(a=S[Je]||null)?em(a.formAction):S.getAttribute("formAction"),a!==null&&(x=a,S=null));var R=new rc("action","action",null,h,g);r.push({event:R,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Os!==0){var X=S?im(g,S):new FormData(g);cf(c,{pending:!0,data:X,method:g.method,action:x},null,X)}}else typeof x=="function"&&(R.preventDefault(),X=S?im(g,S):new FormData(g),cf(c,{pending:!0,data:X,method:g.method,action:x},x,X))},currentTarget:g}]})}}for(var jf=0;jf<Ch.length;jf++){var Xf=Ch[jf],s2=Xf.toLowerCase(),a2=Xf[0].toUpperCase()+Xf.slice(1);On(s2,"on"+a2)}On(kp,"onAnimationEnd"),On(Pp,"onAnimationIteration"),On(Bp,"onAnimationStart"),On("dblclick","onDoubleClick"),On("focusin","onFocus"),On("focusout","onBlur"),On(SA,"onTransitionRun"),On(TA,"onTransitionStart"),On(wA,"onTransitionCancel"),On(Ip,"onTransitionEnd"),Ct("onMouseEnter",["mouseout","mouseover"]),Ct("onMouseLeave",["mouseout","mouseover"]),Ct("onPointerEnter",["pointerout","pointerover"]),Ct("onPointerLeave",["pointerout","pointerover"]),St("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),St("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),St("onBeforeInput",["compositionend","keypress","textInput","paste"]),St("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),St("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),St("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),l2=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Vl));function nm(r,a){a=(a&4)!==0;for(var c=0;c<r.length;c++){var h=r[c],g=h.event;h=h.listeners;t:{var x=void 0;if(a)for(var S=h.length-1;0<=S;S--){var R=h[S],X=R.instance,it=R.currentTarget;if(R=R.listener,X!==x&&g.isPropagationStopped())break t;x=R,g.currentTarget=it;try{x(g)}catch(pt){Oc(pt)}g.currentTarget=null,x=X}else for(S=0;S<h.length;S++){if(R=h[S],X=R.instance,it=R.currentTarget,R=R.listener,X!==x&&g.isPropagationStopped())break t;x=R,g.currentTarget=it;try{x(g)}catch(pt){Oc(pt)}g.currentTarget=null,x=X}}}}function te(r,a){var c=a[ll];c===void 0&&(c=a[ll]=new Set);var h=r+"__bubble";c.has(h)||(rm(a,r,2,!1),c.add(h))}function Yf(r,a,c){var h=0;a&&(h|=4),rm(c,r,h,a)}var jc="_reactListening"+Math.random().toString(36).slice(2);function qf(r){if(!r[jc]){r[jc]=!0,at.forEach(function(c){c!=="selectionchange"&&(l2.has(c)||Yf(c,!1,r),Yf(c,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[jc]||(a[jc]=!0,Yf("selectionchange",!1,a))}}function rm(r,a,c,h){switch(Rm(a)){case 2:var g=F2;break;case 8:g=k2;break;default:g=l0}c=g.bind(null,a,c,r),g=void 0,!ph||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(g=!0),h?g!==void 0?r.addEventListener(a,c,{capture:!0,passive:g}):r.addEventListener(a,c,!0):g!==void 0?r.addEventListener(a,c,{passive:g}):r.addEventListener(a,c,!1)}function Wf(r,a,c,h,g){var x=h;if((a&1)===0&&(a&2)===0&&h!==null)t:for(;;){if(h===null)return;var S=h.tag;if(S===3||S===4){var R=h.stateNode.containerInfo;if(R===g)break;if(S===4)for(S=h.return;S!==null;){var X=S.tag;if((X===3||X===4)&&S.stateNode.containerInfo===g)return;S=S.return}for(;R!==null;){if(S=B(R),S===null)return;if(X=S.tag,X===5||X===6||X===26||X===27){h=x=S;continue t}R=R.parentNode}}h=h.return}hp(function(){var it=x,pt=fh(c),xt=[];t:{var lt=Up.get(r);if(lt!==void 0){var ct=rc,Vt=r;switch(r){case"keypress":if(ic(c)===0)break t;case"keydown":case"keyup":ct=eA;break;case"focusin":Vt="focus",ct=xh;break;case"focusout":Vt="blur",ct=xh;break;case"beforeblur":case"afterblur":ct=xh;break;case"click":if(c.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ct=pp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ct=Vy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ct=rA;break;case kp:case Pp:case Bp:ct=Yy;break;case Ip:ct=aA;break;case"scroll":case"scrollend":ct=zy;break;case"wheel":ct=oA;break;case"copy":case"cut":case"paste":ct=Wy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ct=mp;break;case"toggle":case"beforetoggle":ct=uA}var Ht=(a&4)!==0,_e=!Ht&&(r==="scroll"||r==="scrollend"),Z=Ht?lt!==null?lt+"Capture":null:lt;Ht=[];for(var W=it,et;W!==null;){var mt=W;if(et=mt.stateNode,mt=mt.tag,mt!==5&&mt!==26&&mt!==27||et===null||Z===null||(mt=ol(W,Z),mt!=null&&Ht.push(jl(W,mt,et))),_e)break;W=W.return}0<Ht.length&&(lt=new ct(lt,Vt,null,c,pt),xt.push({event:lt,listeners:Ht}))}}if((a&7)===0){t:{if(lt=r==="mouseover"||r==="pointerover",ct=r==="mouseout"||r==="pointerout",lt&&c!==hh&&(Vt=c.relatedTarget||c.fromElement)&&(B(Vt)||Vt[Dr]))break t;if((ct||lt)&&(lt=pt.window===pt?pt:(lt=pt.ownerDocument)?lt.defaultView||lt.parentWindow:window,ct?(Vt=c.relatedTarget||c.toElement,ct=it,Vt=Vt?B(Vt):null,Vt!==null&&(_e=l(Vt),Ht=Vt.tag,Vt!==_e||Ht!==5&&Ht!==27&&Ht!==6)&&(Vt=null)):(ct=null,Vt=it),ct!==Vt)){if(Ht=pp,mt="onMouseLeave",Z="onMouseEnter",W="mouse",(r==="pointerout"||r==="pointerover")&&(Ht=mp,mt="onPointerLeave",Z="onPointerEnter",W="pointer"),_e=ct==null?lt:rt(ct),et=Vt==null?lt:rt(Vt),lt=new Ht(mt,W+"leave",ct,c,pt),lt.target=_e,lt.relatedTarget=et,mt=null,B(pt)===it&&(Ht=new Ht(Z,W+"enter",Vt,c,pt),Ht.target=et,Ht.relatedTarget=_e,mt=Ht),_e=mt,ct&&Vt)e:{for(Ht=ct,Z=Vt,W=0,et=Ht;et;et=Ra(et))W++;for(et=0,mt=Z;mt;mt=Ra(mt))et++;for(;0<W-et;)Ht=Ra(Ht),W--;for(;0<et-W;)Z=Ra(Z),et--;for(;W--;){if(Ht===Z||Z!==null&&Ht===Z.alternate)break e;Ht=Ra(Ht),Z=Ra(Z)}Ht=null}else Ht=null;ct!==null&&sm(xt,lt,ct,Ht,!1),Vt!==null&&_e!==null&&sm(xt,_e,Vt,Ht,!0)}}t:{if(lt=it?rt(it):window,ct=lt.nodeName&&lt.nodeName.toLowerCase(),ct==="select"||ct==="input"&&lt.type==="file")var Ft=Tp;else if(Ep(lt))if(wp)Ft=yA;else{Ft=xA;var Qt=vA}else ct=lt.nodeName,!ct||ct.toLowerCase()!=="input"||lt.type!=="checkbox"&&lt.type!=="radio"?it&&uh(it.elementType)&&(Ft=Tp):Ft=_A;if(Ft&&(Ft=Ft(r,it))){Sp(xt,Ft,c,pt);break t}Qt&&Qt(r,lt,it),r==="focusout"&&it&&lt.type==="number"&&it.memoizedProps.value!=null&&ch(lt,"number",lt.value)}switch(Qt=it?rt(it):window,r){case"focusin":(Ep(Qt)||Qt.contentEditable==="true")&&(ra=Qt,Th=it,ml=null);break;case"focusout":ml=Th=ra=null;break;case"mousedown":wh=!0;break;case"contextmenu":case"mouseup":case"dragend":wh=!1,Lp(xt,c,pt);break;case"selectionchange":if(EA)break;case"keydown":case"keyup":Lp(xt,c,pt)}var Bt;if(yh)t:{switch(r){case"compositionstart":var zt="onCompositionStart";break t;case"compositionend":zt="onCompositionEnd";break t;case"compositionupdate":zt="onCompositionUpdate";break t}zt=void 0}else na?yp(r,c)&&(zt="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(zt="onCompositionStart");zt&&(vp&&c.locale!=="ko"&&(na||zt!=="onCompositionStart"?zt==="onCompositionEnd"&&na&&(Bt=fp()):(Mr=pt,gh="value"in Mr?Mr.value:Mr.textContent,na=!0)),Qt=Xc(it,zt),0<Qt.length&&(zt=new gp(zt,r,null,c,pt),xt.push({event:zt,listeners:Qt}),Bt?zt.data=Bt:(Bt=Ap(c),Bt!==null&&(zt.data=Bt)))),(Bt=fA?dA(r,c):pA(r,c))&&(zt=Xc(it,"onBeforeInput"),0<zt.length&&(Qt=new gp("onBeforeInput","beforeinput",null,c,pt),xt.push({event:Qt,listeners:zt}),Qt.data=Bt)),r2(xt,r,it,c,pt)}nm(xt,a)})}function jl(r,a,c){return{instance:r,listener:a,currentTarget:c}}function Xc(r,a){for(var c=a+"Capture",h=[];r!==null;){var g=r,x=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||x===null||(g=ol(r,c),g!=null&&h.unshift(jl(r,g,x)),g=ol(r,a),g!=null&&h.push(jl(r,g,x))),r.tag===3)return h;r=r.return}return[]}function Ra(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function sm(r,a,c,h,g){for(var x=a._reactName,S=[];c!==null&&c!==h;){var R=c,X=R.alternate,it=R.stateNode;if(R=R.tag,X!==null&&X===h)break;R!==5&&R!==26&&R!==27||it===null||(X=it,g?(it=ol(c,x),it!=null&&S.unshift(jl(c,it,X))):g||(it=ol(c,x),it!=null&&S.push(jl(c,it,X)))),c=c.return}S.length!==0&&r.push({event:a,listeners:S})}var o2=/\r\n?/g,c2=/\u0000|\uFFFD/g;function am(r){return(typeof r=="string"?r:""+r).replace(o2,`
`).replace(c2,"")}function lm(r,a){return a=am(a),am(r)===a}function Yc(){}function xe(r,a,c,h,g,x){switch(c){case"children":typeof h=="string"?a==="body"||a==="textarea"&&h===""||ta(r,h):(typeof h=="number"||typeof h=="bigint")&&a!=="body"&&ta(r,""+h);break;case"className":me(r,"class",h);break;case"tabIndex":me(r,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":me(r,c,h);break;case"style":cp(r,h,x);break;case"data":if(a!=="object"){me(r,"data",h);break}case"src":case"href":if(h===""&&(a!=="a"||c!=="href")){r.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){r.removeAttribute(c);break}h=tc(""+h),r.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){r.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(c==="formAction"?(a!=="input"&&xe(r,a,"name",g.name,g,null),xe(r,a,"formEncType",g.formEncType,g,null),xe(r,a,"formMethod",g.formMethod,g,null),xe(r,a,"formTarget",g.formTarget,g,null)):(xe(r,a,"encType",g.encType,g,null),xe(r,a,"method",g.method,g,null),xe(r,a,"target",g.target,g,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){r.removeAttribute(c);break}h=tc(""+h),r.setAttribute(c,h);break;case"onClick":h!=null&&(r.onclick=Yc);break;case"onScroll":h!=null&&te("scroll",r);break;case"onScrollEnd":h!=null&&te("scrollend",r);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(c=h.__html,c!=null){if(g.children!=null)throw Error(i(60));r.innerHTML=c}}break;case"multiple":r.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":r.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){r.removeAttribute("xlink:href");break}c=tc(""+h),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(c,""+h):r.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(c,""):r.removeAttribute(c);break;case"capture":case"download":h===!0?r.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(c,h):r.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?r.setAttribute(c,h):r.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?r.removeAttribute(c):r.setAttribute(c,h);break;case"popover":te("beforetoggle",r),te("toggle",r),ge(r,"popover",h);break;case"xlinkActuate":Se(r,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Se(r,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Se(r,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Se(r,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Se(r,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Se(r,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Se(r,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Se(r,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Se(r,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":ge(r,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Uy.get(c)||c,ge(r,c,h))}}function $f(r,a,c,h,g,x){switch(c){case"style":cp(r,h,x);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(c=h.__html,c!=null){if(g.children!=null)throw Error(i(60));r.innerHTML=c}}break;case"children":typeof h=="string"?ta(r,h):(typeof h=="number"||typeof h=="bigint")&&ta(r,""+h);break;case"onScroll":h!=null&&te("scroll",r);break;case"onScrollEnd":h!=null&&te("scrollend",r);break;case"onClick":h!=null&&(r.onclick=Yc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ot.hasOwnProperty(c))t:{if(c[0]==="o"&&c[1]==="n"&&(g=c.endsWith("Capture"),a=c.slice(2,g?c.length-7:void 0),x=r[Je]||null,x=x!=null?x[c]:null,typeof x=="function"&&r.removeEventListener(a,x,g),typeof h=="function")){typeof x!="function"&&x!==null&&(c in r?r[c]=null:r.hasAttribute(c)&&r.removeAttribute(c)),r.addEventListener(a,h,g);break t}c in r?r[c]=h:h===!0?r.setAttribute(c,""):ge(r,c,h)}}}function ui(r,a,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":te("error",r),te("load",r);var h=!1,g=!1,x;for(x in c)if(c.hasOwnProperty(x)){var S=c[x];if(S!=null)switch(x){case"src":h=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:xe(r,a,x,S,c,null)}}g&&xe(r,a,"srcSet",c.srcSet,c,null),h&&xe(r,a,"src",c.src,c,null);return;case"input":te("invalid",r);var R=x=S=g=null,X=null,it=null;for(h in c)if(c.hasOwnProperty(h)){var pt=c[h];if(pt!=null)switch(h){case"name":g=pt;break;case"type":S=pt;break;case"checked":X=pt;break;case"defaultChecked":it=pt;break;case"value":x=pt;break;case"defaultValue":R=pt;break;case"children":case"dangerouslySetInnerHTML":if(pt!=null)throw Error(i(137,a));break;default:xe(r,a,h,pt,c,null)}}sp(r,x,R,X,it,S,g,!1),Zo(r);return;case"select":te("invalid",r),h=S=x=null;for(g in c)if(c.hasOwnProperty(g)&&(R=c[g],R!=null))switch(g){case"value":x=R;break;case"defaultValue":S=R;break;case"multiple":h=R;default:xe(r,a,g,R,c,null)}a=x,c=S,r.multiple=!!h,a!=null?Js(r,!!h,a,!1):c!=null&&Js(r,!!h,c,!0);return;case"textarea":te("invalid",r),x=g=h=null;for(S in c)if(c.hasOwnProperty(S)&&(R=c[S],R!=null))switch(S){case"value":h=R;break;case"defaultValue":g=R;break;case"children":x=R;break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(i(91));break;default:xe(r,a,S,R,c,null)}lp(r,h,g,x),Zo(r);return;case"option":for(X in c)if(c.hasOwnProperty(X)&&(h=c[X],h!=null))switch(X){case"selected":r.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:xe(r,a,X,h,c,null)}return;case"dialog":te("beforetoggle",r),te("toggle",r),te("cancel",r),te("close",r);break;case"iframe":case"object":te("load",r);break;case"video":case"audio":for(h=0;h<Vl.length;h++)te(Vl[h],r);break;case"image":te("error",r),te("load",r);break;case"details":te("toggle",r);break;case"embed":case"source":case"link":te("error",r),te("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(it in c)if(c.hasOwnProperty(it)&&(h=c[it],h!=null))switch(it){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:xe(r,a,it,h,c,null)}return;default:if(uh(a)){for(pt in c)c.hasOwnProperty(pt)&&(h=c[pt],h!==void 0&&$f(r,a,pt,h,c,void 0));return}}for(R in c)c.hasOwnProperty(R)&&(h=c[R],h!=null&&xe(r,a,R,h,c,null))}function u2(r,a,c,h){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,x=null,S=null,R=null,X=null,it=null,pt=null;for(ct in c){var xt=c[ct];if(c.hasOwnProperty(ct)&&xt!=null)switch(ct){case"checked":break;case"value":break;case"defaultValue":X=xt;default:h.hasOwnProperty(ct)||xe(r,a,ct,null,h,xt)}}for(var lt in h){var ct=h[lt];if(xt=c[lt],h.hasOwnProperty(lt)&&(ct!=null||xt!=null))switch(lt){case"type":x=ct;break;case"name":g=ct;break;case"checked":it=ct;break;case"defaultChecked":pt=ct;break;case"value":S=ct;break;case"defaultValue":R=ct;break;case"children":case"dangerouslySetInnerHTML":if(ct!=null)throw Error(i(137,a));break;default:ct!==xt&&xe(r,a,lt,ct,h,xt)}}oh(r,S,R,X,it,pt,x,g);return;case"select":ct=S=R=lt=null;for(x in c)if(X=c[x],c.hasOwnProperty(x)&&X!=null)switch(x){case"value":break;case"multiple":ct=X;default:h.hasOwnProperty(x)||xe(r,a,x,null,h,X)}for(g in h)if(x=h[g],X=c[g],h.hasOwnProperty(g)&&(x!=null||X!=null))switch(g){case"value":lt=x;break;case"defaultValue":R=x;break;case"multiple":S=x;default:x!==X&&xe(r,a,g,x,h,X)}a=R,c=S,h=ct,lt!=null?Js(r,!!c,lt,!1):!!h!=!!c&&(a!=null?Js(r,!!c,a,!0):Js(r,!!c,c?[]:"",!1));return;case"textarea":ct=lt=null;for(R in c)if(g=c[R],c.hasOwnProperty(R)&&g!=null&&!h.hasOwnProperty(R))switch(R){case"value":break;case"children":break;default:xe(r,a,R,null,h,g)}for(S in h)if(g=h[S],x=c[S],h.hasOwnProperty(S)&&(g!=null||x!=null))switch(S){case"value":lt=g;break;case"defaultValue":ct=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==x&&xe(r,a,S,g,h,x)}ap(r,lt,ct);return;case"option":for(var Vt in c)if(lt=c[Vt],c.hasOwnProperty(Vt)&&lt!=null&&!h.hasOwnProperty(Vt))switch(Vt){case"selected":r.selected=!1;break;default:xe(r,a,Vt,null,h,lt)}for(X in h)if(lt=h[X],ct=c[X],h.hasOwnProperty(X)&&lt!==ct&&(lt!=null||ct!=null))switch(X){case"selected":r.selected=lt&&typeof lt!="function"&&typeof lt!="symbol";break;default:xe(r,a,X,lt,h,ct)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ht in c)lt=c[Ht],c.hasOwnProperty(Ht)&&lt!=null&&!h.hasOwnProperty(Ht)&&xe(r,a,Ht,null,h,lt);for(it in h)if(lt=h[it],ct=c[it],h.hasOwnProperty(it)&&lt!==ct&&(lt!=null||ct!=null))switch(it){case"children":case"dangerouslySetInnerHTML":if(lt!=null)throw Error(i(137,a));break;default:xe(r,a,it,lt,h,ct)}return;default:if(uh(a)){for(var _e in c)lt=c[_e],c.hasOwnProperty(_e)&&lt!==void 0&&!h.hasOwnProperty(_e)&&$f(r,a,_e,void 0,h,lt);for(pt in h)lt=h[pt],ct=c[pt],!h.hasOwnProperty(pt)||lt===ct||lt===void 0&&ct===void 0||$f(r,a,pt,lt,h,ct);return}}for(var Z in c)lt=c[Z],c.hasOwnProperty(Z)&&lt!=null&&!h.hasOwnProperty(Z)&&xe(r,a,Z,null,h,lt);for(xt in h)lt=h[xt],ct=c[xt],!h.hasOwnProperty(xt)||lt===ct||lt==null&&ct==null||xe(r,a,xt,lt,h,ct)}var Kf=null,Qf=null;function qc(r){return r.nodeType===9?r:r.ownerDocument}function om(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function cm(r,a){if(r===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&a==="foreignObject"?0:r}function Zf(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Jf=null;function h2(){var r=window.event;return r&&r.type==="popstate"?r===Jf?!1:(Jf=r,!0):(Jf=null,!1)}var um=typeof setTimeout=="function"?setTimeout:void 0,f2=typeof clearTimeout=="function"?clearTimeout:void 0,hm=typeof Promise=="function"?Promise:void 0,d2=typeof queueMicrotask=="function"?queueMicrotask:typeof hm<"u"?function(r){return hm.resolve(null).then(r).catch(p2)}:um;function p2(r){setTimeout(function(){throw r})}function qr(r){return r==="head"}function fm(r,a){var c=a,h=0,g=0;do{var x=c.nextSibling;if(r.removeChild(c),x&&x.nodeType===8)if(c=x.data,c==="/$"){if(0<h&&8>h){c=h;var S=r.ownerDocument;if(c&1&&Xl(S.documentElement),c&2&&Xl(S.body),c&4)for(c=S.head,Xl(c),S=c.firstChild;S;){var R=S.nextSibling,X=S.nodeName;S[N]||X==="SCRIPT"||X==="STYLE"||X==="LINK"&&S.rel.toLowerCase()==="stylesheet"||c.removeChild(S),S=R}}if(g===0){r.removeChild(x),Jl(a);return}g--}else c==="$"||c==="$?"||c==="$!"?g++:h=c.charCodeAt(0)-48;else h=0;c=x}while(c);Jl(a)}function t0(r){var a=r.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var c=a;switch(a=a.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":t0(c),P(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}r.removeChild(c)}}function g2(r,a,c,h){for(;r.nodeType===1;){var g=c;if(r.nodeName.toLowerCase()!==a.toLowerCase()){if(!h&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(h){if(!r[N])switch(a){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(x=r.getAttribute("rel"),x==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(x!==g.rel||r.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||r.getAttribute("title")!==(g.title==null?null:g.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(x=r.getAttribute("src"),(x!==(g.src==null?null:g.src)||r.getAttribute("type")!==(g.type==null?null:g.type)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&x&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(a==="input"&&r.type==="hidden"){var x=g.name==null?null:""+g.name;if(g.type==="hidden"&&r.getAttribute("name")===x)return r}else return r;if(r=Nn(r.nextSibling),r===null)break}return null}function m2(r,a,c){if(a==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!c||(r=Nn(r.nextSibling),r===null))return null;return r}function e0(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function v2(r,a){var c=r.ownerDocument;if(r.data!=="$?"||c.readyState==="complete")a();else{var h=function(){a(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),r._reactRetry=h}}function Nn(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return r}var i0=null;function dm(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"){if(a===0)return r;a--}else c==="/$"&&a++}r=r.previousSibling}return null}function pm(r,a,c){switch(a=qc(c),r){case"html":if(r=a.documentElement,!r)throw Error(i(452));return r;case"head":if(r=a.head,!r)throw Error(i(453));return r;case"body":if(r=a.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function Xl(r){for(var a=r.attributes;a.length;)r.removeAttributeNode(a[0]);P(r)}var _n=new Map,gm=new Set;function Wc(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var xr=nt.d;nt.d={f:x2,r:_2,D:y2,C:A2,L:E2,m:S2,X:w2,S:T2,M:b2};function x2(){var r=xr.f(),a=Uc();return r||a}function _2(r){var a=H(r);a!==null&&a.tag===5&&a.type==="form"?kg(a):xr.r(r)}var Da=typeof document>"u"?null:document;function mm(r,a,c){var h=Da;if(h&&typeof a=="string"&&a){var g=fn(a);g='link[rel="'+r+'"][href="'+g+'"]',typeof c=="string"&&(g+='[crossorigin="'+c+'"]'),gm.has(g)||(gm.add(g),r={rel:r,crossOrigin:c,href:a},h.querySelector(g)===null&&(a=h.createElement("link"),ui(a,"link",r),tt(a),h.head.appendChild(a)))}}function y2(r){xr.D(r),mm("dns-prefetch",r,null)}function A2(r,a){xr.C(r,a),mm("preconnect",r,a)}function E2(r,a,c){xr.L(r,a,c);var h=Da;if(h&&r&&a){var g='link[rel="preload"][as="'+fn(a)+'"]';a==="image"&&c&&c.imageSrcSet?(g+='[imagesrcset="'+fn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(g+='[imagesizes="'+fn(c.imageSizes)+'"]')):g+='[href="'+fn(r)+'"]';var x=g;switch(a){case"style":x=Oa(r);break;case"script":x=Ma(r)}_n.has(x)||(r=p({rel:"preload",href:a==="image"&&c&&c.imageSrcSet?void 0:r,as:a},c),_n.set(x,r),h.querySelector(g)!==null||a==="style"&&h.querySelector(Yl(x))||a==="script"&&h.querySelector(ql(x))||(a=h.createElement("link"),ui(a,"link",r),tt(a),h.head.appendChild(a)))}}function S2(r,a){xr.m(r,a);var c=Da;if(c&&r){var h=a&&typeof a.as=="string"?a.as:"script",g='link[rel="modulepreload"][as="'+fn(h)+'"][href="'+fn(r)+'"]',x=g;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=Ma(r)}if(!_n.has(x)&&(r=p({rel:"modulepreload",href:r},a),_n.set(x,r),c.querySelector(g)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(ql(x)))return}h=c.createElement("link"),ui(h,"link",r),tt(h),c.head.appendChild(h)}}}function T2(r,a,c){xr.S(r,a,c);var h=Da;if(h&&r){var g=ft(h).hoistableStyles,x=Oa(r);a=a||"default";var S=g.get(x);if(!S){var R={loading:0,preload:null};if(S=h.querySelector(Yl(x)))R.loading=5;else{r=p({rel:"stylesheet",href:r,"data-precedence":a},c),(c=_n.get(x))&&n0(r,c);var X=S=h.createElement("link");tt(X),ui(X,"link",r),X._p=new Promise(function(it,pt){X.onload=it,X.onerror=pt}),X.addEventListener("load",function(){R.loading|=1}),X.addEventListener("error",function(){R.loading|=2}),R.loading|=4,$c(S,a,h)}S={type:"stylesheet",instance:S,count:1,state:R},g.set(x,S)}}}function w2(r,a){xr.X(r,a);var c=Da;if(c&&r){var h=ft(c).hoistableScripts,g=Ma(r),x=h.get(g);x||(x=c.querySelector(ql(g)),x||(r=p({src:r,async:!0},a),(a=_n.get(g))&&r0(r,a),x=c.createElement("script"),tt(x),ui(x,"link",r),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},h.set(g,x))}}function b2(r,a){xr.M(r,a);var c=Da;if(c&&r){var h=ft(c).hoistableScripts,g=Ma(r),x=h.get(g);x||(x=c.querySelector(ql(g)),x||(r=p({src:r,async:!0,type:"module"},a),(a=_n.get(g))&&r0(r,a),x=c.createElement("script"),tt(x),ui(x,"link",r),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},h.set(g,x))}}function vm(r,a,c,h){var g=(g=J.current)?Wc(g):null;if(!g)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(a=Oa(c.href),c=ft(g).hoistableStyles,h=c.get(a),h||(h={type:"style",instance:null,count:0,state:null},c.set(a,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){r=Oa(c.href);var x=ft(g).hoistableStyles,S=x.get(r);if(S||(g=g.ownerDocument||g,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(r,S),(x=g.querySelector(Yl(r)))&&!x._p&&(S.instance=x,S.state.loading=5),_n.has(r)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},_n.set(r,c),x||C2(g,r,c,S.state))),a&&h===null)throw Error(i(528,""));return S}if(a&&h!==null)throw Error(i(529,""));return null;case"script":return a=c.async,c=c.src,typeof c=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Ma(c),c=ft(g).hoistableScripts,h=c.get(a),h||(h={type:"script",instance:null,count:0,state:null},c.set(a,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function Oa(r){return'href="'+fn(r)+'"'}function Yl(r){return'link[rel="stylesheet"]['+r+"]"}function xm(r){return p({},r,{"data-precedence":r.precedence,precedence:null})}function C2(r,a,c,h){r.querySelector('link[rel="preload"][as="style"]['+a+"]")?h.loading=1:(a=r.createElement("link"),h.preload=a,a.addEventListener("load",function(){return h.loading|=1}),a.addEventListener("error",function(){return h.loading|=2}),ui(a,"link",c),tt(a),r.head.appendChild(a))}function Ma(r){return'[src="'+fn(r)+'"]'}function ql(r){return"script[async]"+r}function _m(r,a,c){if(a.count++,a.instance===null)switch(a.type){case"style":var h=r.querySelector('style[data-href~="'+fn(c.href)+'"]');if(h)return a.instance=h,tt(h),h;var g=p({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(r.ownerDocument||r).createElement("style"),tt(h),ui(h,"style",g),$c(h,c.precedence,r),a.instance=h;case"stylesheet":g=Oa(c.href);var x=r.querySelector(Yl(g));if(x)return a.state.loading|=4,a.instance=x,tt(x),x;h=xm(c),(g=_n.get(g))&&n0(h,g),x=(r.ownerDocument||r).createElement("link"),tt(x);var S=x;return S._p=new Promise(function(R,X){S.onload=R,S.onerror=X}),ui(x,"link",h),a.state.loading|=4,$c(x,c.precedence,r),a.instance=x;case"script":return x=Ma(c.src),(g=r.querySelector(ql(x)))?(a.instance=g,tt(g),g):(h=c,(g=_n.get(x))&&(h=p({},c),r0(h,g)),r=r.ownerDocument||r,g=r.createElement("script"),tt(g),ui(g,"link",h),r.head.appendChild(g),a.instance=g);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(h=a.instance,a.state.loading|=4,$c(h,c.precedence,r));return a.instance}function $c(r,a,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=h.length?h[h.length-1]:null,x=g,S=0;S<h.length;S++){var R=h[S];if(R.dataset.precedence===a)x=R;else if(x!==g)break}x?x.parentNode.insertBefore(r,x.nextSibling):(a=c.nodeType===9?c.head:c,a.insertBefore(r,a.firstChild))}function n0(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.title==null&&(r.title=a.title)}function r0(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.integrity==null&&(r.integrity=a.integrity)}var Kc=null;function ym(r,a,c){if(Kc===null){var h=new Map,g=Kc=new Map;g.set(c,h)}else g=Kc,h=g.get(c),h||(h=new Map,g.set(c,h));if(h.has(r))return h;for(h.set(r,null),c=c.getElementsByTagName(r),g=0;g<c.length;g++){var x=c[g];if(!(x[N]||x[Ze]||r==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var S=x.getAttribute(a)||"";S=r+S;var R=h.get(S);R?R.push(x):h.set(S,[x])}}return h}function Am(r,a,c){r=r.ownerDocument||r,r.head.insertBefore(c,a==="title"?r.querySelector("head > title"):null)}function R2(r,a,c){if(c===1||a.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return r=a.disabled,typeof a.precedence=="string"&&r==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function Em(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var Wl=null;function D2(){}function O2(r,a,c){if(Wl===null)throw Error(i(475));var h=Wl;if(a.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var g=Oa(c.href),x=r.querySelector(Yl(g));if(x){r=x._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(h.count++,h=Qc.bind(h),r.then(h,h)),a.state.loading|=4,a.instance=x,tt(x);return}x=r.ownerDocument||r,c=xm(c),(g=_n.get(g))&&n0(c,g),x=x.createElement("link"),tt(x);var S=x;S._p=new Promise(function(R,X){S.onload=R,S.onerror=X}),ui(x,"link",c),a.instance=x}h.stylesheets===null&&(h.stylesheets=new Map),h.stylesheets.set(a,r),(r=a.state.preload)&&(a.state.loading&3)===0&&(h.count++,a=Qc.bind(h),r.addEventListener("load",a),r.addEventListener("error",a))}}function M2(){if(Wl===null)throw Error(i(475));var r=Wl;return r.stylesheets&&r.count===0&&s0(r,r.stylesheets),0<r.count?function(a){var c=setTimeout(function(){if(r.stylesheets&&s0(r,r.stylesheets),r.unsuspend){var h=r.unsuspend;r.unsuspend=null,h()}},6e4);return r.unsuspend=a,function(){r.unsuspend=null,clearTimeout(c)}}:null}function Qc(){if(this.count--,this.count===0){if(this.stylesheets)s0(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Zc=null;function s0(r,a){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Zc=new Map,a.forEach(N2,r),Zc=null,Qc.call(r))}function N2(r,a){if(!(a.state.loading&4)){var c=Zc.get(r);if(c)var h=c.get(null);else{c=new Map,Zc.set(r,c);for(var g=r.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<g.length;x++){var S=g[x];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(c.set(S.dataset.precedence,S),h=S)}h&&c.set(null,h)}g=a.instance,S=g.getAttribute("data-precedence"),x=c.get(S)||h,x===h&&c.set(null,g),c.set(S,g),this.count++,h=Qc.bind(this),g.addEventListener("load",h),g.addEventListener("error",h),x?x.parentNode.insertBefore(g,x.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(g,r.firstChild)),a.state.loading|=4}}var $l={$$typeof:w,Provider:null,Consumer:null,_currentValue:Tt,_currentValue2:Tt,_threadCount:0};function L2(r,a,c,h,g,x,S,R){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=rl(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rl(0),this.hiddenUpdates=rl(null),this.identifierPrefix=h,this.onUncaughtError=g,this.onCaughtError=x,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=R,this.incompleteTransitions=new Map}function Sm(r,a,c,h,g,x,S,R,X,it,pt,xt){return r=new L2(r,a,c,S,R,X,it,xt),a=1,x===!0&&(a|=24),x=qi(3,null,null,a),r.current=x,x.stateNode=r,a=Uh(),a.refCount++,r.pooledCache=a,a.refCount++,x.memoizedState={element:h,isDehydrated:c,cache:a},Vh(x),r}function Tm(r){return r?(r=oa,r):oa}function wm(r,a,c,h,g,x){g=Tm(g),h.context===null?h.context=g:h.pendingContext=g,h=Fr(a),h.payload={element:c},x=x===void 0?null:x,x!==null&&(h.callback=x),c=kr(r,h,a),c!==null&&(Zi(c,r,a),wl(c,r,a))}function bm(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<a?c:a}}function a0(r,a){bm(r,a),(r=r.alternate)&&bm(r,a)}function Cm(r){if(r.tag===13){var a=la(r,67108864);a!==null&&Zi(a,r,67108864),a0(r,67108864)}}var Jc=!0;function F2(r,a,c,h){var g=Y.T;Y.T=null;var x=nt.p;try{nt.p=2,l0(r,a,c,h)}finally{nt.p=x,Y.T=g}}function k2(r,a,c,h){var g=Y.T;Y.T=null;var x=nt.p;try{nt.p=8,l0(r,a,c,h)}finally{nt.p=x,Y.T=g}}function l0(r,a,c,h){if(Jc){var g=o0(h);if(g===null)Wf(r,a,h,tu,c),Dm(r,h);else if(B2(g,r,a,c,h))h.stopPropagation();else if(Dm(r,h),a&4&&-1<P2.indexOf(r)){for(;g!==null;){var x=H(g);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var S=Hn(x.pendingLanes);if(S!==0){var R=x;for(R.pendingLanes|=2,R.entangledLanes|=2;S;){var X=1<<31-bi(S);R.entanglements[1]|=X,S&=~X}Yn(x),(oe&6)===0&&(Bc=Ot()+500,Gl(0))}}break;case 13:R=la(x,2),R!==null&&Zi(R,x,2),Uc(),a0(x,2)}if(x=o0(h),x===null&&Wf(r,a,h,tu,c),x===g)break;g=x}g!==null&&h.stopPropagation()}else Wf(r,a,h,null,c)}}function o0(r){return r=fh(r),c0(r)}var tu=null;function c0(r){if(tu=null,r=B(r),r!==null){var a=l(r);if(a===null)r=null;else{var c=a.tag;if(c===13){if(r=o(a),r!==null)return r;r=null}else if(c===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null)}}return tu=r,null}function Rm(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ki()){case on:return 2;case Un:return 8;case Cn:case jo:return 32;case $s:return 268435456;default:return 32}default:return 32}}var u0=!1,Wr=null,$r=null,Kr=null,Kl=new Map,Ql=new Map,Qr=[],P2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Dm(r,a){switch(r){case"focusin":case"focusout":Wr=null;break;case"dragenter":case"dragleave":$r=null;break;case"mouseover":case"mouseout":Kr=null;break;case"pointerover":case"pointerout":Kl.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ql.delete(a.pointerId)}}function Zl(r,a,c,h,g,x){return r===null||r.nativeEvent!==x?(r={blockedOn:a,domEventName:c,eventSystemFlags:h,nativeEvent:x,targetContainers:[g]},a!==null&&(a=H(a),a!==null&&Cm(a)),r):(r.eventSystemFlags|=h,a=r.targetContainers,g!==null&&a.indexOf(g)===-1&&a.push(g),r)}function B2(r,a,c,h,g){switch(a){case"focusin":return Wr=Zl(Wr,r,a,c,h,g),!0;case"dragenter":return $r=Zl($r,r,a,c,h,g),!0;case"mouseover":return Kr=Zl(Kr,r,a,c,h,g),!0;case"pointerover":var x=g.pointerId;return Kl.set(x,Zl(Kl.get(x)||null,r,a,c,h,g)),!0;case"gotpointercapture":return x=g.pointerId,Ql.set(x,Zl(Ql.get(x)||null,r,a,c,h,g)),!0}return!1}function Om(r){var a=B(r.target);if(a!==null){var c=l(a);if(c!==null){if(a=c.tag,a===13){if(a=o(c),a!==null){r.blockedOn=a,ah(r.priority,function(){if(c.tag===13){var h=Qi();h=sl(h);var g=la(c,h);g!==null&&Zi(g,c,h),a0(c,h)}});return}}else if(a===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function eu(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var c=o0(r.nativeEvent);if(c===null){c=r.nativeEvent;var h=new c.constructor(c.type,c);hh=h,c.target.dispatchEvent(h),hh=null}else return a=H(c),a!==null&&Cm(a),r.blockedOn=c,!1;a.shift()}return!0}function Mm(r,a,c){eu(r)&&c.delete(a)}function I2(){u0=!1,Wr!==null&&eu(Wr)&&(Wr=null),$r!==null&&eu($r)&&($r=null),Kr!==null&&eu(Kr)&&(Kr=null),Kl.forEach(Mm),Ql.forEach(Mm)}function iu(r,a){r.blockedOn===a&&(r.blockedOn=null,u0||(u0=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,I2)))}var nu=null;function Nm(r){nu!==r&&(nu=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){nu===r&&(nu=null);for(var a=0;a<r.length;a+=3){var c=r[a],h=r[a+1],g=r[a+2];if(typeof h!="function"){if(c0(h||c)===null)continue;break}var x=H(c);x!==null&&(r.splice(a,3),a-=3,cf(x,{pending:!0,data:g,method:c.method,action:h},h,g))}}))}function Jl(r){function a(X){return iu(X,r)}Wr!==null&&iu(Wr,r),$r!==null&&iu($r,r),Kr!==null&&iu(Kr,r),Kl.forEach(a),Ql.forEach(a);for(var c=0;c<Qr.length;c++){var h=Qr[c];h.blockedOn===r&&(h.blockedOn=null)}for(;0<Qr.length&&(c=Qr[0],c.blockedOn===null);)Om(c),c.blockedOn===null&&Qr.shift();if(c=(r.ownerDocument||r).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var g=c[h],x=c[h+1],S=g[Je]||null;if(typeof x=="function")S||Nm(c);else if(S){var R=null;if(x&&x.hasAttribute("formAction")){if(g=x,S=x[Je]||null)R=S.formAction;else if(c0(g)!==null)continue}else R=S.action;typeof R=="function"?c[h+1]=R:(c.splice(h,3),h-=3),Nm(c)}}}function h0(r){this._internalRoot=r}ru.prototype.render=h0.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(i(409));var c=a.current,h=Qi();wm(c,h,r,a,null,null)},ru.prototype.unmount=h0.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;wm(r.current,2,null,r,null,null),Uc(),a[Dr]=null}};function ru(r){this._internalRoot=r}ru.prototype.unstable_scheduleHydration=function(r){if(r){var a=Qo();r={blockedOn:null,target:r,priority:a};for(var c=0;c<Qr.length&&a!==0&&a<Qr[c].priority;c++);Qr.splice(c,0,r),c===0&&Om(r)}};var Lm=t.version;if(Lm!=="19.1.1")throw Error(i(527,Lm,"19.1.1"));nt.findDOMNode=function(r){var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=f(a),r=r!==null?d(r):null,r=r===null?null:r.stateNode,r};var U2={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Y,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var su=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!su.isDisabled&&su.supportsFiber)try{nr=su.inject(U2),li=su}catch{}}return eo.createRoot=function(r,a){if(!s(r))throw Error(i(299));var c=!1,h="",g=$g,x=Kg,S=Qg,R=null;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onUncaughtError!==void 0&&(g=a.onUncaughtError),a.onCaughtError!==void 0&&(x=a.onCaughtError),a.onRecoverableError!==void 0&&(S=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(R=a.unstable_transitionCallbacks)),a=Sm(r,1,!1,null,null,c,h,g,x,S,R,null),r[Dr]=a.current,qf(r),new h0(a)},eo.hydrateRoot=function(r,a,c){if(!s(r))throw Error(i(299));var h=!1,g="",x=$g,S=Kg,R=Qg,X=null,it=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(x=c.onUncaughtError),c.onCaughtError!==void 0&&(S=c.onCaughtError),c.onRecoverableError!==void 0&&(R=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(X=c.unstable_transitionCallbacks),c.formState!==void 0&&(it=c.formState)),a=Sm(r,1,!0,a,c??null,h,g,x,S,R,X,it),a.context=Tm(null),c=a.current,h=Qi(),h=sl(h),g=Fr(h),g.callback=null,kr(c,g,h),c=h,a.current.lanes=c,ds(a,c),Yn(a),r[Dr]=a.current,qf(r),new ru(a)},eo.version="19.1.1",eo}var Xm;function K2(){if(Xm)return g0.exports;Xm=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),g0.exports=$2(),g0.exports}var Q2=K2(),_0={exports:{}},Ym;function Z2(){return Ym||(Ym=1,(function(n){var t=(function(e){var i=Object.prototype,s=i.hasOwnProperty,l=Object.defineProperty||function(st,M,q){st[M]=q.value},o,u=typeof Symbol=="function"?Symbol:{},f=u.iterator||"@@iterator",d=u.asyncIterator||"@@asyncIterator",p=u.toStringTag||"@@toStringTag";function m(st,M,q){return Object.defineProperty(st,M,{value:q,enumerable:!0,configurable:!0,writable:!0}),st[M]}try{m({},"")}catch{m=function(M,q,D){return M[q]=D}}function v(st,M,q,D){var k=M&&M.prototype instanceof w?M:w,U=Object.create(k.prototype),j=new Y(D||[]);return l(U,"_invoke",{value:ut(st,q,j)}),U}e.wrap=v;function _(st,M,q){try{return{type:"normal",arg:st.call(M,q)}}catch(D){return{type:"throw",arg:D}}}var A="suspendedStart",y="suspendedYield",E="executing",T="completed",b={};function w(){}function O(){}function F(){}var z={};m(z,f,function(){return this});var L=Object.getPrototypeOf,G=L&&L(L(nt([])));G&&G!==i&&s.call(G,f)&&(z=G);var V=F.prototype=w.prototype=Object.create(z);O.prototype=F,l(V,"constructor",{value:F,configurable:!0}),l(F,"constructor",{value:O,configurable:!0}),O.displayName=m(F,p,"GeneratorFunction");function Q(st){["next","throw","return"].forEach(function(M){m(st,M,function(q){return this._invoke(M,q)})})}e.isGeneratorFunction=function(st){var M=typeof st=="function"&&st.constructor;return M?M===O||(M.displayName||M.name)==="GeneratorFunction":!1},e.mark=function(st){return Object.setPrototypeOf?Object.setPrototypeOf(st,F):(st.__proto__=F,m(st,p,"GeneratorFunction")),st.prototype=Object.create(V),st},e.awrap=function(st){return{__await:st}};function K(st,M){function q(U,j,J,_t){var At=_(st[U],st,j);if(At.type==="throw")_t(At.arg);else{var vt=At.arg,gt=vt.value;return gt&&typeof gt=="object"&&s.call(gt,"__await")?M.resolve(gt.__await).then(function(Pt){q("next",Pt,J,_t)},function(Pt){q("throw",Pt,J,_t)}):M.resolve(gt).then(function(Pt){vt.value=Pt,J(vt)},function(Pt){return q("throw",Pt,J,_t)})}}var D;function k(U,j){function J(){return new M(function(_t,At){q(U,j,_t,At)})}return D=D?D.then(J,J):J()}l(this,"_invoke",{value:k})}Q(K.prototype),m(K.prototype,d,function(){return this}),e.AsyncIterator=K,e.async=function(st,M,q,D,k){k===void 0&&(k=Promise);var U=new K(v(st,M,q,D),k);return e.isGeneratorFunction(M)?U:U.next().then(function(j){return j.done?j.value:U.next()})};function ut(st,M,q){var D=A;return function(U,j){if(D===E)throw new Error("Generator is already running");if(D===T){if(U==="throw")throw j;return Tt()}for(q.method=U,q.arg=j;;){var J=q.delegate;if(J){var _t=ht(J,q);if(_t){if(_t===b)continue;return _t}}if(q.method==="next")q.sent=q._sent=q.arg;else if(q.method==="throw"){if(D===A)throw D=T,q.arg;q.dispatchException(q.arg)}else q.method==="return"&&q.abrupt("return",q.arg);D=E;var At=_(st,M,q);if(At.type==="normal"){if(D=q.done?T:y,At.arg===b)continue;return{value:At.arg,done:q.done}}else At.type==="throw"&&(D=T,q.method="throw",q.arg=At.arg)}}}function ht(st,M){var q=M.method,D=st.iterator[q];if(D===o)return M.delegate=null,q==="throw"&&st.iterator.return&&(M.method="return",M.arg=o,ht(st,M),M.method==="throw")||q!=="return"&&(M.method="throw",M.arg=new TypeError("The iterator does not provide a '"+q+"' method")),b;var k=_(D,st.iterator,M.arg);if(k.type==="throw")return M.method="throw",M.arg=k.arg,M.delegate=null,b;var U=k.arg;if(!U)return M.method="throw",M.arg=new TypeError("iterator result is not an object"),M.delegate=null,b;if(U.done)M[st.resultName]=U.value,M.next=st.nextLoc,M.method!=="return"&&(M.method="next",M.arg=o);else return U;return M.delegate=null,b}Q(V),m(V,p,"Generator"),m(V,f,function(){return this}),m(V,"toString",function(){return"[object Generator]"});function bt(st){var M={tryLoc:st[0]};1 in st&&(M.catchLoc=st[1]),2 in st&&(M.finallyLoc=st[2],M.afterLoc=st[3]),this.tryEntries.push(M)}function Et(st){var M=st.completion||{};M.type="normal",delete M.arg,st.completion=M}function Y(st){this.tryEntries=[{tryLoc:"root"}],st.forEach(bt,this),this.reset(!0)}e.keys=function(st){var M=Object(st),q=[];for(var D in M)q.push(D);return q.reverse(),function k(){for(;q.length;){var U=q.pop();if(U in M)return k.value=U,k.done=!1,k}return k.done=!0,k}};function nt(st){if(st){var M=st[f];if(M)return M.call(st);if(typeof st.next=="function")return st;if(!isNaN(st.length)){var q=-1,D=function k(){for(;++q<st.length;)if(s.call(st,q))return k.value=st[q],k.done=!1,k;return k.value=o,k.done=!0,k};return D.next=D}}return{next:Tt}}e.values=nt;function Tt(){return{value:o,done:!0}}return Y.prototype={constructor:Y,reset:function(st){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(Et),!st)for(var M in this)M.charAt(0)==="t"&&s.call(this,M)&&!isNaN(+M.slice(1))&&(this[M]=o)},stop:function(){this.done=!0;var st=this.tryEntries[0],M=st.completion;if(M.type==="throw")throw M.arg;return this.rval},dispatchException:function(st){if(this.done)throw st;var M=this;function q(_t,At){return U.type="throw",U.arg=st,M.next=_t,At&&(M.method="next",M.arg=o),!!At}for(var D=this.tryEntries.length-1;D>=0;--D){var k=this.tryEntries[D],U=k.completion;if(k.tryLoc==="root")return q("end");if(k.tryLoc<=this.prev){var j=s.call(k,"catchLoc"),J=s.call(k,"finallyLoc");if(j&&J){if(this.prev<k.catchLoc)return q(k.catchLoc,!0);if(this.prev<k.finallyLoc)return q(k.finallyLoc)}else if(j){if(this.prev<k.catchLoc)return q(k.catchLoc,!0)}else if(J){if(this.prev<k.finallyLoc)return q(k.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(st,M){for(var q=this.tryEntries.length-1;q>=0;--q){var D=this.tryEntries[q];if(D.tryLoc<=this.prev&&s.call(D,"finallyLoc")&&this.prev<D.finallyLoc){var k=D;break}}k&&(st==="break"||st==="continue")&&k.tryLoc<=M&&M<=k.finallyLoc&&(k=null);var U=k?k.completion:{};return U.type=st,U.arg=M,k?(this.method="next",this.next=k.finallyLoc,b):this.complete(U)},complete:function(st,M){if(st.type==="throw")throw st.arg;return st.type==="break"||st.type==="continue"?this.next=st.arg:st.type==="return"?(this.rval=this.arg=st.arg,this.method="return",this.next="end"):st.type==="normal"&&M&&(this.next=M),b},finish:function(st){for(var M=this.tryEntries.length-1;M>=0;--M){var q=this.tryEntries[M];if(q.finallyLoc===st)return this.complete(q.completion,q.afterLoc),Et(q),b}},catch:function(st){for(var M=this.tryEntries.length-1;M>=0;--M){var q=this.tryEntries[M];if(q.tryLoc===st){var D=q.completion;if(D.type==="throw"){var k=D.arg;Et(q)}return k}}throw new Error("illegal catch attempt")},delegateYield:function(st,M,q){return this.delegate={iterator:nt(st),resultName:M,nextLoc:q},this.method==="next"&&(this.arg=o),b}},e})(n.exports);try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}})(_0)),_0.exports}var y0,qm;function vd(){return qm||(qm=1,y0=(n,t)=>`${n}-${t}-${Math.random().toString(16).slice(3,8)}`),y0}var A0,Wm;function yx(){if(Wm)return A0;Wm=1;const n=vd();let t=0;return A0=({id:e,action:i,payload:s={}})=>{let l=e;return typeof l>"u"&&(l=n("Job",t),t+=1),{id:l,action:i,payload:s}},A0}var io={},$m;function xd(){if($m)return io;$m=1;let n=!1;return io.logging=n,io.setLogging=t=>{n=t},io.log=(...t)=>n?console.log.apply(this,t):null,io}var E0,Km;function J2(){if(Km)return E0;Km=1;const n=yx(),{log:t}=xd(),e=vd();let i=0;return E0=()=>{const s=e("Scheduler",i),l={},o={};let u=[];i+=1;const f=()=>u.length,d=()=>Object.keys(l).length,p=()=>{if(u.length!==0){const y=Object.keys(l);for(let E=0;E<y.length;E+=1)if(typeof o[y[E]]>"u"){u[0](l[y[E]]);break}}},m=(y,E)=>new Promise((T,b)=>{const w=n({action:y,payload:E});u.push(async O=>{u.shift(),o[O.id]=w;try{T(await O[y].apply(this,[...E,w.id]))}catch(F){b(F)}finally{delete o[O.id],p()}}),t(`[${s}]: Add ${w.id} to JobQueue`),t(`[${s}]: JobQueue length=${u.length}`),p()});return{addWorker:y=>(l[y.id]=y,t(`[${s}]: Add ${y.id}`),t(`[${s}]: Number of workers=${d()}`),p(),y.id),addJob:async(y,...E)=>{if(d()===0)throw Error(`[${s}]: You need to have at least one worker before adding jobs`);return m(y,E)},terminate:async()=>{Object.keys(l).forEach(async y=>{await l[y].terminate()}),u=[]},getQueueLen:f,getNumWorkers:d}},E0}function tE(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var S0,Qm;function eE(){return Qm||(Qm=1,S0=n=>{const t={};return typeof WorkerGlobalScope<"u"?t.type="webworker":typeof document=="object"?t.type="browser":typeof process=="object"&&typeof tE=="function"&&(t.type="node"),typeof n>"u"?t:t[n]}),S0}var T0,Zm;function iE(){if(Zm)return T0;Zm=1;const t=eE()("type")==="browser"?e=>new URL(e,window.location.href).href:e=>e;return T0=e=>{const i={...e};return["corePath","workerPath","langPath"].forEach(s=>{e[s]&&(i[s]=t(i[s]))}),i},T0}var w0,Jm;function Ax(){return Jm||(Jm=1,w0={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),w0}const nE="6.0.1",rE={version:nE};var b0,tv;function sE(){return tv||(tv=1,b0={workerBlobURL:!0,logger:()=>{}}),b0}var C0,ev;function aE(){if(ev)return C0;ev=1;const n=rE.version;return C0={...sE(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${n}/dist/worker.min.js`},C0}var R0,iv;function lE(){return iv||(iv=1,R0=({workerPath:n,workerBlobURL:t})=>{let e;if(Blob&&URL&&t){const i=new Blob([`importScripts("${n}");`],{type:"application/javascript"});e=new Worker(URL.createObjectURL(i))}else e=new Worker(n);return e}),R0}var D0,nv;function oE(){return nv||(nv=1,D0=n=>{n.terminate()}),D0}var O0,rv;function cE(){return rv||(rv=1,O0=(n,t)=>{n.onmessage=({data:e})=>{t(e)}}),O0}var M0,sv;function uE(){return sv||(sv=1,M0=async(n,t)=>{n.postMessage(t)}),M0}var N0,av;function hE(){if(av)return N0;av=1;const n=e=>new Promise((i,s)=>{const l=new FileReader;l.onload=()=>{i(l.result)},l.onerror=({target:{error:{code:o}}})=>{s(Error(`File could not be read! Code=${o}`))},l.readAsArrayBuffer(e)}),t=async e=>{let i=e;if(typeof e>"u")return"undefined";if(typeof e=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(e)?i=atob(e.split(",")[1]).split("").map(s=>s.charCodeAt(0)):i=await(await fetch(e)).arrayBuffer();else if(typeof HTMLElement<"u"&&e instanceof HTMLElement)e.tagName==="IMG"&&(i=await t(e.src)),e.tagName==="VIDEO"&&(i=await t(e.poster)),e.tagName==="CANVAS"&&await new Promise(s=>{e.toBlob(async l=>{i=await n(l),s()})});else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas){const s=await e.convertToBlob();i=await n(s)}else(e instanceof File||e instanceof Blob)&&(i=await n(e));return new Uint8Array(i)};return N0=t,N0}var L0,lv;function fE(){if(lv)return L0;lv=1;const n=aE(),t=lE(),e=oE(),i=cE(),s=uE(),l=hE();return L0={defaultOptions:n,spawnWorker:t,terminateWorker:e,onMessage:i,send:s,loadImage:l},L0}var F0,ov;function Ex(){if(ov)return F0;ov=1;const n=iE(),t=yx(),{log:e}=xd(),i=vd(),s=Ax(),{defaultOptions:l,spawnWorker:o,terminateWorker:u,onMessage:f,loadImage:d,send:p}=fE();let m=0;return F0=async(v="eng",_=s.LSTM_ONLY,A={},y={})=>{const E=i("Worker",m),{logger:T,errorHandler:b,...w}=n({...l,...A}),O={},F=typeof v=="string"?v.split("+"):v;let z=_,L=y;const G=[s.DEFAULT,s.LSTM_ONLY].includes(_)&&!w.legacyCore;let V,Q;const K=new Promise((vt,gt)=>{Q=vt,V=gt}),ut=vt=>{V(vt.message)};let ht=o(w);ht.onerror=ut,m+=1;const bt=({id:vt,action:gt,payload:Pt})=>new Promise((It,ee)=>{e(`[${E}]: Start ${vt}, action=${gt}`);const jt=`${gt}-${vt}`;O[jt]={resolve:It,reject:ee},p(ht,{workerId:E,jobId:vt,action:gt,payload:Pt})}),Et=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),Y=vt=>bt(t({id:vt,action:"load",payload:{options:{lstmOnly:G,corePath:w.corePath,logging:w.logging}}})),nt=(vt,gt,Pt)=>bt(t({id:Pt,action:"FS",payload:{method:"writeFile",args:[vt,gt]}})),Tt=(vt,gt)=>bt(t({id:gt,action:"FS",payload:{method:"readFile",args:[vt,{encoding:"utf8"}]}})),st=(vt,gt)=>bt(t({id:gt,action:"FS",payload:{method:"unlink",args:[vt]}})),M=(vt,gt,Pt)=>bt(t({id:Pt,action:"FS",payload:{method:vt,args:gt}})),q=(vt,gt)=>bt(t({id:gt,action:"loadLanguage",payload:{langs:vt,options:{langPath:w.langPath,dataPath:w.dataPath,cachePath:w.cachePath,cacheMethod:w.cacheMethod,gzip:w.gzip,lstmOnly:[s.DEFAULT,s.LSTM_ONLY].includes(z)&&!w.legacyLang}}})),D=(vt,gt,Pt,It)=>bt(t({id:It,action:"initialize",payload:{langs:vt,oem:gt,config:Pt}})),k=(vt="eng",gt,Pt,It)=>{if(G&&[s.TESSERACT_ONLY,s.TESSERACT_LSTM_COMBINED].includes(gt))throw Error("Legacy model requested but code missing.");const ee=gt||z;z=ee;const jt=Pt||L;L=jt;const pe=(typeof vt=="string"?vt.split("+"):vt).filter(Ot=>!F.includes(Ot));return F.push(...pe),pe.length>0?q(pe,It).then(()=>D(vt,ee,jt,It)):D(vt,ee,jt,It)},U=(vt={},gt)=>bt(t({id:gt,action:"setParameters",payload:{params:vt}})),j=async(vt,gt={},Pt={text:!0},It)=>bt(t({id:It,action:"recognize",payload:{image:await d(vt),options:gt,output:Pt}})),J=async(vt,gt)=>{if(G)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return bt(t({id:gt,action:"detect",payload:{image:await d(vt)}}))},_t=async()=>(ht!==null&&(u(ht),ht=null),Promise.resolve());f(ht,({workerId:vt,jobId:gt,status:Pt,action:It,data:ee})=>{const jt=`${It}-${gt}`;if(Pt==="resolve")e(`[${vt}]: Complete ${gt}`),O[jt].resolve({jobId:gt,data:ee}),delete O[jt];else if(Pt==="reject")if(O[jt].reject(ee),delete O[jt],It==="load"&&V(ee),b)b(ee);else throw Error(ee);else Pt==="progress"&&T({...ee,userJobId:gt})});const At={id:E,worker:ht,load:Et,writeText:nt,readText:Tt,removeFile:st,FS:M,reinitialize:k,setParameters:U,recognize:j,detect:J,terminate:_t};return Y().then(()=>q(v)).then(()=>D(v,_,y)).then(()=>Q(At)).catch(()=>{}),K},F0}var k0,cv;function dE(){if(cv)return k0;cv=1;const n=Ex();return k0={recognize:async(i,s,l)=>{const o=await n(s,1,l);return o.recognize(i).finally(async()=>{await o.terminate()})},detect:async(i,s)=>{const l=await n("osd",0,s);return l.detect(i).finally(async()=>{await l.terminate()})}},k0}var P0,uv;function pE(){return uv||(uv=1,P0={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),P0}var B0,hv;function gE(){return hv||(hv=1,B0={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),B0}var I0,fv;function mE(){if(fv)return I0;fv=1,Z2();const n=J2(),t=Ex(),e=dE(),i=pE(),s=Ax(),l=gE(),{setLogging:o}=xd();return I0={languages:i,OEM:s,PSM:l,createScheduler:n,createWorker:t,setLogging:o,...e},I0}var vE=mE();const xE=z2(vE);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var wu={};wu.version="0.18.5";var Sx=1252,_E=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Tx=function(n){_E.indexOf(n)!=-1&&(Sx=n)};function yE(){Tx(1252)}var Ao=function(n){Tx(n)};function AE(){Ao(1200),yE()}var au=function(t){return String.fromCharCode(t)},dv=function(t){return String.fromCharCode(t)},bu,is="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Eo(n){for(var t="",e=0,i=0,s=0,l=0,o=0,u=0,f=0,d=0;d<n.length;)e=n.charCodeAt(d++),l=e>>2,i=n.charCodeAt(d++),o=(e&3)<<4|i>>4,s=n.charCodeAt(d++),u=(i&15)<<2|s>>6,f=s&63,isNaN(i)?u=f=64:isNaN(s)&&(f=64),t+=is.charAt(l)+is.charAt(o)+is.charAt(u)+is.charAt(f);return t}function br(n){var t="",e=0,i=0,s=0,l=0,o=0,u=0,f=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<n.length;)l=is.indexOf(n.charAt(d++)),o=is.indexOf(n.charAt(d++)),e=l<<2|o>>4,t+=String.fromCharCode(e),u=is.indexOf(n.charAt(d++)),i=(o&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(i)),f=is.indexOf(n.charAt(d++)),s=(u&3)<<6|f,f!==64&&(t+=String.fromCharCode(s));return t}var le=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Rr=(function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(t,e){return e?new Buffer(t,e):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Bs(n){return le?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function pv(n){return le?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var Pn=function(t){return le?Rr(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)&255})};function ju(n){if(typeof ArrayBuffer>"u")return Pn(n);for(var t=new ArrayBuffer(n.length),e=new Uint8Array(t),i=0;i!=n.length;++i)e[i]=n.charCodeAt(i)&255;return t}function No(n){if(Array.isArray(n))return n.map(function(i){return String.fromCharCode(i)}).join("");for(var t=[],e=0;e<n.length;++e)t[e]=String.fromCharCode(n[e]);return t.join("")}function EE(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var mi=le?function(n){return Buffer.concat(n.map(function(t){return Buffer.isBuffer(t)?t:Rr(t)}))}:function(n){if(typeof Uint8Array<"u"){var t=0,e=0;for(t=0;t<n.length;++t)e+=n[t].length;var i=new Uint8Array(e),s=0;for(t=0,e=0;t<n.length;e+=s,++t)if(s=n[t].length,n[t]instanceof Uint8Array)i.set(n[t],e);else{if(typeof n[t]=="string")throw"wtf";i.set(new Uint8Array(n[t]),e)}return i}return[].concat.apply([],n.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function SE(n){for(var t=[],e=0,i=n.length+250,s=Bs(n.length+255),l=0;l<n.length;++l){var o=n.charCodeAt(l);if(o<128)s[e++]=o;else if(o<2048)s[e++]=192|o>>6&31,s[e++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=n.charCodeAt(++l)&1023;s[e++]=240|o>>8&7,s[e++]=128|o>>2&63,s[e++]=128|u>>6&15|(o&3)<<4,s[e++]=128|u&63}else s[e++]=224|o>>12&15,s[e++]=128|o>>6&63,s[e++]=128|o&63;e>i&&(t.push(s.slice(0,e)),e=0,s=Bs(65535),i=65530)}return t.push(s.slice(0,e)),mi(t)}var po=/\u0000/g,lu=/[\u0001-\u0006]/g;function Va(n){for(var t="",e=n.length-1;e>=0;)t+=n.charAt(e--);return t}function Bn(n,t){var e=""+n;return e.length>=t?e:Fe("0",t-e.length)+e}function _d(n,t){var e=""+n;return e.length>=t?e:Fe(" ",t-e.length)+e}function Cu(n,t){var e=""+n;return e.length>=t?e:e+Fe(" ",t-e.length)}function TE(n,t){var e=""+Math.round(n);return e.length>=t?e:Fe("0",t-e.length)+e}function wE(n,t){var e=""+n;return e.length>=t?e:Fe("0",t-e.length)+e}var gv=Math.pow(2,32);function Na(n,t){if(n>gv||n<-gv)return TE(n,t);var e=Math.round(n);return wE(e,t)}function Ru(n,t){return t=t||0,n.length>=7+t&&(n.charCodeAt(t)|32)===103&&(n.charCodeAt(t+1)|32)===101&&(n.charCodeAt(t+2)|32)===110&&(n.charCodeAt(t+3)|32)===101&&(n.charCodeAt(t+4)|32)===114&&(n.charCodeAt(t+5)|32)===97&&(n.charCodeAt(t+6)|32)===108}var mv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],U0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function bE(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',n}var ke={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},vv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},CE={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Du(n,t,e){for(var i=n<0?-1:1,s=n*i,l=0,o=1,u=0,f=1,d=0,p=0,m=Math.floor(s);d<t&&(m=Math.floor(s),u=m*o+l,p=m*d+f,!(s-m<5e-8));)s=1/(s-m),l=o,o=u,f=d,d=p;if(p>t&&(d>t?(p=f,u=l):(p=d,u=o)),!e)return[0,i*u,p];var v=Math.floor(i*u/p);return[v,i*u-v*p,p]}function ou(n,t,e){if(n>2958465||n<0)return null;var i=n|0,s=Math.floor(86400*(n-i)),l=0,o=[],u={D:i,T:s,u:86400*(n-i)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(i+=1462),u.u>.9999&&(u.u=0,++s==86400&&(u.T=s=0,++i,++u.D)),i===60)o=e?[1317,10,29]:[1900,2,29],l=3;else if(i===0)o=e?[1317,8,29]:[1900,1,0],l=6;else{i>60&&--i;var f=new Date(1900,0,1);f.setDate(f.getDate()+i-1),o=[f.getFullYear(),f.getMonth()+1,f.getDate()],l=f.getDay(),i<60&&(l=(l+6)%7),e&&(l=FE(f,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=s%60,s=Math.floor(s/60),u.M=s%60,s=Math.floor(s/60),u.H=s,u.q=l,u}var wx=new Date(1899,11,31,0,0,0),RE=wx.getTime(),DE=new Date(1900,2,1,0,0,0);function bx(n,t){var e=n.getTime();return t?e-=1461*24*60*60*1e3:n>=DE&&(e+=1440*60*1e3),(e-(RE+(n.getTimezoneOffset()-wx.getTimezoneOffset())*6e4))/(1440*60*1e3)}function yd(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function OE(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function ME(n){var t=n<0?12:11,e=yd(n.toFixed(12));return e.length<=t||(e=n.toPrecision(10),e.length<=t)?e:n.toExponential(5)}function NE(n){var t=yd(n.toFixed(11));return t.length>(n<0?12:11)||t==="0"||t==="-0"?n.toPrecision(6):t}function LE(n){var t=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),e;return t>=-4&&t<=-1?e=n.toPrecision(10+t):Math.abs(t)<=9?e=ME(n):t===10?e=n.toFixed(10).substr(0,12):e=NE(n),yd(OE(e.toUpperCase()))}function ed(n,t){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):LE(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return rs(14,bx(n,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+n)}function FE(n,t){t[0]-=581;var e=n.getDay();return n<60&&(e=(e+6)%7),e}function kE(n,t,e,i){var s="",l=0,o=0,u=e.y,f,d=0;switch(n){case 98:u=e.y+543;case 121:switch(t.length){case 1:case 2:f=u%100,d=2;break;default:f=u%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:f=e.m,d=t.length;break;case 3:return U0[e.m-1][1];case 5:return U0[e.m-1][0];default:return U0[e.m-1][2]}break;case 100:switch(t.length){case 1:case 2:f=e.d,d=t.length;break;case 3:return mv[e.q][0];default:return mv[e.q][1]}break;case 104:switch(t.length){case 1:case 2:f=1+(e.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:f=e.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:f=e.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return e.u===0&&(t=="s"||t=="ss")?Bn(e.S,t.length):(i>=2?o=i===3?1e3:100:o=i===1?10:1,l=Math.round(o*(e.S+e.u)),l>=60*o&&(l=0),t==="s"?l===0?"0":""+l/o:(s=Bn(l,2+i),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":f=e.D*24+e.H;break;case"[m]":case"[mm]":f=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":f=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:f=u,d=1;break}var p=d>0?Bn(f,d):"";return p}function ns(n){var t=3;if(n.length<=t)return n;for(var e=n.length%t,i=n.substr(0,e);e!=n.length;e+=t)i+=(i.length>0?",":"")+n.substr(e,t);return i}var Cx=/%/g;function PE(n,t,e){var i=t.replace(Cx,""),s=t.length-i.length;return Sr(n,i,e*Math.pow(10,2*s))+Fe("%",s)}function BE(n,t,e){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return Sr(n,t.substr(0,i),e/Math.pow(10,3*(t.length-i)))}function Rx(n,t){var e,i=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Rx(n,-t);var s=n.indexOf(".");s===-1&&(s=n.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),e=(t/Math.pow(10,l)).toPrecision(i+1+(s+l)%s),e.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(o-e.length+l):e+="E+"+(o-l);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,s)+"."+e.substr(2+s),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,d,p){return f+d+p.substr(0,(s+l)%s)+"."+p.substr(l)+"E"})}else e=t.toExponential(i);return n.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),n.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var Dx=/# (\?+)( ?)\/( ?)(\d+)/;function IE(n,t,e){var i=parseInt(n[4],10),s=Math.round(t*i),l=Math.floor(s/i),o=s-l*i,u=i;return e+(l===0?"":""+l)+" "+(o===0?Fe(" ",n[1].length+1+n[4].length):_d(o,n[1].length)+n[2]+"/"+n[3]+Bn(u,n[4].length))}function UE(n,t,e){return e+(t===0?"":""+t)+Fe(" ",n[1].length+2+n[4].length)}var Ox=/^#*0*\.([0#]+)/,Mx=/\).*[0#]/,Nx=/\(###\) ###\\?-####/;function Mi(n){for(var t="",e,i=0;i!=n.length;++i)switch(e=n.charCodeAt(i)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(e)}return t}function xv(n,t){var e=Math.pow(10,t);return""+Math.round(n*e)/e}function _v(n,t){var e=n-Math.floor(n),i=Math.pow(10,t);return t<(""+Math.round(e*i)).length?0:Math.round(e*i)}function HE(n,t){return t<(""+Math.round((n-Math.floor(n))*Math.pow(10,t))).length?1:0}function zE(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function En(n,t,e){if(n.charCodeAt(0)===40&&!t.match(Mx)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?En("n",i,e):"("+En("n",i,-e)+")"}if(t.charCodeAt(t.length-1)===44)return BE(n,t,e);if(t.indexOf("%")!==-1)return PE(n,t,e);if(t.indexOf("E")!==-1)return Rx(t,e);if(t.charCodeAt(0)===36)return"$"+En(n,t.substr(t.charAt(1)==" "?2:1),e);var s,l,o,u,f=Math.abs(e),d=e<0?"-":"";if(t.match(/^00+$/))return d+Na(f,t.length);if(t.match(/^[#?]+$/))return s=Na(e,0),s==="0"&&(s=""),s.length>t.length?s:Mi(t.substr(0,t.length-s.length))+s;if(l=t.match(Dx))return IE(l,f,d);if(t.match(/^#+0+$/))return d+Na(f,t.length-t.indexOf("0"));if(l=t.match(Ox))return s=xv(e,l[1].length).replace(/^([^\.]+)$/,"$1."+Mi(l[1])).replace(/\.$/,"."+Mi(l[1])).replace(/\.(\d*)$/,function(A,y){return"."+y+Fe("0",Mi(l[1]).length-y.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return d+xv(f,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return d+ns(Na(f,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+En(n,t,-e):ns(""+(Math.floor(e)+HE(e,l[1].length)))+"."+Bn(_v(e,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return En(n,t.replace(/^#,#*,/,""),e);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Va(En(n,t.replace(/[\\-]/g,""),e)),o=0,Va(Va(t.replace(/\\/g,"")).replace(/[0#]/g,function(A){return o<s.length?s.charAt(o++):A==="0"?"0":""}));if(t.match(Nx))return s=En(n,"##########",e),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),u=Du(f,Math.pow(10,o)-1,!1),s=""+d,p=Sr("n",l[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+l[2]+"/"+l[3],p=Cu(u[2],o),p.length<l[4].length&&(p=Mi(l[4].substr(l[4].length-p.length))+p),s+=p,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),u=Du(f,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?_d(u[1],o)+l[2]+"/"+l[3]+Cu(u[2],o):Fe(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=Na(e,0),t.length<=s.length?s:Mi(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+e.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var m=t.indexOf(".")-o,v=t.length-s.length-m;return Mi(t.substr(0,m)+s+t.substr(t.length-v))}if(l=t.match(/^00,000\.([#0]*0)$/))return o=_v(e,l[1].length),e<0?"-"+En(n,t,-e):ns(zE(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(A){return"00,"+(A.length<3?Bn(0,3-A.length):"")+A})+"."+Bn(o,l[1].length);switch(t){case"###,##0.00":return En(n,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var _=ns(Na(f,0));return _!=="0"?d+_:"";case"###,###.00":return En(n,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return En(n,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function GE(n,t,e){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return Sr(n,t.substr(0,i),e/Math.pow(10,3*(t.length-i)))}function VE(n,t,e){var i=t.replace(Cx,""),s=t.length-i.length;return Sr(n,i,e*Math.pow(10,2*s))+Fe("%",s)}function Lx(n,t){var e,i=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Lx(n,-t);var s=n.indexOf(".");s===-1&&(s=n.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),e=(t/Math.pow(10,l)).toPrecision(i+1+(s+l)%s),!e.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(o-e.length+l):e+="E+"+(o-l),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,d,p){return f+d+p.substr(0,(s+l)%s)+"."+p.substr(l)+"E"})}else e=t.toExponential(i);return n.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),n.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Qn(n,t,e){if(n.charCodeAt(0)===40&&!t.match(Mx)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Qn("n",i,e):"("+Qn("n",i,-e)+")"}if(t.charCodeAt(t.length-1)===44)return GE(n,t,e);if(t.indexOf("%")!==-1)return VE(n,t,e);if(t.indexOf("E")!==-1)return Lx(t,e);if(t.charCodeAt(0)===36)return"$"+Qn(n,t.substr(t.charAt(1)==" "?2:1),e);var s,l,o,u,f=Math.abs(e),d=e<0?"-":"";if(t.match(/^00+$/))return d+Bn(f,t.length);if(t.match(/^[#?]+$/))return s=""+e,e===0&&(s=""),s.length>t.length?s:Mi(t.substr(0,t.length-s.length))+s;if(l=t.match(Dx))return UE(l,f,d);if(t.match(/^#+0+$/))return d+Bn(f,t.length-t.indexOf("0"));if(l=t.match(Ox))return s=(""+e).replace(/^([^\.]+)$/,"$1."+Mi(l[1])).replace(/\.$/,"."+Mi(l[1])),s=s.replace(/\.(\d*)$/,function(A,y){return"."+y+Fe("0",Mi(l[1]).length-y.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return d+ns(""+f);if(l=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Qn(n,t,-e):ns(""+e)+"."+Fe("0",l[1].length);if(l=t.match(/^#,#*,#0/))return Qn(n,t.replace(/^#,#*,/,""),e);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Va(Qn(n,t.replace(/[\\-]/g,""),e)),o=0,Va(Va(t.replace(/\\/g,"")).replace(/[0#]/g,function(A){return o<s.length?s.charAt(o++):A==="0"?"0":""}));if(t.match(Nx))return s=Qn(n,"##########",e),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),u=Du(f,Math.pow(10,o)-1,!1),s=""+d,p=Sr("n",l[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+l[2]+"/"+l[3],p=Cu(u[2],o),p.length<l[4].length&&(p=Mi(l[4].substr(l[4].length-p.length))+p),s+=p,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),u=Du(f,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?_d(u[1],o)+l[2]+"/"+l[3]+Cu(u[2],o):Fe(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=""+e,t.length<=s.length?s:Mi(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0]+)\.([#0]+)$/)){s=""+e.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var m=t.indexOf(".")-o,v=t.length-s.length-m;return Mi(t.substr(0,m)+s+t.substr(t.length-v))}if(l=t.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Qn(n,t,-e):ns(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(A){return"00,"+(A.length<3?Bn(0,3-A.length):"")+A})+"."+Bn(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var _=ns(""+f);return _!=="0"?d+_:"";default:if(t.match(/\.[0#?]*$/))return Qn(n,t.slice(0,t.lastIndexOf(".")),e)+Mi(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Sr(n,t,e){return(e|0)===e?Qn(n,t,e):En(n,t,e)}function jE(n){for(var t=[],e=!1,i=0,s=0;i<n.length;++i)switch(n.charCodeAt(i)){case 34:e=!e;break;case 95:case 42:case 92:++i;break;case 59:t[t.length]=n.substr(s,i-s),s=i+1}if(t[t.length]=n.substr(s),e===!0)throw new Error("Format |"+n+"| unterminated string ");return t}var Fx=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function kx(n){for(var t=0,e="",i="";t<n.length;)switch(e=n.charAt(t)){case"G":Ru(n,t)&&(t+=6),t++;break;case'"':for(;n.charCodeAt(++t)!==34&&t<n.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(n.charAt(t+1)==="1"||n.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(n.substr(t,3).toUpperCase()==="A/P"||n.substr(t,5).toUpperCase()==="AM/PM"||n.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(i=e;n.charAt(t++)!=="]"&&t<n.length;)i+=n.charAt(t);if(i.match(Fx))return!0;break;case".":case"0":case"#":for(;t<n.length&&("0#?.,E+-%".indexOf(e=n.charAt(++t))>-1||e=="\\"&&n.charAt(t+1)=="-"&&"0#".indexOf(n.charAt(t+2))>-1););break;case"?":for(;n.charAt(++t)===e;);break;case"*":++t,(n.charAt(t)==" "||n.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<n.length&&"0123456789".indexOf(n.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function XE(n,t,e,i){for(var s=[],l="",o=0,u="",f="t",d,p,m,v="H";o<n.length;)switch(u=n.charAt(o)){case"G":if(!Ru(n,o))throw new Error("unrecognized character "+u+" in "+n);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(l="";(m=n.charCodeAt(++o))!==34&&o<n.length;)l+=String.fromCharCode(m);s[s.length]={t:"t",v:l},++o;break;case"\\":var _=n.charAt(++o),A=_==="("||_===")"?_:"t";s[s.length]={t:A,v:_},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(n.charAt(o+1)==="1"||n.charAt(o+1)==="2"){if(d==null&&(d=ou(t,e,n.charAt(o+1)==="2"),d==null))return"";s[s.length]={t:"X",v:n.substr(o,2)},f=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=ou(t,e),d==null))return"";for(l=u;++o<n.length&&n.charAt(o).toLowerCase()===u;)l+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=v),s[s.length]={t:u,v:l},f=u;break;case"A":case"a":case"上":var y={t:u,v:u};if(d==null&&(d=ou(t,e)),n.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(y.v=d.H>=12?"P":"A"),y.t="T",v="h",o+=3):n.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(y.v=d.H>=12?"PM":"AM"),y.t="T",o+=5,v="h"):n.substr(o,5).toUpperCase()==="上午/下午"?(d!=null&&(y.v=d.H>=12?"下午":"上午"),y.t="T",o+=5,v="h"):(y.t="t",++o),d==null&&y.t==="T")return"";s[s.length]=y,f=u;break;case"[":for(l=u;n.charAt(o++)!=="]"&&o<n.length;)l+=n.charAt(o);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(Fx)){if(d==null&&(d=ou(t,e),d==null))return"";s[s.length]={t:"Z",v:l.toLowerCase()},f=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",kx(n)||(s[s.length]={t:"t",v:l}));break;case".":if(d!=null){for(l=u;++o<n.length&&(u=n.charAt(o))==="0";)l+=u;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++o<n.length&&"0#?.,E+-%".indexOf(u=n.charAt(o))>-1;)l+=u;s[s.length]={t:"n",v:l};break;case"?":for(l=u;n.charAt(++o)===u;)l+=u;s[s.length]={t:u,v:l},f=u;break;case"*":++o,(n.charAt(o)==" "||n.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:i===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;o<n.length&&"0123456789".indexOf(n.charAt(++o))>-1;)l+=n.charAt(o);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:u,v:u},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+n);s[s.length]={t:"t",v:u},++o;break}var E=0,T=0,b;for(o=s.length-1,f="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=v,f="h",E<1&&(E=1);break;case"s":(b=s[o].v.match(/\.0+$/))&&(T=Math.max(T,b[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":f=s[o].t;break;case"m":f==="s"&&(s[o].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&s[o].v.match(/[Hh]/)&&(E=1),E<2&&s[o].v.match(/[Mm]/)&&(E=2),E<3&&s[o].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var w="",O;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=kE(s[o].t.charCodeAt(0),s[o].v,d,T),s[o].t="t";break;case"n":case"?":for(O=o+1;s[O]!=null&&((u=s[O].t)==="?"||u==="D"||(u===" "||u==="t")&&s[O+1]!=null&&(s[O+1].t==="?"||s[O+1].t==="t"&&s[O+1].v==="/")||s[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(s[O].v==="/"||s[O].v===" "&&s[O+1]!=null&&s[O+1].t=="?"));)s[o].v+=s[O].v,s[O]={v:"",t:";"},++O;w+=s[o].v,o=O-1;break;case"G":s[o].t="t",s[o].v=ed(t,e);break}var F="",z,L;if(w.length>0){w.charCodeAt(0)==40?(z=t<0&&w.charCodeAt(0)===45?-t:t,L=Sr("n",w,z)):(z=t<0&&i>1?-t:t,L=Sr("n",w,z),z<0&&s[0]&&s[0].t=="t"&&(L=L.substr(1),s[0].v="-"+s[0].v)),O=L.length-1;var G=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){G=o;break}var V=s.length;if(G===s.length&&L.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(O>=s[o].v.length-1?(O-=s[o].v.length,s[o].v=L.substr(O+1,s[o].v.length)):O<0?s[o].v="":(s[o].v=L.substr(0,O+1),O=-1),s[o].t="t",V=o);O>=0&&V<s.length&&(s[V].v=L.substr(0,O+1)+s[V].v)}else if(G!==s.length&&L.indexOf("E")===-1){for(O=L.indexOf(".")-1,o=G;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(p=s[o].v.indexOf(".")>-1&&o===G?s[o].v.indexOf(".")-1:s[o].v.length-1,F=s[o].v.substr(p+1);p>=0;--p)O>=0&&(s[o].v.charAt(p)==="0"||s[o].v.charAt(p)==="#")&&(F=L.charAt(O--)+F);s[o].v=F,s[o].t="t",V=o}for(O>=0&&V<s.length&&(s[V].v=L.substr(0,O+1)+s[V].v),O=L.indexOf(".")+1,o=G;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==G)){for(p=s[o].v.indexOf(".")>-1&&o===G?s[o].v.indexOf(".")+1:0,F=s[o].v.substr(0,p);p<s[o].v.length;++p)O<L.length&&(F+=L.charAt(O++));s[o].v=F,s[o].t="t",V=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(z=i>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=Sr(s[o].t,s[o].v,z),s[o].t="t");var Q="";for(o=0;o!==s.length;++o)s[o]!=null&&(Q+=s[o].v);return Q}var yv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Av(n,t){if(t==null)return!1;var e=parseFloat(t[2]);switch(t[1]){case"=":if(n==e)return!0;break;case">":if(n>e)return!0;break;case"<":if(n<e)return!0;break;case"<>":if(n!=e)return!0;break;case">=":if(n>=e)return!0;break;case"<=":if(n<=e)return!0;break}return!1}function YE(n,t){var e=jE(n),i=e.length,s=e[i-1].indexOf("@");if(i<4&&s>-1&&--i,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof t!="number")return[4,e.length===4||s>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=s>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=s>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=s>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var l=t>0?e[0]:t<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[i,l];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var o=e[0].match(yv),u=e[1].match(yv);return Av(t,o)?[i,e[0]]:Av(t,u)?[i,e[1]]:[i,e[o!=null&&u!=null?2:1]]}return[i,l]}function rs(n,t,e){e==null&&(e={});var i="";switch(typeof n){case"string":n=="m/d/yy"&&e.dateNF?i=e.dateNF:i=n;break;case"number":n==14&&e.dateNF?i=e.dateNF:i=(e.table!=null?e.table:ke)[n],i==null&&(i=e.table&&e.table[vv[n]]||ke[vv[n]]),i==null&&(i=CE[n]||"General");break}if(Ru(i,0))return ed(t,e);t instanceof Date&&(t=bx(t,e.date1904));var s=YE(i,t);if(Ru(s[1]))return ed(t,e);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return XE(s[1],t,e,s[0])}function Px(n,t){if(typeof t!="number"){t=+t||-1;for(var e=0;e<392;++e){if(ke[e]==null){t<0&&(t=e);continue}if(ke[e]==n){t=e;break}}t<0&&(t=391)}return ke[t]=n,t}function Xu(n){for(var t=0;t!=392;++t)n[t]!==void 0&&Px(n[t],t)}function Yu(){ke=bE()}var Bx=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function qE(n){var t=typeof n=="number"?ke[n]:n;return t=t.replace(Bx,"(\\d+)"),new RegExp("^"+t+"$")}function WE(n,t,e){var i=-1,s=-1,l=-1,o=-1,u=-1,f=-1;(t.match(Bx)||[]).forEach(function(m,v){var _=parseInt(e[v+1],10);switch(m.toLowerCase().charAt(0)){case"y":i=_;break;case"d":l=_;break;case"h":o=_;break;case"s":f=_;break;case"m":o>=0?u=_:s=_;break}}),f>=0&&u==-1&&s>=0&&(u=s,s=-1);var d=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var p=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return o==-1&&u==-1&&f==-1?d:i==-1&&s==-1&&l==-1?p:d+"T"+p}var $E=(function(){var n={};n.version="1.2.0";function t(){for(var L=0,G=new Array(256),V=0;V!=256;++V)L=V,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,G[V]=L;return typeof Int32Array<"u"?new Int32Array(G):G}var e=t();function i(L){var G=0,V=0,Q=0,K=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Q=0;Q!=256;++Q)K[Q]=L[Q];for(Q=0;Q!=256;++Q)for(V=L[Q],G=256+Q;G<4096;G+=256)V=K[G]=V>>>8^L[V&255];var ut=[];for(Q=1;Q!=16;++Q)ut[Q-1]=typeof Int32Array<"u"?K.subarray(Q*256,Q*256+256):K.slice(Q*256,Q*256+256);return ut}var s=i(e),l=s[0],o=s[1],u=s[2],f=s[3],d=s[4],p=s[5],m=s[6],v=s[7],_=s[8],A=s[9],y=s[10],E=s[11],T=s[12],b=s[13],w=s[14];function O(L,G){for(var V=G^-1,Q=0,K=L.length;Q<K;)V=V>>>8^e[(V^L.charCodeAt(Q++))&255];return~V}function F(L,G){for(var V=G^-1,Q=L.length-15,K=0;K<Q;)V=w[L[K++]^V&255]^b[L[K++]^V>>8&255]^T[L[K++]^V>>16&255]^E[L[K++]^V>>>24]^y[L[K++]]^A[L[K++]]^_[L[K++]]^v[L[K++]]^m[L[K++]]^p[L[K++]]^d[L[K++]]^f[L[K++]]^u[L[K++]]^o[L[K++]]^l[L[K++]]^e[L[K++]];for(Q+=15;K<Q;)V=V>>>8^e[(V^L[K++])&255];return~V}function z(L,G){for(var V=G^-1,Q=0,K=L.length,ut=0,ht=0;Q<K;)ut=L.charCodeAt(Q++),ut<128?V=V>>>8^e[(V^ut)&255]:ut<2048?(V=V>>>8^e[(V^(192|ut>>6&31))&255],V=V>>>8^e[(V^(128|ut&63))&255]):ut>=55296&&ut<57344?(ut=(ut&1023)+64,ht=L.charCodeAt(Q++)&1023,V=V>>>8^e[(V^(240|ut>>8&7))&255],V=V>>>8^e[(V^(128|ut>>2&63))&255],V=V>>>8^e[(V^(128|ht>>6&15|(ut&3)<<4))&255],V=V>>>8^e[(V^(128|ht&63))&255]):(V=V>>>8^e[(V^(224|ut>>12&15))&255],V=V>>>8^e[(V^(128|ut>>6&63))&255],V=V>>>8^e[(V^(128|ut&63))&255]);return~V}return n.table=e,n.bstr=O,n.buf=F,n.str=z,n})(),ye=(function(){var t={};t.version="1.2.1";function e(C,I){for(var N=C.split("/"),P=I.split("/"),B=0,H=0,rt=Math.min(N.length,P.length);B<rt;++B){if(H=N[B].length-P[B].length)return H;if(N[B]!=P[B])return N[B]<P[B]?-1:1}return N.length-P.length}function i(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:i(C.slice(0,-1));var I=C.lastIndexOf("/");return I===-1?C:C.slice(0,I+1)}function s(C){if(C.charAt(C.length-1)=="/")return s(C.slice(0,-1));var I=C.lastIndexOf("/");return I===-1?C:C.slice(I+1)}function l(C,I){typeof I=="string"&&(I=new Date(I));var N=I.getHours();N=N<<6|I.getMinutes(),N=N<<5|I.getSeconds()>>>1,C.write_shift(2,N);var P=I.getFullYear()-1980;P=P<<4|I.getMonth()+1,P=P<<5|I.getDate(),C.write_shift(2,P)}function o(C){var I=C.read_shift(2)&65535,N=C.read_shift(2)&65535,P=new Date,B=N&31;N>>>=5;var H=N&15;N>>>=4,P.setMilliseconds(0),P.setFullYear(N+1980),P.setMonth(H-1),P.setDate(B);var rt=I&31;I>>>=5;var ft=I&63;return I>>>=6,P.setHours(I),P.setMinutes(ft),P.setSeconds(rt<<1),P}function u(C){en(C,0);for(var I={},N=0;C.l<=C.length-4;){var P=C.read_shift(2),B=C.read_shift(2),H=C.l+B,rt={};switch(P){case 21589:N=C.read_shift(1),N&1&&(rt.mtime=C.read_shift(4)),B>5&&(N&2&&(rt.atime=C.read_shift(4)),N&4&&(rt.ctime=C.read_shift(4))),rt.mtime&&(rt.mt=new Date(rt.mtime*1e3));break}C.l=H,I[P]=rt}return I}var f;function d(){return f||(f={})}function p(C,I){if(C[0]==80&&C[1]==75)return nl(C,I);if((C[0]|32)==109&&(C[1]|32)==105)return ah(C,I);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var N=3,P=512,B=0,H=0,rt=0,ft=0,tt=0,at=[],ot=C.slice(0,512);en(ot,0);var St=m(ot);switch(N=St[0],N){case 3:P=512;break;case 4:P=4096;break;case 0:if(St[1]==0)return nl(C,I);default:throw new Error("Major Version: Expected 3 or 4 saw "+N)}P!==512&&(ot=C.slice(0,P),en(ot,28));var Ct=C.slice(0,P);v(ot,N);var Nt=ot.read_shift(4,"i");if(N===3&&Nt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Nt);ot.l+=4,rt=ot.read_shift(4,"i"),ot.l+=4,ot.chk("00100000","Mini Stream Cutoff Size: "),ft=ot.read_shift(4,"i"),B=ot.read_shift(4,"i"),tt=ot.read_shift(4,"i"),H=ot.read_shift(4,"i");for(var wt=-1,Mt=0;Mt<109&&(wt=ot.read_shift(4,"i"),!(wt<0));++Mt)at[Mt]=wt;var Yt=_(C,P);E(tt,H,Yt,P,at);var ge=b(Yt,rt,at,P);ge[rt].name="!Directory",B>0&&ft!==ht&&(ge[ft].name="!MiniFAT"),ge[at[0]].name="!FAT",ge.fat_addrs=at,ge.ssz=P;var me={},Se=[],rr=[],Or=[];w(rt,ge,Yt,Se,B,me,rr,ft),A(rr,Or,Se),Se.shift();var un={FileIndex:rr,FullPaths:Or};return I&&I.raw&&(un.raw={header:Ct,sectors:Yt}),un}function m(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(bt,"Header Signature: "),C.l+=16;var I=C.read_shift(2,"u");return[C.read_shift(2,"u"),I]}function v(C,I){var N=9;switch(C.l+=2,N=C.read_shift(2)){case 9:if(I!=3)throw new Error("Sector Shift: Expected 9 saw "+N);break;case 12:if(I!=4)throw new Error("Sector Shift: Expected 12 saw "+N);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+N)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function _(C,I){for(var N=Math.ceil(C.length/I)-1,P=[],B=1;B<N;++B)P[B-1]=C.slice(B*I,(B+1)*I);return P[N-1]=C.slice(N*I),P}function A(C,I,N){for(var P=0,B=0,H=0,rt=0,ft=0,tt=N.length,at=[],ot=[];P<tt;++P)at[P]=ot[P]=P,I[P]=N[P];for(;ft<ot.length;++ft)P=ot[ft],B=C[P].L,H=C[P].R,rt=C[P].C,at[P]===P&&(B!==-1&&at[B]!==B&&(at[P]=at[B]),H!==-1&&at[H]!==H&&(at[P]=at[H])),rt!==-1&&(at[rt]=P),B!==-1&&P!=at[P]&&(at[B]=at[P],ot.lastIndexOf(B)<ft&&ot.push(B)),H!==-1&&P!=at[P]&&(at[H]=at[P],ot.lastIndexOf(H)<ft&&ot.push(H));for(P=1;P<tt;++P)at[P]===P&&(H!==-1&&at[H]!==H?at[P]=at[H]:B!==-1&&at[B]!==B&&(at[P]=at[B]));for(P=1;P<tt;++P)if(C[P].type!==0){if(ft=P,ft!=at[ft])do ft=at[ft],I[P]=I[ft]+"/"+I[P];while(ft!==0&&at[ft]!==-1&&ft!=at[ft]);at[P]=-1}for(I[0]+="/",P=1;P<tt;++P)C[P].type!==2&&(I[P]+="/")}function y(C,I,N){for(var P=C.start,B=C.size,H=[],rt=P;N&&B>0&&rt>=0;)H.push(I.slice(rt*ut,rt*ut+ut)),B-=ut,rt=Ms(N,rt*4);return H.length===0?dt(0):mi(H).slice(0,C.size)}function E(C,I,N,P,B){var H=ht;if(C===ht){if(I!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var rt=N[C],ft=(P>>>2)-1;if(!rt)return;for(var tt=0;tt<ft&&(H=Ms(rt,tt*4))!==ht;++tt)B.push(H);E(Ms(rt,P-4),I-1,N,P,B)}}function T(C,I,N,P,B){var H=[],rt=[];B||(B=[]);var ft=P-1,tt=0,at=0;for(tt=I;tt>=0;){B[tt]=!0,H[H.length]=tt,rt.push(C[tt]);var ot=N[Math.floor(tt*4/P)];if(at=tt*4&ft,P<4+at)throw new Error("FAT boundary crossed: "+tt+" 4 "+P);if(!C[ot])break;tt=Ms(C[ot],at)}return{nodes:H,data:Dv([rt])}}function b(C,I,N,P){var B=C.length,H=[],rt=[],ft=[],tt=[],at=P-1,ot=0,St=0,Ct=0,Nt=0;for(ot=0;ot<B;++ot)if(ft=[],Ct=ot+I,Ct>=B&&(Ct-=B),!rt[Ct]){tt=[];var wt=[];for(St=Ct;St>=0;){wt[St]=!0,rt[St]=!0,ft[ft.length]=St,tt.push(C[St]);var Mt=N[Math.floor(St*4/P)];if(Nt=St*4&at,P<4+Nt)throw new Error("FAT boundary crossed: "+St+" 4 "+P);if(!C[Mt]||(St=Ms(C[Mt],Nt),wt[St]))break}H[Ct]={nodes:ft,data:Dv([tt])}}return H}function w(C,I,N,P,B,H,rt,ft){for(var tt=0,at=P.length?2:0,ot=I[C].data,St=0,Ct=0,Nt;St<ot.length;St+=128){var wt=ot.slice(St,St+128);en(wt,64),Ct=wt.read_shift(2),Nt=wd(wt,0,Ct-at),P.push(Nt);var Mt={name:Nt,type:wt.read_shift(1),color:wt.read_shift(1),L:wt.read_shift(4,"i"),R:wt.read_shift(4,"i"),C:wt.read_shift(4,"i"),clsid:wt.read_shift(16),state:wt.read_shift(4,"i"),start:0,size:0},Yt=wt.read_shift(2)+wt.read_shift(2)+wt.read_shift(2)+wt.read_shift(2);Yt!==0&&(Mt.ct=O(wt,wt.l-8));var ge=wt.read_shift(2)+wt.read_shift(2)+wt.read_shift(2)+wt.read_shift(2);ge!==0&&(Mt.mt=O(wt,wt.l-8)),Mt.start=wt.read_shift(4,"i"),Mt.size=wt.read_shift(4,"i"),Mt.size<0&&Mt.start<0&&(Mt.size=Mt.type=0,Mt.start=ht,Mt.name=""),Mt.type===5?(tt=Mt.start,B>0&&tt!==ht&&(I[tt].name="!StreamData")):Mt.size>=4096?(Mt.storage="fat",I[Mt.start]===void 0&&(I[Mt.start]=T(N,Mt.start,I.fat_addrs,I.ssz)),I[Mt.start].name=Mt.name,Mt.content=I[Mt.start].data.slice(0,Mt.size)):(Mt.storage="minifat",Mt.size<0?Mt.size=0:tt!==ht&&Mt.start!==ht&&I[tt]&&(Mt.content=y(Mt,I[tt].data,(I[ft]||{}).data))),Mt.content&&en(Mt.content,0),H[Nt]=Mt,rt.push(Mt)}}function O(C,I){return new Date((sn(C,I+4)/1e7*Math.pow(2,32)+sn(C,I)/1e7-11644473600)*1e3)}function F(C,I){return d(),p(f.readFileSync(C),I)}function z(C,I){var N=I&&I.type;switch(N||le&&Buffer.isBuffer(C)&&(N="buffer"),N||"base64"){case"file":return F(C,I);case"base64":return p(Pn(br(C)),I);case"binary":return p(Pn(C),I)}return p(C,I)}function L(C,I){var N=I||{},P=N.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=P+"/",C.FileIndex[0]={name:P,type:5}),N.CLSID&&(C.FileIndex[0].clsid=N.CLSID),G(C)}function G(C){var I="Sh33tJ5";if(!ye.find(C,"/"+I)){var N=dt(4);N[0]=55,N[1]=N[3]=50,N[2]=54,C.FileIndex.push({name:I,type:2,content:N,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+I),V(C)}}function V(C,I){L(C);for(var N=!1,P=!1,B=C.FullPaths.length-1;B>=0;--B){var H=C.FileIndex[B];switch(H.type){case 0:P?N=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:P=!0,isNaN(H.R*H.L*H.C)&&(N=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(N=!0);break;default:N=!0;break}}if(!(!N&&!I)){var rt=new Date(1987,1,19),ft=0,tt=Object.create?Object.create(null):{},at=[];for(B=0;B<C.FullPaths.length;++B)tt[C.FullPaths[B]]=!0,C.FileIndex[B].type!==0&&at.push([C.FullPaths[B],C.FileIndex[B]]);for(B=0;B<at.length;++B){var ot=i(at[B][0]);P=tt[ot],P||(at.push([ot,{name:s(ot).replace("/",""),type:1,clsid:Y,ct:rt,mt:rt,content:null}]),tt[ot]=!0)}for(at.sort(function(Nt,wt){return e(Nt[0],wt[0])}),C.FullPaths=[],C.FileIndex=[],B=0;B<at.length;++B)C.FullPaths[B]=at[B][0],C.FileIndex[B]=at[B][1];for(B=0;B<at.length;++B){var St=C.FileIndex[B],Ct=C.FullPaths[B];if(St.name=s(Ct).replace("/",""),St.L=St.R=St.C=-(St.color=1),St.size=St.content?St.content.length:0,St.start=0,St.clsid=St.clsid||Y,B===0)St.C=at.length>1?1:-1,St.size=0,St.type=5;else if(Ct.slice(-1)=="/"){for(ft=B+1;ft<at.length&&i(C.FullPaths[ft])!=Ct;++ft);for(St.C=ft>=at.length?-1:ft,ft=B+1;ft<at.length&&i(C.FullPaths[ft])!=i(Ct);++ft);St.R=ft>=at.length?-1:ft,St.type=1}else i(C.FullPaths[B+1]||"")==i(Ct)&&(St.R=B+1),St.type=2}}}function Q(C,I){var N=I||{};if(N.fileType=="mad")return zn(C,N);switch(V(C),N.fileType){case"zip":return ds(C,N)}var P=(function(Nt){for(var wt=0,Mt=0,Yt=0;Yt<Nt.FileIndex.length;++Yt){var ge=Nt.FileIndex[Yt];if(ge.content){var me=ge.content.length;me>0&&(me<4096?wt+=me+63>>6:Mt+=me+511>>9)}}for(var Se=Nt.FullPaths.length+3>>2,rr=wt+7>>3,Or=wt+127>>7,un=rr+Mt+Se+Or,Rn=un+127>>7,ps=Rn<=109?0:Math.ceil((Rn-109)/127);un+Rn+ps+127>>7>Rn;)ps=++Rn<=109?0:Math.ceil((Rn-109)/127);var Dn=[1,ps,Rn,Or,Se,Mt,wt,0];return Nt.FileIndex[0].size=wt<<6,Dn[7]=(Nt.FileIndex[0].start=Dn[0]+Dn[1]+Dn[2]+Dn[3]+Dn[4]+Dn[5])+(Dn[6]+7>>3),Dn})(C),B=dt(P[7]<<9),H=0,rt=0;{for(H=0;H<8;++H)B.write_shift(1,Et[H]);for(H=0;H<8;++H)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),H=0;H<3;++H)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,P[2]),B.write_shift(4,P[0]+P[1]+P[2]+P[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,P[3]?P[0]+P[1]+P[2]-1:ht),B.write_shift(4,P[3]),B.write_shift(-4,P[1]?P[0]-1:ht),B.write_shift(4,P[1]),H=0;H<109;++H)B.write_shift(-4,H<P[2]?P[1]+H:-1)}if(P[1])for(rt=0;rt<P[1];++rt){for(;H<236+rt*127;++H)B.write_shift(-4,H<P[2]?P[1]+H:-1);B.write_shift(-4,rt===P[1]-1?ht:rt+1)}var ft=function(Nt){for(rt+=Nt;H<rt-1;++H)B.write_shift(-4,H+1);Nt&&(++H,B.write_shift(-4,ht))};for(rt=H=0,rt+=P[1];H<rt;++H)B.write_shift(-4,nt.DIFSECT);for(rt+=P[2];H<rt;++H)B.write_shift(-4,nt.FATSECT);ft(P[3]),ft(P[4]);for(var tt=0,at=0,ot=C.FileIndex[0];tt<C.FileIndex.length;++tt)ot=C.FileIndex[tt],ot.content&&(at=ot.content.length,!(at<4096)&&(ot.start=rt,ft(at+511>>9)));for(ft(P[6]+7>>3);B.l&511;)B.write_shift(-4,nt.ENDOFCHAIN);for(rt=H=0,tt=0;tt<C.FileIndex.length;++tt)ot=C.FileIndex[tt],ot.content&&(at=ot.content.length,!(!at||at>=4096)&&(ot.start=rt,ft(at+63>>6)));for(;B.l&511;)B.write_shift(-4,nt.ENDOFCHAIN);for(H=0;H<P[4]<<2;++H){var St=C.FullPaths[H];if(!St||St.length===0){for(tt=0;tt<17;++tt)B.write_shift(4,0);for(tt=0;tt<3;++tt)B.write_shift(4,-1);for(tt=0;tt<12;++tt)B.write_shift(4,0);continue}ot=C.FileIndex[H],H===0&&(ot.start=ot.size?ot.start-1:ht);var Ct=H===0&&N.root||ot.name;if(at=2*(Ct.length+1),B.write_shift(64,Ct,"utf16le"),B.write_shift(2,at),B.write_shift(1,ot.type),B.write_shift(1,ot.color),B.write_shift(-4,ot.L),B.write_shift(-4,ot.R),B.write_shift(-4,ot.C),ot.clsid)B.write_shift(16,ot.clsid,"hex");else for(tt=0;tt<4;++tt)B.write_shift(4,0);B.write_shift(4,ot.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,ot.start),B.write_shift(4,ot.size),B.write_shift(4,0)}for(H=1;H<C.FileIndex.length;++H)if(ot=C.FileIndex[H],ot.size>=4096)if(B.l=ot.start+1<<9,le&&Buffer.isBuffer(ot.content))ot.content.copy(B,B.l,0,ot.size),B.l+=ot.size+511&-512;else{for(tt=0;tt<ot.size;++tt)B.write_shift(1,ot.content[tt]);for(;tt&511;++tt)B.write_shift(1,0)}for(H=1;H<C.FileIndex.length;++H)if(ot=C.FileIndex[H],ot.size>0&&ot.size<4096)if(le&&Buffer.isBuffer(ot.content))ot.content.copy(B,B.l,0,ot.size),B.l+=ot.size+63&-64;else{for(tt=0;tt<ot.size;++tt)B.write_shift(1,ot.content[tt]);for(;tt&63;++tt)B.write_shift(1,0)}if(le)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function K(C,I){var N=C.FullPaths.map(function(tt){return tt.toUpperCase()}),P=N.map(function(tt){var at=tt.split("/");return at[at.length-(tt.slice(-1)=="/"?2:1)]}),B=!1;I.charCodeAt(0)===47?(B=!0,I=N[0].slice(0,-1)+I):B=I.indexOf("/")!==-1;var H=I.toUpperCase(),rt=B===!0?N.indexOf(H):P.indexOf(H);if(rt!==-1)return C.FileIndex[rt];var ft=!H.match(lu);for(H=H.replace(po,""),ft&&(H=H.replace(lu,"!")),rt=0;rt<N.length;++rt)if((ft?N[rt].replace(lu,"!"):N[rt]).replace(po,"")==H||(ft?P[rt].replace(lu,"!"):P[rt]).replace(po,"")==H)return C.FileIndex[rt];return null}var ut=64,ht=-2,bt="d0cf11e0a1b11ae1",Et=[208,207,17,224,161,177,26,225],Y="00000000000000000000000000000000",nt={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ht,FREESECT:-1,HEADER_SIGNATURE:bt,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Tt(C,I,N){d();var P=Q(C,N);f.writeFileSync(I,P)}function st(C){for(var I=new Array(C.length),N=0;N<C.length;++N)I[N]=String.fromCharCode(C[N]);return I.join("")}function M(C,I){var N=Q(C,I);switch(I&&I.type||"buffer"){case"file":return d(),f.writeFileSync(I.filename,N),N;case"binary":return typeof N=="string"?N:st(N);case"base64":return Eo(typeof N=="string"?N:st(N));case"buffer":if(le)return Buffer.isBuffer(N)?N:Rr(N);case"array":return typeof N=="string"?Pn(N):N}return N}var q;function D(C){try{var I=C.InflateRaw,N=new I;if(N._processChunk(new Uint8Array([3,0]),N._finishFlushFlag),N.bytesRead)q=C;else throw new Error("zlib does not expose bytesRead")}catch(P){console.error("cannot use native zlib: "+(P.message||P))}}function k(C,I){if(!q)return Wo(C,I);var N=q.InflateRaw,P=new N,B=P._processChunk(C.slice(C.l),P._finishFlushFlag);return C.l+=P.bytesRead,B}function U(C){return q?q.deflateRawSync(C):Xo(C)}var j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],_t=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function At(C){var I=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(I>>16|I>>8|I)&255}for(var vt=typeof Uint8Array<"u",gt=vt?new Uint8Array(256):[],Pt=0;Pt<256;++Pt)gt[Pt]=At(Pt);function It(C,I){var N=gt[C&255];return I<=8?N>>>8-I:(N=N<<8|gt[C>>8&255],I<=16?N>>>16-I:(N=N<<8|gt[C>>16&255],N>>>24-I))}function ee(C,I){var N=I&7,P=I>>>3;return(C[P]|(N<=6?0:C[P+1]<<8))>>>N&3}function jt(C,I){var N=I&7,P=I>>>3;return(C[P]|(N<=5?0:C[P+1]<<8))>>>N&7}function ln(C,I){var N=I&7,P=I>>>3;return(C[P]|(N<=4?0:C[P+1]<<8))>>>N&15}function pe(C,I){var N=I&7,P=I>>>3;return(C[P]|(N<=3?0:C[P+1]<<8))>>>N&31}function Ot(C,I){var N=I&7,P=I>>>3;return(C[P]|(N<=1?0:C[P+1]<<8))>>>N&127}function ki(C,I,N){var P=I&7,B=I>>>3,H=(1<<N)-1,rt=C[B]>>>P;return N<8-P||(rt|=C[B+1]<<8-P,N<16-P)||(rt|=C[B+2]<<16-P,N<24-P)||(rt|=C[B+3]<<24-P),rt&H}function on(C,I,N){var P=I&7,B=I>>>3;return P<=5?C[B]|=(N&7)<<P:(C[B]|=N<<P&255,C[B+1]=(N&7)>>8-P),I+3}function Un(C,I,N){var P=I&7,B=I>>>3;return N=(N&1)<<P,C[B]|=N,I+1}function Cn(C,I,N){var P=I&7,B=I>>>3;return N<<=P,C[B]|=N&255,N>>>=8,C[B+1]=N,I+8}function jo(C,I,N){var P=I&7,B=I>>>3;return N<<=P,C[B]|=N&255,N>>>=8,C[B+1]=N&255,C[B+2]=N>>>8,I+16}function $s(C,I){var N=C.length,P=2*N>I?2*N:I+5,B=0;if(N>=I)return C;if(le){var H=pv(P);if(C.copy)C.copy(H);else for(;B<C.length;++B)H[B]=C[B];return H}else if(vt){var rt=new Uint8Array(P);if(rt.set)rt.set(C);else for(;B<N;++B)rt[B]=C[B];return rt}return C.length=P,C}function cn(C){for(var I=new Array(C),N=0;N<C;++N)I[N]=0;return I}function Ks(C,I,N){var P=1,B=0,H=0,rt=0,ft=0,tt=C.length,at=vt?new Uint16Array(32):cn(32);for(H=0;H<32;++H)at[H]=0;for(H=tt;H<N;++H)C[H]=0;tt=C.length;var ot=vt?new Uint16Array(tt):cn(tt);for(H=0;H<tt;++H)at[B=C[H]]++,P<B&&(P=B),ot[H]=0;for(at[0]=0,H=1;H<=P;++H)at[H+16]=ft=ft+at[H-1]<<1;for(H=0;H<tt;++H)ft=C[H],ft!=0&&(ot[H]=at[ft+16]++);var St=0;for(H=0;H<tt;++H)if(St=C[H],St!=0)for(ft=It(ot[H],P)>>P-St,rt=(1<<P+4-St)-1;rt>=0;--rt)I[ft|rt<<St]=St&15|H<<4;return P}var nr=vt?new Uint16Array(512):cn(512),li=vt?new Uint16Array(32):cn(32);if(!vt){for(var Ai=0;Ai<512;++Ai)nr[Ai]=0;for(Ai=0;Ai<32;++Ai)li[Ai]=0}(function(){for(var C=[],I=0;I<32;I++)C.push(5);Ks(C,li,32);var N=[];for(I=0;I<=143;I++)N.push(8);for(;I<=255;I++)N.push(9);for(;I<=279;I++)N.push(7);for(;I<=287;I++)N.push(8);Ks(N,nr,288)})();var bi=(function(){for(var I=vt?new Uint8Array(32768):[],N=0,P=0;N<_t.length-1;++N)for(;P<_t[N+1];++P)I[P]=N;for(;P<32768;++P)I[P]=29;var B=vt?new Uint8Array(259):[];for(N=0,P=0;N<J.length-1;++N)for(;P<J[N+1];++P)B[P]=N;function H(ft,tt){for(var at=0;at<ft.length;){var ot=Math.min(65535,ft.length-at),St=at+ot==ft.length;for(tt.write_shift(1,+St),tt.write_shift(2,ot),tt.write_shift(2,~ot&65535);ot-- >0;)tt[tt.l++]=ft[at++]}return tt.l}function rt(ft,tt){for(var at=0,ot=0,St=vt?new Uint16Array(32768):[];ot<ft.length;){var Ct=Math.min(65535,ft.length-ot);if(Ct<10){for(at=on(tt,at,+(ot+Ct==ft.length)),at&7&&(at+=8-(at&7)),tt.l=at/8|0,tt.write_shift(2,Ct),tt.write_shift(2,~Ct&65535);Ct-- >0;)tt[tt.l++]=ft[ot++];at=tt.l*8;continue}at=on(tt,at,+(ot+Ct==ft.length)+2);for(var Nt=0;Ct-- >0;){var wt=ft[ot];Nt=(Nt<<5^wt)&32767;var Mt=-1,Yt=0;if((Mt=St[Nt])&&(Mt|=ot&-32768,Mt>ot&&(Mt-=32768),Mt<ot))for(;ft[Mt+Yt]==ft[ot+Yt]&&Yt<250;)++Yt;if(Yt>2){wt=B[Yt],wt<=22?at=Cn(tt,at,gt[wt+1]>>1)-1:(Cn(tt,at,3),at+=5,Cn(tt,at,gt[wt-23]>>5),at+=3);var ge=wt<8?0:wt-4>>2;ge>0&&(jo(tt,at,Yt-J[wt]),at+=ge),wt=I[ot-Mt],at=Cn(tt,at,gt[wt]>>3),at-=3;var me=wt<4?0:wt-2>>1;me>0&&(jo(tt,at,ot-Mt-_t[wt]),at+=me);for(var Se=0;Se<Yt;++Se)St[Nt]=ot&32767,Nt=(Nt<<5^ft[ot])&32767,++ot;Ct-=Yt-1}else wt<=143?wt=wt+48:at=Un(tt,at,1),at=Cn(tt,at,gt[wt]),St[Nt]=ot&32767,++ot}at=Cn(tt,at,0)-1}return tt.l=(at+7)/8|0,tt.l}return function(tt,at){return tt.length<8?H(tt,at):rt(tt,at)}})();function Xo(C){var I=dt(50+Math.floor(C.length*1.1)),N=bi(C,I);return I.slice(0,N)}var Yo=vt?new Uint16Array(32768):cn(32768),qo=vt?new Uint16Array(32768):cn(32768),us=vt?new Uint16Array(128):cn(128),hs=1,Hn=1;function Qs(C,I){var N=pe(C,I)+257;I+=5;var P=pe(C,I)+1;I+=5;var B=ln(C,I)+4;I+=4;for(var H=0,rt=vt?new Uint8Array(19):cn(19),ft=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],tt=1,at=vt?new Uint8Array(8):cn(8),ot=vt?new Uint8Array(8):cn(8),St=rt.length,Ct=0;Ct<B;++Ct)rt[j[Ct]]=H=jt(C,I),tt<H&&(tt=H),at[H]++,I+=3;var Nt=0;for(at[0]=0,Ct=1;Ct<=tt;++Ct)ot[Ct]=Nt=Nt+at[Ct-1]<<1;for(Ct=0;Ct<St;++Ct)(Nt=rt[Ct])!=0&&(ft[Ct]=ot[Nt]++);var wt=0;for(Ct=0;Ct<St;++Ct)if(wt=rt[Ct],wt!=0){Nt=gt[ft[Ct]]>>8-wt;for(var Mt=(1<<7-wt)-1;Mt>=0;--Mt)us[Nt|Mt<<wt]=wt&7|Ct<<3}var Yt=[];for(tt=1;Yt.length<N+P;)switch(Nt=us[Ot(C,I)],I+=Nt&7,Nt>>>=3){case 16:for(H=3+ee(C,I),I+=2,Nt=Yt[Yt.length-1];H-- >0;)Yt.push(Nt);break;case 17:for(H=3+jt(C,I),I+=3;H-- >0;)Yt.push(0);break;case 18:for(H=11+Ot(C,I),I+=7;H-- >0;)Yt.push(0);break;default:Yt.push(Nt),tt<Nt&&(tt=Nt);break}var ge=Yt.slice(0,N),me=Yt.slice(N);for(Ct=N;Ct<286;++Ct)ge[Ct]=0;for(Ct=P;Ct<30;++Ct)me[Ct]=0;return hs=Ks(ge,Yo,286),Hn=Ks(me,qo,30),I}function fs(C,I){if(C[0]==3&&!(C[1]&3))return[Bs(I),2];for(var N=0,P=0,B=pv(I||1<<18),H=0,rt=B.length>>>0,ft=0,tt=0;(P&1)==0;){if(P=jt(C,N),N+=3,P>>>1)P>>1==1?(ft=9,tt=5):(N=Qs(C,N),ft=hs,tt=Hn);else{N&7&&(N+=8-(N&7));var at=C[N>>>3]|C[(N>>>3)+1]<<8;if(N+=32,at>0)for(!I&&rt<H+at&&(B=$s(B,H+at),rt=B.length);at-- >0;)B[H++]=C[N>>>3],N+=8;continue}for(;;){!I&&rt<H+32767&&(B=$s(B,H+32767),rt=B.length);var ot=ki(C,N,ft),St=P>>>1==1?nr[ot]:Yo[ot];if(N+=St&15,St>>>=4,(St>>>8&255)===0)B[H++]=St;else{if(St==256)break;St-=257;var Ct=St<8?0:St-4>>2;Ct>5&&(Ct=0);var Nt=H+J[St];Ct>0&&(Nt+=ki(C,N,Ct),N+=Ct),ot=ki(C,N,tt),St=P>>>1==1?li[ot]:qo[ot],N+=St&15,St>>>=4;var wt=St<4?0:St-2>>1,Mt=_t[St];for(wt>0&&(Mt+=ki(C,N,wt),N+=wt),!I&&rt<Nt&&(B=$s(B,Nt+100),rt=B.length);H<Nt;)B[H]=B[H-Mt],++H}}}return I?[B,N+7>>>3]:[B.slice(0,H),N+7>>>3]}function Wo(C,I){var N=C.slice(C.l||0),P=fs(N,I);return C.l+=P[1],P[0]}function il(C,I){if(C)typeof console<"u"&&console.error(I);else throw new Error(I)}function nl(C,I){var N=C;en(N,0);var P=[],B=[],H={FileIndex:P,FullPaths:B};L(H,{root:I.root});for(var rt=N.length-4;(N[rt]!=80||N[rt+1]!=75||N[rt+2]!=5||N[rt+3]!=6)&&rt>=0;)--rt;N.l=rt+4,N.l+=4;var ft=N.read_shift(2);N.l+=6;var tt=N.read_shift(4);for(N.l=tt,rt=0;rt<ft;++rt){N.l+=20;var at=N.read_shift(4),ot=N.read_shift(4),St=N.read_shift(2),Ct=N.read_shift(2),Nt=N.read_shift(2);N.l+=8;var wt=N.read_shift(4),Mt=u(N.slice(N.l+St,N.l+St+Ct));N.l+=St+Ct+Nt;var Yt=N.l;N.l=wt+4,rl(N,at,ot,H,Mt),N.l=Yt}return H}function rl(C,I,N,P,B){C.l+=2;var H=C.read_shift(2),rt=C.read_shift(2),ft=o(C);if(H&8257)throw new Error("Unsupported ZIP encryption");for(var tt=C.read_shift(4),at=C.read_shift(4),ot=C.read_shift(4),St=C.read_shift(2),Ct=C.read_shift(2),Nt="",wt=0;wt<St;++wt)Nt+=String.fromCharCode(C[C.l++]);if(Ct){var Mt=u(C.slice(C.l,C.l+Ct));(Mt[21589]||{}).mt&&(ft=Mt[21589].mt),((B||{})[21589]||{}).mt&&(ft=B[21589].mt)}C.l+=Ct;var Yt=C.slice(C.l,C.l+at);switch(rt){case 8:Yt=k(C,ot);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+rt)}var ge=!1;H&8&&(tt=C.read_shift(4),tt==134695760&&(tt=C.read_shift(4),ge=!0),at=C.read_shift(4),ot=C.read_shift(4)),at!=I&&il(ge,"Bad compressed size: "+I+" != "+at),ot!=N&&il(ge,"Bad uncompressed size: "+N+" != "+ot),Je(P,Nt,Yt,{unsafe:!0,mt:ft})}function ds(C,I){var N=I||{},P=[],B=[],H=dt(1),rt=N.compression?8:0,ft=0,tt=0,at=0,ot=0,St=0,Ct=C.FullPaths[0],Nt=Ct,wt=C.FileIndex[0],Mt=[],Yt=0;for(tt=1;tt<C.FullPaths.length;++tt)if(Nt=C.FullPaths[tt].slice(Ct.length),wt=C.FileIndex[tt],!(!wt.size||!wt.content||Nt=="Sh33tJ5")){var ge=ot,me=dt(Nt.length);for(at=0;at<Nt.length;++at)me.write_shift(1,Nt.charCodeAt(at)&127);me=me.slice(0,me.l),Mt[St]=$E.buf(wt.content,0);var Se=wt.content;rt==8&&(Se=U(Se)),H=dt(30),H.write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,ft),H.write_shift(2,rt),wt.mt?l(H,wt.mt):H.write_shift(4,0),H.write_shift(-4,Mt[St]),H.write_shift(4,Se.length),H.write_shift(4,wt.content.length),H.write_shift(2,me.length),H.write_shift(2,0),ot+=H.length,P.push(H),ot+=me.length,P.push(me),ot+=Se.length,P.push(Se),H=dt(46),H.write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,ft),H.write_shift(2,rt),H.write_shift(4,0),H.write_shift(-4,Mt[St]),H.write_shift(4,Se.length),H.write_shift(4,wt.content.length),H.write_shift(2,me.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,ge),Yt+=H.l,B.push(H),Yt+=me.length,B.push(me),++St}return H=dt(22),H.write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,St),H.write_shift(2,St),H.write_shift(4,Yt),H.write_shift(4,ot),H.write_shift(2,0),mi([mi(P),mi(B),H])}var Zs={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function $o(C,I){if(C.ctype)return C.ctype;var N=C.name||"",P=N.match(/\.([^\.]+)$/);return P&&Zs[P[1]]||I&&(P=(N=I).match(/[\.\\]([^\.\\])+$/),P&&Zs[P[1]])?Zs[P[1]]:"application/octet-stream"}function Ko(C){for(var I=Eo(C),N=[],P=0;P<I.length;P+=76)N.push(I.slice(P,P+76));return N.join(`\r
`)+`\r
`}function sl(C){var I=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(at){var ot=at.charCodeAt(0).toString(16).toUpperCase();return"="+(ot.length==1?"0"+ot:ot)});I=I.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),I.charAt(0)==`
`&&(I="=0D"+I.slice(1)),I=I.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var N=[],P=I.split(`\r
`),B=0;B<P.length;++B){var H=P[B];if(H.length==0){N.push("");continue}for(var rt=0;rt<H.length;){var ft=76,tt=H.slice(rt,rt+ft);tt.charAt(ft-1)=="="?ft--:tt.charAt(ft-2)=="="?ft-=2:tt.charAt(ft-3)=="="&&(ft-=3),tt=H.slice(rt,rt+ft),rt+=ft,rt<H.length&&(tt+="="),N.push(tt)}}return N.join(`\r
`)}function al(C){for(var I=[],N=0;N<C.length;++N){for(var P=C[N];N<=C.length&&P.charAt(P.length-1)=="=";)P=P.slice(0,P.length-1)+C[++N];I.push(P)}for(var B=0;B<I.length;++B)I[B]=I[B].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return Pn(I.join(`\r
`))}function Qo(C,I,N){for(var P="",B="",H="",rt,ft=0;ft<10;++ft){var tt=I[ft];if(!tt||tt.match(/^\s*$/))break;var at=tt.match(/^(.*?):\s*([^\s].*)$/);if(at)switch(at[1].toLowerCase()){case"content-location":P=at[2].trim();break;case"content-type":H=at[2].trim();break;case"content-transfer-encoding":B=at[2].trim();break}}switch(++ft,B.toLowerCase()){case"base64":rt=Pn(br(I.slice(ft).join("")));break;case"quoted-printable":rt=al(I.slice(ft));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var ot=Je(C,P.slice(N.length),rt,{unsafe:!0});H&&(ot.ctype=H)}function ah(C,I){if(st(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var N=I&&I.root||"",P=(le&&Buffer.isBuffer(C)?C.toString("binary"):st(C)).split(`\r
`),B=0,H="";for(B=0;B<P.length;++B)if(H=P[B],!!/^Content-Location:/i.test(H)&&(H=H.slice(H.indexOf("file")),N||(N=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,N.length)!=N))for(;N.length>0&&(N=N.slice(0,N.length-1),N=N.slice(0,N.lastIndexOf("/")+1),H.slice(0,N.length)!=N););var rt=(P[1]||"").match(/boundary="(.*?)"/);if(!rt)throw new Error("MAD cannot find boundary");var ft="--"+(rt[1]||""),tt=[],at=[],ot={FileIndex:tt,FullPaths:at};L(ot);var St,Ct=0;for(B=0;B<P.length;++B){var Nt=P[B];Nt!==ft&&Nt!==ft+"--"||(Ct++&&Qo(ot,P.slice(St,B),N),St=B)}return ot}function zn(C,I){var N=I||{},P=N.boundary||"SheetJS";P="------="+P;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+P.slice(2)+'"',"","",""],H=C.FullPaths[0],rt=H,ft=C.FileIndex[0],tt=1;tt<C.FullPaths.length;++tt)if(rt=C.FullPaths[tt].slice(H.length),ft=C.FileIndex[tt],!(!ft.size||!ft.content||rt=="Sh33tJ5")){rt=rt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Yt){return"_x"+Yt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Yt){return"_u"+Yt.charCodeAt(0).toString(16)+"_"});for(var at=ft.content,ot=le&&Buffer.isBuffer(at)?at.toString("binary"):st(at),St=0,Ct=Math.min(1024,ot.length),Nt=0,wt=0;wt<=Ct;++wt)(Nt=ot.charCodeAt(wt))>=32&&Nt<128&&++St;var Mt=St>=Ct*4/5;B.push(P),B.push("Content-Location: "+(N.root||"file:///C:/SheetJS/")+rt),B.push("Content-Transfer-Encoding: "+(Mt?"quoted-printable":"base64")),B.push("Content-Type: "+$o(ft,rt)),B.push(""),B.push(Mt?sl(ot):Ko(ot))}return B.push(P+`--\r
`),B.join(`\r
`)}function Ze(C){var I={};return L(I,C),I}function Je(C,I,N,P){var B=P&&P.unsafe;B||L(C);var H=!B&&ye.find(C,I);if(!H){var rt=C.FullPaths[0];I.slice(0,rt.length)==rt?rt=I:(rt.slice(-1)!="/"&&(rt+="/"),rt=(rt+I).replace("//","/")),H={name:s(I),type:2},C.FileIndex.push(H),C.FullPaths.push(rt),B||ye.utils.cfb_gc(C)}return H.content=N,H.size=N?N.length:0,P&&(P.CLSID&&(H.clsid=P.CLSID),P.mt&&(H.mt=P.mt),P.ct&&(H.ct=P.ct)),H}function Dr(C,I){L(C);var N=ye.find(C,I);if(N){for(var P=0;P<C.FileIndex.length;++P)if(C.FileIndex[P]==N)return C.FileIndex.splice(P,1),C.FullPaths.splice(P,1),!0}return!1}function ll(C,I,N){L(C);var P=ye.find(C,I);if(P){for(var B=0;B<C.FileIndex.length;++B)if(C.FileIndex[B]==P)return C.FileIndex[B].name=s(N),C.FullPaths[B]=N,!0}return!1}function lh(C){V(C,!0)}return t.find=K,t.read=z,t.parse=p,t.write=M,t.writeFile=Tt,t.utils={cfb_new:Ze,cfb_add:Je,cfb_del:Dr,cfb_mov:ll,cfb_gc:lh,ReadShift:mo,CheckField:e_,prep_blob:en,bconcat:mi,use_zlib:D,_deflateRaw:Xo,_inflateRaw:Wo,consts:nt},t})();function KE(n){return typeof n=="string"?ju(n):Array.isArray(n)?EE(n):n}function Lo(n,t,e){if(typeof Deno<"u"){if(e&&typeof t=="string")switch(e){case"utf8":t=new TextEncoder(e).encode(t);break;case"binary":t=ju(t);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(n,t)}var i=e=="utf8"?To(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,n);if(typeof Blob<"u"){var s=new Blob([KE(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,n);if(typeof saveAs<"u")return saveAs(s,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:n,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=n,o.href=l,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(n);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=No(t)),u.write(t),u.close(),t}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+n)}function yi(n){for(var t=Object.keys(n),e=[],i=0;i<t.length;++i)Object.prototype.hasOwnProperty.call(n,t[i])&&e.push(t[i]);return e}function Ev(n,t){for(var e=[],i=yi(n),s=0;s!==i.length;++s)e[n[i[s]][t]]==null&&(e[n[i[s]][t]]=i[s]);return e}function Ad(n){for(var t=[],e=yi(n),i=0;i!==e.length;++i)t[n[e[i]]]=e[i];return t}function qu(n){for(var t=[],e=yi(n),i=0;i!==e.length;++i)t[n[e[i]]]=parseInt(e[i],10);return t}function QE(n){for(var t=[],e=yi(n),i=0;i!==e.length;++i)t[n[e[i]]]==null&&(t[n[e[i]]]=[]),t[n[e[i]]].push(e[i]);return t}var Ou=new Date(1899,11,30,0,0,0);function ji(n,t){var e=n.getTime(),i=Ou.getTime()+(n.getTimezoneOffset()-Ou.getTimezoneOffset())*6e4;return(e-i)/(1440*60*1e3)}var Ix=new Date,ZE=Ou.getTime()+(Ix.getTimezoneOffset()-Ou.getTimezoneOffset())*6e4,Sv=Ix.getTimezoneOffset();function Ux(n){var t=new Date;return t.setTime(n*24*60*60*1e3+ZE),t.getTimezoneOffset()!==Sv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Sv)*6e4),t}var Tv=new Date("2017-02-19T19:06:09.000Z"),Hx=isNaN(Tv.getFullYear())?new Date("2/19/17"):Tv,JE=Hx.getFullYear()==2017;function Fi(n,t){var e=new Date(n);if(JE)return t>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):t<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(n instanceof Date)return n;if(Hx.getFullYear()==1917&&!isNaN(e.getFullYear())){var i=e.getFullYear();return n.indexOf(""+i)>-1||e.setFullYear(e.getFullYear()+100),e}var s=n.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return n.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function Wu(n,t){if(le&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var e={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(l){return e[l]||l})}catch{}for(var i=[],s=0;s!=n.length;++s)i.push(String.fromCharCode(n[s]));return i.join("")}function Xi(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var t={};for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=Xi(n[e]));return t}function Fe(n,t){for(var e="";e.length<t;)e+=n;return e}function Tr(n){var t=Number(n);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(n))return t;var e=1,i=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(t=Number(i))||(i=i.replace(/[(](.*)[)]/,function(s,l){return e=-e,l}),!isNaN(t=Number(i)))?t/e:t}var tS=["january","february","march","april","may","june","july","august","september","october","november","december"];function So(n){var t=new Date(n),e=new Date(NaN),i=t.getYear(),s=t.getMonth(),l=t.getDate();if(isNaN(l))return e;var o=n.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&tS.indexOf(o)==-1)return e}else if(o.match(/[a-z]/))return e;return i<0||i>8099?e:(s>0||l>1)&&i!=101?t:n.match(/[^-0-9:,\/\\]/)?e:t}function $t(n,t,e){if(n.FullPaths){if(typeof e=="string"){var i;return le?i=Rr(e):i=SE(e),ye.utils.cfb_add(n,t,i)}ye.utils.cfb_add(n,t,e)}else n.file(t,e)}function Ed(){return ye.utils.cfb_new()}var We=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,eS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Sd=Ad(eS),Td=/[&<>'"]/g,iS=/[\u0000-\u0008\u000b-\u001f]/g;function fe(n){var t=n+"";return t.replace(Td,function(e){return Sd[e]}).replace(iS,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function wv(n){return fe(n).replace(/ /g,"_x0020_")}var zx=/[\u0000-\u001f]/g;function nS(n){var t=n+"";return t.replace(Td,function(e){return Sd[e]}).replace(/\n/g,"<br/>").replace(zx,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function rS(n){var t=n+"";return t.replace(Td,function(e){return Sd[e]}).replace(zx,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}function sS(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function aS(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function H0(n){for(var t="",e=0,i=0,s=0,l=0,o=0,u=0;e<n.length;){if(i=n.charCodeAt(e++),i<128){t+=String.fromCharCode(i);continue}if(s=n.charCodeAt(e++),i>191&&i<224){o=(i&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(l=n.charCodeAt(e++),i<240){t+=String.fromCharCode((i&15)<<12|(s&63)<<6|l&63);continue}o=n.charCodeAt(e++),u=((i&7)<<18|(s&63)<<12|(l&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function bv(n){var t=Bs(2*n.length),e,i,s=1,l=0,o=0,u;for(i=0;i<n.length;i+=s)s=1,(u=n.charCodeAt(i))<128?e=u:u<224?(e=(u&31)*64+(n.charCodeAt(i+1)&63),s=2):u<240?(e=(u&15)*4096+(n.charCodeAt(i+1)&63)*64+(n.charCodeAt(i+2)&63),s=3):(s=4,e=(u&7)*262144+(n.charCodeAt(i+1)&63)*4096+(n.charCodeAt(i+2)&63)*64+(n.charCodeAt(i+3)&63),e-=65536,o=55296+(e>>>10&1023),e=56320+(e&1023)),o!==0&&(t[l++]=o&255,t[l++]=o>>>8,o=0),t[l++]=e%256,t[l++]=e>>>8;return t.slice(0,l).toString("ucs2")}function Cv(n){return Rr(n,"binary").toString("utf8")}var cu="foo bar bazâð£",go=le&&(Cv(cu)==H0(cu)&&Cv||bv(cu)==H0(cu)&&bv)||H0,To=le?function(n){return Rr(n,"utf8").toString("binary")}:function(n){for(var t=[],e=0,i=0,s=0;e<n.length;)switch(i=n.charCodeAt(e++),!0){case i<128:t.push(String.fromCharCode(i));break;case i<2048:t.push(String.fromCharCode(192+(i>>6))),t.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,s=n.charCodeAt(e++)-56320+(i<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(i>>12))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)))}return t.join("")},lS=(function(){var n=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(e){for(var i=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<n.length;++s)i=i.replace(n[s][0],n[s][1]);return i}})(),Gx=/(^\s|\s$|\n)/;function vi(n,t){return"<"+n+(t.match(Gx)?' xml:space="preserve"':"")+">"+t+"</"+n+">"}function wo(n){return yi(n).map(function(t){return" "+t+'="'+n[t]+'"'}).join("")}function Rt(n,t,e){return"<"+n+(e!=null?wo(e):"")+(t!=null?(t.match(Gx)?' xml:space="preserve"':"")+">"+t+"</"+n:"/")+">"}function id(n,t){try{return n.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function oS(n,t){switch(typeof n){case"string":var e=Rt("vt:lpwstr",fe(n));return e=e.replace(/&quot;/g,"_x0022_"),e;case"number":return Rt((n|0)==n?"vt:i4":"vt:r8",fe(String(n)));case"boolean":return Rt("vt:bool",n?"true":"false")}if(n instanceof Date)return Rt("vt:filetime",id(n));throw new Error("Unable to serialize "+n)}var ri={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Za=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],rn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function cS(n,t){for(var e=1-2*(n[t+7]>>>7),i=((n[t+7]&127)<<4)+(n[t+6]>>>4&15),s=n[t+6]&15,l=5;l>=0;--l)s=s*256+n[t+l];return i==2047?s==0?e*(1/0):NaN:(i==0?i=-1022:(i-=1023,s+=Math.pow(2,52)),e*Math.pow(2,i-52)*s)}function uS(n,t,e){var i=(t<0||1/t==-1/0?1:0)<<7,s=0,l=0,o=i?-t:t;isFinite(o)?o==0?s=l=0:(s=Math.floor(Math.log(o)/Math.LN2),l=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?s=-1022:(l-=Math.pow(2,52),s+=1023)):(s=2047,l=isNaN(t)?26985:0);for(var u=0;u<=5;++u,l/=256)n[e+u]=l&255;n[e+6]=(s&15)<<4|l&15,n[e+7]=s>>4|i}var Rv=function(n){for(var t=[],e=10240,i=0;i<n[0].length;++i)if(n[0][i])for(var s=0,l=n[0][i].length;s<l;s+=e)t.push.apply(t,n[0][i].slice(s,s+e));return t},Dv=le?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(t){return Buffer.isBuffer(t)?t:Rr(t)})):Rv(n)}:Rv,Ov=function(n,t,e){for(var i=[],s=t;s<e;s+=2)i.push(String.fromCharCode(co(n,s)));return i.join("").replace(po,"")},wd=le?function(n,t,e){return Buffer.isBuffer(n)?n.toString("utf16le",t,e).replace(po,""):Ov(n,t,e)}:Ov,Mv=function(n,t,e){for(var i=[],s=t;s<t+e;++s)i.push(("0"+n[s].toString(16)).slice(-2));return i.join("")},Vx=le?function(n,t,e){return Buffer.isBuffer(n)?n.toString("hex",t,t+e):Mv(n,t,e)}:Mv,Nv=function(n,t,e){for(var i=[],s=t;s<e;s++)i.push(String.fromCharCode(Pa(n,s)));return i.join("")},Fo=le?function(t,e,i){return Buffer.isBuffer(t)?t.toString("utf8",e,i):Nv(t,e,i)}:Nv,jx=function(n,t){var e=sn(n,t);return e>0?Fo(n,t+4,t+4+e-1):""},Xx=jx,Yx=function(n,t){var e=sn(n,t);return e>0?Fo(n,t+4,t+4+e-1):""},qx=Yx,Wx=function(n,t){var e=2*sn(n,t);return e>0?Fo(n,t+4,t+4+e-1):""},$x=Wx,Kx=function(t,e){var i=sn(t,e);return i>0?wd(t,e+4,e+4+i):""},Qx=Kx,Zx=function(n,t){var e=sn(n,t);return e>0?Fo(n,t+4,t+4+e):""},Jx=Zx,t_=function(n,t){return cS(n,t)},Mu=t_,bd=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};le&&(Xx=function(t,e){if(!Buffer.isBuffer(t))return jx(t,e);var i=t.readUInt32LE(e);return i>0?t.toString("utf8",e+4,e+4+i-1):""},qx=function(t,e){if(!Buffer.isBuffer(t))return Yx(t,e);var i=t.readUInt32LE(e);return i>0?t.toString("utf8",e+4,e+4+i-1):""},$x=function(t,e){if(!Buffer.isBuffer(t))return Wx(t,e);var i=2*t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+i-1)},Qx=function(t,e){if(!Buffer.isBuffer(t))return Kx(t,e);var i=t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+i)},Jx=function(t,e){if(!Buffer.isBuffer(t))return Zx(t,e);var i=t.readUInt32LE(e);return t.toString("utf8",e+4,e+4+i)},Mu=function(t,e){return Buffer.isBuffer(t)?t.readDoubleLE(e):t_(t,e)},bd=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Pa=function(n,t){return n[t]},co=function(n,t){return n[t+1]*256+n[t]},hS=function(n,t){var e=n[t+1]*256+n[t];return e<32768?e:(65535-e+1)*-1},sn=function(n,t){return n[t+3]*(1<<24)+(n[t+2]<<16)+(n[t+1]<<8)+n[t]},Ms=function(n,t){return n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t]},fS=function(n,t){return n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3]};function mo(n,t){var e="",i,s,l=[],o,u,f,d;switch(t){case"dbcs":if(d=this.l,le&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*n).toString("utf16le");else for(f=0;f<n;++f)e+=String.fromCharCode(co(this,d)),d+=2;n*=2;break;case"utf8":e=Fo(this,this.l,this.l+n);break;case"utf16le":n*=2,e=wd(this,this.l,this.l+n);break;case"wstr":return mo.call(this,n,"dbcs");case"lpstr-ansi":e=Xx(this,this.l),n=4+sn(this,this.l);break;case"lpstr-cp":e=qx(this,this.l),n=4+sn(this,this.l);break;case"lpwstr":e=$x(this,this.l),n=4+2*sn(this,this.l);break;case"lpp4":n=4+sn(this,this.l),e=Qx(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+sn(this,this.l),e=Jx(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,e="";(o=Pa(this,this.l+n++))!==0;)l.push(au(o));e=l.join("");break;case"_wstr":for(n=0,e="";(o=co(this,this.l+n))!==0;)l.push(au(o)),n+=2;n+=2,e=l.join("");break;case"dbcs-cont":for(e="",d=this.l,f=0;f<n;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Pa(this,d),this.l=d+1,u=mo.call(this,n-f,o?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(au(co(this,d))),d+=2}e=l.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(e="",d=this.l,f=0;f!=n;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Pa(this,d),this.l=d+1,u=mo.call(this,n-f,o?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(au(Pa(this,d))),d+=1}e=l.join("");break;default:switch(n){case 1:return i=Pa(this,this.l),this.l++,i;case 2:return i=(t==="i"?hS:co)(this,this.l),this.l+=2,i;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(i=(n>0?Ms:fS)(this,this.l),this.l+=4,i):(s=sn(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return n==8?s=Mu(this,this.l):s=Mu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;n=8;case 16:e=Vx(this,this.l,n);break}}return this.l+=n,e}var dS=function(n,t,e){n[e]=t&255,n[e+1]=t>>>8&255,n[e+2]=t>>>16&255,n[e+3]=t>>>24&255},pS=function(n,t,e){n[e]=t&255,n[e+1]=t>>8&255,n[e+2]=t>>16&255,n[e+3]=t>>24&255},gS=function(n,t,e){n[e]=t&255,n[e+1]=t>>>8&255};function mS(n,t,e){var i=0,s=0;if(e==="dbcs"){for(s=0;s!=t.length;++s)gS(this,t.charCodeAt(s),this.l+2*s);i=2*t.length}else if(e==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;i=t.length}else if(e==="hex"){for(;s<n;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(e==="utf16le"){var l=Math.min(this.l+n,this.length);for(s=0;s<Math.min(t.length,n);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(n){case 1:i=1,this[this.l]=t&255;break;case 2:i=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:i=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:i=4,dS(this,t,this.l);break;case 8:if(i=8,e==="f"){uS(this,t,this.l);break}case 16:break;case-4:i=4,pS(this,t,this.l);break}return this.l+=i,this}function e_(n,t){var e=Vx(this,this.l,n.length>>1);if(e!==n)throw new Error(t+"Expected "+n+" saw "+e);this.l+=n.length>>1}function en(n,t){n.l=t,n.read_shift=mo,n.chk=e_,n.write_shift=mS}function er(n,t){n.l+=t}function dt(n){var t=Bs(n);return en(t,0),t}function Vi(){var n=[],t=le?256:2048,e=function(d){var p=dt(d);return en(p,0),p},i=e(t),s=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&n.push(i),i=null)},l=function(d){return i&&d<i.length-i.l?i:(s(),i=e(Math.max(d+1,t)))},o=function(){return s(),mi(n)},u=function(d){s(),i=d,i.l==null&&(i.l=i.length),l(t)};return{next:l,push:u,end:o,_bufs:n}}function yt(n,t,e,i){var s=+t,l;if(!isNaN(s)){i||(i=cR[s].p||(e||[]).length||0),l=1+(s>=128?1:0)+1,i>=128&&++l,i>=16384&&++l,i>=2097152&&++l;var o=n.next(l);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var u=0;u!=4;++u)if(i>=128)o.write_shift(1,(i&127)+128),i>>=7;else{o.write_shift(1,i);break}i>0&&bd(e)&&n.push(e)}}function vo(n,t,e){var i=Xi(n);if(t.s?(i.cRel&&(i.c+=t.s.c),i.rRel&&(i.r+=t.s.r)):(i.cRel&&(i.c+=t.c),i.rRel&&(i.r+=t.r)),!e||e.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function Lv(n,t,e){var i=Xi(n);return i.s=vo(i.s,t.s,e),i.e=vo(i.e,t.s,e),i}function xo(n,t){if(n.cRel&&n.c<0)for(n=Xi(n);n.c<0;)n.c+=t>8?16384:256;if(n.rRel&&n.r<0)for(n=Xi(n);n.r<0;)n.r+=t>8?1048576:t>5?65536:16384;var e=de(n);return!n.cRel&&n.cRel!=null&&(e=_S(e)),!n.rRel&&n.rRel!=null&&(e=vS(e)),e}function z0(n,t){return n.s.r==0&&!n.s.rRel&&n.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+Ti(n.s.c)+":"+(n.e.cRel?"":"$")+Ti(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(t.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+xi(n.s.r)+":"+(n.e.rRel?"":"$")+xi(n.e.r):xo(n.s,t.biff)+":"+xo(n.e,t.biff)}function Cd(n){return parseInt(xS(n),10)-1}function xi(n){return""+(n+1)}function vS(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function xS(n){return n.replace(/\$(\d+)$/,"$1")}function Rd(n){for(var t=yS(n),e=0,i=0;i!==t.length;++i)e=26*e+t.charCodeAt(i)-64;return e-1}function Ti(n){if(n<0)throw new Error("invalid column "+n);var t="";for(++n;n;n=Math.floor((n-1)/26))t=String.fromCharCode((n-1)%26+65)+t;return t}function _S(n){return n.replace(/^([A-Z])/,"$$$1")}function yS(n){return n.replace(/^\$([A-Z])/,"$1")}function AS(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function si(n){for(var t=0,e=0,i=0;i<n.length;++i){var s=n.charCodeAt(i);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(e=26*e+(s-64))}return{c:e-1,r:t-1}}function de(n){for(var t=n.c+1,e="";t;t=(t-1)/26|0)e=String.fromCharCode((t-1)%26+65)+e;return e+(n.r+1)}function an(n){var t=n.indexOf(":");return t==-1?{s:si(n),e:si(n)}:{s:si(n.slice(0,t)),e:si(n.slice(t+1))}}function qe(n,t){return typeof t>"u"||typeof t=="number"?qe(n.s,n.e):(typeof n!="string"&&(n=de(n)),typeof t!="string"&&(t=de(t)),n==t?n:n+":"+t)}function we(n){var t={s:{c:0,r:0},e:{c:0,r:0}},e=0,i=0,s=0,l=n.length;for(e=0;i<l&&!((s=n.charCodeAt(i)-64)<1||s>26);++i)e=26*e+s;for(t.s.c=--e,e=0;i<l&&!((s=n.charCodeAt(i)-48)<0||s>9);++i)e=10*e+s;if(t.s.r=--e,i===l||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++i,e=0;i!=l&&!((s=n.charCodeAt(i)-64)<1||s>26);++i)e=26*e+s;for(t.e.c=--e,e=0;i!=l&&!((s=n.charCodeAt(i)-48)<0||s>9);++i)e=10*e+s;return t.e.r=--e,t}function Fv(n,t){var e=n.t=="d"&&t instanceof Date;if(n.z!=null)try{return n.w=rs(n.z,e?ji(t):t)}catch{}try{return n.w=rs((n.XF||{}).numFmtId||(e?14:0),e?ji(t):t)}catch{return""+t}}function Cr(n,t,e){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&e&&e.dateNF&&(n.z=e.dateNF),n.t=="e"?ko[n.v]||n.v:t==null?Fv(n,n.v):Fv(n,t))}function Gs(n,t){var e=t&&t.sheet?t.sheet:"Sheet1",i={};return i[e]=n,{SheetNames:[e],Sheets:i}}function i_(n,t,e){var i=e||{},s=n?Array.isArray(n):i.dense,l=n||(s?[]:{}),o=0,u=0;if(l&&i.origin!=null){if(typeof i.origin=="number")o=i.origin;else{var f=typeof i.origin=="string"?si(i.origin):i.origin;o=f.r,u=f.c}l["!ref"]||(l["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var p=we(l["!ref"]);d.s.c=p.s.c,d.s.r=p.s.r,d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),o==-1&&(d.e.r=o=p.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=t[m].length;++v)if(!(typeof t[m][v]>"u")){var _={v:t[m][v]},A=o+m,y=u+v;if(d.s.r>A&&(d.s.r=A),d.s.c>y&&(d.s.c=y),d.e.r<A&&(d.e.r=A),d.e.c<y&&(d.e.c=y),t[m][v]&&typeof t[m][v]=="object"&&!Array.isArray(t[m][v])&&!(t[m][v]instanceof Date))_=t[m][v];else if(Array.isArray(_.v)&&(_.f=t[m][v][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(i.nullError)_.t="e",_.v=0;else if(i.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=i.dateNF||ke[14],i.cellDates?(_.t="d",_.w=rs(_.z,ji(_.v))):(_.t="n",_.v=ji(_.v),_.w=rs(_.z,_.v))):_.t="s";if(s)l[A]||(l[A]=[]),l[A][y]&&l[A][y].z&&(_.z=l[A][y].z),l[A][y]=_;else{var E=de({c:y,r:A});l[E]&&l[E].z&&(_.z=l[E].z),l[E]=_}}}return d.s.c<1e7&&(l["!ref"]=qe(d)),l}function Ja(n,t){return i_(null,n,t)}function ES(n){return n.read_shift(4,"i")}function In(n,t){return t||(t=dt(4)),t.write_shift(4,n),t}function wi(n){var t=n.read_shift(4);return t===0?"":n.read_shift(t,"dbcs")}function ai(n,t){var e=!1;return t==null&&(e=!0,t=dt(4+2*n.length)),t.write_shift(4,n.length),n.length>0&&t.write_shift(0,n,"dbcs"),e?t.slice(0,t.l):t}function SS(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function TS(n,t){return t||(t=dt(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Dd(n,t){var e=n.l,i=n.read_shift(1),s=wi(n),l=[],o={t:s,h:s};if((i&1)!==0){for(var u=n.read_shift(4),f=0;f!=u;++f)l.push(SS(n));o.r=l}else o.r=[{ich:0,ifnt:0}];return n.l=e+t,o}function wS(n,t){var e=!1;return t==null&&(e=!0,t=dt(15+4*n.t.length)),t.write_shift(1,0),ai(n.t,t),e?t.slice(0,t.l):t}var bS=Dd;function CS(n,t){var e=!1;return t==null&&(e=!0,t=dt(23+4*n.t.length)),t.write_shift(1,1),ai(n.t,t),t.write_shift(4,1),TS({},t),e?t.slice(0,t.l):t}function bn(n){var t=n.read_shift(4),e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:t,iStyleRef:e}}function Vs(n,t){return t==null&&(t=dt(8)),t.write_shift(-4,n.c),t.write_shift(3,n.iStyleRef||n.s),t.write_shift(1,0),t}function js(n){var t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:t}}function Xs(n,t){return t==null&&(t=dt(4)),t.write_shift(3,n.iStyleRef||n.s),t.write_shift(1,0),t}var RS=wi,n_=ai;function Od(n){var t=n.read_shift(4);return t===0||t===4294967295?"":n.read_shift(t,"dbcs")}function Nu(n,t){var e=!1;return t==null&&(e=!0,t=dt(127)),t.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&t.write_shift(0,n,"dbcs"),e?t.slice(0,t.l):t}var DS=wi,nd=Od,Md=Nu;function r_(n){var t=n.slice(n.l,n.l+4),e=t[0]&1,i=t[0]&2;n.l+=4;var s=i===0?Mu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ms(t,0)>>2;return e?s/100:s}function s_(n,t){t==null&&(t=dt(4));var e=0,i=0,s=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?i=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(i=1,e=1),i)t.write_shift(-4,((e?s:n)<<2)+(e+2));else throw new Error("unsupported RkNumber "+n)}function a_(n){var t={s:{},e:{}};return t.s.r=n.read_shift(4),t.e.r=n.read_shift(4),t.s.c=n.read_shift(4),t.e.c=n.read_shift(4),t}function OS(n,t){return t||(t=dt(16)),t.write_shift(4,n.s.r),t.write_shift(4,n.e.r),t.write_shift(4,n.s.c),t.write_shift(4,n.e.c),t}var Ys=a_,tl=OS;function el(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function Is(n,t){return(t||dt(8)).write_shift(8,n,"f")}function MS(n){var t={},e=n.read_shift(1),i=e>>>1,s=n.read_shift(1),l=n.read_shift(2,"i"),o=n.read_shift(1),u=n.read_shift(1),f=n.read_shift(1);switch(n.l++,i){case 0:t.auto=1;break;case 1:t.index=s;var d=HS[s];d&&(t.rgb=Xv(d));break;case 2:t.rgb=Xv([o,u,f]);break;case 3:t.theme=s;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function Lu(n,t){if(t||(t=dt(8)),!n||n.auto)return t.write_shift(4,0),t.write_shift(4,0),t;n.index!=null?(t.write_shift(1,2),t.write_shift(1,n.index)):n.theme!=null?(t.write_shift(1,6),t.write_shift(1,n.theme)):(t.write_shift(1,5),t.write_shift(1,0));var e=n.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),t.write_shift(2,e),!n.rgb||n.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var i=n.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),t.write_shift(1,parseInt(i.slice(0,2),16)),t.write_shift(1,parseInt(i.slice(2,4),16)),t.write_shift(1,parseInt(i.slice(4,6),16)),t.write_shift(1,255)}return t}function NS(n){var t=n.read_shift(1);n.l++;var e={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return e}function LS(n,t){t||(t=dt(2));var e=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return t.write_shift(1,e),t.write_shift(1,0),t}var l_=2,Ji=3,uu=11,Fu=19,hu=64,FS=65,kS=71,PS=4108,BS=4126,pi=80,kv={1:{n:"CodePage",t:l_},2:{n:"Category",t:pi},3:{n:"PresentationFormat",t:pi},4:{n:"ByteCount",t:Ji},5:{n:"LineCount",t:Ji},6:{n:"ParagraphCount",t:Ji},7:{n:"SlideCount",t:Ji},8:{n:"NoteCount",t:Ji},9:{n:"HiddenCount",t:Ji},10:{n:"MultimediaClipCount",t:Ji},11:{n:"ScaleCrop",t:uu},12:{n:"HeadingPairs",t:PS},13:{n:"TitlesOfParts",t:BS},14:{n:"Manager",t:pi},15:{n:"Company",t:pi},16:{n:"LinksUpToDate",t:uu},17:{n:"CharacterCount",t:Ji},19:{n:"SharedDoc",t:uu},22:{n:"HyperlinksChanged",t:uu},23:{n:"AppVersion",t:Ji,p:"version"},24:{n:"DigSig",t:FS},26:{n:"ContentType",t:pi},27:{n:"ContentStatus",t:pi},28:{n:"Language",t:pi},29:{n:"Version",t:pi},255:{},2147483648:{n:"Locale",t:Fu},2147483651:{n:"Behavior",t:Fu},1919054434:{}},Pv={1:{n:"CodePage",t:l_},2:{n:"Title",t:pi},3:{n:"Subject",t:pi},4:{n:"Author",t:pi},5:{n:"Keywords",t:pi},6:{n:"Comments",t:pi},7:{n:"Template",t:pi},8:{n:"LastAuthor",t:pi},9:{n:"RevNumber",t:pi},10:{n:"EditTime",t:hu},11:{n:"LastPrinted",t:hu},12:{n:"CreatedDate",t:hu},13:{n:"ModifiedDate",t:hu},14:{n:"PageCount",t:Ji},15:{n:"WordCount",t:Ji},16:{n:"CharCount",t:Ji},17:{n:"Thumbnail",t:kS},18:{n:"Application",t:pi},19:{n:"DocSecurity",t:Ji},255:{},2147483648:{n:"Locale",t:Fu},2147483651:{n:"Behavior",t:Fu},1919054434:{}};function IS(n){return n.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var US=IS([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),HS=Xi(US),ko={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},zS={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},fu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function o_(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function c_(n,t){var e=QE(zS),i=[],s;i[i.length]=We,i[i.length]=Rt("Types",null,{xmlns:ri.CT,"xmlns:xsd":ri.xsd,"xmlns:xsi":ri.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Rt("Default",null,{Extension:f[0],ContentType:f[1]})}));var l=function(f){n[f]&&n[f].length>0&&(s=n[f][0],i[i.length]=Rt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:fu[f][t.bookType]||fu[f].xlsx}))},o=function(f){(n[f]||[]).forEach(function(d){i[i.length]=Rt("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:fu[f][t.bookType]||fu[f].xlsx})})},u=function(f){(n[f]||[]).forEach(function(d){i[i.length]=Rt("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:e[f][0]})})};return l("workbooks"),o("sheets"),o("charts"),u("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),o("metadata"),u("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var se={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function u_(n){var t=n.lastIndexOf("/");return n.slice(0,t+1)+"_rels/"+n.slice(t+1)+".rels"}function ja(n){var t=[We,Rt("Relationships",null,{xmlns:ri.RELS})];return yi(n["!id"]).forEach(function(e){t[t.length]=Rt("Relationship",null,n["!id"][e])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function he(n,t,e,i,s,l){if(s||(s={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),t<0)for(t=n["!idx"];n["!id"]["rId"+t];++t);if(n["!idx"]=t+1,s.Id="rId"+t,s.Type=i,s.Target=e,[se.HLINK,se.XPATH,se.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),n["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return n["!id"][s.Id]=s,n[("/"+s.Target).replace("//","/")]=s,t}function GS(n){var t=[We];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<n.length;++e)t.push('  <manifest:file-entry manifest:full-path="'+n[e][0]+'" manifest:media-type="'+n[e][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Bv(n,t,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function VS(n,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function jS(n){var t=[We];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=n.length;++e)t.push(Bv(n[e][0],n[e][1])),t.push(VS("",n[e][0]));return t.push(Bv("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function h_(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+wu.version+"</meta:generator></office:meta></office:document-meta>"}var Ps=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function G0(n,t,e,i,s){s[n]!=null||t==null||t===""||(s[n]=t,t=fe(t),i[i.length]=e?Rt(n,t,e):vi(n,t))}function f_(n,t){var e=t||{},i=[We,Rt("cp:coreProperties",null,{"xmlns:cp":ri.CORE_PROPS,"xmlns:dc":ri.dc,"xmlns:dcterms":ri.dcterms,"xmlns:dcmitype":ri.dcmitype,"xmlns:xsi":ri.xsi})],s={};if(!n&&!e.Props)return i.join("");n&&(n.CreatedDate!=null&&G0("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:id(n.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,s),n.ModifiedDate!=null&&G0("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:id(n.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,s));for(var l=0;l!=Ps.length;++l){var o=Ps[l],u=e.Props&&e.Props[o[1]]!=null?e.Props[o[1]]:n?n[o[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&G0(o[0],u,null,i,s)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var Xa=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],d_=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function p_(n){var t=[],e=Rt;return n||(n={}),n.Application="SheetJS",t[t.length]=We,t[t.length]=Rt("Properties",null,{xmlns:ri.EXT_PROPS,"xmlns:vt":ri.vt}),Xa.forEach(function(i){if(n[i[1]]!==void 0){var s;switch(i[2]){case"string":s=fe(String(n[i[1]]));break;case"bool":s=n[i[1]]?"true":"false";break}s!==void 0&&(t[t.length]=e(i[0],s))}}),t[t.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=e("TitlesOfParts",e("vt:vector",n.SheetNames.map(function(i){return"<vt:lpstr>"+fe(i)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function g_(n){var t=[We,Rt("Properties",null,{xmlns:ri.CUST_PROPS,"xmlns:vt":ri.vt})];if(!n)return t.join("");var e=1;return yi(n).forEach(function(s){++e,t[t.length]=Rt("property",oS(n[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:fe(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Iv={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function XS(n,t){var e=[];return yi(Iv).map(function(i){for(var s=0;s<Ps.length;++s)if(Ps[s][1]==i)return Ps[s];for(s=0;s<Xa.length;++s)if(Xa[s][1]==i)return Xa[s];throw i}).forEach(function(i){if(n[i[1]]!=null){var s=t&&t.Props&&t.Props[i[1]]!=null?t.Props[i[1]]:n[i[1]];switch(i[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),e.push(vi(Iv[i[1]]||i[1],s))}}),Rt("DocumentProperties",e.join(""),{xmlns:rn.o})}function YS(n,t){var e=["Worksheets","SheetNames"],i="CustomDocumentProperties",s=[];return n&&yi(n).forEach(function(l){if(Object.prototype.hasOwnProperty.call(n,l)){for(var o=0;o<Ps.length;++o)if(l==Ps[o][1])return;for(o=0;o<Xa.length;++o)if(l==Xa[o][1])return;for(o=0;o<e.length;++o)if(l==e[o])return;var u=n[l],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u=String(u),s.push(Rt(wv(l),u,{"dt:dt":f}))}}),t&&yi(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)&&!(n&&Object.prototype.hasOwnProperty.call(n,l))){var o=t[l],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o instanceof Date?(u="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Rt(wv(l),o,{"dt:dt":u}))}}),"<"+i+' xmlns="'+rn.o+'">'+s.join("")+"</"+i+">"}function qS(n){var t=typeof n=="string"?new Date(Date.parse(n)):n,e=t.getTime()/1e3+11644473600,i=e%Math.pow(2,32),s=(e-i)/Math.pow(2,32);i*=1e7,s*=1e7;var l=i/Math.pow(2,32)|0;l>0&&(i=i%Math.pow(2,32),s+=l);var o=dt(8);return o.write_shift(4,i),o.write_shift(4,s),o}function Uv(n,t){var e=dt(4),i=dt(4);switch(e.write_shift(4,n==80?31:n),n){case 3:i.write_shift(-4,t);break;case 5:i=dt(8),i.write_shift(8,t,"f");break;case 11:i.write_shift(4,t?1:0);break;case 64:i=qS(t);break;case 31:case 80:for(i=dt(4+2*(t.length+1)+(t.length%2?0:2)),i.write_shift(4,t.length+1),i.write_shift(0,t,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+t)}return mi([e,i])}var m_=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function WS(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function Hv(n,t,e){var i=dt(8),s=[],l=[],o=8,u=0,f=dt(8),d=dt(8);if(f.write_shift(4,2),f.write_shift(4,1200),d.write_shift(4,1),l.push(f),s.push(d),o+=8+f.length,!t){d=dt(8),d.write_shift(4,0),s.unshift(d);var p=[dt(4)];for(p[0].write_shift(4,n.length),u=0;u<n.length;++u){var m=n[u][0];for(f=dt(8+2*(m.length+1)+(m.length%2?0:2)),f.write_shift(4,u+2),f.write_shift(4,m.length+1),f.write_shift(0,m,"dbcs");f.l!=f.length;)f.write_shift(1,0);p.push(f)}f=mi(p),l.unshift(f),o+=8+f.length}for(u=0;u<n.length;++u)if(!(t&&!t[n[u][0]])&&!(m_.indexOf(n[u][0])>-1||d_.indexOf(n[u][0])>-1)&&n[u][1]!=null){var v=n[u][1],_=0;if(t){_=+t[n[u][0]];var A=e[_];if(A.p=="version"&&typeof v=="string"){var y=v.split(".");v=(+y[0]<<16)+(+y[1]||0)}f=Uv(A.t,v)}else{var E=WS(v);E==-1&&(E=31,v=String(v)),f=Uv(E,v)}l.push(f),d=dt(8),d.write_shift(4,t?_:2+u),s.push(d),o+=8+f.length}var T=8*(l.length+1);for(u=0;u<l.length;++u)s[u].write_shift(4,T),T+=l[u].length;return i.write_shift(4,o),i.write_shift(4,l.length),mi([i].concat(s).concat(l))}function zv(n,t,e,i,s,l){var o=dt(s?68:48),u=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,ye.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var f=Hv(n,e,i);if(u.push(f),s){var d=Hv(s,null,null);o.write_shift(16,l,"hex"),o.write_shift(4,68+f.length),u.push(d)}return mi(u)}function $S(n,t){t||(t=dt(n));for(var e=0;e<n;++e)t.write_shift(1,0);return t}function KS(n,t){return n.read_shift(t)===1}function Ni(n,t){return t||(t=dt(2)),t.write_shift(2,+!!n),t}function v_(n){return n.read_shift(2,"u")}function Tn(n,t){return t||(t=dt(2)),t.write_shift(2,n),t}function x_(n,t,e){return e||(e=dt(2)),e.write_shift(1,t=="e"?+n:+!!n),e.write_shift(1,t=="e"?1:0),e}function __(n,t,e){var i=n.read_shift(e&&e.biff>=12?2:1),s="sbcs-cont";if(e&&e.biff>=8,!e||e.biff==8){var l=n.read_shift(1);l&&(s="dbcs-cont")}else e.biff==12&&(s="wstr");e.biff>=2&&e.biff<=5&&(s="cpstr");var o=i?n.read_shift(i,s):"";return o}function QS(n){var t=n.t||"",e=dt(3);e.write_shift(2,t.length),e.write_shift(1,1);var i=dt(2*t.length);i.write_shift(2*t.length,t,"utf16le");var s=[e,i];return mi(s)}function ZS(n,t,e){var i;if(e){if(e.biff>=2&&e.biff<=5)return n.read_shift(t,"cpstr");if(e.biff>=12)return n.read_shift(t,"dbcs-cont")}var s=n.read_shift(1);return s===0?i=n.read_shift(t,"sbcs-cont"):i=n.read_shift(t,"dbcs-cont"),i}function JS(n,t,e){var i=n.read_shift(e&&e.biff==2?1:2);return i===0?(n.l++,""):ZS(n,i,e)}function tT(n,t,e){if(e.biff>5)return JS(n,t,e);var i=n.read_shift(1);return i===0?(n.l++,""):n.read_shift(i,e.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function y_(n,t,e){return e||(e=dt(3+2*n.length)),e.write_shift(2,n.length),e.write_shift(1,1),e.write_shift(31,n,"utf16le"),e}function Gv(n,t){t||(t=dt(6+n.length*2)),t.write_shift(4,1+n.length);for(var e=0;e<n.length;++e)t.write_shift(2,n.charCodeAt(e));return t.write_shift(2,0),t}function eT(n){var t=dt(512),e=0,i=n.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var s=i.indexOf("#"),l=s>-1?31:23;switch(i.charAt(0)){case"#":l=28;break;case".":l&=-3;break}t.write_shift(4,2),t.write_shift(4,l);var o=[8,6815827,6619237,4849780,83];for(e=0;e<o.length;++e)t.write_shift(4,o[e]);if(l==28)i=i.slice(1),Gv(i,t);else if(l&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<o.length;++e)t.write_shift(1,parseInt(o[e],16));var u=s>-1?i.slice(0,s):i;for(t.write_shift(4,2*(u.length+1)),e=0;e<u.length;++e)t.write_shift(2,u.charCodeAt(e));t.write_shift(2,0),l&8&&Gv(s>-1?i.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<o.length;++e)t.write_shift(1,parseInt(o[e],16));for(var f=0;i.slice(f*3,f*3+3)=="../"||i.slice(f*3,f*3+3)=="..\\";)++f;for(t.write_shift(2,f),t.write_shift(4,i.length-3*f+1),e=0;e<i.length-3*f;++e)t.write_shift(1,i.charCodeAt(e+3*f)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),e=0;e<6;++e)t.write_shift(4,0)}return t.slice(0,t.l)}function Us(n,t,e,i){return i||(i=dt(6)),i.write_shift(2,n),i.write_shift(2,t),i.write_shift(2,e||0),i}function iT(n,t,e){var i=e.biff>8?4:2,s=n.read_shift(i),l=n.read_shift(i,"i"),o=n.read_shift(i,"i");return[s,l,o]}function nT(n){var t=n.read_shift(2),e=n.read_shift(2),i=n.read_shift(2),s=n.read_shift(2);return{s:{c:i,r:t},e:{c:s,r:e}}}function A_(n,t){return t||(t=dt(8)),t.write_shift(2,n.s.r),t.write_shift(2,n.e.r),t.write_shift(2,n.s.c),t.write_shift(2,n.e.c),t}function Nd(n,t,e){var i=1536,s=16;switch(e.bookType){case"biff8":break;case"biff5":i=1280,s=8;break;case"biff4":i=4,s=6;break;case"biff3":i=3,s=6;break;case"biff2":i=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=dt(s);return l.write_shift(2,i),l.write_shift(2,t),s>4&&l.write_shift(2,29282),s>6&&l.write_shift(2,1997),s>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function rT(n,t){var e=!t||t.biff==8,i=dt(e?112:54);for(i.write_shift(t.biff==8?2:1,7),e&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(e?0:536870912));i.l<i.length;)i.write_shift(1,e?0:32);return i}function sT(n,t){var e=!t||t.biff>=8?2:1,i=dt(8+e*n.name.length);i.write_shift(4,n.pos),i.write_shift(1,n.hs||0),i.write_shift(1,n.dt),i.write_shift(1,n.name.length),t.biff>=8&&i.write_shift(1,1),i.write_shift(e*n.name.length,n.name,t.biff<8?"sbcs":"utf16le");var s=i.slice(0,i.l);return s.l=i.l,s}function aT(n,t){var e=dt(8);e.write_shift(4,n.Count),e.write_shift(4,n.Unique);for(var i=[],s=0;s<n.length;++s)i[s]=QS(n[s]);var l=mi([e].concat(i));return l.parts=[e.length].concat(i.map(function(o){return o.length})),l}function lT(){var n=dt(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function oT(n){var t=dt(18),e=1718;return n&&n.RTL&&(e|=64),t.write_shift(2,e),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function cT(n,t){var e=n.name||"Arial",i=t&&t.biff==5,s=i?15+e.length:16+2*e.length,l=dt(s);return l.write_shift(2,n.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,e.length),i||l.write_shift(1,1),l.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le"),l}function uT(n,t,e,i){var s=dt(10);return Us(n,t,i,s),s.write_shift(4,e),s}function hT(n,t,e,i,s){var l=!s||s.biff==8,o=dt(8+ +l+(1+l)*e.length);return Us(n,t,i,o),o.write_shift(2,e.length),l&&o.write_shift(1,1),o.write_shift((1+l)*e.length,e,l?"utf16le":"sbcs"),o}function fT(n,t,e,i){var s=e&&e.biff==5;i||(i=dt(s?3+t.length:5+2*t.length)),i.write_shift(2,n),i.write_shift(s?1:2,t.length),s||i.write_shift(1,1),i.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var l=i.length>i.l?i.slice(0,i.l):i;return l.l==null&&(l.l=l.length),l}function dT(n,t){var e=t.biff==8||!t.biff?4:2,i=dt(2*e+6);return i.write_shift(e,n.s.r),i.write_shift(e,n.e.r+1),i.write_shift(2,n.s.c),i.write_shift(2,n.e.c+1),i.write_shift(2,0),i}function Vv(n,t,e,i){var s=e&&e.biff==5;i||(i=dt(s?16:20)),i.write_shift(2,0),n.style?(i.write_shift(2,n.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,n.numFmtId||0),i.write_shift(2,t<<4));var l=0;return n.numFmtId>0&&s&&(l|=1024),i.write_shift(4,l),i.write_shift(4,0),s||i.write_shift(4,0),i.write_shift(2,0),i}function pT(n){var t=dt(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function gT(n,t,e,i,s,l){var o=dt(8);return Us(n,t,i,o),x_(e,l,o),o}function mT(n,t,e,i){var s=dt(14);return Us(n,t,i,s),Is(e,s),s}function vT(n,t,e){if(e.biff<8)return xT(n,t,e);for(var i=[],s=n.l+t,l=n.read_shift(e.biff>8?4:2);l--!==0;)i.push(iT(n,e.biff>8?12:6,e));if(n.l!=s)throw new Error("Bad ExternSheet: "+n.l+" != "+s);return i}function xT(n,t,e){n[n.l+1]==3&&n[n.l]++;var i=__(n,t,e);return i.charCodeAt(0)==3?i.slice(1):i}function _T(n){var t=dt(2+n.length*8);t.write_shift(2,n.length);for(var e=0;e<n.length;++e)A_(n[e],t);return t}function yT(n){var t=dt(24),e=si(n[0]);t.write_shift(2,e.r),t.write_shift(2,e.r),t.write_shift(2,e.c),t.write_shift(2,e.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(i[s],16));return mi([t,eT(n[1])])}function AT(n){var t=n[1].Tooltip,e=dt(10+2*(t.length+1));e.write_shift(2,2048);var i=si(n[0]);e.write_shift(2,i.r),e.write_shift(2,i.r),e.write_shift(2,i.c),e.write_shift(2,i.c);for(var s=0;s<t.length;++s)e.write_shift(2,t.charCodeAt(s));return e.write_shift(2,0),e}function ET(n){return n||(n=dt(4)),n.write_shift(2,1),n.write_shift(2,1),n}function ST(n,t,e){if(!e.cellStyles)return er(n,t);var i=e&&e.biff>=12?4:2,s=n.read_shift(i),l=n.read_shift(i),o=n.read_shift(i),u=n.read_shift(i),f=n.read_shift(2);i==2&&(n.l+=2);var d={s,e:l,w:o,ixfe:u,flags:f};return(e.biff>=5||!e.biff)&&(d.level=f>>8&7),d}function TT(n,t){var e=dt(12);e.write_shift(2,t),e.write_shift(2,t),e.write_shift(2,n.width*256),e.write_shift(2,0);var i=0;return n.hidden&&(i|=1),e.write_shift(1,i),i=n.level||0,e.write_shift(1,i),e.write_shift(2,0),e}function wT(n){for(var t=dt(2*n),e=0;e<n;++e)t.write_shift(2,e+1);return t}function bT(n,t,e){var i=dt(15);return Bo(i,n,t),i.write_shift(8,e,"f"),i}function CT(n,t,e){var i=dt(9);return Bo(i,n,t),i.write_shift(2,e),i}var RT=(function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Ad({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(u,f){var d=[],p=Bs(1);switch(f.type){case"base64":p=Pn(br(u));break;case"binary":p=Pn(u);break;case"buffer":case"array":p=u;break}en(p,0);var m=p.read_shift(1),v=!!(m&136),_=!1,A=!1;switch(m){case 2:break;case 3:break;case 48:_=!0,v=!0;break;case 49:_=!0,v=!0;break;case 131:break;case 139:break;case 140:A=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var y=0,E=521;m==2&&(y=p.read_shift(2)),p.l+=3,m!=2&&(y=p.read_shift(4)),y>1048576&&(y=1e6),m!=2&&(E=p.read_shift(2));var T=p.read_shift(2),b=f.codepage||1252;m!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(b=n[p[p.l]]),p.l+=1,p.l+=2),A&&(p.l+=36);for(var w=[],O={},F=Math.min(p.length,m==2?521:E-10-(_?264:0)),z=A?32:11;p.l<F&&p[p.l]!=13;)switch(O={},O.name=bu.utils.decode(b,p.slice(p.l,p.l+z)).replace(/[\u0000\r\n].*$/g,""),p.l+=z,O.type=String.fromCharCode(p.read_shift(1)),m!=2&&!A&&(O.offset=p.read_shift(4)),O.len=p.read_shift(1),m==2&&(O.offset=p.read_shift(2)),O.dec=p.read_shift(1),O.name.length&&w.push(O),m!=2&&(p.l+=A?13:14),O.type){case"B":(!_||O.len!=8)&&f.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(p[p.l]!==13&&(p.l=E-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=E;var L=0,G=0;for(d[0]=[],G=0;G!=w.length;++G)d[0][G]=w[G].name;for(;y-- >0;){if(p[p.l]===42){p.l+=T;continue}for(++p.l,d[++L]=[],G=0,G=0;G!=w.length;++G){var V=p.slice(p.l,p.l+w[G].len);p.l+=w[G].len,en(V,0);var Q=bu.utils.decode(b,V);switch(w[G].type){case"C":Q.trim().length&&(d[L][G]=Q.replace(/\s+$/,""));break;case"D":Q.length===8?d[L][G]=new Date(+Q.slice(0,4),+Q.slice(4,6)-1,+Q.slice(6,8)):d[L][G]=Q;break;case"F":d[L][G]=parseFloat(Q.trim());break;case"+":case"I":d[L][G]=A?V.read_shift(-4,"i")^2147483648:V.read_shift(4,"i");break;case"L":switch(Q.trim().toUpperCase()){case"Y":case"T":d[L][G]=!0;break;case"N":case"F":d[L][G]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Q+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));d[L][G]="##MEMO##"+(A?parseInt(Q.trim(),10):V.read_shift(4));break;case"N":Q=Q.replace(/\u0000/g,"").trim(),Q&&Q!="."&&(d[L][G]=+Q||0);break;case"@":d[L][G]=new Date(V.read_shift(-8,"f")-621356832e5);break;case"T":d[L][G]=new Date((V.read_shift(4)-2440588)*864e5+V.read_shift(4));break;case"Y":d[L][G]=V.read_shift(4,"i")/1e4+V.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[L][G]=-V.read_shift(-8,"f");break;case"B":if(_&&w[G].len==8){d[L][G]=V.read_shift(8,"f");break}case"G":case"P":V.l+=w[G].len;break;case"0":if(w[G].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[G].type)}}}if(m!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=w,d}function i(u,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var p=Ja(e(u,d),d);return p["!cols"]=d.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete d.DBF,p}function s(u,f){try{return Gs(i(u,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,f){var d=f||{};if(+d.codepage>=0&&Ao(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var p=Vi(),m=Uu(u,{header:1,raw:!0,cellDates:!0}),v=m[0],_=m.slice(1),A=u["!cols"]||[],y=0,E=0,T=0,b=1;for(y=0;y<v.length;++y){if(((A[y]||{}).DBF||{}).name){v[y]=A[y].DBF.name,++T;continue}if(v[y]!=null){if(++T,typeof v[y]=="number"&&(v[y]=v[y].toString(10)),typeof v[y]!="string")throw new Error("DBF Invalid column name "+v[y]+" |"+typeof v[y]+"|");if(v.indexOf(v[y])!==y){for(E=0;E<1024;++E)if(v.indexOf(v[y]+"_"+E)==-1){v[y]+="_"+E;break}}}}var w=we(u["!ref"]),O=[],F=[],z=[];for(y=0;y<=w.e.c-w.s.c;++y){var L="",G="",V=0,Q=[];for(E=0;E<_.length;++E)_[E][y]!=null&&Q.push(_[E][y]);if(Q.length==0||v[y]==null){O[y]="?";continue}for(E=0;E<Q.length;++E){switch(typeof Q[E]){case"number":G="B";break;case"string":G="C";break;case"boolean":G="L";break;case"object":G=Q[E]instanceof Date?"D":"C";break;default:G="C"}V=Math.max(V,String(Q[E]).length),L=L&&L!=G?"C":G}V>250&&(V=250),G=((A[y]||{}).DBF||{}).type,G=="C"&&A[y].DBF.len>V&&(V=A[y].DBF.len),L=="B"&&G=="N"&&(L="N",z[y]=A[y].DBF.dec,V=A[y].DBF.len),F[y]=L=="C"||G=="N"?V:l[L]||0,b+=F[y],O[y]=L}var K=p.next(32);for(K.write_shift(4,318902576),K.write_shift(4,_.length),K.write_shift(2,296+32*T),K.write_shift(2,b),y=0;y<4;++y)K.write_shift(4,0);for(K.write_shift(4,0|(+t[Sx]||3)<<8),y=0,E=0;y<v.length;++y)if(v[y]!=null){var ut=p.next(32),ht=(v[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ut.write_shift(1,ht,"sbcs"),ut.write_shift(1,O[y]=="?"?"C":O[y],"sbcs"),ut.write_shift(4,E),ut.write_shift(1,F[y]||l[O[y]]||0),ut.write_shift(1,z[y]||0),ut.write_shift(1,2),ut.write_shift(4,0),ut.write_shift(1,0),ut.write_shift(4,0),ut.write_shift(4,0),E+=F[y]||l[O[y]]||0}var bt=p.next(264);for(bt.write_shift(4,13),y=0;y<65;++y)bt.write_shift(4,0);for(y=0;y<_.length;++y){var Et=p.next(b);for(Et.write_shift(1,0),E=0;E<v.length;++E)if(v[E]!=null)switch(O[E]){case"L":Et.write_shift(1,_[y][E]==null?63:_[y][E]?84:70);break;case"B":Et.write_shift(8,_[y][E]||0,"f");break;case"N":var Y="0";for(typeof _[y][E]=="number"&&(Y=_[y][E].toFixed(z[E]||0)),T=0;T<F[E]-Y.length;++T)Et.write_shift(1,32);Et.write_shift(1,Y,"sbcs");break;case"D":_[y][E]?(Et.write_shift(4,("0000"+_[y][E].getFullYear()).slice(-4),"sbcs"),Et.write_shift(2,("00"+(_[y][E].getMonth()+1)).slice(-2),"sbcs"),Et.write_shift(2,("00"+_[y][E].getDate()).slice(-2),"sbcs")):Et.write_shift(8,"00000000","sbcs");break;case"C":var nt=String(_[y][E]!=null?_[y][E]:"").slice(0,F[E]);for(Et.write_shift(1,nt,"sbcs"),T=0;T<F[E]-nt.length;++T)Et.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:s,to_sheet:i,from_sheet:o}})(),DT=(function(){var n={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+yi(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(v,_){var A=n[_];return typeof A=="number"?dv(A):A},i=function(v,_,A){var y=_.charCodeAt(0)-32<<4|A.charCodeAt(0)-48;return y==59?v:dv(y)};n["|"]=254;function s(v,_){switch(_.type){case"base64":return l(br(v),_);case"binary":return l(v,_);case"buffer":return l(le&&Buffer.isBuffer(v)?v.toString("binary"):No(v),_);case"array":return l(Wu(v),_)}throw new Error("Unrecognized type "+_.type)}function l(v,_){var A=v.split(/[\n\r]+/),y=-1,E=-1,T=0,b=0,w=[],O=[],F=null,z={},L=[],G=[],V=[],Q=0,K;for(+_.codepage>=0&&Ao(+_.codepage);T!==A.length;++T){Q=0;var ut=A[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(t,e),ht=ut.replace(/;;/g,"\0").split(";").map(function(j){return j.replace(/\u0000/g,";")}),bt=ht[0],Et;if(ut.length>0)switch(bt){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ht[1].charAt(0)=="P"&&O.push(ut.slice(3).replace(/;;/g,";"));break;case"C":var Y=!1,nt=!1,Tt=!1,st=!1,M=-1,q=-1;for(b=1;b<ht.length;++b)switch(ht[b].charAt(0)){case"A":break;case"X":E=parseInt(ht[b].slice(1))-1,nt=!0;break;case"Y":for(y=parseInt(ht[b].slice(1))-1,nt||(E=0),K=w.length;K<=y;++K)w[K]=[];break;case"K":Et=ht[b].slice(1),Et.charAt(0)==='"'?Et=Et.slice(1,Et.length-1):Et==="TRUE"?Et=!0:Et==="FALSE"?Et=!1:isNaN(Tr(Et))?isNaN(So(Et).getDate())||(Et=Fi(Et)):(Et=Tr(Et),F!==null&&kx(F)&&(Et=Ux(Et))),Y=!0;break;case"E":st=!0;var D=Cw(ht[b].slice(1),{r:y,c:E});w[y][E]=[w[y][E],D];break;case"S":Tt=!0,w[y][E]=[w[y][E],"S5S"];break;case"G":break;case"R":M=parseInt(ht[b].slice(1))-1;break;case"C":q=parseInt(ht[b].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+ut)}if(Y&&(w[y][E]&&w[y][E].length==2?w[y][E][0]=Et:w[y][E]=Et,F=null),Tt){if(st)throw new Error("SYLK shared formula cannot have own formula");var k=M>-1&&w[M][q];if(!k||!k[1])throw new Error("SYLK shared formula cannot find base");w[y][E][1]=Rw(k[1],{r:y-M,c:E-q})}break;case"F":var U=0;for(b=1;b<ht.length;++b)switch(ht[b].charAt(0)){case"X":E=parseInt(ht[b].slice(1))-1,++U;break;case"Y":for(y=parseInt(ht[b].slice(1))-1,K=w.length;K<=y;++K)w[K]=[];break;case"M":Q=parseInt(ht[b].slice(1))/20;break;case"F":break;case"G":break;case"P":F=O[parseInt(ht[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(V=ht[b].slice(1).split(" "),K=parseInt(V[0],10);K<=parseInt(V[1],10);++K)Q=parseInt(V[2],10),G[K-1]=Q===0?{hidden:!0}:{wch:Q},Ld(G[K-1]);break;case"C":E=parseInt(ht[b].slice(1))-1,G[E]||(G[E]={});break;case"R":y=parseInt(ht[b].slice(1))-1,L[y]||(L[y]={}),Q>0?(L[y].hpt=Q,L[y].hpx=b_(Q)):Q===0&&(L[y].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+ut)}U<1&&(F=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+ut)}}return L.length>0&&(z["!rows"]=L),G.length>0&&(z["!cols"]=G),_&&_.sheetRows&&(w=w.slice(0,_.sheetRows)),[w,z]}function o(v,_){var A=s(v,_),y=A[0],E=A[1],T=Ja(y,_);return yi(E).forEach(function(b){T[b]=E[b]}),T}function u(v,_){return Gs(o(v,_),_)}function f(v,_,A,y){var E="C;Y"+(A+1)+";X"+(y+1)+";K";switch(v.t){case"n":E+=v.v||0,v.f&&!v.F&&(E+=";E"+kd(v.f,{r:A,c:y}));break;case"b":E+=v.v?"TRUE":"FALSE";break;case"e":E+=v.w||v.v;break;case"d":E+='"'+(v.w||v.v)+'"';break;case"s":E+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function d(v,_){_.forEach(function(A,y){var E="F;W"+(y+1)+" "+(y+1)+" ";A.hidden?E+="0":(typeof A.width=="number"&&!A.wpx&&(A.wpx=ku(A.width)),typeof A.wpx=="number"&&!A.wch&&(A.wch=Pu(A.wpx)),typeof A.wch=="number"&&(E+=Math.round(A.wch))),E.charAt(E.length-1)!=" "&&v.push(E)})}function p(v,_){_.forEach(function(A,y){var E="F;";A.hidden?E+="M0;":A.hpt?E+="M"+20*A.hpt+";":A.hpx&&(E+="M"+20*Bu(A.hpx)+";"),E.length>2&&v.push(E+"R"+(y+1))})}function m(v,_){var A=["ID;PWXL;N;E"],y=[],E=we(v["!ref"]),T,b=Array.isArray(v),w=`\r
`;A.push("P;PGeneral"),A.push("F;P0;DG0G8;M255"),v["!cols"]&&d(A,v["!cols"]),v["!rows"]&&p(A,v["!rows"]),A.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var O=E.s.r;O<=E.e.r;++O)for(var F=E.s.c;F<=E.e.c;++F){var z=de({r:O,c:F});T=b?(v[O]||[])[F]:v[z],!(!T||T.v==null&&(!T.f||T.F))&&y.push(f(T,v,O,F))}return A.join(w)+w+y.join(w)+w+"E"+w}return{to_workbook:u,to_sheet:o,from_sheet:m}})(),OT=(function(){function n(l,o){switch(o.type){case"base64":return t(br(l),o);case"binary":return t(l,o);case"buffer":return t(le&&Buffer.isBuffer(l)?l.toString("binary"):No(l),o);case"array":return t(Wu(l),o)}throw new Error("Unrecognized type "+o.type)}function t(l,o){for(var u=l.split(`
`),f=-1,d=-1,p=0,m=[];p!==u.length;++p){if(u[p].trim()==="BOT"){m[++f]=[],d=0;continue}if(!(f<0)){var v=u[p].trim().split(","),_=v[0],A=v[1];++p;for(var y=u[p]||"";(y.match(/["]/g)||[]).length&1&&p<u.length-1;)y+=`
`+u[++p];switch(y=y.trim(),+_){case-1:if(y==="BOT"){m[++f]=[],d=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?m[f][d]=!0:y==="FALSE"?m[f][d]=!1:isNaN(Tr(A))?isNaN(So(A).getDate())?m[f][d]=A:m[f][d]=Fi(A):m[f][d]=Tr(A),++d;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),m[f][d++]=y!==""?y:null;break}if(y==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function e(l,o){return Ja(n(l,o),o)}function i(l,o){return Gs(e(l,o),o)}var s=(function(){var l=function(f,d,p,m,v){f.push(d),f.push(p+","+m),f.push('"'+v.replace(/"/g,'""')+'"')},o=function(f,d,p,m){f.push(d+","+p),f.push(d==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(f){var d=[],p=we(f["!ref"]),m,v=Array.isArray(f);l(d,"TABLE",0,1,"sheetjs"),l(d,"VECTORS",0,p.e.r-p.s.r+1,""),l(d,"TUPLES",0,p.e.c-p.s.c+1,""),l(d,"DATA",0,0,"");for(var _=p.s.r;_<=p.e.r;++_){o(d,-1,0,"BOT");for(var A=p.s.c;A<=p.e.c;++A){var y=de({r:_,c:A});if(m=v?(f[_]||[])[A]:f[y],!m){o(d,1,0,"");continue}switch(m.t){case"n":var E=m.w;!E&&m.v!=null&&(E=m.v),E==null?m.f&&!m.F?o(d,1,0,"="+m.f):o(d,1,0,""):o(d,0,E,"V");break;case"b":o(d,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=rs(m.z||ke[14],ji(Fi(m.v)))),o(d,0,m.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var T=`\r
`,b=d.join(T);return b}})();return{to_workbook:i,to_sheet:e,from_sheet:s}})(),E_=(function(){function n(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(m,v){for(var _=m.split(`
`),A=-1,y=-1,E=0,T=[];E!==_.length;++E){var b=_[E].trim().split(":");if(b[0]==="cell"){var w=si(b[1]);if(T.length<=w.r)for(A=T.length;A<=w.r;++A)T[A]||(T[A]=[]);switch(A=w.r,y=w.c,b[2]){case"t":T[A][y]=n(b[3]);break;case"v":T[A][y]=+b[3];break;case"vtf":var O=b[b.length-1];case"vtc":switch(b[3]){case"nl":T[A][y]=!!+b[4];break;default:T[A][y]=+b[4];break}b[2]=="vtf"&&(T[A][y]=[T[A][y],O])}}}return v&&v.sheetRows&&(T=T.slice(0,v.sheetRows)),T}function i(m,v){return Ja(e(m,v),v)}function s(m,v){return Gs(i(m,v),v)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(m){if(!m||!m["!ref"])return"";for(var v=[],_=[],A,y="",E=an(m["!ref"]),T=Array.isArray(m),b=E.s.r;b<=E.e.r;++b)for(var w=E.s.c;w<=E.e.c;++w)if(y=de({r:b,c:w}),A=T?(m[b]||[])[w]:m[y],!(!A||A.v==null||A.t==="z")){switch(_=["cell",y,"t"],A.t){case"s":case"str":_.push(t(A.v));break;case"n":A.f?(_[2]="vtf",_[3]="n",_[4]=A.v,_[5]=t(A.f)):(_[2]="v",_[3]=A.v);break;case"b":_[2]="vt"+(A.f?"f":"c"),_[3]="nl",_[4]=A.v?"1":"0",_[5]=t(A.f||(A.v?"TRUE":"FALSE"));break;case"d":var O=ji(Fi(A.v));_[2]="vtc",_[3]="nd",_[4]=""+O,_[5]=A.w||rs(A.z||ke[14],O);break;case"e":continue}v.push(_.join(":"))}return v.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function p(m){return[l,o,u,o,d(m),f].join(`
`)}return{to_workbook:s,to_sheet:i,from_sheet:p}})(),MT=(function(){function n(p,m,v,_,A){A.raw?m[v][_]=p:p===""||(p==="TRUE"?m[v][_]=!0:p==="FALSE"?m[v][_]=!1:isNaN(Tr(p))?isNaN(So(p).getDate())?m[v][_]=p:m[v][_]=Fi(p):m[v][_]=Tr(p))}function t(p,m){var v=m||{},_=[];if(!p||p.length===0)return _;for(var A=p.split(/[\r\n]/),y=A.length-1;y>=0&&A[y].length===0;)--y;for(var E=10,T=0,b=0;b<=y;++b)T=A[b].indexOf(" "),T==-1?T=A[b].length:T++,E=Math.max(E,T);for(b=0;b<=y;++b){_[b]=[];var w=0;for(n(A[b].slice(0,E).trim(),_,b,w,v),w=1;w<=(A[b].length-E)/10+1;++w)n(A[b].slice(E+(w-1)*10,E+w*10).trim(),_,b,w,v)}return v.sheetRows&&(_=_.slice(0,v.sheetRows)),_}var e={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function s(p){for(var m={},v=!1,_=0,A=0;_<p.length;++_)(A=p.charCodeAt(_))==34?v=!v:!v&&A in e&&(m[A]=(m[A]||0)+1);A=[];for(_ in m)Object.prototype.hasOwnProperty.call(m,_)&&A.push([m[_],_]);if(!A.length){m=i;for(_ in m)Object.prototype.hasOwnProperty.call(m,_)&&A.push([m[_],_])}return A.sort(function(y,E){return y[0]-E[0]||i[y[1]]-i[E[1]]}),e[A.pop()[1]]||44}function l(p,m){var v=m||{},_="",A=v.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(_=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(_=p.charAt(4),p=p.slice(6)):_=s(p.slice(0,1024)):v&&v.FS?_=v.FS:_=s(p.slice(0,1024));var E=0,T=0,b=0,w=0,O=0,F=_.charCodeAt(0),z=!1,L=0,G=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var V=v.dateNF!=null?qE(v.dateNF):null;function Q(){var K=p.slice(w,O),ut={};if(K.charAt(0)=='"'&&K.charAt(K.length-1)=='"'&&(K=K.slice(1,-1).replace(/""/g,'"')),K.length===0)ut.t="z";else if(v.raw)ut.t="s",ut.v=K;else if(K.trim().length===0)ut.t="s",ut.v=K;else if(K.charCodeAt(0)==61)K.charCodeAt(1)==34&&K.charCodeAt(K.length-1)==34?(ut.t="s",ut.v=K.slice(2,-1).replace(/""/g,'"')):Dw(K)?(ut.t="n",ut.f=K.slice(1)):(ut.t="s",ut.v=K);else if(K=="TRUE")ut.t="b",ut.v=!0;else if(K=="FALSE")ut.t="b",ut.v=!1;else if(!isNaN(b=Tr(K)))ut.t="n",v.cellText!==!1&&(ut.w=K),ut.v=b;else if(!isNaN(So(K).getDate())||V&&K.match(V)){ut.z=v.dateNF||ke[14];var ht=0;V&&K.match(V)&&(K=WE(K,v.dateNF,K.match(V)||[]),ht=1),v.cellDates?(ut.t="d",ut.v=Fi(K,ht)):(ut.t="n",ut.v=ji(Fi(K,ht))),v.cellText!==!1&&(ut.w=rs(ut.z,ut.v instanceof Date?ji(ut.v):ut.v)),v.cellNF||delete ut.z}else ut.t="s",ut.v=K;if(ut.t=="z"||(v.dense?(A[E]||(A[E]=[]),A[E][T]=ut):A[de({c:T,r:E})]=ut),w=O+1,G=p.charCodeAt(w),y.e.c<T&&(y.e.c=T),y.e.r<E&&(y.e.r=E),L==F)++T;else if(T=0,++E,v.sheetRows&&v.sheetRows<=E)return!0}t:for(;O<p.length;++O)switch(L=p.charCodeAt(O)){case 34:G===34&&(z=!z);break;case F:case 10:case 13:if(!z&&Q())break t;break}return O-w>0&&Q(),A["!ref"]=qe(y),A}function o(p,m){return!(m&&m.PRN)||m.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?l(p,m):Ja(t(p,m),m)}function u(p,m){var v="",_=m.type=="string"?[0,0,0,0]:VR(p,m);switch(m.type){case"base64":v=br(p);break;case"binary":v=p;break;case"buffer":m.codepage==65001?v=p.toString("utf8"):m.codepage&&typeof bu<"u"||(v=le&&Buffer.isBuffer(p)?p.toString("binary"):No(p));break;case"array":v=Wu(p);break;case"string":v=p;break;default:throw new Error("Unrecognized type "+m.type)}return _[0]==239&&_[1]==187&&_[2]==191?v=go(v.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?v=go(v):m.type=="binary"&&typeof bu<"u",v.slice(0,19)=="socialcalc:version:"?E_.to_sheet(m.type=="string"?v:go(v),m):o(v,m)}function f(p,m){return Gs(u(p,m),m)}function d(p){for(var m=[],v=we(p["!ref"]),_,A=Array.isArray(p),y=v.s.r;y<=v.e.r;++y){for(var E=[],T=v.s.c;T<=v.e.c;++T){var b=de({r:y,c:T});if(_=A?(p[y]||[])[T]:p[b],!_||_.v==null){E.push("          ");continue}for(var w=(_.w||(Cr(_),_.w)||"").slice(0,10);w.length<10;)w+=" ";E.push(w+(T===0?" ":""))}m.push(E.join(""))}return m.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:d}})(),jv=(function(){function n(D,k,U){if(D){en(D,D.l||0);for(var j=U.Enum||M;D.l<D.length;){var J=D.read_shift(2),_t=j[J]||j[65535],At=D.read_shift(2),vt=D.l+At,gt=_t.f&&_t.f(D,At,U);if(D.l=vt,k(gt,_t,J))return}}}function t(D,k){switch(k.type){case"base64":return e(Pn(br(D)),k);case"binary":return e(Pn(D),k);case"buffer":case"array":return e(D,k)}throw"Unsupported type "+k.type}function e(D,k){if(!D)return D;var U=k||{},j=U.dense?[]:{},J="Sheet1",_t="",At=0,vt={},gt=[],Pt=[],It={s:{r:0,c:0},e:{r:0,c:0}},ee=U.sheetRows||0;if(D[2]==0&&(D[3]==8||D[3]==9)&&D.length>=16&&D[14]==5&&D[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(D[2]==2)U.Enum=M,n(D,function(Ot,ki,on){switch(on){case 0:U.vers=Ot,Ot>=4096&&(U.qpro=!0);break;case 6:It=Ot;break;case 204:Ot&&(_t=Ot);break;case 222:_t=Ot;break;case 15:case 51:U.qpro||(Ot[1].v=Ot[1].v.slice(1));case 13:case 14:case 16:on==14&&(Ot[2]&112)==112&&(Ot[2]&15)>1&&(Ot[2]&15)<15&&(Ot[1].z=U.dateNF||ke[14],U.cellDates&&(Ot[1].t="d",Ot[1].v=Ux(Ot[1].v))),U.qpro&&Ot[3]>At&&(j["!ref"]=qe(It),vt[J]=j,gt.push(J),j=U.dense?[]:{},It={s:{r:0,c:0},e:{r:0,c:0}},At=Ot[3],J=_t||"Sheet"+(At+1),_t="");var Un=U.dense?(j[Ot[0].r]||[])[Ot[0].c]:j[de(Ot[0])];if(Un){Un.t=Ot[1].t,Un.v=Ot[1].v,Ot[1].z!=null&&(Un.z=Ot[1].z),Ot[1].f!=null&&(Un.f=Ot[1].f);break}U.dense?(j[Ot[0].r]||(j[Ot[0].r]=[]),j[Ot[0].r][Ot[0].c]=Ot[1]):j[de(Ot[0])]=Ot[1];break}},U);else if(D[2]==26||D[2]==14)U.Enum=q,D[2]==14&&(U.qpro=!0,D.l=0),n(D,function(Ot,ki,on){switch(on){case 204:J=Ot;break;case 22:Ot[1].v=Ot[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ot[3]>At&&(j["!ref"]=qe(It),vt[J]=j,gt.push(J),j=U.dense?[]:{},It={s:{r:0,c:0},e:{r:0,c:0}},At=Ot[3],J="Sheet"+(At+1)),ee>0&&Ot[0].r>=ee)break;U.dense?(j[Ot[0].r]||(j[Ot[0].r]=[]),j[Ot[0].r][Ot[0].c]=Ot[1]):j[de(Ot[0])]=Ot[1],It.e.c<Ot[0].c&&(It.e.c=Ot[0].c),It.e.r<Ot[0].r&&(It.e.r=Ot[0].r);break;case 27:Ot[14e3]&&(Pt[Ot[14e3][0]]=Ot[14e3][1]);break;case 1537:Pt[Ot[0]]=Ot[1],Ot[0]==At&&(J=Ot[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+D[2]);if(j["!ref"]=qe(It),vt[_t||J]=j,gt.push(_t||J),!Pt.length)return{SheetNames:gt,Sheets:vt};for(var jt={},ln=[],pe=0;pe<Pt.length;++pe)vt[gt[pe]]?(ln.push(Pt[pe]||gt[pe]),jt[Pt[pe]]=vt[Pt[pe]]||vt[gt[pe]]):(ln.push(Pt[pe]),jt[Pt[pe]]={"!ref":"A1"});return{SheetNames:ln,Sheets:jt}}function i(D,k){var U=k||{};if(+U.codepage>=0&&Ao(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var j=Vi(),J=we(D["!ref"]),_t=Array.isArray(D),At=[];Dt(j,0,l(1030)),Dt(j,6,f(J));for(var vt=Math.min(J.e.r,8191),gt=J.s.r;gt<=vt;++gt)for(var Pt=xi(gt),It=J.s.c;It<=J.e.c;++It){gt===J.s.r&&(At[It]=Ti(It));var ee=At[It]+Pt,jt=_t?(D[gt]||[])[It]:D[ee];if(!(!jt||jt.t=="z"))if(jt.t=="n")(jt.v|0)==jt.v&&jt.v>=-32768&&jt.v<=32767?Dt(j,13,_(gt,It,jt.v)):Dt(j,14,y(gt,It,jt.v));else{var ln=Cr(jt);Dt(j,15,m(gt,It,ln.slice(0,239)))}}return Dt(j,1),j.end()}function s(D,k){var U=k||{};if(+U.codepage>=0&&Ao(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var j=Vi();Dt(j,0,o(D));for(var J=0,_t=0;J<D.SheetNames.length;++J)(D.Sheets[D.SheetNames[J]]||{})["!ref"]&&Dt(j,27,st(D.SheetNames[J],_t++));var At=0;for(J=0;J<D.SheetNames.length;++J){var vt=D.Sheets[D.SheetNames[J]];if(!(!vt||!vt["!ref"])){for(var gt=we(vt["!ref"]),Pt=Array.isArray(vt),It=[],ee=Math.min(gt.e.r,8191),jt=gt.s.r;jt<=ee;++jt)for(var ln=xi(jt),pe=gt.s.c;pe<=gt.e.c;++pe){jt===gt.s.r&&(It[pe]=Ti(pe));var Ot=It[pe]+ln,ki=Pt?(vt[jt]||[])[pe]:vt[Ot];if(!(!ki||ki.t=="z"))if(ki.t=="n")Dt(j,23,Q(jt,pe,At,ki.v));else{var on=Cr(ki);Dt(j,22,L(jt,pe,At,on.slice(0,239)))}}++At}}return Dt(j,1),j.end()}function l(D){var k=dt(2);return k.write_shift(2,D),k}function o(D){var k=dt(26);k.write_shift(2,4096),k.write_shift(2,4),k.write_shift(4,0);for(var U=0,j=0,J=0,_t=0;_t<D.SheetNames.length;++_t){var At=D.SheetNames[_t],vt=D.Sheets[At];if(!(!vt||!vt["!ref"])){++J;var gt=an(vt["!ref"]);U<gt.e.r&&(U=gt.e.r),j<gt.e.c&&(j=gt.e.c)}}return U>8191&&(U=8191),k.write_shift(2,U),k.write_shift(1,J),k.write_shift(1,j),k.write_shift(2,0),k.write_shift(2,0),k.write_shift(1,1),k.write_shift(1,2),k.write_shift(4,0),k.write_shift(4,0),k}function u(D,k,U){var j={s:{c:0,r:0},e:{c:0,r:0}};return k==8&&U.qpro?(j.s.c=D.read_shift(1),D.l++,j.s.r=D.read_shift(2),j.e.c=D.read_shift(1),D.l++,j.e.r=D.read_shift(2),j):(j.s.c=D.read_shift(2),j.s.r=D.read_shift(2),k==12&&U.qpro&&(D.l+=2),j.e.c=D.read_shift(2),j.e.r=D.read_shift(2),k==12&&U.qpro&&(D.l+=2),j.s.c==65535&&(j.s.c=j.e.c=j.s.r=j.e.r=0),j)}function f(D){var k=dt(8);return k.write_shift(2,D.s.c),k.write_shift(2,D.s.r),k.write_shift(2,D.e.c),k.write_shift(2,D.e.r),k}function d(D,k,U){var j=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(j[0].c=D.read_shift(1),j[3]=D.read_shift(1),j[0].r=D.read_shift(2),D.l+=2):(j[2]=D.read_shift(1),j[0].c=D.read_shift(2),j[0].r=D.read_shift(2)),j}function p(D,k,U){var j=D.l+k,J=d(D,k,U);if(J[1].t="s",U.vers==20768){D.l++;var _t=D.read_shift(1);return J[1].v=D.read_shift(_t,"utf8"),J}return U.qpro&&D.l++,J[1].v=D.read_shift(j-D.l,"cstr"),J}function m(D,k,U){var j=dt(7+U.length);j.write_shift(1,255),j.write_shift(2,k),j.write_shift(2,D),j.write_shift(1,39);for(var J=0;J<j.length;++J){var _t=U.charCodeAt(J);j.write_shift(1,_t>=128?95:_t)}return j.write_shift(1,0),j}function v(D,k,U){var j=d(D,k,U);return j[1].v=D.read_shift(2,"i"),j}function _(D,k,U){var j=dt(7);return j.write_shift(1,255),j.write_shift(2,k),j.write_shift(2,D),j.write_shift(2,U,"i"),j}function A(D,k,U){var j=d(D,k,U);return j[1].v=D.read_shift(8,"f"),j}function y(D,k,U){var j=dt(13);return j.write_shift(1,255),j.write_shift(2,k),j.write_shift(2,D),j.write_shift(8,U,"f"),j}function E(D,k,U){var j=D.l+k,J=d(D,k,U);if(J[1].v=D.read_shift(8,"f"),U.qpro)D.l=j;else{var _t=D.read_shift(2);O(D.slice(D.l,D.l+_t),J),D.l+=_t}return J}function T(D,k,U){var j=k&32768;return k&=-32769,k=(j?D:0)+(k>=8192?k-16384:k),(j?"":"$")+(U?Ti(k):xi(k))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(D,k){en(D,0);for(var U=[],j=0,J="",_t="",At="",vt="";D.l<D.length;){var gt=D[D.l++];switch(gt){case 0:U.push(D.read_shift(8,"f"));break;case 1:_t=T(k[0].c,D.read_shift(2),!0),J=T(k[0].r,D.read_shift(2),!1),U.push(_t+J);break;case 2:{var Pt=T(k[0].c,D.read_shift(2),!0),It=T(k[0].r,D.read_shift(2),!1);_t=T(k[0].c,D.read_shift(2),!0),J=T(k[0].r,D.read_shift(2),!1),U.push(Pt+It+":"+_t+J)}break;case 3:if(D.l<D.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(D.read_shift(2));break;case 6:{for(var ee="";gt=D[D.l++];)ee+=String.fromCharCode(gt);U.push('"'+ee.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:vt=U.pop(),At=U.pop(),U.push(["AND","OR"][gt-20]+"("+At+","+vt+")");break;default:if(gt<32&&w[gt])vt=U.pop(),At=U.pop(),U.push(At+w[gt]+vt);else if(b[gt]){if(j=b[gt][1],j==69&&(j=D[D.l++]),j>U.length){console.error("WK1 bad formula parse 0x"+gt.toString(16)+":|"+U.join("|")+"|");return}var jt=U.slice(-j);U.length-=j,U.push(b[gt][0]+"("+jt.join(",")+")")}else return gt<=7?console.error("WK1 invalid opcode "+gt.toString(16)):gt<=24?console.error("WK1 unsupported op "+gt.toString(16)):gt<=30?console.error("WK1 invalid opcode "+gt.toString(16)):gt<=115?console.error("WK1 unsupported function opcode "+gt.toString(16)):console.error("WK1 unrecognized opcode "+gt.toString(16))}}U.length==1?k[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function F(D){var k=[{c:0,r:0},{t:"n",v:0},0];return k[0].r=D.read_shift(2),k[3]=D[D.l++],k[0].c=D[D.l++],k}function z(D,k){var U=F(D);return U[1].t="s",U[1].v=D.read_shift(k-4,"cstr"),U}function L(D,k,U,j){var J=dt(6+j.length);J.write_shift(2,D),J.write_shift(1,U),J.write_shift(1,k),J.write_shift(1,39);for(var _t=0;_t<j.length;++_t){var At=j.charCodeAt(_t);J.write_shift(1,At>=128?95:At)}return J.write_shift(1,0),J}function G(D,k){var U=F(D);U[1].v=D.read_shift(2);var j=U[1].v>>1;if(U[1].v&1)switch(j&7){case 0:j=(j>>3)*5e3;break;case 1:j=(j>>3)*500;break;case 2:j=(j>>3)/20;break;case 3:j=(j>>3)/200;break;case 4:j=(j>>3)/2e3;break;case 5:j=(j>>3)/2e4;break;case 6:j=(j>>3)/16;break;case 7:j=(j>>3)/64;break}return U[1].v=j,U}function V(D,k){var U=F(D),j=D.read_shift(4),J=D.read_shift(4),_t=D.read_shift(2);if(_t==65535)return j===0&&J===3221225472?(U[1].t="e",U[1].v=15):j===0&&J===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var At=_t&32768;return _t=(_t&32767)-16446,U[1].v=(1-At*2)*(J*Math.pow(2,_t+32)+j*Math.pow(2,_t)),U}function Q(D,k,U,j){var J=dt(14);if(J.write_shift(2,D),J.write_shift(1,U),J.write_shift(1,k),j==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var _t=0,At=0,vt=0,gt=0;return j<0&&(_t=1,j=-j),At=Math.log2(j)|0,j/=Math.pow(2,At-31),gt=j>>>0,(gt&2147483648)==0&&(j/=2,++At,gt=j>>>0),j-=gt,gt|=2147483648,gt>>>=0,j*=Math.pow(2,32),vt=j>>>0,J.write_shift(4,vt),J.write_shift(4,gt),At+=16383+(_t?32768:0),J.write_shift(2,At),J}function K(D,k){var U=V(D);return D.l+=k-14,U}function ut(D,k){var U=F(D),j=D.read_shift(4);return U[1].v=j>>6,U}function ht(D,k){var U=F(D),j=D.read_shift(8,"f");return U[1].v=j,U}function bt(D,k){var U=ht(D);return D.l+=k-10,U}function Et(D,k){return D[D.l+k-1]==0?D.read_shift(k,"cstr"):""}function Y(D,k){var U=D[D.l++];U>k-1&&(U=k-1);for(var j="";j.length<U;)j+=String.fromCharCode(D[D.l++]);return j}function nt(D,k,U){if(!(!U.qpro||k<21)){var j=D.read_shift(1);D.l+=17,D.l+=1,D.l+=2;var J=D.read_shift(k-21,"cstr");return[j,J]}}function Tt(D,k){for(var U={},j=D.l+k;D.l<j;){var J=D.read_shift(2);if(J==14e3){for(U[J]=[0,""],U[J][0]=D.read_shift(2);D[D.l];)U[J][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return U}function st(D,k){var U=dt(5+D.length);U.write_shift(2,14e3),U.write_shift(2,k);for(var j=0;j<D.length;++j){var J=D.charCodeAt(j);U[U.l++]=J>127?95:J}return U[U.l++]=0,U}var M={0:{n:"BOF",f:v_},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:A},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Et},222:{n:"SHEETNAMELP",f:Y},65535:{n:""}},q={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:z},23:{n:"NUMBER17",f:V},24:{n:"NUMBER18",f:G},25:{n:"FORMULA19",f:K},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Tt},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ut},38:{n:"??"},39:{n:"NUMBER27",f:ht},40:{n:"FORMULA28",f:bt},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Et},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:nt},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:s,to_workbook:t}})(),NT=/^\s|\s$|[\t\n\r]/;function S_(n,t){if(!t.bookSST)return"";var e=[We];e[e.length]=Rt("sst",null,{xmlns:Za[0],count:n.Count,uniqueCount:n.Unique});for(var i=0;i!=n.length;++i)if(n[i]!=null){var s=n[i],l="<si>";s.r?l+=s.r:(l+="<t",s.t||(s.t=""),s.t.match(NT)&&(l+=' xml:space="preserve"'),l+=">"+fe(s.t)+"</t>"),l+="</si>",e[e.length]=l}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function LT(n){return[n.read_shift(4),n.read_shift(4)]}function FT(n,t){return t||(t=dt(8)),t.write_shift(4,n.Count),t.write_shift(4,n.Unique),t}var kT=wS;function PT(n){var t=Vi();yt(t,159,FT(n));for(var e=0;e<n.length;++e)yt(t,19,kT(n[e]));return yt(t,160),t.end()}function BT(n){for(var t=[],e=n.split(""),i=0;i<e.length;++i)t[i]=e[i].charCodeAt(0);return t}function T_(n){var t=0,e,i=BT(n),s=i.length+1,l,o,u,f,d;for(e=Bs(s),e[0]=i.length,l=1;l!=s;++l)e[l]=i[l-1];for(l=s-1;l>=0;--l)o=e[l],u=(t&16384)===0?0:1,f=t<<1&32767,d=u|f,t=d^o;return t^52811}var IT=(function(){function n(s,l){switch(l.type){case"base64":return t(br(s),l);case"binary":return t(s,l);case"buffer":return t(le&&Buffer.isBuffer(s)?s.toString("binary"):No(s),l);case"array":return t(Wu(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){var o=l||{},u=o.dense?[]:{},f=s.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(p,m){Array.isArray(u)&&(u[m]=[]);for(var v=/\\\w+\b/g,_=0,A,y=-1;A=v.exec(p);){switch(A[0]){case"\\cell":var E=p.slice(_,v.lastIndex-A[0].length);if(E[0]==" "&&(E=E.slice(1)),++y,E.length){var T={v:E,t:"s"};Array.isArray(u)?u[m][y]=T:u[de({r:m,c:y})]=T}break}_=v.lastIndex}y>d.e.c&&(d.e.c=y)}),u["!ref"]=qe(d),u}function e(s,l){return Gs(n(s,l),l)}function i(s){for(var l=["{\\rtf1\\ansi"],o=we(s["!ref"]),u,f=Array.isArray(s),d=o.s.r;d<=o.e.r;++d){l.push("\\trowd\\trautofit1");for(var p=o.s.c;p<=o.e.c;++p)l.push("\\cellx"+(p+1));for(l.push("\\pard\\intbl"),p=o.s.c;p<=o.e.c;++p){var m=de({r:d,c:p});u=f?(s[d]||[])[p]:s[m],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||(Cr(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:e,to_sheet:n,from_sheet:i}})();function Xv(n){for(var t=0,e=1;t!=3;++t)e=e*256+(n[t]>255?255:n[t]<0?0:n[t]);return e.toString(16).toUpperCase().slice(1)}var UT=6,wr=UT;function ku(n){return Math.floor((n+Math.round(128/wr)/256)*wr)}function Pu(n){return Math.floor((n-5)/wr*100+.5)/100}function rd(n){return Math.round((n*wr+5)/wr*256)/256}function Ld(n){n.width?(n.wpx=ku(n.width),n.wch=Pu(n.wpx),n.MDW=wr):n.wpx?(n.wch=Pu(n.wpx),n.width=rd(n.wch),n.MDW=wr):typeof n.wch=="number"&&(n.width=rd(n.wch),n.wpx=ku(n.width),n.MDW=wr),n.customWidth&&delete n.customWidth}var HT=96,w_=HT;function Bu(n){return n*96/w_}function b_(n){return n*w_/96}function zT(n){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var i=e[0];i<=e[1];++i)n[i]!=null&&(t[t.length]=Rt("numFmt",null,{numFmtId:i,formatCode:fe(n[i])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Rt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function GT(n){var t=[];return t[t.length]=Rt("cellXfs",null),n.forEach(function(e){t[t.length]=Rt("xf",null,e)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Rt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function C_(n,t){var e=[We,Rt("styleSheet",null,{xmlns:Za[0],"xmlns:vt":ri.vt})],i;return n.SSF&&(i=zT(n.SSF))!=null&&(e[e.length]=i),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=GT(t.cellXfs))&&(e[e.length]=i),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function VT(n,t){var e=n.read_shift(2),i=wi(n);return[e,i]}function jT(n,t,e){e||(e=dt(6+4*t.length)),e.write_shift(2,n),ai(t,e);var i=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),i}function XT(n,t,e){var i={};i.sz=n.read_shift(2)/20;var s=NS(n);s.fItalic&&(i.italic=1),s.fCondense&&(i.condense=1),s.fExtend&&(i.extend=1),s.fShadow&&(i.shadow=1),s.fOutline&&(i.outline=1),s.fStrikeout&&(i.strike=1);var l=n.read_shift(2);switch(l===700&&(i.bold=1),n.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var o=n.read_shift(1);o!=0&&(i.underline=o);var u=n.read_shift(1);u>0&&(i.family=u);var f=n.read_shift(1);switch(f>0&&(i.charset=f),n.l++,i.color=MS(n),n.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=wi(n),i}function YT(n,t){t||(t=dt(153)),t.write_shift(2,n.sz*20),LS(n,t),t.write_shift(2,n.bold?700:400);var e=0;n.vertAlign=="superscript"?e=1:n.vertAlign=="subscript"&&(e=2),t.write_shift(2,e),t.write_shift(1,n.underline||0),t.write_shift(1,n.family||0),t.write_shift(1,n.charset||0),t.write_shift(1,0),Lu(n.color,t);var i=0;return i=2,t.write_shift(1,i),ai(n.name,t),t.length>t.l?t.slice(0,t.l):t}var qT=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],V0,WT=er;function Yv(n,t){t||(t=dt(84)),V0||(V0=Ad(qT));var e=V0[n.patternType];e==null&&(e=40),t.write_shift(4,e);var i=0;if(e!=40)for(Lu({auto:1},t),Lu({auto:1},t);i<12;++i)t.write_shift(4,0);else{for(;i<4;++i)t.write_shift(4,0);for(;i<12;++i)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function $T(n,t){var e=n.l+t,i=n.read_shift(2),s=n.read_shift(2);return n.l=e,{ixfe:i,numFmtId:s}}function R_(n,t,e){e||(e=dt(16)),e.write_shift(2,t||0),e.write_shift(2,n.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var i=0;return e.write_shift(1,i),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function no(n,t){return t||(t=dt(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var KT=er;function QT(n,t){return t||(t=dt(51)),t.write_shift(1,0),no(null,t),no(null,t),no(null,t),no(null,t),no(null,t),t.length>t.l?t.slice(0,t.l):t}function ZT(n,t){return t||(t=dt(52)),t.write_shift(4,n.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Nu(n.name||"",t),t.length>t.l?t.slice(0,t.l):t}function JT(n,t,e){var i=dt(2052);return i.write_shift(4,n),Nu(t,i),Nu(e,i),i.length>i.l?i.slice(0,i.l):i}function tw(n,t){if(t){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)t[s]!=null&&++e}),e!=0&&(yt(n,615,In(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)t[s]!=null&&yt(n,44,jT(s,t[s]))}),yt(n,616))}}function ew(n){var t=1;yt(n,611,In(t)),yt(n,43,YT({sz:12,color:{theme:1},name:"Calibri",family:2})),yt(n,612)}function iw(n){var t=2;yt(n,603,In(t)),yt(n,45,Yv({patternType:"none"})),yt(n,45,Yv({patternType:"gray125"})),yt(n,604)}function nw(n){var t=1;yt(n,613,In(t)),yt(n,46,QT()),yt(n,614)}function rw(n){var t=1;yt(n,626,In(t)),yt(n,47,R_({numFmtId:0},65535)),yt(n,627)}function sw(n,t){yt(n,617,In(t.length)),t.forEach(function(e){yt(n,47,R_(e,0))}),yt(n,618)}function aw(n){var t=1;yt(n,619,In(t)),yt(n,48,ZT({xfId:0,name:"Normal"})),yt(n,620)}function lw(n){var t=0;yt(n,505,In(t)),yt(n,506)}function ow(n){var t=0;yt(n,508,JT(t,"TableStyleMedium9","PivotStyleMedium4")),yt(n,509)}function cw(n,t){var e=Vi();return yt(e,278),tw(e,n.SSF),ew(e),iw(e),nw(e),rw(e),sw(e,t.cellXfs),aw(e),lw(e),ow(e),yt(e,279),e.end()}function D_(n,t){if(t&&t.themeXLSX)return t.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var e=[We];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',e[e.length]='<a:font script="Hang" typeface="맑은 고딕"/>',e[e.length]='<a:font script="Hans" typeface="宋体"/>',e[e.length]='<a:font script="Hant" typeface="新細明體"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',e[e.length]='<a:font script="Hang" typeface="맑은 고딕"/>',e[e.length]='<a:font script="Hans" typeface="宋体"/>',e[e.length]='<a:font script="Hant" typeface="新細明體"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function uw(n,t){return{flags:n.read_shift(4),version:n.read_shift(4),name:wi(n)}}function hw(n){var t=dt(12+2*n.name.length);return t.write_shift(4,n.flags),t.write_shift(4,n.version),ai(n.name,t),t.slice(0,t.l)}function fw(n){for(var t=[],e=n.read_shift(4);e-- >0;)t.push([n.read_shift(4),n.read_shift(4)]);return t}function dw(n){var t=dt(4+8*n.length);t.write_shift(4,n.length);for(var e=0;e<n.length;++e)t.write_shift(4,n[e][0]),t.write_shift(4,n[e][1]);return t}function pw(n,t){var e=dt(8+2*t.length);return e.write_shift(4,n),ai(t,e),e.slice(0,e.l)}function gw(n){return n.l+=4,n.read_shift(4)!=0}function mw(n,t){var e=dt(8);return e.write_shift(4,n),e.write_shift(4,1),e}function vw(){var n=Vi();return yt(n,332),yt(n,334,In(1)),yt(n,335,hw({name:"XLDAPR",version:12e4,flags:3496657072})),yt(n,336),yt(n,339,pw(1,"XLDAPR")),yt(n,52),yt(n,35,In(514)),yt(n,4096,In(0)),yt(n,4097,Tn(1)),yt(n,36),yt(n,53),yt(n,340),yt(n,337,mw(1)),yt(n,51,dw([[1,0]])),yt(n,338),yt(n,333),n.end()}function O_(){var n=[We];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function xw(n){var t={};t.i=n.read_shift(4);var e={};e.r=n.read_shift(4),e.c=n.read_shift(4),t.r=de(e);var i=n.read_shift(1);return i&2&&(t.l="1"),i&8&&(t.a="1"),t}var Ha=1024;function M_(n,t){for(var e=[21600,21600],i=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),s=[Rt("xml",null,{"xmlns:v":rn.v,"xmlns:o":rn.o,"xmlns:x":rn.x,"xmlns:mv":rn.mv}).replace(/\/>/,">"),Rt("o:shapelayout",Rt("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),Rt("v:shapetype",[Rt("v:stroke",null,{joinstyle:"miter"}),Rt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:i})];Ha<n*1e3;)Ha+=1e3;return t.forEach(function(l){var o=si(l[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var f=u.type=="gradient"?Rt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Rt("v:fill",f,u),p={on:"t",obscured:"t"};++Ha,s=s.concat(["<v:shape"+wo({id:"_x0000_s"+Ha,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Rt("v:shadow",null,p),Rt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",vi("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),vi("x:AutoFill","False"),vi("x:Row",String(o.r)),vi("x:Column",String(o.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function N_(n){var t=[We,Rt("comments",null,{xmlns:Za[0]})],e=[];return t.push("<authors>"),n.forEach(function(i){i[1].forEach(function(s){var l=fe(s.a);e.indexOf(l)==-1&&(e.push(l),t.push("<author>"+l+"</author>")),s.T&&s.ID&&e.indexOf("tc="+s.ID)==-1&&(e.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),n.forEach(function(i){var s=0,l=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?s=e.indexOf("tc="+i[1][0].ID):i[1].forEach(function(f){f.a&&(s=e.indexOf(fe(f.a))),l.push(f.t||"")}),t.push('<comment ref="'+i[0]+'" authorId="'+s+'"><text>'),l.length<=1)t.push(vi("t",fe(l[0]||"")));else{for(var o=`Comment:
    `+l[0]+`
`,u=1;u<l.length;++u)o+=`Reply:
    `+l[u]+`
`;t.push(vi("t",fe(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function _w(n,t,e){var i=[We,Rt("ThreadedComments",null,{xmlns:ri.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(s){var l="";(s[1]||[]).forEach(function(o,u){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var f={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};u==0?l=f.id:f.parentId=l,o.ID=f.id,o.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),i.push(Rt("threadedComment",vi("text",o.t||""),f))})}),i.push("</ThreadedComments>"),i.join("")}function yw(n){var t=[We,Rt("personList",null,{xmlns:ri.TCMNT,"xmlns:x":Za[0]}).replace(/[\/]>/,">")];return n.forEach(function(e,i){t.push(Rt("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Aw(n){var t={};t.iauthor=n.read_shift(4);var e=Ys(n);return t.rfx=e.s,t.ref=de(e.s),n.l+=16,t}function Ew(n,t){return t==null&&(t=dt(36)),t.write_shift(4,n[1].iauthor),tl(n[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Sw=wi;function Tw(n){return ai(n.slice(0,54))}function ww(n){var t=Vi(),e=[];return yt(t,628),yt(t,630),n.forEach(function(i){i[1].forEach(function(s){e.indexOf(s.a)>-1||(e.push(s.a.slice(0,54)),yt(t,632,Tw(s.a)))})}),yt(t,631),yt(t,633),n.forEach(function(i){i[1].forEach(function(s){s.iauthor=e.indexOf(s.a);var l={s:si(i[0]),e:si(i[0])};yt(t,635,Ew([l,s])),s.t&&s.t.length>0&&yt(t,637,CS(s)),yt(t,636),delete s.iauthor})}),yt(t,634),yt(t,629),t.end()}function bw(n,t){t.FullPaths.forEach(function(e,i){if(i!=0){var s=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&ye.utils.cfb_add(n,s,t.FileIndex[i].content)}})}var L_=["xlsb","xlsm","xlam","biff8","xla"],Cw=(function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function e(i,s,l,o){var u=!1,f=!1;l.length==0?f=!0:l.charAt(0)=="["&&(f=!0,l=l.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var d=l.length>0?parseInt(l,10)|0:0,p=o.length>0?parseInt(o,10)|0:0;return u?p+=t.c:--p,f?d+=t.r:--d,s+(u?"":"$")+Ti(p)+(f?"":"$")+xi(d)}return function(s,l){return t=l,s.replace(n,e)}})(),Fd=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,kd=(function(){return function(t,e){return t.replace(Fd,function(i,s,l,o,u,f){var d=Rd(o)-(l?0:e.c),p=Cd(f)-(u?0:e.r),m=p==0?"":u?p+1:"["+p+"]",v=d==0?"":l?d+1:"["+d+"]";return s+"R"+m+"C"+v})}})();function Rw(n,t){return n.replace(Fd,function(e,i,s,l,o,u){return i+(s=="$"?s+l:Ti(Rd(l)+t.c))+(o=="$"?o+u:xi(Cd(u)+t.r))})}function Dw(n){return n.length!=1}function Ge(n){n.l+=1}function ss(n,t){var e=n.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function F_(n,t,e){var i=2;if(e){if(e.biff>=2&&e.biff<=5)return k_(n);e.biff==12&&(i=4)}var s=n.read_shift(i),l=n.read_shift(i),o=ss(n),u=ss(n);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function k_(n){var t=ss(n),e=ss(n),i=n.read_shift(1),s=n.read_shift(1);return{s:{r:t[0],c:i,cRel:t[1],rRel:t[2]},e:{r:e[0],c:s,cRel:e[1],rRel:e[2]}}}function Ow(n,t,e){if(e.biff<8)return k_(n);var i=n.read_shift(e.biff==12?4:2),s=n.read_shift(e.biff==12?4:2),l=ss(n),o=ss(n);return{s:{r:i,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function P_(n,t,e){if(e&&e.biff>=2&&e.biff<=5)return Mw(n);var i=n.read_shift(e&&e.biff==12?4:2),s=ss(n);return{r:i,c:s[0],cRel:s[1],rRel:s[2]}}function Mw(n){var t=ss(n),e=n.read_shift(1);return{r:t[0],c:e,cRel:t[1],rRel:t[2]}}function Nw(n){var t=n.read_shift(2),e=n.read_shift(2);return{r:t,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function Lw(n,t,e){var i=e&&e.biff?e.biff:8;if(i>=2&&i<=5)return Fw(n);var s=n.read_shift(i>=12?4:2),l=n.read_shift(2),o=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;s>524287;)s-=1048576;if(o==1)for(;l>8191;)l=l-16384;return{r:s,c:l,cRel:o,rRel:u}}function Fw(n){var t=n.read_shift(2),e=n.read_shift(1),i=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,i==1&&t>=8192&&(t=t-16384),s==1&&e>=128&&(e=e-256),{r:t,c:e,cRel:s,rRel:i}}function kw(n,t,e){var i=(n[n.l++]&96)>>5,s=F_(n,e.biff>=2&&e.biff<=5?6:8,e);return[i,s]}function Pw(n,t,e){var i=(n[n.l++]&96)>>5,s=n.read_shift(2,"i"),l=8;if(e)switch(e.biff){case 5:n.l+=12,l=6;break;case 12:l=12;break}var o=F_(n,l,e);return[i,s,o]}function Bw(n,t,e){var i=(n[n.l++]&96)>>5;return n.l+=e&&e.biff>8?12:e.biff<8?6:8,[i]}function Iw(n,t,e){var i=(n[n.l++]&96)>>5,s=n.read_shift(2),l=8;if(e)switch(e.biff){case 5:n.l+=12,l=6;break;case 12:l=12;break}return n.l+=l,[i,s]}function Uw(n,t,e){var i=(n[n.l++]&96)>>5,s=Ow(n,t-1,e);return[i,s]}function Hw(n,t,e){var i=(n[n.l++]&96)>>5;return n.l+=e.biff==2?6:e.biff==12?14:7,[i]}function qv(n){var t=n[n.l+1]&1,e=1;return n.l+=4,[t,e]}function zw(n,t,e){n.l+=2;for(var i=n.read_shift(e&&e.biff==2?1:2),s=[],l=0;l<=i;++l)s.push(n.read_shift(e&&e.biff==2?1:2));return s}function Gw(n,t,e){var i=n[n.l+1]&255?1:0;return n.l+=2,[i,n.read_shift(e&&e.biff==2?1:2)]}function Vw(n,t,e){var i=n[n.l+1]&255?1:0;return n.l+=2,[i,n.read_shift(e&&e.biff==2?1:2)]}function jw(n){var t=n[n.l+1]&255?1:0;return n.l+=2,[t,n.read_shift(2)]}function Xw(n,t,e){var i=n[n.l+1]&255?1:0;return n.l+=e&&e.biff==2?3:4,[i]}function B_(n){var t=n.read_shift(1),e=n.read_shift(1);return[t,e]}function Yw(n){return n.read_shift(2),B_(n)}function qw(n){return n.read_shift(2),B_(n)}function Ww(n,t,e){var i=(n[n.l]&96)>>5;n.l+=1;var s=P_(n,0,e);return[i,s]}function $w(n,t,e){var i=(n[n.l]&96)>>5;n.l+=1;var s=Lw(n,0,e);return[i,s]}function Kw(n,t,e){var i=(n[n.l]&96)>>5;n.l+=1;var s=n.read_shift(2);e&&e.biff==5&&(n.l+=12);var l=P_(n,0,e);return[i,s,l]}function Qw(n,t,e){var i=(n[n.l]&96)>>5;n.l+=1;var s=n.read_shift(e&&e.biff<=3?1:2);return[Qb[s],H_[s],i]}function Zw(n,t,e){var i=n[n.l++],s=n.read_shift(1),l=e&&e.biff<=3?[i==88?-1:0,n.read_shift(1)]:Jw(n);return[s,(l[0]===0?H_:Kb)[l[1]]]}function Jw(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function tb(n,t,e){n.l+=e&&e.biff==2?3:4}function eb(n,t,e){if(n.l++,e&&e.biff==12)return[n.read_shift(4,"i"),0];var i=n.read_shift(2),s=n.read_shift(e&&e.biff==2?1:2);return[i,s]}function ib(n){return n.l++,ko[n.read_shift(1)]}function nb(n){return n.l++,n.read_shift(2)}function rb(n){return n.l++,n.read_shift(1)!==0}function sb(n){return n.l++,el(n)}function ab(n,t,e){return n.l++,__(n,t-1,e)}function lb(n,t){var e=[n.read_shift(1)];if(t==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=KS(n,1)?"TRUE":"FALSE",t!=12&&(n.l+=7);break;case 37:case 16:e[1]=ko[n[n.l]],n.l+=t==12?4:8;break;case 0:n.l+=8;break;case 1:e[1]=el(n);break;case 2:e[1]=tT(n,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function ob(n,t,e){for(var i=n.read_shift(e.biff==12?4:2),s=[],l=0;l!=i;++l)s.push((e.biff==12?Ys:nT)(n));return s}function cb(n,t,e){var i=0,s=0;e.biff==12?(i=n.read_shift(4),s=n.read_shift(4)):(s=1+n.read_shift(1),i=1+n.read_shift(2)),e.biff>=2&&e.biff<8&&(--i,--s==0&&(s=256));for(var l=0,o=[];l!=i&&(o[l]=[]);++l)for(var u=0;u!=s;++u)o[l][u]=lb(n,e.biff);return o}function ub(n,t,e){var i=n.read_shift(1)>>>5&3,s=!e||e.biff>=8?4:2,l=n.read_shift(s);switch(e.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[i,0,l]}function hb(n,t,e){if(e.biff==5)return fb(n);var i=n.read_shift(1)>>>5&3,s=n.read_shift(2),l=n.read_shift(4);return[i,s,l]}function fb(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2,"i");n.l+=8;var i=n.read_shift(2);return n.l+=12,[t,e,i]}function db(n,t,e){var i=n.read_shift(1)>>>5&3;n.l+=e&&e.biff==2?3:4;var s=n.read_shift(e&&e.biff==2?1:2);return[i,s]}function pb(n,t,e){var i=n.read_shift(1)>>>5&3,s=n.read_shift(e&&e.biff==2?1:2);return[i,s]}function gb(n,t,e){var i=n.read_shift(1)>>>5&3;return n.l+=4,e.biff<8&&n.l--,e.biff==12&&(n.l+=2),[i]}function mb(n,t,e){var i=(n[n.l++]&96)>>5,s=n.read_shift(2),l=4;if(e)switch(e.biff){case 5:l=15;break;case 12:l=6;break}return n.l+=l,[i,s]}var vb=er,xb=er,_b=er;function Po(n,t,e){return n.l+=2,[Nw(n)]}function Pd(n){return n.l+=6,[]}var yb=Po,Ab=Pd,Eb=Pd,Sb=Po;function I_(n){return n.l+=2,[v_(n),n.read_shift(2)&1]}var Tb=Po,wb=I_,bb=Pd,Cb=Po,Rb=Po,Db=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Ob(n){n.l+=2;var t=n.read_shift(2),e=n.read_shift(2),i=n.read_shift(4),s=n.read_shift(2),l=n.read_shift(2),o=Db[e>>2&31];return{ixti:t,coltype:e&3,rt:o,idx:i,c:s,C:l}}function Mb(n){return n.l+=2,[n.read_shift(4)]}function Nb(n,t,e){return n.l+=5,n.l+=2,n.l+=e.biff==2?1:4,["PTGSHEET"]}function Lb(n,t,e){return n.l+=e.biff==2?4:5,["PTGENDSHEET"]}function Fb(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2);return[t,e]}function kb(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2);return[t,e]}function Pb(n){return n.l+=4,[0,0]}var Wv={1:{n:"PtgExp",f:eb},2:{n:"PtgTbl",f:_b},3:{n:"PtgAdd",f:Ge},4:{n:"PtgSub",f:Ge},5:{n:"PtgMul",f:Ge},6:{n:"PtgDiv",f:Ge},7:{n:"PtgPower",f:Ge},8:{n:"PtgConcat",f:Ge},9:{n:"PtgLt",f:Ge},10:{n:"PtgLe",f:Ge},11:{n:"PtgEq",f:Ge},12:{n:"PtgGe",f:Ge},13:{n:"PtgGt",f:Ge},14:{n:"PtgNe",f:Ge},15:{n:"PtgIsect",f:Ge},16:{n:"PtgUnion",f:Ge},17:{n:"PtgRange",f:Ge},18:{n:"PtgUplus",f:Ge},19:{n:"PtgUminus",f:Ge},20:{n:"PtgPercent",f:Ge},21:{n:"PtgParen",f:Ge},22:{n:"PtgMissArg",f:Ge},23:{n:"PtgStr",f:ab},26:{n:"PtgSheet",f:Nb},27:{n:"PtgEndSheet",f:Lb},28:{n:"PtgErr",f:ib},29:{n:"PtgBool",f:rb},30:{n:"PtgInt",f:nb},31:{n:"PtgNum",f:sb},32:{n:"PtgArray",f:Hw},33:{n:"PtgFunc",f:Qw},34:{n:"PtgFuncVar",f:Zw},35:{n:"PtgName",f:ub},36:{n:"PtgRef",f:Ww},37:{n:"PtgArea",f:kw},38:{n:"PtgMemArea",f:db},39:{n:"PtgMemErr",f:vb},40:{n:"PtgMemNoMem",f:xb},41:{n:"PtgMemFunc",f:pb},42:{n:"PtgRefErr",f:gb},43:{n:"PtgAreaErr",f:Bw},44:{n:"PtgRefN",f:$w},45:{n:"PtgAreaN",f:Uw},46:{n:"PtgMemAreaN",f:Fb},47:{n:"PtgMemNoMemN",f:kb},57:{n:"PtgNameX",f:hb},58:{n:"PtgRef3d",f:Kw},59:{n:"PtgArea3d",f:Pw},60:{n:"PtgRefErr3d",f:mb},61:{n:"PtgAreaErr3d",f:Iw},255:{}},Bb={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ib={1:{n:"PtgElfLel",f:I_},2:{n:"PtgElfRw",f:Cb},3:{n:"PtgElfCol",f:yb},6:{n:"PtgElfRwV",f:Rb},7:{n:"PtgElfColV",f:Sb},10:{n:"PtgElfRadical",f:Tb},11:{n:"PtgElfRadicalS",f:bb},13:{n:"PtgElfColS",f:Ab},15:{n:"PtgElfColSV",f:Eb},16:{n:"PtgElfRadicalLel",f:wb},25:{n:"PtgList",f:Ob},29:{n:"PtgSxName",f:Mb},255:{}},Ub={0:{n:"PtgAttrNoop",f:Pb},1:{n:"PtgAttrSemi",f:Xw},2:{n:"PtgAttrIf",f:Vw},4:{n:"PtgAttrChoose",f:zw},8:{n:"PtgAttrGoto",f:Gw},16:{n:"PtgAttrSum",f:tb},32:{n:"PtgAttrBaxcel",f:qv},33:{n:"PtgAttrBaxcel",f:qv},64:{n:"PtgAttrSpace",f:Yw},65:{n:"PtgAttrSpaceSemi",f:qw},128:{n:"PtgAttrIfError",f:jw},255:{}};function Hb(n,t,e,i){if(i.biff<8)return er(n,t);for(var s=n.l+t,l=[],o=0;o!==e.length;++o)switch(e[o][0]){case"PtgArray":e[o][1]=cb(n,0,i),l.push(e[o][1]);break;case"PtgMemArea":e[o][2]=ob(n,e[o][1],i),l.push(e[o][2]);break;case"PtgExp":i&&i.biff==12&&(e[o][1][1]=n.read_shift(4),l.push(e[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[o][0]}return t=s-n.l,t!==0&&l.push(er(n,t)),l}function zb(n,t,e){for(var i=n.l+t,s,l,o=[];i!=n.l;)t=i-n.l,l=n[n.l],s=Wv[l]||Wv[Bb[l]],(l===24||l===25)&&(s=(l===24?Ib:Ub)[n[n.l+1]]),!s||!s.f?er(n,t):o.push([s.n,s.f(n,t,e)]);return o}function Gb(n){for(var t=[],e=0;e<n.length;++e){for(var i=n[e],s=[],l=0;l<i.length;++l){var o=i[l];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var Vb={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function jb(n,t){if(!n&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function U_(n,t,e){if(!n)return"SH33TJSERR0";if(e.biff>8&&(!n.XTI||!n.XTI[t]))return n.SheetNames[t];if(!n.XTI)return"SH33TJSERR6";var i=n.XTI[t];if(e.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":n.XTI[t-1];if(!i)return"SH33TJSERR1";var s="";if(e.biff>8)switch(n[i[0]][0]){case 357:return s=i[1]==-1?"#REF":n.SheetNames[i[1]],i[1]==i[2]?s:s+":"+n.SheetNames[i[2]];case 358:return e.SID!=null?n.SheetNames[e.SID]:"SH33TJSSAME"+n[i[0]][0];case 355:default:return"SH33TJSSRC"+n[i[0]][0]}switch(n[i[0]][0][0]){case 1025:return s=i[1]==-1?"#REF":n.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?s:s+":"+n.SheetNames[i[2]];case 14849:return n[i[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return n[i[0]][0][3]?(s=i[1]==-1?"#REF":n[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?s:s+":"+n[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function $v(n,t,e){var i=U_(n,t,e);return i=="#REF"?i:jb(i,e)}function Ka(n,t,e,i,s){var l=s&&s.biff||8,o={s:{c:0,r:0}},u=[],f,d,p,m=0,v=0,_,A="";if(!n[0]||!n[0][0])return"";for(var y=-1,E="",T=0,b=n[0].length;T<b;++T){var w=n[0][T];switch(w[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),d=u.pop(),y>=0){switch(n[0][y][1][0]){case 0:E=Fe(" ",n[0][y][1][1]);break;case 1:E=Fe("\r",n[0][y][1][1]);break;default:if(E="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][y][1][0])}d=d+E,y=-1}u.push(d+Vb[w[0]]+f);break;case"PtgIsect":f=u.pop(),d=u.pop(),u.push(d+" "+f);break;case"PtgUnion":f=u.pop(),d=u.pop(),u.push(d+","+f);break;case"PtgRange":f=u.pop(),d=u.pop(),u.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=vo(w[1][1],o,s),u.push(xo(p,l));break;case"PtgRefN":p=e?vo(w[1][1],e,s):w[1][1],u.push(xo(p,l));break;case"PtgRef3d":m=w[1][1],p=vo(w[1][2],o,s),A=$v(i,m,s),u.push(A+"!"+xo(p,l));break;case"PtgFunc":case"PtgFuncVar":var O=w[1][0],F=w[1][1];O||(O=0),O&=127;var z=O==0?[]:u.slice(-O);u.length-=O,F==="User"&&(F=z.shift()),u.push(F+"("+z.join(",")+")");break;case"PtgBool":u.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(w[1]);break;case"PtgNum":u.push(String(w[1]));break;case"PtgStr":u.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(w[1]);break;case"PtgAreaN":_=Lv(w[1][1],e?{s:e}:o,s),u.push(z0(_,s));break;case"PtgArea":_=Lv(w[1][1],o,s),u.push(z0(_,s));break;case"PtgArea3d":m=w[1][1],_=w[1][2],A=$v(i,m,s),u.push(A+"!"+z0(_,s));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=w[1][2];var L=(i.names||[])[v-1]||(i[0]||[])[v],G=L?L.Name:"SH33TJSNAME"+String(v);G&&G.slice(0,6)=="_xlfn."&&!s.xlfn&&(G=G.slice(6)),u.push(G);break;case"PtgNameX":var V=w[1][1];v=w[1][2];var Q;if(s.biff<=5)V<0&&(V=-V),i[V]&&(Q=i[V][v]);else{var K="";if(((i[V]||[])[0]||[])[0]==14849||(((i[V]||[])[0]||[])[0]==1025?i[V][v]&&i[V][v].itab>0&&(K=i.SheetNames[i[V][v].itab-1]+"!"):K=i.SheetNames[v-1]+"!"),i[V]&&i[V][v])K+=i[V][v].Name;else if(i[0]&&i[0][v])K+=i[0][v].Name;else{var ut=(U_(i,V,s)||"").split(";;");ut[v-1]?K=ut[v-1]:K+="SH33TJSERRX"}u.push(K);break}Q||(Q={Name:"SH33TJSERRY"}),u.push(Q.Name);break;case"PtgParen":var ht="(",bt=")";if(y>=0){switch(E="",n[0][y][1][0]){case 2:ht=Fe(" ",n[0][y][1][1])+ht;break;case 3:ht=Fe("\r",n[0][y][1][1])+ht;break;case 4:bt=Fe(" ",n[0][y][1][1])+bt;break;case 5:bt=Fe("\r",n[0][y][1][1])+bt;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][y][1][0])}y=-1}u.push(ht+u.pop()+bt);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:w[1][1],r:w[1][0]};var Et={c:e.c,r:e.r};if(i.sharedf[de(p)]){var Y=i.sharedf[de(p)];u.push(Ka(Y,o,Et,i,s))}else{var nt=!1;for(f=0;f!=i.arrayf.length;++f)if(d=i.arrayf[f],!(p.c<d[0].s.c||p.c>d[0].e.c)&&!(p.r<d[0].s.r||p.r>d[0].e.r)){u.push(Ka(d[1],o,Et,i,s)),nt=!0;break}nt||u.push(w[1])}break;case"PtgArray":u.push("{"+Gb(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var Tt=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&y>=0&&Tt.indexOf(n[0][T][0])==-1){w=n[0][y];var st=!0;switch(w[1][0]){case 4:st=!1;case 0:E=Fe(" ",w[1][1]);break;case 5:st=!1;case 1:E=Fe("\r",w[1][1]);break;default:if(E="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}u.push((st?E:"")+u.pop()+(st?"":E)),y=-1}}if(u.length>1&&s.WTF)throw new Error("bad formula stack");return u[0]}function Xb(n){if(n==null){var t=dt(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof n=="number")return Is(n);return Is(0)}function Yb(n,t,e,i,s){var l=Us(t,e,s),o=Xb(n.v),u=dt(6),f=33;u.write_shift(2,f),u.write_shift(4,0);for(var d=dt(n.bf.length),p=0;p<n.bf.length;++p)d[p]=n.bf[p];var m=mi([l,o,u,d]);return m}function $u(n,t,e){var i=n.read_shift(4),s=zb(n,i,e),l=n.read_shift(4),o=l>0?Hb(n,l,s,e):null;return[s,o]}var qb=$u,Ku=$u,Wb=$u,$b=$u,Kb={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},H_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Qb={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Zb(n){var t="of:="+n.replace(Fd,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Jb(n){return n.replace(/\./,"!")}var _o=typeof Map<"u";function Bd(n,t,e){var i=0,s=n.length;if(e){if(_o?e.has(t):Object.prototype.hasOwnProperty.call(e,t)){for(var l=_o?e.get(t):e[t];i<l.length;++i)if(n[l[i]].t===t)return n.Count++,l[i]}}else for(;i<s;++i)if(n[i].t===t)return n.Count++,i;return n[s]={t},n.Count++,n.Unique++,e&&(_o?(e.has(t)||e.set(t,[]),e.get(t).push(s)):(Object.prototype.hasOwnProperty.call(e,t)||(e[t]=[]),e[t].push(s))),s}function Qu(n,t){var e={min:n+1,max:n+1},i=-1;return t.MDW&&(wr=t.MDW),t.width!=null?e.customWidth=1:t.wpx!=null?i=Pu(t.wpx):t.wch!=null&&(i=t.wch),i>-1?(e.width=rd(i),e.customWidth=1):t.width!=null&&(e.width=t.width),t.hidden&&(e.hidden=!0),t.level!=null&&(e.outlineLevel=e.level=t.level),e}function z_(n,t){if(n){var e=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=e[0]),n.right==null&&(n.right=e[1]),n.top==null&&(n.top=e[2]),n.bottom==null&&(n.bottom=e[3]),n.header==null&&(n.header=e[4]),n.footer==null&&(n.footer=e[5])}}function cs(n,t,e){var i=e.revssf[t.z!=null?t.z:"General"],s=60,l=n.length;if(i==null&&e.ssf){for(;s<392;++s)if(e.ssf[s]==null){Px(t.z,s),e.ssf[s]=t.z,e.revssf[t.z]=i=s;break}}for(s=0;s!=l;++s)if(n[s].numFmtId===i)return s;return n[l]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function tC(n,t,e){if(n&&n["!ref"]){var i=we(n["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+e+"): "+n["!ref"])}}function eC(n){if(n.length===0)return"";for(var t='<mergeCells count="'+n.length+'">',e=0;e!=n.length;++e)t+='<mergeCell ref="'+qe(n[e])+'"/>';return t+"</mergeCells>"}function iC(n,t,e,i,s){var l=!1,o={},u=null;if(i.bookType!=="xlsx"&&t.vbaraw){var f=t.SheetNames[e];try{t.Workbook&&(f=t.Workbook.Sheets[e].CodeName||f)}catch{}l=!0,o.codeName=To(fe(f))}if(n&&n["!outline"]){var d={summaryBelow:1,summaryRight:1};n["!outline"].above&&(d.summaryBelow=0),n["!outline"].left&&(d.summaryRight=0),u=(u||"")+Rt("outlinePr",null,d)}!l&&!u||(s[s.length]=Rt("sheetPr",u,o))}var nC=["objects","scenarios","selectLockedCells","selectUnlockedCells"],rC=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function sC(n){var t={sheet:1};return nC.forEach(function(e){n[e]!=null&&n[e]&&(t[e]="1")}),rC.forEach(function(e){n[e]!=null&&!n[e]&&(t[e]="0")}),n.password&&(t.password=T_(n.password).toString(16).toUpperCase()),Rt("sheetProtection",null,t)}function aC(n){return z_(n),Rt("pageMargins",null,n)}function lC(n,t){for(var e=["<cols>"],i,s=0;s!=t.length;++s)(i=t[s])&&(e[e.length]=Rt("col",null,Qu(s,i)));return e[e.length]="</cols>",e.join("")}function oC(n,t,e,i){var s=typeof n.ref=="string"?n.ref:qe(n.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var l=e.Workbook.Names,o=an(s);o.s.r==o.e.r&&(o.e.r=an(t["!ref"]).e.r,s=qe(o));for(var u=0;u<l.length;++u){var f=l[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==i){f.Ref="'"+e.SheetNames[i]+"'!"+s;break}}return u==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+e.SheetNames[i]+"'!"+s}),Rt("autoFilter",null,{ref:s})}function cC(n,t,e,i){var s={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),Rt("sheetViews",Rt("sheetView",null,s),{})}function uC(n,t,e,i){if(n.c&&e["!comments"].push([t,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var s="",l=n.t,o=n.v;if(n.t!=="z")switch(n.t){case"b":s=n.v?"1":"0";break;case"n":s=""+n.v;break;case"e":s=ko[n.v];break;case"d":i&&i.cellDates?s=Fi(n.v,-1).toISOString():(n=Xi(n),n.t="n",s=""+(n.v=ji(Fi(n.v)))),typeof n.z>"u"&&(n.z=ke[14]);break;default:s=n.v;break}var u=vi("v",fe(s)),f={r:t},d=cs(i.cellXfs,n,i);switch(d!==0&&(f.s=d),n.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){u=vi("v",""+Bd(i.Strings,n.v,i.revStrings)),f.t="s";break}f.t="str";break}if(n.t!=l&&(n.t=l,n.v=o),typeof n.f=="string"&&n.f){var p=n.F&&n.F.slice(0,t.length)==t?{t:"array",ref:n.F}:null;u=Rt("f",fe(n.f),p)+(n.v!=null?u:"")}return n.l&&e["!links"].push([t,n.l]),n.D&&(f.cm=1),Rt("c",u,f)}function hC(n,t,e,i){var s=[],l=[],o=we(n["!ref"]),u="",f,d="",p=[],m=0,v=0,_=n["!rows"],A=Array.isArray(n),y={r:d},E,T=-1;for(v=o.s.c;v<=o.e.c;++v)p[v]=Ti(v);for(m=o.s.r;m<=o.e.r;++m){for(l=[],d=xi(m),v=o.s.c;v<=o.e.c;++v){f=p[v]+d;var b=A?(n[m]||[])[v]:n[f];b!==void 0&&(u=uC(b,f,n,t))!=null&&l.push(u)}(l.length>0||_&&_[m])&&(y={r:d},_&&_[m]&&(E=_[m],E.hidden&&(y.hidden=1),T=-1,E.hpx?T=Bu(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(y.ht=T,y.customHeight=1),E.level&&(y.outlineLevel=E.level)),s[s.length]=Rt("row",l.join(""),y))}if(_)for(;m<_.length;++m)_&&_[m]&&(y={r:m+1},E=_[m],E.hidden&&(y.hidden=1),T=-1,E.hpx?T=Bu(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(y.ht=T,y.customHeight=1),E.level&&(y.outlineLevel=E.level),s[s.length]=Rt("row","",y));return s.join("")}function G_(n,t,e,i){var s=[We,Rt("worksheet",null,{xmlns:Za[0],"xmlns:r":ri.r})],l=e.SheetNames[n],o=0,u="",f=e.Sheets[l];f==null&&(f={});var d=f["!ref"]||"A1",p=we(d);if(p.e.c>16383||p.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),d=qe(p)}i||(i={}),f["!comments"]=[];var m=[];iC(f,e,n,t,s),s[s.length]=Rt("dimension",null,{ref:d}),s[s.length]=cC(f,t,n,e),t.sheetFormat&&(s[s.length]=Rt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(s[s.length]=lC(f,f["!cols"])),s[o=s.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(u=hC(f,t),u.length>0&&(s[s.length]=u)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),f["!protect"]&&(s[s.length]=sC(f["!protect"])),f["!autofilter"]!=null&&(s[s.length]=oC(f["!autofilter"],f,e,n)),f["!merges"]!=null&&f["!merges"].length>0&&(s[s.length]=eC(f["!merges"]));var v=-1,_,A=-1;return f["!links"].length>0&&(s[s.length]="<hyperlinks>",f["!links"].forEach(function(y){y[1].Target&&(_={ref:y[0]},y[1].Target.charAt(0)!="#"&&(A=he(i,-1,fe(y[1].Target).replace(/#.*$/,""),se.HLINK),_["r:id"]="rId"+A),(v=y[1].Target.indexOf("#"))>-1&&(_.location=fe(y[1].Target.slice(v+1))),y[1].Tooltip&&(_.tooltip=fe(y[1].Tooltip)),s[s.length]=Rt("hyperlink",null,_))}),s[s.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(s[s.length]=aC(f["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=vi("ignoredErrors",Rt("ignoredError",null,{numberStoredAsText:1,sqref:d}))),m.length>0&&(A=he(i,-1,"../drawings/drawing"+(n+1)+".xml",se.DRAW),s[s.length]=Rt("drawing",null,{"r:id":"rId"+A}),f["!drawing"]=m),f["!comments"].length>0&&(A=he(i,-1,"../drawings/vmlDrawing"+(n+1)+".vml",se.VML),s[s.length]=Rt("legacyDrawing",null,{"r:id":"rId"+A}),f["!legacy"]=A),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function fC(n,t){var e={},i=n.l+t;e.r=n.read_shift(4),n.l+=4;var s=n.read_shift(2);n.l+=1;var l=n.read_shift(1);return n.l=i,l&7&&(e.level=l&7),l&16&&(e.hidden=!0),l&32&&(e.hpt=s/20),e}function dC(n,t,e){var i=dt(145),s=(e["!rows"]||[])[n]||{};i.write_shift(4,n),i.write_shift(4,0);var l=320;s.hpx?l=Bu(s.hpx)*20:s.hpt&&(l=s.hpt*20),i.write_shift(2,l),i.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),i.write_shift(1,o),i.write_shift(1,0);var u=0,f=i.l;i.l+=4;for(var d={r:n,c:0},p=0;p<16;++p)if(!(t.s.c>p+1<<10||t.e.c<p<<10)){for(var m=-1,v=-1,_=p<<10;_<p+1<<10;++_){d.c=_;var A=Array.isArray(e)?(e[d.r]||[])[d.c]:e[de(d)];A&&(m<0&&(m=_),v=_)}m<0||(++u,i.write_shift(4,m),i.write_shift(4,v))}var y=i.l;return i.l=f,i.write_shift(4,u),i.l=y,i.length>i.l?i.slice(0,i.l):i}function pC(n,t,e,i){var s=dC(i,e,t);(s.length>17||(t["!rows"]||[])[i])&&yt(n,0,s)}var gC=Ys,mC=tl;function vC(){}function xC(n,t){var e={},i=n[n.l];return++n.l,e.above=!(i&64),e.left=!(i&128),n.l+=18,e.name=RS(n),e}function _C(n,t,e){e==null&&(e=dt(84+4*n.length));var i=192;t&&(t.above&&(i&=-65),t.left&&(i&=-129)),e.write_shift(1,i);for(var s=1;s<3;++s)e.write_shift(1,0);return Lu({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),n_(n,e),e.slice(0,e.l)}function yC(n){var t=bn(n);return[t]}function AC(n,t,e){return e==null&&(e=dt(8)),Vs(t,e)}function EC(n){var t=js(n);return[t]}function SC(n,t,e){return e==null&&(e=dt(4)),Xs(t,e)}function TC(n){var t=bn(n),e=n.read_shift(1);return[t,e,"b"]}function wC(n,t,e){return e==null&&(e=dt(9)),Vs(t,e),e.write_shift(1,n.v?1:0),e}function bC(n){var t=js(n),e=n.read_shift(1);return[t,e,"b"]}function CC(n,t,e){return e==null&&(e=dt(5)),Xs(t,e),e.write_shift(1,n.v?1:0),e}function RC(n){var t=bn(n),e=n.read_shift(1);return[t,e,"e"]}function DC(n,t,e){return e==null&&(e=dt(9)),Vs(t,e),e.write_shift(1,n.v),e}function OC(n){var t=js(n),e=n.read_shift(1);return[t,e,"e"]}function MC(n,t,e){return e==null&&(e=dt(8)),Xs(t,e),e.write_shift(1,n.v),e.write_shift(2,0),e.write_shift(1,0),e}function NC(n){var t=bn(n),e=n.read_shift(4);return[t,e,"s"]}function LC(n,t,e){return e==null&&(e=dt(12)),Vs(t,e),e.write_shift(4,t.v),e}function FC(n){var t=js(n),e=n.read_shift(4);return[t,e,"s"]}function kC(n,t,e){return e==null&&(e=dt(8)),Xs(t,e),e.write_shift(4,t.v),e}function PC(n){var t=bn(n),e=el(n);return[t,e,"n"]}function BC(n,t,e){return e==null&&(e=dt(16)),Vs(t,e),Is(n.v,e),e}function IC(n){var t=js(n),e=el(n);return[t,e,"n"]}function UC(n,t,e){return e==null&&(e=dt(12)),Xs(t,e),Is(n.v,e),e}function HC(n){var t=bn(n),e=r_(n);return[t,e,"n"]}function zC(n,t,e){return e==null&&(e=dt(12)),Vs(t,e),s_(n.v,e),e}function GC(n){var t=js(n),e=r_(n);return[t,e,"n"]}function VC(n,t,e){return e==null&&(e=dt(8)),Xs(t,e),s_(n.v,e),e}function jC(n){var t=bn(n),e=Dd(n);return[t,e,"is"]}function XC(n){var t=bn(n),e=wi(n);return[t,e,"str"]}function YC(n,t,e){return e==null&&(e=dt(12+4*n.v.length)),Vs(t,e),ai(n.v,e),e.length>e.l?e.slice(0,e.l):e}function qC(n){var t=js(n),e=wi(n);return[t,e,"str"]}function WC(n,t,e){return e==null&&(e=dt(8+4*n.v.length)),Xs(t,e),ai(n.v,e),e.length>e.l?e.slice(0,e.l):e}function $C(n,t,e){var i=n.l+t,s=bn(n);s.r=e["!row"];var l=n.read_shift(1),o=[s,l,"b"];if(e.cellFormula){n.l+=2;var u=Ku(n,i-n.l,e);o[3]=Ka(u,null,s,e.supbooks,e)}else n.l=i;return o}function KC(n,t,e){var i=n.l+t,s=bn(n);s.r=e["!row"];var l=n.read_shift(1),o=[s,l,"e"];if(e.cellFormula){n.l+=2;var u=Ku(n,i-n.l,e);o[3]=Ka(u,null,s,e.supbooks,e)}else n.l=i;return o}function QC(n,t,e){var i=n.l+t,s=bn(n);s.r=e["!row"];var l=el(n),o=[s,l,"n"];if(e.cellFormula){n.l+=2;var u=Ku(n,i-n.l,e);o[3]=Ka(u,null,s,e.supbooks,e)}else n.l=i;return o}function ZC(n,t,e){var i=n.l+t,s=bn(n);s.r=e["!row"];var l=wi(n),o=[s,l,"str"];if(e.cellFormula){n.l+=2;var u=Ku(n,i-n.l,e);o[3]=Ka(u,null,s,e.supbooks,e)}else n.l=i;return o}var JC=Ys,t4=tl;function e4(n,t){return t==null&&(t=dt(4)),t.write_shift(4,n),t}function i4(n,t){var e=n.l+t,i=Ys(n),s=Od(n),l=wi(n),o=wi(n),u=wi(n);n.l=e;var f={rfx:i,relId:s,loc:l,display:u};return o&&(f.Tooltip=o),f}function n4(n,t){var e=dt(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));tl({s:si(n[0]),e:si(n[0])},e),Md("rId"+t,e);var i=n[1].Target.indexOf("#"),s=i==-1?"":n[1].Target.slice(i+1);return ai(s||"",e),ai(n[1].Tooltip||"",e),ai("",e),e.slice(0,e.l)}function r4(){}function s4(n,t,e){var i=n.l+t,s=a_(n),l=n.read_shift(1),o=[s];if(o[2]=l,e.cellFormula){var u=qb(n,i-n.l,e);o[1]=u}else n.l=i;return o}function a4(n,t,e){var i=n.l+t,s=Ys(n),l=[s];if(e.cellFormula){var o=$b(n,i-n.l,e);l[1]=o,n.l=i}else n.l=i;return l}function l4(n,t,e){e==null&&(e=dt(18));var i=Qu(n,t);e.write_shift(-4,n),e.write_shift(-4,n),e.write_shift(4,(i.width||10)*256),e.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof i.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),e.write_shift(2,s),e}var V_=["left","right","top","bottom","header","footer"];function o4(n){var t={};return V_.forEach(function(e){t[e]=el(n)}),t}function c4(n,t){return t==null&&(t=dt(48)),z_(n),V_.forEach(function(e){Is(n[e],t)}),t}function u4(n){var t=n.read_shift(2);return n.l+=28,{RTL:t&32}}function h4(n,t,e){e==null&&(e=dt(30));var i=924;return(((t||{}).Views||[])[0]||{}).RTL&&(i|=32),e.write_shift(2,i),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function f4(n){var t=dt(24);return t.write_shift(4,4),t.write_shift(4,1),tl(n,t),t}function d4(n,t){return t==null&&(t=dt(66)),t.write_shift(2,n.password?T_(n.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?t.write_shift(4,n[e[0]]!=null&&!n[e[0]]?1:0):t.write_shift(4,n[e[0]]!=null&&n[e[0]]?0:1)}),t}function p4(){}function g4(){}function m4(n,t,e,i,s,l,o){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=Xi(t),t.z=t.z||ke[14],t.v=ji(Fi(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var f={r:e,c:i};switch(f.s=cs(s.cellXfs,t,s),t.l&&l["!links"].push([de(f),t.l]),t.c&&l["!comments"].push([de(f),t.c]),t.t){case"s":case"str":return s.bookSST?(u=Bd(s.Strings,t.v,s.revStrings),f.t="s",f.v=u,o?yt(n,18,kC(t,f)):yt(n,7,LC(t,f))):(f.t="str",o?yt(n,17,WC(t,f)):yt(n,6,YC(t,f))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?yt(n,13,VC(t,f)):yt(n,2,zC(t,f)):o?yt(n,16,UC(t,f)):yt(n,5,BC(t,f)),!0;case"b":return f.t="b",o?yt(n,15,CC(t,f)):yt(n,4,wC(t,f)),!0;case"e":return f.t="e",o?yt(n,14,MC(t,f)):yt(n,3,DC(t,f)),!0}return o?yt(n,12,SC(t,f)):yt(n,1,AC(t,f)),!0}function v4(n,t,e,i){var s=we(t["!ref"]||"A1"),l,o="",u=[];yt(n,145);var f=Array.isArray(t),d=s.e.r;t["!rows"]&&(d=Math.max(s.e.r,t["!rows"].length-1));for(var p=s.s.r;p<=d;++p){o=xi(p),pC(n,t,s,p);var m=!1;if(p<=s.e.r)for(var v=s.s.c;v<=s.e.c;++v){p===s.s.r&&(u[v]=Ti(v)),l=u[v]+o;var _=f?(t[p]||[])[v]:t[l];if(!_){m=!1;continue}m=m4(n,_,p,v,i,t,m)}}yt(n,146)}function x4(n,t){!t||!t["!merges"]||(yt(n,177,e4(t["!merges"].length)),t["!merges"].forEach(function(e){yt(n,176,t4(e))}),yt(n,178))}function _4(n,t){!t||!t["!cols"]||(yt(n,390),t["!cols"].forEach(function(e,i){e&&yt(n,60,l4(i,e))}),yt(n,391))}function y4(n,t){!t||!t["!ref"]||(yt(n,648),yt(n,649,f4(we(t["!ref"]))),yt(n,650))}function A4(n,t,e){t["!links"].forEach(function(i){if(i[1].Target){var s=he(e,-1,i[1].Target.replace(/#.*$/,""),se.HLINK);yt(n,494,n4(i,s))}}),delete t["!links"]}function E4(n,t,e,i){if(t["!comments"].length>0){var s=he(i,-1,"../drawings/vmlDrawing"+(e+1)+".vml",se.VML);yt(n,551,Md("rId"+s)),t["!legacy"]=s}}function S4(n,t,e,i){if(t["!autofilter"]){var s=t["!autofilter"],l=typeof s.ref=="string"?s.ref:qe(s.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var o=e.Workbook.Names,u=an(l);u.s.r==u.e.r&&(u.e.r=an(t["!ref"]).e.r,l=qe(u));for(var f=0;f<o.length;++f){var d=o[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==i){d.Ref="'"+e.SheetNames[i]+"'!"+l;break}}f==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+e.SheetNames[i]+"'!"+l}),yt(n,161,tl(we(l))),yt(n,162)}}function T4(n,t,e){yt(n,133),yt(n,137,h4(t,e)),yt(n,138),yt(n,134)}function w4(n,t){t["!protect"]&&yt(n,535,d4(t["!protect"]))}function b4(n,t,e,i){var s=Vi(),l=e.SheetNames[n],o=e.Sheets[l]||{},u=l;try{e&&e.Workbook&&(u=e.Workbook.Sheets[n].CodeName||u)}catch{}var f=we(o["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],yt(s,129),(e.vbaraw||o["!outline"])&&yt(s,147,_C(u,o["!outline"])),yt(s,148,mC(f)),T4(s,o,e.Workbook),_4(s,o),v4(s,o,n,t),w4(s,o),S4(s,o,e,n),x4(s,o),A4(s,o,i),o["!margins"]&&yt(s,476,c4(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&y4(s,o),E4(s,o,n,i),yt(s,130),s.end()}function C4(n,t){n.l+=10;var e=wi(n);return{name:e}}var R4=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function D4(n){return!n.Workbook||!n.Workbook.WBProps?"false":aS(n.Workbook.WBProps.date1904)?"true":"false"}var O4="][*?/\\".split("");function j_(n,t){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var e=!0;return O4.forEach(function(i){if(n.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),e}function M4(n,t,e){n.forEach(function(i,s){j_(i);for(var l=0;l<s;++l)if(i==n[l])throw new Error("Duplicate Sheet Name: "+i);if(e){var o=t&&t[s]&&t[s].CodeName||i;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function N4(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var t=n.Workbook&&n.Workbook.Sheets||[];M4(n.SheetNames,t,!!n.vbaraw);for(var e=0;e<n.SheetNames.length;++e)tC(n.Sheets[n.SheetNames[e]],n.SheetNames[e],e)}function X_(n){var t=[We];t[t.length]=Rt("workbook",null,{xmlns:Za[0],"xmlns:r":ri.r});var e=n.Workbook&&(n.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(R4.forEach(function(u){n.Workbook.WBProps[u[0]]!=null&&n.Workbook.WBProps[u[0]]!=u[1]&&(i[u[0]]=n.Workbook.WBProps[u[0]])}),n.Workbook.WBProps.CodeName&&(i.codeName=n.Workbook.WBProps.CodeName,delete i.CodeName)),t[t.length]=Rt("workbookPr",null,i);var s=n.Workbook&&n.Workbook.Sheets||[],l=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",l=0;l!=n.SheetNames.length&&!(!s[l]||!s[l].Hidden);++l);l==n.SheetNames.length&&(l=0),t[t.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",l=0;l!=n.SheetNames.length;++l){var o={name:fe(n.SheetNames[l].slice(0,31))};if(o.sheetId=""+(l+1),o["r:id"]="rId"+(l+1),s[l])switch(s[l].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Rt("sheet",null,o)}return t[t.length]="</sheets>",e&&(t[t.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(u){var f={name:u.Name};u.Comment&&(f.comment=u.Comment),u.Sheet!=null&&(f.localSheetId=""+u.Sheet),u.Hidden&&(f.hidden="1"),u.Ref&&(t[t.length]=Rt("definedName",fe(u.Ref),f))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function L4(n,t){var e={};return e.Hidden=n.read_shift(4),e.iTabID=n.read_shift(4),e.strRelID=nd(n),e.name=wi(n),e}function F4(n,t){return t||(t=dt(127)),t.write_shift(4,n.Hidden),t.write_shift(4,n.iTabID),Md(n.strRelID,t),ai(n.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function k4(n,t){var e={},i=n.read_shift(4);e.defaultThemeVersion=n.read_shift(4);var s=t>8?wi(n):"";return s.length>0&&(e.CodeName=s),e.autoCompressPictures=!!(i&65536),e.backupFile=!!(i&64),e.checkCompatibility=!!(i&4096),e.date1904=!!(i&1),e.filterPrivacy=!!(i&8),e.hidePivotFieldList=!!(i&1024),e.promptedSolutions=!!(i&16),e.publishItems=!!(i&2048),e.refreshAllConnections=!!(i&262144),e.saveExternalLinkValues=!!(i&128),e.showBorderUnselectedTables=!!(i&4),e.showInkAnnotation=!!(i&32),e.showObjects=["all","placeholders","none"][i>>13&3],e.showPivotChartFilter=!!(i&32768),e.updateLinks=["userSet","never","always"][i>>8&3],e}function P4(n,t){t||(t=dt(72));var e=0;return n&&n.filterPrivacy&&(e|=8),t.write_shift(4,e),t.write_shift(4,0),n_(n&&n.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function B4(n,t,e){var i=n.l+t;n.l+=4,n.l+=1;var s=n.read_shift(4),l=DS(n),o=Wb(n,0,e),u=Od(n);n.l=i;var f={Name:l,Ptg:o};return s<268435455&&(f.Sheet=s),u&&(f.Comment=u),f}function I4(n,t){yt(n,143);for(var e=0;e!=t.SheetNames.length;++e){var i=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[e]&&t.Workbook.Sheets[e].Hidden||0,s={Hidden:i,iTabID:e+1,strRelID:"rId"+(e+1),name:t.SheetNames[e]};yt(n,156,F4(s))}yt(n,144)}function U4(n,t){t||(t=dt(127));for(var e=0;e!=4;++e)t.write_shift(4,0);return ai("SheetJS",t),ai(wu.version,t),ai(wu.version,t),ai("7262",t),t.length>t.l?t.slice(0,t.l):t}function H4(n,t){t||(t=dt(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,n),t.write_shift(4,n);var e=120;return t.write_shift(1,e),t.length>t.l?t.slice(0,t.l):t}function z4(n,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var e=t.Workbook.Sheets,i=0,s=-1,l=-1;i<e.length;++i)!e[i]||!e[i].Hidden&&s==-1?s=i:e[i].Hidden==1&&l==-1&&(l=i);l>s||(yt(n,135),yt(n,158,H4(s)),yt(n,136))}}function G4(n,t){var e=Vi();return yt(e,131),yt(e,128,U4()),yt(e,153,P4(n.Workbook&&n.Workbook.WBProps||null)),z4(e,n),I4(e,n),yt(e,132),e.end()}function V4(n,t,e){return(t.slice(-4)===".bin"?G4:X_)(n)}function j4(n,t,e,i,s){return(t.slice(-4)===".bin"?b4:G_)(n,e,i,s)}function X4(n,t,e){return(t.slice(-4)===".bin"?cw:C_)(n,e)}function Y4(n,t,e){return(t.slice(-4)===".bin"?PT:S_)(n,e)}function q4(n,t,e){return(t.slice(-4)===".bin"?ww:N_)(n)}function W4(n){return(n.slice(-4)===".bin"?vw:O_)()}function $4(n,t){var e=[];return n.Props&&e.push(XS(n.Props,t)),n.Custprops&&e.push(YS(n.Props,n.Custprops)),e.join("")}function K4(){return""}function Q4(n,t){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(i,s){var l=[];l.push(Rt("NumberFormat",null,{"ss:Format":fe(ke[i.numFmtId])}));var o={"ss:ID":"s"+(21+s)};e.push(Rt("Style",l.join(""),o))}),Rt("Styles",e.join(""))}function Y_(n){return Rt("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+kd(n.Ref,{r:0,c:0})})}function Z4(n){if(!((n||{}).Workbook||{}).Names)return"";for(var t=n.Workbook.Names,e=[],i=0;i<t.length;++i){var s=t[i];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||e.push(Y_(s)))}return Rt("Names",e.join(""))}function J4(n,t,e,i){if(!n||!((i||{}).Workbook||{}).Names)return"";for(var s=i.Workbook.Names,l=[],o=0;o<s.length;++o){var u=s[o];u.Sheet==e&&(u.Name.match(/^_xlfn\./)||l.push(Y_(u)))}return l.join("")}function tR(n,t,e,i){if(!n)return"";var s=[];if(n["!margins"]&&(s.push("<PageSetup>"),n["!margins"].header&&s.push(Rt("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&s.push(Rt("Footer",null,{"x:Margin":n["!margins"].footer})),s.push(Rt("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),s.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[e])if(i.Workbook.Sheets[e].Hidden)s.push(Rt("Visible",i.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<e&&!(i.Workbook.Sheets[l]&&!i.Workbook.Sheets[l].Hidden);++l);l==e&&s.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),n["!protect"]&&(s.push(vi("ProtectContents","True")),n["!protect"].objects&&s.push(vi("ProtectObjects","True")),n["!protect"].scenarios&&s.push(vi("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?s.push(vi("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&s.push(vi("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){n["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Rt("WorksheetOptions",s.join(""),{xmlns:rn.x})}function eR(n){return n.map(function(t){var e=sS(t.t||""),i=Rt("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return Rt("Comment",i,{"ss:Author":t.a})}).join("")}function iR(n,t,e,i,s,l,o){if(!n||n.v==null&&n.f==null)return"";var u={};if(n.f&&(u["ss:Formula"]="="+fe(kd(n.f,o))),n.F&&n.F.slice(0,t.length)==t){var f=si(n.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(f.r==o.r?"":"["+(f.r-o.r)+"]")+"C"+(f.c==o.c?"":"["+(f.c-o.c)+"]")}if(n.l&&n.l.Target&&(u["ss:HRef"]=fe(n.l.Target),n.l.Tooltip&&(u["x:HRefScreenTip"]=fe(n.l.Tooltip))),e["!merges"])for(var d=e["!merges"],p=0;p!=d.length;++p)d[p].s.c!=o.c||d[p].s.r!=o.r||(d[p].e.c>d[p].s.c&&(u["ss:MergeAcross"]=d[p].e.c-d[p].s.c),d[p].e.r>d[p].s.r&&(u["ss:MergeDown"]=d[p].e.r-d[p].s.r));var m="",v="";switch(n.t){case"z":if(!i.sheetStubs)return"";break;case"n":m="Number",v=String(n.v);break;case"b":m="Boolean",v=n.v?"1":"0";break;case"e":m="Error",v=ko[n.v];break;case"d":m="DateTime",v=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||ke[14]);break;case"s":m="String",v=rS(n.v||"");break}var _=cs(i.cellXfs,n,i);u["ss:StyleID"]="s"+(21+_),u["ss:Index"]=o.c+1;var A=n.v!=null?v:"",y=n.t=="z"?"":'<Data ss:Type="'+m+'">'+A+"</Data>";return(n.c||[]).length>0&&(y+=eR(n.c)),Rt("Cell",y,u)}function nR(n,t){var e='<Row ss:Index="'+(n+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=b_(t.hpt)),t.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(e+=' ss:Hidden="1"')),e+">"}function rR(n,t,e,i){if(!n["!ref"])return"";var s=we(n["!ref"]),l=n["!merges"]||[],o=0,u=[];n["!cols"]&&n["!cols"].forEach(function(E,T){Ld(E);var b=!!E.width,w=Qu(T,E),O={"ss:Index":T+1};b&&(O["ss:Width"]=ku(w.width)),E.hidden&&(O["ss:Hidden"]="1"),u.push(Rt("Column",null,O))});for(var f=Array.isArray(n),d=s.s.r;d<=s.e.r;++d){for(var p=[nR(d,(n["!rows"]||[])[d])],m=s.s.c;m<=s.e.c;++m){var v=!1;for(o=0;o!=l.length;++o)if(!(l[o].s.c>m)&&!(l[o].s.r>d)&&!(l[o].e.c<m)&&!(l[o].e.r<d)){(l[o].s.c!=m||l[o].s.r!=d)&&(v=!0);break}if(!v){var _={r:d,c:m},A=de(_),y=f?(n[d]||[])[m]:n[A];p.push(iR(y,A,n,t,e,i,_))}}p.push("</Row>"),p.length>2&&u.push(p.join(""))}return u.join("")}function sR(n,t,e){var i=[],s=e.SheetNames[n],l=e.Sheets[s],o=l?J4(l,t,n,e):"";return o.length>0&&i.push("<Names>"+o+"</Names>"),o=l?rR(l,t,n,e):"",o.length>0&&i.push("<Table>"+o+"</Table>"),i.push(tR(l,t,n,e)),i.join("")}function aR(n,t){t||(t={}),n.SSF||(n.SSF=Xi(ke)),n.SSF&&(Yu(),Xu(n.SSF),t.revssf=qu(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF,t.cellXfs=[],cs(t.cellXfs,{},{revssf:{General:0}}));var e=[];e.push($4(n,t)),e.push(K4()),e.push(""),e.push("");for(var i=0;i<n.SheetNames.length;++i)e.push(Rt("Worksheet",sR(i,t,n),{"ss:Name":fe(n.SheetNames[i])}));return e[2]=Q4(n,t),e[3]=Z4(n),We+Rt("Workbook",e.join(""),{xmlns:rn.ss,"xmlns:o":rn.o,"xmlns:x":rn.x,"xmlns:ss":rn.ss,"xmlns:dt":rn.dt,"xmlns:html":rn.html})}var j0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function lR(n,t){var e=[],i=[],s=[],l=0,o,u=Ev(kv,"n"),f=Ev(Pv,"n");if(n.Props)for(o=yi(n.Props),l=0;l<o.length;++l)(Object.prototype.hasOwnProperty.call(u,o[l])?e:Object.prototype.hasOwnProperty.call(f,o[l])?i:s).push([o[l],n.Props[o[l]]]);if(n.Custprops)for(o=yi(n.Custprops),l=0;l<o.length;++l)Object.prototype.hasOwnProperty.call(n.Props||{},o[l])||(Object.prototype.hasOwnProperty.call(u,o[l])?e:Object.prototype.hasOwnProperty.call(f,o[l])?i:s).push([o[l],n.Custprops[o[l]]]);var d=[];for(l=0;l<s.length;++l)m_.indexOf(s[l][0])>-1||d_.indexOf(s[l][0])>-1||s[l][1]!=null&&d.push(s[l]);i.length&&ye.utils.cfb_add(t,"/SummaryInformation",zv(i,j0.SI,f,Pv)),(e.length||d.length)&&ye.utils.cfb_add(t,"/DocumentSummaryInformation",zv(e,j0.DSI,u,kv,d.length?d:null,j0.UDI))}function oR(n,t){var e=t||{},i=ye.utils.cfb_new({root:"R"}),s="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":s="/Workbook",e.biff=8;break;case"biff5":s="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return ye.utils.cfb_add(i,s,q_(n,e)),e.biff==8&&(n.Props||n.Custprops)&&lR(n,i),e.biff==8&&n.vbaraw&&bw(i,ye.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),i}var cR={0:{f:fC},1:{f:yC},2:{f:HC},3:{f:RC},4:{f:TC},5:{f:PC},6:{f:XC},7:{f:NC},8:{f:ZC},9:{f:QC},10:{f:$C},11:{f:KC},12:{f:EC},13:{f:GC},14:{f:OC},15:{f:bC},16:{f:IC},17:{f:qC},18:{f:FC},19:{f:Dd},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:B4},40:{},42:{},43:{f:XT},44:{f:VT},45:{f:WT},46:{f:KT},47:{f:$T},48:{},49:{f:ES},50:{},51:{f:fw},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ST},62:{f:jC},63:{f:xw},64:{f:p4},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:er,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:u4},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:xC},148:{f:gC,p:16},151:{f:r4},152:{},153:{f:k4},154:{},155:{},156:{f:L4},157:{},158:{},159:{T:1,f:LT},160:{T:-1},161:{T:1,f:Ys},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:JC},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:uw},336:{T:-1},337:{f:gw,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:nd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:vT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:s4},427:{f:a4},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:o4},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:vC},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:i4},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:nd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Sw},633:{T:1},634:{T:-1},635:{T:1,f:Aw},636:{T:-1},637:{f:bS},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:C4},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:g4},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Dt(n,t,e,i){var s=t;if(!isNaN(s)){var l=i||(e||[]).length||0,o=n.next(4);o.write_shift(2,s),o.write_shift(2,l),l>0&&bd(e)&&n.push(e)}}function uR(n,t,e,i){var s=(e||[]).length||0;if(s<=8224)return Dt(n,t,e,s);var l=t;if(!isNaN(l)){for(var o=e.parts||[],u=0,f=0,d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;var p=n.next(4);for(p.write_shift(2,l),p.write_shift(2,d),n.push(e.slice(f,f+d)),f+=d;f<s;){for(p=n.next(4),p.write_shift(2,60),d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;p.write_shift(2,d),n.push(e.slice(f,f+d)),f+=d}}}function Bo(n,t,e){return n||(n=dt(7)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,0),n.write_shift(1,0),n}function hR(n,t,e,i){var s=dt(9);return Bo(s,n,t),x_(e,i||"b",s),s}function fR(n,t,e){var i=dt(8+2*e.length);return Bo(i,n,t),i.write_shift(1,e.length),i.write_shift(e.length,e,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function dR(n,t,e,i){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?ji(Fi(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Dt(n,2,CT(e,i,s)):Dt(n,3,bT(e,i,s));return;case"b":case"e":Dt(n,5,hR(e,i,t.v,t.t));return;case"s":case"str":Dt(n,4,fR(e,i,(t.v||"").slice(0,255)));return}Dt(n,1,Bo(null,e,i))}function pR(n,t,e,i){var s=Array.isArray(t),l=we(t["!ref"]||"A1"),o,u="",f=[];if(l.e.c>255||l.e.r>16383){if(i.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),o=qe(l)}for(var d=l.s.r;d<=l.e.r;++d){u=xi(d);for(var p=l.s.c;p<=l.e.c;++p){d===l.s.r&&(f[p]=Ti(p)),o=f[p]+u;var m=s?(t[d]||[])[p]:t[o];m&&dR(n,m,d,p)}}}function gR(n,t){for(var e=t||{},i=Vi(),s=0,l=0;l<n.SheetNames.length;++l)n.SheetNames[l]==e.sheet&&(s=l);if(s==0&&e.sheet&&n.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);return Dt(i,e.biff==4?1033:e.biff==3?521:9,Nd(n,16,e)),pR(i,n.Sheets[n.SheetNames[s]],s,e),Dt(i,10),i.end()}function mR(n,t,e){Dt(n,49,cT({sz:12,name:"Arial"},e))}function vR(n,t,e){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)t[s]!=null&&Dt(n,1054,fT(s,t[s],e))})}function xR(n,t){var e=dt(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),Dt(n,2151,e),e=dt(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),A_(we(t["!ref"]||"A1"),e),e.write_shift(4,4),Dt(n,2152,e)}function _R(n,t){for(var e=0;e<16;++e)Dt(n,224,Vv({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(i){Dt(n,224,Vv(i,0,t))})}function yR(n,t){for(var e=0;e<t["!links"].length;++e){var i=t["!links"][e];Dt(n,440,yT(i)),i[1].Tooltip&&Dt(n,2048,AT(i))}delete t["!links"]}function AR(n,t){if(t){var e=0;t.forEach(function(i,s){++e<=256&&i&&Dt(n,125,TT(Qu(s,i),s))})}}function ER(n,t,e,i,s){var l=16+cs(s.cellXfs,t,s);if(t.v==null&&!t.bf){Dt(n,513,Us(e,i,l));return}if(t.bf)Dt(n,6,Yb(t,e,i,s,l));else switch(t.t){case"d":case"n":var o=t.t=="d"?ji(Fi(t.v)):t.v;Dt(n,515,mT(e,i,o,l));break;case"b":case"e":Dt(n,517,gT(e,i,t.v,l,s,t.t));break;case"s":case"str":if(s.bookSST){var u=Bd(s.Strings,t.v,s.revStrings);Dt(n,253,uT(e,i,u,l))}else Dt(n,516,hT(e,i,(t.v||"").slice(0,255),l,s));break;default:Dt(n,513,Us(e,i,l))}}function SR(n,t,e){var i=Vi(),s=e.SheetNames[n],l=e.Sheets[s]||{},o=(e||{}).Workbook||{},u=(o.Sheets||[])[n]||{},f=Array.isArray(l),d=t.biff==8,p,m="",v=[],_=we(l["!ref"]||"A1"),A=d?65536:16384;if(_.e.c>255||_.e.r>=A){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,A-1)}Dt(i,2057,Nd(e,16,t)),Dt(i,13,Tn(1)),Dt(i,12,Tn(100)),Dt(i,15,Ni(!0)),Dt(i,17,Ni(!1)),Dt(i,16,Is(.001)),Dt(i,95,Ni(!0)),Dt(i,42,Ni(!1)),Dt(i,43,Ni(!1)),Dt(i,130,Tn(1)),Dt(i,128,pT()),Dt(i,131,Ni(!1)),Dt(i,132,Ni(!1)),d&&AR(i,l["!cols"]),Dt(i,512,dT(_,t)),d&&(l["!links"]=[]);for(var y=_.s.r;y<=_.e.r;++y){m=xi(y);for(var E=_.s.c;E<=_.e.c;++E){y===_.s.r&&(v[E]=Ti(E)),p=v[E]+m;var T=f?(l[y]||[])[E]:l[p];T&&(ER(i,T,y,E,t),d&&T.l&&l["!links"].push([p,T.l]))}}var b=u.CodeName||u.name||s;return d&&Dt(i,574,oT((o.Views||[])[0])),d&&(l["!merges"]||[]).length&&Dt(i,229,_T(l["!merges"])),d&&yR(i,l),Dt(i,442,y_(b)),d&&xR(i,l),Dt(i,10),i.end()}function TR(n,t,e){var i=Vi(),s=(n||{}).Workbook||{},l=s.Sheets||[],o=s.WBProps||{},u=e.biff==8,f=e.biff==5;if(Dt(i,2057,Nd(n,5,e)),e.bookType=="xla"&&Dt(i,135),Dt(i,225,u?Tn(1200):null),Dt(i,193,$S(2)),f&&Dt(i,191),f&&Dt(i,192),Dt(i,226),Dt(i,92,rT("SheetJS",e)),Dt(i,66,Tn(u?1200:1252)),u&&Dt(i,353,Tn(0)),u&&Dt(i,448),Dt(i,317,wT(n.SheetNames.length)),u&&n.vbaraw&&Dt(i,211),u&&n.vbaraw){var d=o.CodeName||"ThisWorkbook";Dt(i,442,y_(d))}Dt(i,156,Tn(17)),Dt(i,25,Ni(!1)),Dt(i,18,Ni(!1)),Dt(i,19,Tn(0)),u&&Dt(i,431,Ni(!1)),u&&Dt(i,444,Tn(0)),Dt(i,61,lT()),Dt(i,64,Ni(!1)),Dt(i,141,Tn(0)),Dt(i,34,Ni(D4(n)=="true")),Dt(i,14,Ni(!0)),u&&Dt(i,439,Ni(!1)),Dt(i,218,Tn(0)),mR(i,n,e),vR(i,n.SSF,e),_R(i,e),u&&Dt(i,352,Ni(!1));var p=i.end(),m=Vi();u&&Dt(m,140,ET()),u&&e.Strings&&uR(m,252,aT(e.Strings)),Dt(m,10);var v=m.end(),_=Vi(),A=0,y=0;for(y=0;y<n.SheetNames.length;++y)A+=(u?12:11)+(u?2:1)*n.SheetNames[y].length;var E=p.length+A+v.length;for(y=0;y<n.SheetNames.length;++y){var T=l[y]||{};Dt(_,133,sT({pos:E,hs:T.Hidden||0,dt:0,name:n.SheetNames[y]},e)),E+=t[y].length}var b=_.end();if(A!=b.length)throw new Error("BS8 "+A+" != "+b.length);var w=[];return p.length&&w.push(p),b.length&&w.push(b),v.length&&w.push(v),mi(w)}function wR(n,t){var e=t||{},i=[];n&&!n.SSF&&(n.SSF=Xi(ke)),n&&n.SSF&&(Yu(),Xu(n.SSF),e.revssf=qu(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Id(e),e.cellXfs=[],cs(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var s=0;s<n.SheetNames.length;++s)i[i.length]=SR(s,e,n);return i.unshift(TR(n,i,e)),mi(i)}function q_(n,t){for(var e=0;e<=n.SheetNames.length;++e){var i=n.Sheets[n.SheetNames[e]];if(!(!i||!i["!ref"])){var s=an(i["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost.")}}var l=t||{};switch(l.biff||2){case 8:case 5:return wR(n,t);case 4:case 3:case 2:return gR(n,t)}throw new Error("invalid type "+l.bookType+" for BIFF")}function bR(n,t,e,i){for(var s=n["!merges"]||[],l=[],o=t.s.c;o<=t.e.c;++o){for(var u=0,f=0,d=0;d<s.length;++d)if(!(s[d].s.r>e||s[d].s.c>o)&&!(s[d].e.r<e||s[d].e.c<o)){if(s[d].s.r<e||s[d].s.c<o){u=-1;break}u=s[d].e.r-s[d].s.r+1,f=s[d].e.c-s[d].s.c+1;break}if(!(u<0)){var p=de({r:e,c:o}),m=i.dense?(n[e]||[])[o]:n[p],v=m&&m.v!=null&&(m.h||nS(m.w||(Cr(m),m.w)||""))||"",_={};u>1&&(_.rowspan=u),f>1&&(_.colspan=f),i.editable?v='<span contenteditable="true">'+v+"</span>":m&&(_["data-t"]=m&&m.t||"z",m.v!=null&&(_["data-v"]=m.v),m.z!=null&&(_["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+m.l.Target+'">'+v+"</a>")),_.id=(i.id||"sjs")+"-"+p,l.push(Rt("td",v,_))}}var A="<tr>";return A+l.join("")+"</tr>"}var CR='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',RR="</body></html>";function DR(n,t,e){var i=[];return i.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function W_(n,t){var e=t||{},i=e.header!=null?e.header:CR,s=e.footer!=null?e.footer:RR,l=[i],o=an(n["!ref"]);e.dense=Array.isArray(n),l.push(DR(n,o,e));for(var u=o.s.r;u<=o.e.r;++u)l.push(bR(n,o,u,e));return l.push("</table>"+s),l.join("")}function $_(n,t,e){var i=e||{},s=0,l=0;if(i.origin!=null)if(typeof i.origin=="number")s=i.origin;else{var o=typeof i.origin=="string"?si(i.origin):i.origin;s=o.r,l=o.c}var u=t.getElementsByTagName("tr"),f=Math.min(i.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:s,c:l}};if(n["!ref"]){var p=an(n["!ref"]);d.s.r=Math.min(d.s.r,p.s.r),d.s.c=Math.min(d.s.c,p.s.c),d.e.r=Math.max(d.e.r,p.e.r),d.e.c=Math.max(d.e.c,p.e.c),s==-1&&(d.e.r=s=p.e.r+1)}var m=[],v=0,_=n["!rows"]||(n["!rows"]=[]),A=0,y=0,E=0,T=0,b=0,w=0;for(n["!cols"]||(n["!cols"]=[]);A<u.length&&y<f;++A){var O=u[A];if(Kv(O)){if(i.display)continue;_[y]={hidden:!0}}var F=O.children;for(E=T=0;E<F.length;++E){var z=F[E];if(!(i.display&&Kv(z))){var L=z.hasAttribute("data-v")?z.getAttribute("data-v"):z.hasAttribute("v")?z.getAttribute("v"):lS(z.innerHTML),G=z.getAttribute("data-z")||z.getAttribute("z");for(v=0;v<m.length;++v){var V=m[v];V.s.c==T+l&&V.s.r<y+s&&y+s<=V.e.r&&(T=V.e.c+1-l,v=-1)}w=+z.getAttribute("colspan")||1,((b=+z.getAttribute("rowspan")||1)>1||w>1)&&m.push({s:{r:y+s,c:T+l},e:{r:y+s+(b||1)-1,c:T+l+(w||1)-1}});var Q={t:"s",v:L},K=z.getAttribute("data-t")||z.getAttribute("t")||"";L!=null&&(L.length==0?Q.t=K||"z":i.raw||L.trim().length==0||K=="s"||(L==="TRUE"?Q={t:"b",v:!0}:L==="FALSE"?Q={t:"b",v:!1}:isNaN(Tr(L))?isNaN(So(L).getDate())||(Q={t:"d",v:Fi(L)},i.cellDates||(Q={t:"n",v:ji(Q.v)}),Q.z=i.dateNF||ke[14]):Q={t:"n",v:Tr(L)})),Q.z===void 0&&G!=null&&(Q.z=G);var ut="",ht=z.getElementsByTagName("A");if(ht&&ht.length)for(var bt=0;bt<ht.length&&!(ht[bt].hasAttribute("href")&&(ut=ht[bt].getAttribute("href"),ut.charAt(0)!="#"));++bt);ut&&ut.charAt(0)!="#"&&(Q.l={Target:ut}),i.dense?(n[y+s]||(n[y+s]=[]),n[y+s][T+l]=Q):n[de({c:T+l,r:y+s})]=Q,d.e.c<T+l&&(d.e.c=T+l),T+=w}}++y}return m.length&&(n["!merges"]=(n["!merges"]||[]).concat(m)),d.e.r=Math.max(d.e.r,y-1+s),n["!ref"]=qe(d),y>=f&&(n["!fullref"]=qe((d.e.r=u.length-A+y-1+s,d))),n}function K_(n,t){var e=t||{},i=e.dense?[]:{};return $_(i,n,t)}function OR(n,t){return Gs(K_(n,t),t)}function Kv(n){var t="",e=MR(n);return e&&(t=e(n).getPropertyValue("display")),t||(t=n.style&&n.style.display),t==="none"}function MR(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var NR=(function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+wo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return We+t}})(),Qv=(function(){var n=function(l){return fe(l).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,e=`          <table:covered-table-cell/>
`,i=function(l,o,u){var f=[];f.push('      <table:table table:name="'+fe(o.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,p=0,m=an(l["!ref"]||"A1"),v=l["!merges"]||[],_=0,A=Array.isArray(l);if(l["!cols"])for(p=0;p<=m.e.c;++p)f.push("        <table:table-column"+(l["!cols"][p]?' table:style-name="co'+l["!cols"][p].ods+'"':"")+`></table:table-column>
`);var y="",E=l["!rows"]||[];for(d=0;d<m.s.r;++d)y=E[d]?' table:style-name="ro'+E[d].ods+'"':"",f.push("        <table:table-row"+y+`></table:table-row>
`);for(;d<=m.e.r;++d){for(y=E[d]?' table:style-name="ro'+E[d].ods+'"':"",f.push("        <table:table-row"+y+`>
`),p=0;p<m.s.c;++p)f.push(t);for(;p<=m.e.c;++p){var T=!1,b={},w="";for(_=0;_!=v.length;++_)if(!(v[_].s.c>p)&&!(v[_].s.r>d)&&!(v[_].e.c<p)&&!(v[_].e.r<d)){(v[_].s.c!=p||v[_].s.r!=d)&&(T=!0),b["table:number-columns-spanned"]=v[_].e.c-v[_].s.c+1,b["table:number-rows-spanned"]=v[_].e.r-v[_].s.r+1;break}if(T){f.push(e);continue}var O=de({r:d,c:p}),F=A?(l[d]||[])[p]:l[O];if(F&&F.f&&(b["table:formula"]=fe(Zb(F.f)),F.F&&F.F.slice(0,O.length)==O)){var z=an(F.F);b["table:number-matrix-columns-spanned"]=z.e.c-z.s.c+1,b["table:number-matrix-rows-spanned"]=z.e.r-z.s.r+1}if(!F){f.push(t);continue}switch(F.t){case"b":w=F.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=F.v?"true":"false";break;case"n":w=F.w||String(F.v||0),b["office:value-type"]="float",b["office:value"]=F.v||0;break;case"s":case"str":w=F.v==null?"":F.v,b["office:value-type"]="string";break;case"d":w=F.w||Fi(F.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Fi(F.v).toISOString(),b["table:style-name"]="ce1";break;default:f.push(t);continue}var L=n(w);if(F.l&&F.l.Target){var G=F.l.Target;G=G.charAt(0)=="#"?"#"+Jb(G.slice(1)):G,G.charAt(0)!="#"&&!G.match(/^\w+:/)&&(G="../"+G),L=Rt("text:a",L,{"xlink:href":G.replace(/&/g,"&amp;")})}f.push("          "+Rt("table:table-cell",Rt("text:p",L,{}),b)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},s=function(l,o){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var u=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var p=0;p<d["!cols"].length;++p)if(d["!cols"][p]){var m=d["!cols"][p];if(m.width==null&&m.wpx==null&&m.wch==null)continue;Ld(m),m.ods=u;var v=d["!cols"][p].wpx+"px";l.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),l.push(`  </style:style>
`),++u}}});var f=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var p=0;p<d["!rows"].length;++p)if(d["!rows"][p]){d["!rows"][p].ods=f;var m=d["!rows"][p].hpx+"px";l.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),l.push(`  </style:style>
`),++f}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(o,u){var f=[We],d=wo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=wo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(f.push("<office:document"+d+p+`>
`),f.push(h_().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+d+`>
`),s(f,o),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var m=0;m!=o.SheetNames.length;++m)f.push(i(o.Sheets[o.SheetNames[m]],o,m));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),u.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function Q_(n,t){if(t.bookType=="fods")return Qv(n,t);var e=Ed(),i="",s=[],l=[];return i="mimetype",$t(e,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",$t(e,i,Qv(n,t)),s.push([i,"text/xml"]),l.push([i,"ContentFile"]),i="styles.xml",$t(e,i,NR(n,t)),s.push([i,"text/xml"]),l.push([i,"StylesFile"]),i="meta.xml",$t(e,i,We+h_()),s.push([i,"text/xml"]),l.push([i,"MetadataFile"]),i="manifest.rdf",$t(e,i,jS(l)),s.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",$t(e,i,GS(s)),e}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Iu(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function LR(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):Pn(To(n))}function FR(n,t){t:for(var e=0;e<=n.length-t.length;++e){for(var i=0;i<t.length;++i)if(n[e+i]!=t[i])continue t;return!0}return!1}function as(n){var t=n.reduce(function(s,l){return s+l.length},0),e=new Uint8Array(t),i=0;return n.forEach(function(s){e.set(s,i),i+=s.length}),e}function kR(n,t,e){var i=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-20,s=e/Math.pow(10,i-6176);n[t+15]|=i>>7,n[t+14]|=(i&127)<<1;for(var l=0;s>=1;++l,s/=256)n[t+l]=s&255;n[t+15]|=e>=0?0:128}function bo(n,t){var e=t?t[0]:0,i=n[e]&127;t:if(n[e++]>=128&&(i|=(n[e]&127)<<7,n[e++]<128||(i|=(n[e]&127)<<14,n[e++]<128)||(i|=(n[e]&127)<<21,n[e++]<128)||(i+=(n[e]&127)*Math.pow(2,28),++e,n[e++]<128)||(i+=(n[e]&127)*Math.pow(2,35),++e,n[e++]<128)||(i+=(n[e]&127)*Math.pow(2,42),++e,n[e++]<128)))break t;return t&&(t[0]=e),i}function ue(n){var t=new Uint8Array(7);t[0]=n&127;var e=1;t:if(n>127){if(t[e-1]|=128,t[e]=n>>7&127,++e,n<=16383||(t[e-1]|=128,t[e]=n>>14&127,++e,n<=2097151)||(t[e-1]|=128,t[e]=n>>21&127,++e,n<=268435455)||(t[e-1]|=128,t[e]=n/256>>>21&127,++e,n<=34359738367)||(t[e-1]|=128,t[e]=n/65536>>>21&127,++e,n<=4398046511103))break t;t[e-1]|=128,t[e]=n/16777216>>>21&127,++e}return t.slice(0,e)}function Ya(n){var t=0,e=n[t]&127;t:if(n[t++]>=128){if(e|=(n[t]&127)<<7,n[t++]<128||(e|=(n[t]&127)<<14,n[t++]<128)||(e|=(n[t]&127)<<21,n[t++]<128))break t;e|=(n[t]&127)<<28}return e}function Qe(n){for(var t=[],e=[0];e[0]<n.length;){var i=e[0],s=bo(n,e),l=s&7;s=Math.floor(s/8);var o=0,u;if(s==0)break;switch(l){case 0:{for(var f=e[0];n[e[0]++]>=128;);u=n.slice(f,e[0])}break;case 5:o=4,u=n.slice(e[0],e[0]+o),e[0]+=o;break;case 1:o=8,u=n.slice(e[0],e[0]+o),e[0]+=o;break;case 2:o=bo(n,e),u=n.slice(e[0],e[0]+o),e[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(s," at offset ").concat(i))}var d={data:u,type:l};t[s]==null?t[s]=[d]:t[s].push(d)}return t}function fi(n){var t=[];return n.forEach(function(e,i){e.forEach(function(s){s.data&&(t.push(ue(i*8+s.type)),s.type==2&&t.push(ue(s.data.length)),t.push(s.data))})}),as(t)}function Ln(n){for(var t,e=[],i=[0];i[0]<n.length;){var s=bo(n,i),l=Qe(n.slice(i[0],i[0]+s));i[0]+=s;var o={id:Ya(l[1][0].data),messages:[]};l[2].forEach(function(u){var f=Qe(u.data),d=Ya(f[3][0].data);o.messages.push({meta:f,data:n.slice(i[0],i[0]+d)}),i[0]+=d}),(t=l[3])!=null&&t[0]&&(o.merge=Ya(l[3][0].data)>>>0>0),e.push(o)}return e}function La(n){var t=[];return n.forEach(function(e){var i=[];i[1]=[{data:ue(e.id),type:0}],i[2]=[],e.merge!=null&&(i[3]=[{data:ue(+!!e.merge),type:0}]);var s=[];e.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:ue(o.data.length)}],i[2].push({data:fi(o.meta),type:2})});var l=fi(i);t.push(ue(l.length)),t.push(l),s.forEach(function(o){return t.push(o)})}),as(t)}function PR(n,t){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var e=[0],i=bo(t,e),s=[];e[0]<t.length;){var l=t[e[0]]&3;if(l==0){var o=t[e[0]++]>>2;if(o<60)++o;else{var u=o-59;o=t[e[0]],u>1&&(o|=t[e[0]+1]<<8),u>2&&(o|=t[e[0]+2]<<16),u>3&&(o|=t[e[0]+3]<<24),o>>>=0,o++,e[0]+=u}s.push(t.slice(e[0],e[0]+o)),e[0]+=o;continue}else{var f=0,d=0;if(l==1?(d=(t[e[0]]>>2&7)+4,f=(t[e[0]++]&224)<<3,f|=t[e[0]++]):(d=(t[e[0]++]>>2)+1,l==2?(f=t[e[0]]|t[e[0]+1]<<8,e[0]+=2):(f=(t[e[0]]|t[e[0]+1]<<8|t[e[0]+2]<<16|t[e[0]+3]<<24)>>>0,e[0]+=4)),s=[as(s)],f==0)throw new Error("Invalid offset 0");if(f>s[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(s.push(s[0].slice(-f)),d-=f;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-f,-f+d))}}var p=as(s);if(p.length!=i)throw new Error("Unexpected length: ".concat(p.length," != ").concat(i));return p}function Fn(n){for(var t=[],e=0;e<n.length;){var i=n[e++],s=n[e]|n[e+1]<<8|n[e+2]<<16;e+=3,t.push(PR(i,n.slice(e,e+s))),e+=s}if(e!==n.length)throw new Error("data is not a valid framed stream!");return as(t)}function Fa(n){for(var t=[],e=0;e<n.length;){var i=Math.min(n.length-e,268435455),s=new Uint8Array(4);t.push(s);var l=ue(i),o=l.length;t.push(l),i<=60?(o++,t.push(new Uint8Array([i-1<<2]))):i<=256?(o+=2,t.push(new Uint8Array([240,i-1&255]))):i<=65536?(o+=3,t.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(o+=4,t.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(o+=5,t.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),t.push(n.slice(e,e+i)),o+=i,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,e+=i}return as(t)}function X0(n,t){var e=new Uint8Array(32),i=Iu(e),s=12,l=0;switch(e[0]=5,n.t){case"n":e[1]=2,kR(e,s,n.v),l|=1,s+=16;break;case"b":e[1]=6,i.setFloat64(s,n.v?1:0,!0),l|=2,s+=8;break;case"s":if(t.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));e[1]=3,i.setUint32(s,t.indexOf(n.v),!0),l|=8,s+=4;break;default:throw"unsupported cell type "+n.t}return i.setUint32(8,l,!0),e.slice(0,s)}function Y0(n,t){var e=new Uint8Array(32),i=Iu(e),s=12,l=0;switch(e[0]=3,n.t){case"n":e[2]=2,i.setFloat64(s,n.v,!0),l|=32,s+=8;break;case"b":e[2]=6,i.setFloat64(s,n.v?1:0,!0),l|=32,s+=8;break;case"s":if(t.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));e[2]=3,i.setUint32(s,t.indexOf(n.v),!0),l|=16,s+=4;break;default:throw"unsupported cell type "+n.t}return i.setUint32(4,l,!0),e.slice(0,s)}function Jr(n){var t=Qe(n);return bo(t[1][0].data)}function BR(n,t,e){var i,s,l,o;if(!((i=n[6])!=null&&i[0])||!((s=n[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var u=((o=(l=n[8])==null?void 0:l[0])==null?void 0:o.data)&&Ya(n[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var f=0,d=Iu(n[7][0].data),p=0,m=[],v=Iu(n[4][0].data),_=0,A=[],y=0;y<t.length;++y){if(t[y]==null){d.setUint16(y*2,65535,!0),v.setUint16(y*2,65535);continue}d.setUint16(y*2,p,!0),v.setUint16(y*2,_,!0);var E,T;switch(typeof t[y]){case"string":E=X0({t:"s",v:t[y]},e),T=Y0({t:"s",v:t[y]},e);break;case"number":E=X0({t:"n",v:t[y]},e),T=Y0({t:"n",v:t[y]},e);break;case"boolean":E=X0({t:"b",v:t[y]},e),T=Y0({t:"b",v:t[y]},e);break;default:throw new Error("Unsupported value "+t[y])}m.push(E),p+=E.length,A.push(T),_+=T.length,++f}for(n[2][0].data=ue(f);y<n[7][0].data.length/2;++y)d.setUint16(y*2,65535,!0),v.setUint16(y*2,65535,!0);return n[6][0].data=as(m),n[3][0].data=as(A),f}function IR(n,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=an(e["!ref"]);i.s.r=i.s.c=0;var s=!1;i.e.c>9&&(s=!0,i.e.c=9),i.e.r>49&&(s=!0,i.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(qe(i)));var l=Uu(e,{range:i,header:1}),o=["~Sh33tJ5~"];l.forEach(function(k){return k.forEach(function(U){typeof U=="string"&&o.push(U)})});var u={},f=[],d=ye.read(t.numbers,{type:"base64"});d.FileIndex.map(function(k,U){return[k,d.FullPaths[U]]}).forEach(function(k){var U=k[0],j=k[1];if(U.type==2&&U.name.match(/\.iwa/)){var J=U.content,_t=Fn(J),At=Ln(_t);At.forEach(function(vt){f.push(vt.id),u[vt.id]={deps:[],location:j,type:Ya(vt.messages[0].meta[1][0].data)}})}}),f.sort(function(k,U){return k-U});var p=f.filter(function(k){return k>1}).map(function(k){return[k,ue(k)]});d.FileIndex.map(function(k,U){return[k,d.FullPaths[U]]}).forEach(function(k){var U=k[0];if(k[1],!!U.name.match(/\.iwa/)){var j=Ln(Fn(U.content));j.forEach(function(J){J.messages.forEach(function(_t){p.forEach(function(At){J.messages.some(function(vt){return Ya(vt.meta[1][0].data)!=11006&&FR(vt.data,At[1])})&&u[At[0]].deps.push(J.id)})})})}});for(var m=ye.find(d,u[1].location),v=Ln(Fn(m.content)),_,A=0;A<v.length;++A){var y=v[A];y.id==1&&(_=y)}var E=Jr(Qe(_.messages[0].data)[1][0].data);for(m=ye.find(d,u[E].location),v=Ln(Fn(m.content)),A=0;A<v.length;++A)y=v[A],y.id==E&&(_=y);for(E=Jr(Qe(_.messages[0].data)[2][0].data),m=ye.find(d,u[E].location),v=Ln(Fn(m.content)),A=0;A<v.length;++A)y=v[A],y.id==E&&(_=y);for(E=Jr(Qe(_.messages[0].data)[2][0].data),m=ye.find(d,u[E].location),v=Ln(Fn(m.content)),A=0;A<v.length;++A)y=v[A],y.id==E&&(_=y);var T=Qe(_.messages[0].data);{T[6][0].data=ue(i.e.r+1),T[7][0].data=ue(i.e.c+1);var b=Jr(T[46][0].data),w=ye.find(d,u[b].location),O=Ln(Fn(w.content));{for(var F=0;F<O.length&&O[F].id!=b;++F);if(O[F].id!=b)throw"Bad ColumnRowUIDMapArchive";var z=Qe(O[F].messages[0].data);z[1]=[],z[2]=[],z[3]=[];for(var L=0;L<=i.e.c;++L){var G=[];G[1]=G[2]=[{type:0,data:ue(L+420690)}],z[1].push({type:2,data:fi(G)}),z[2].push({type:0,data:ue(L)}),z[3].push({type:0,data:ue(L)})}z[4]=[],z[5]=[],z[6]=[];for(var V=0;V<=i.e.r;++V)G=[],G[1]=G[2]=[{type:0,data:ue(V+726270)}],z[4].push({type:2,data:fi(G)}),z[5].push({type:0,data:ue(V)}),z[6].push({type:0,data:ue(V)});O[F].messages[0].data=fi(z)}w.content=Fa(La(O)),w.size=w.content.length,delete T[46];var Q=Qe(T[4][0].data);{Q[7][0].data=ue(i.e.r+1);var K=Qe(Q[1][0].data),ut=Jr(K[2][0].data);w=ye.find(d,u[ut].location),O=Ln(Fn(w.content));{if(O[0].id!=ut)throw"Bad HeaderStorageBucket";var ht=Qe(O[0].messages[0].data);for(V=0;V<l.length;++V){var bt=Qe(ht[2][0].data);bt[1][0].data=ue(V),bt[4][0].data=ue(l[V].length),ht[2][V]={type:ht[2][0].type,data:fi(bt)}}O[0].messages[0].data=fi(ht)}w.content=Fa(La(O)),w.size=w.content.length;var Et=Jr(Q[2][0].data);w=ye.find(d,u[Et].location),O=Ln(Fn(w.content));{if(O[0].id!=Et)throw"Bad HeaderStorageBucket";for(ht=Qe(O[0].messages[0].data),L=0;L<=i.e.c;++L)bt=Qe(ht[2][0].data),bt[1][0].data=ue(L),bt[4][0].data=ue(i.e.r+1),ht[2][L]={type:ht[2][0].type,data:fi(bt)};O[0].messages[0].data=fi(ht)}w.content=Fa(La(O)),w.size=w.content.length;var Y=Jr(Q[4][0].data);(function(){for(var k=ye.find(d,u[Y].location),U=Ln(Fn(k.content)),j,J=0;J<U.length;++J){var _t=U[J];_t.id==Y&&(j=_t)}var At=Qe(j.messages[0].data);{At[3]=[];var vt=[];o.forEach(function(It,ee){vt[1]=[{type:0,data:ue(ee)}],vt[2]=[{type:0,data:ue(1)}],vt[3]=[{type:2,data:LR(It)}],At[3].push({type:2,data:fi(vt)})})}j.messages[0].data=fi(At);var gt=La(U),Pt=Fa(gt);k.content=Pt,k.size=k.content.length})();var nt=Qe(Q[3][0].data);{var Tt=nt[1][0];delete nt[2];var st=Qe(Tt.data);{var M=Jr(st[2][0].data);(function(){for(var k=ye.find(d,u[M].location),U=Ln(Fn(k.content)),j,J=0;J<U.length;++J){var _t=U[J];_t.id==M&&(j=_t)}var At=Qe(j.messages[0].data);{delete At[6],delete nt[7];var vt=new Uint8Array(At[5][0].data);At[5]=[];for(var gt=0,Pt=0;Pt<=i.e.r;++Pt){var It=Qe(vt);gt+=BR(It,l[Pt],o),It[1][0].data=ue(Pt),At[5].push({data:fi(It),type:2})}At[1]=[{type:0,data:ue(i.e.c+1)}],At[2]=[{type:0,data:ue(i.e.r+1)}],At[3]=[{type:0,data:ue(gt)}],At[4]=[{type:0,data:ue(i.e.r+1)}]}j.messages[0].data=fi(At);var ee=La(U),jt=Fa(ee);k.content=jt,k.size=k.content.length})()}Tt.data=fi(st)}Q[3][0].data=fi(nt)}T[4][0].data=fi(Q)}_.messages[0].data=fi(T);var q=La(v),D=Fa(q);return m.content=D,m.size=m.content.length,d}function UR(n){return function(e){for(var i=0;i!=n.length;++i){var s=n[i];e[s[0]]===void 0&&(e[s[0]]=s[1]),s[2]==="n"&&(e[s[0]]=Number(e[s[0]]))}}}function Id(n){UR([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function HR(n,t){return t.bookType=="ods"?Q_(n,t):t.bookType=="numbers"?IR(n,t):t.bookType=="xlsb"?zR(n,t):GR(n,t)}function zR(n,t){Ha=1024,n&&!n.SSF&&(n.SSF=Xi(ke)),n&&n.SSF&&(Yu(),Xu(n.SSF),t.revssf=qu(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,_o?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e=t.bookType=="xlsb"?"bin":"xml",i=L_.indexOf(t.bookType)>-1,s=o_();Id(t=t||{});var l=Ed(),o="",u=0;if(t.cellXfs=[],cs(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),o="docProps/core.xml",$t(l,o,f_(n.Props,t)),s.coreprops.push(o),he(t.rels,2,o,se.CORE_PROPS),o="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var f=[],d=0;d<n.SheetNames.length;++d)(n.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(n.SheetNames[d]);n.Props.SheetNames=f}for(n.Props.Worksheets=n.Props.SheetNames.length,$t(l,o,p_(n.Props)),s.extprops.push(o),he(t.rels,3,o,se.EXT_PROPS),n.Custprops!==n.Props&&yi(n.Custprops||{}).length>0&&(o="docProps/custom.xml",$t(l,o,g_(n.Custprops)),s.custprops.push(o),he(t.rels,4,o,se.CUST_PROPS)),u=1;u<=n.SheetNames.length;++u){var p={"!id":{}},m=n.Sheets[n.SheetNames[u-1]],v=(m||{})["!type"]||"sheet";switch(v){case"chart":default:o="xl/worksheets/sheet"+u+"."+e,$t(l,o,j4(u-1,o,t,n,p)),s.sheets.push(o),he(t.wbrels,-1,"worksheets/sheet"+u+"."+e,se.WS[0])}if(m){var _=m["!comments"],A=!1,y="";_&&_.length>0&&(y="xl/comments"+u+"."+e,$t(l,y,q4(_,y)),s.comments.push(y),he(p,-1,"../comments"+u+"."+e,se.CMNT),A=!0),m["!legacy"]&&A&&$t(l,"xl/drawings/vmlDrawing"+u+".vml",M_(u,m["!comments"])),delete m["!comments"],delete m["!legacy"]}p["!id"].rId1&&$t(l,u_(o),ja(p))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+e,$t(l,o,Y4(t.Strings,o,t)),s.strs.push(o),he(t.wbrels,-1,"sharedStrings."+e,se.SST)),o="xl/workbook."+e,$t(l,o,V4(n,o)),s.workbooks.push(o),he(t.rels,1,o,se.WB),o="xl/theme/theme1.xml",$t(l,o,D_(n.Themes,t)),s.themes.push(o),he(t.wbrels,-1,"theme/theme1.xml",se.THEME),o="xl/styles."+e,$t(l,o,X4(n,o,t)),s.styles.push(o),he(t.wbrels,-1,"styles."+e,se.STY),n.vbaraw&&i&&(o="xl/vbaProject.bin",$t(l,o,n.vbaraw),s.vba.push(o),he(t.wbrels,-1,"vbaProject.bin",se.VBA)),o="xl/metadata."+e,$t(l,o,W4(o)),s.metadata.push(o),he(t.wbrels,-1,"metadata."+e,se.XLMETA),$t(l,"[Content_Types].xml",c_(s,t)),$t(l,"_rels/.rels",ja(t.rels)),$t(l,"xl/_rels/workbook."+e+".rels",ja(t.wbrels)),delete t.revssf,delete t.ssf,l}function GR(n,t){Ha=1024,n&&!n.SSF&&(n.SSF=Xi(ke)),n&&n.SSF&&(Yu(),Xu(n.SSF),t.revssf=qu(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,_o?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e="xml",i=L_.indexOf(t.bookType)>-1,s=o_();Id(t=t||{});var l=Ed(),o="",u=0;if(t.cellXfs=[],cs(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),o="docProps/core.xml",$t(l,o,f_(n.Props,t)),s.coreprops.push(o),he(t.rels,2,o,se.CORE_PROPS),o="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var f=[],d=0;d<n.SheetNames.length;++d)(n.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(n.SheetNames[d]);n.Props.SheetNames=f}n.Props.Worksheets=n.Props.SheetNames.length,$t(l,o,p_(n.Props)),s.extprops.push(o),he(t.rels,3,o,se.EXT_PROPS),n.Custprops!==n.Props&&yi(n.Custprops||{}).length>0&&(o="docProps/custom.xml",$t(l,o,g_(n.Custprops)),s.custprops.push(o),he(t.rels,4,o,se.CUST_PROPS));var p=["SheetJ5"];for(t.tcid=0,u=1;u<=n.SheetNames.length;++u){var m={"!id":{}},v=n.Sheets[n.SheetNames[u-1]],_=(v||{})["!type"]||"sheet";switch(_){case"chart":default:o="xl/worksheets/sheet"+u+"."+e,$t(l,o,G_(u-1,t,n,m)),s.sheets.push(o),he(t.wbrels,-1,"worksheets/sheet"+u+"."+e,se.WS[0])}if(v){var A=v["!comments"],y=!1,E="";if(A&&A.length>0){var T=!1;A.forEach(function(b){b[1].forEach(function(w){w.T==!0&&(T=!0)})}),T&&(E="xl/threadedComments/threadedComment"+u+"."+e,$t(l,E,_w(A,p,t)),s.threadedcomments.push(E),he(m,-1,"../threadedComments/threadedComment"+u+"."+e,se.TCMNT)),E="xl/comments"+u+"."+e,$t(l,E,N_(A)),s.comments.push(E),he(m,-1,"../comments"+u+"."+e,se.CMNT),y=!0}v["!legacy"]&&y&&$t(l,"xl/drawings/vmlDrawing"+u+".vml",M_(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}m["!id"].rId1&&$t(l,u_(o),ja(m))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+e,$t(l,o,S_(t.Strings,t)),s.strs.push(o),he(t.wbrels,-1,"sharedStrings."+e,se.SST)),o="xl/workbook."+e,$t(l,o,X_(n)),s.workbooks.push(o),he(t.rels,1,o,se.WB),o="xl/theme/theme1.xml",$t(l,o,D_(n.Themes,t)),s.themes.push(o),he(t.wbrels,-1,"theme/theme1.xml",se.THEME),o="xl/styles."+e,$t(l,o,C_(n,t)),s.styles.push(o),he(t.wbrels,-1,"styles."+e,se.STY),n.vbaraw&&i&&(o="xl/vbaProject.bin",$t(l,o,n.vbaraw),s.vba.push(o),he(t.wbrels,-1,"vbaProject.bin",se.VBA)),o="xl/metadata."+e,$t(l,o,O_()),s.metadata.push(o),he(t.wbrels,-1,"metadata."+e,se.XLMETA),p.length>1&&(o="xl/persons/person.xml",$t(l,o,yw(p)),s.people.push(o),he(t.wbrels,-1,"persons/person.xml",se.PEOPLE)),$t(l,"[Content_Types].xml",c_(s,t)),$t(l,"_rels/.rels",ja(t.rels)),$t(l,"xl/_rels/workbook."+e+".rels",ja(t.wbrels)),delete t.revssf,delete t.ssf,l}function VR(n,t){var e="";switch((t||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":e=br(n.slice(0,12));break;case"binary":e=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function Z_(n,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Lo(t.file,ye.write(n,{type:le?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return ye.write(n,t)}function jR(n,t){var e=Xi(t||{}),i=HR(n,e);return XR(i,e)}function XR(n,t){var e={},i=le?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(e.compression="DEFLATE"),t.password)e.type=i;else switch(t.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":e.type=i;break;default:throw new Error("Unrecognized type "+t.type)}var s=n.FullPaths?ye.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!t.compression}):n.generate(e);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(ju(s))}return t.password&&typeof encrypt_agile<"u"?Z_(encrypt_agile(s,t.password),t):t.type==="file"?Lo(t.file,s):t.type=="string"?go(s):s}function YR(n,t){var e=t||{},i=oR(n,e);return Z_(i,e)}function Zn(n,t,e){e||(e="");var i=e+n;switch(t.type){case"base64":return Eo(To(i));case"binary":return To(i);case"string":return n;case"file":return Lo(t.file,i,"utf8");case"buffer":return le?Rr(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):Zn(i,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function qR(n,t){switch(t.type){case"base64":return Eo(n);case"binary":return n;case"string":return n;case"file":return Lo(t.file,n,"binary");case"buffer":return le?Rr(n,"binary"):n.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function du(n,t){switch(t.type){case"string":case"base64":case"binary":for(var e="",i=0;i<n.length;++i)e+=String.fromCharCode(n[i]);return t.type=="base64"?Eo(e):t.type=="string"?go(e):e;case"file":return Lo(t.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+t.type)}}function J_(n,t){AE(),N4(n);var e=Xi(t||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var i=J_(n,e);return e.type="array",ju(i)}var s=0;if(e.sheet&&(typeof e.sheet=="number"?s=e.sheet:s=n.SheetNames.indexOf(e.sheet),!n.SheetNames[s]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return Zn(aR(n,e),e);case"slk":case"sylk":return Zn(DT.from_sheet(n.Sheets[n.SheetNames[s]],e),e);case"htm":case"html":return Zn(W_(n.Sheets[n.SheetNames[s]],e),e);case"txt":return qR(ty(n.Sheets[n.SheetNames[s]],e),e);case"csv":return Zn(Ud(n.Sheets[n.SheetNames[s]],e),e,"\uFEFF");case"dif":return Zn(OT.from_sheet(n.Sheets[n.SheetNames[s]],e),e);case"dbf":return du(RT.from_sheet(n.Sheets[n.SheetNames[s]],e),e);case"prn":return Zn(MT.from_sheet(n.Sheets[n.SheetNames[s]],e),e);case"rtf":return Zn(IT.from_sheet(n.Sheets[n.SheetNames[s]],e),e);case"eth":return Zn(E_.from_sheet(n.Sheets[n.SheetNames[s]],e),e);case"fods":return Zn(Q_(n,e),e);case"wk1":return du(jv.sheet_to_wk1(n.Sheets[n.SheetNames[s]],e),e);case"wk3":return du(jv.book_to_wk3(n,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),du(q_(n,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),YR(n,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return jR(n,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function WR(n){if(!n.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},e=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(n.bookType=e.slice(1)),n.bookType=t[n.bookType]||n.bookType}}function $R(n,t,e){var i={};return i.type="file",i.file=t,WR(i),J_(n,i)}function KR(n,t,e,i,s,l,o,u){var f=xi(e),d=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),m=!0,v=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:e,enumerable:!1})}catch{v.__rowNum__=e}else v.__rowNum__=e;if(!o||n[e])for(var _=t.s.c;_<=t.e.c;++_){var A=o?n[e][_]:n[i[_]+f];if(A===void 0||A.t===void 0){if(d===void 0)continue;l[_]!=null&&(v[l[_]]=d);continue}var y=A.v;switch(A.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+A.t)}if(l[_]!=null){if(y==null)if(A.t=="e"&&y===null)v[l[_]]=null;else if(d!==void 0)v[l[_]]=d;else if(p&&y===null)v[l[_]]=null;else continue;else v[l[_]]=p&&(A.t!=="n"||A.t==="n"&&u.rawNumbers!==!1)?y:Cr(A,y,u);y!=null&&(m=!1)}}return{row:v,isempty:m}}function Uu(n,t){if(n==null||n["!ref"]==null)return[];var e={t:"n",v:0},i=0,s=1,l=[],o=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},p=d.range!=null?d.range:n["!ref"];switch(d.header===1?i=1:d.header==="A"?i=2:Array.isArray(d.header)?i=3:d.header==null&&(i=0),typeof p){case"string":f=we(p);break;case"number":f=we(n["!ref"]),f.s.r=p;break;default:f=p}i>0&&(s=0);var m=xi(f.s.r),v=[],_=[],A=0,y=0,E=Array.isArray(n),T=f.s.r,b=0,w={};E&&!n[T]&&(n[T]=[]);var O=d.skipHidden&&n["!cols"]||[],F=d.skipHidden&&n["!rows"]||[];for(b=f.s.c;b<=f.e.c;++b)if(!(O[b]||{}).hidden)switch(v[b]=Ti(b),e=E?n[T][b]:n[v[b]+m],i){case 1:l[b]=b-f.s.c;break;case 2:l[b]=v[b];break;case 3:l[b]=d.header[b-f.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),u=o=Cr(e,null,d),y=w[o]||0,!y)w[o]=1;else{do u=o+"_"+y++;while(w[u]);w[o]=y,w[u]=1}l[b]=u}for(T=f.s.r+s;T<=f.e.r;++T)if(!(F[T]||{}).hidden){var z=KR(n,f,T,v,i,l,E,d);(z.isempty===!1||(i===1?d.blankrows!==!1:d.blankrows))&&(_[A++]=z.row)}return _.length=A,_}var Zv=/"/g;function QR(n,t,e,i,s,l,o,u){for(var f=!0,d=[],p="",m=xi(e),v=t.s.c;v<=t.e.c;++v)if(i[v]){var _=u.dense?(n[e]||[])[v]:n[i[v]+m];if(_==null)p="";else if(_.v!=null){f=!1,p=""+(u.rawNumbers&&_.t=="n"?_.v:Cr(_,null,u));for(var A=0,y=0;A!==p.length;++A)if((y=p.charCodeAt(A))===s||y===l||y===34||u.forceQuotes){p='"'+p.replace(Zv,'""')+'"';break}p=="ID"&&(p='"ID"')}else _.f!=null&&!_.F?(f=!1,p="="+_.f,p.indexOf(",")>=0&&(p='"'+p.replace(Zv,'""')+'"')):p="";d.push(p)}return u.blankrows===!1&&f?null:d.join(o)}function Ud(n,t){var e=[],i=t??{};if(n==null||n["!ref"]==null)return"";var s=we(n["!ref"]),l=i.FS!==void 0?i.FS:",",o=l.charCodeAt(0),u=i.RS!==void 0?i.RS:`
`,f=u.charCodeAt(0),d=new RegExp((l=="|"?"\\|":l)+"+$"),p="",m=[];i.dense=Array.isArray(n);for(var v=i.skipHidden&&n["!cols"]||[],_=i.skipHidden&&n["!rows"]||[],A=s.s.c;A<=s.e.c;++A)(v[A]||{}).hidden||(m[A]=Ti(A));for(var y=0,E=s.s.r;E<=s.e.r;++E)(_[E]||{}).hidden||(p=QR(n,s,E,m,o,f,l,i),p!=null&&(i.strip&&(p=p.replace(d,"")),(p||i.blankrows!==!1)&&e.push((y++?u:"")+p)));return delete i.dense,e.join("")}function ty(n,t){t||(t={}),t.FS="	",t.RS=`
`;var e=Ud(n,t);return e}function ZR(n){var t="",e,i="";if(n==null||n["!ref"]==null)return[];var s=we(n["!ref"]),l="",o=[],u,f=[],d=Array.isArray(n);for(u=s.s.c;u<=s.e.c;++u)o[u]=Ti(u);for(var p=s.s.r;p<=s.e.r;++p)for(l=xi(p),u=s.s.c;u<=s.e.c;++u)if(t=o[u]+l,e=d?(n[p]||[])[u]:n[t],i="",e!==void 0){if(e.F!=null){if(t=e.F,!e.f)continue;i=e.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(e.f!=null)i=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)i=""+e.v;else if(e.t=="b")i=e.v?"TRUE":"FALSE";else if(e.w!==void 0)i="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?i="'"+e.v:i=""+e.v}}f[f.length]=t+"="+i}return f}function ey(n,t,e){var i=e||{},s=+!i.skipHeader,l=n||{},o=0,u=0;if(l&&i.origin!=null)if(typeof i.origin=="number")o=i.origin;else{var f=typeof i.origin=="string"?si(i.origin):i.origin;o=f.r,u=f.c}var d,p={s:{c:0,r:0},e:{c:u,r:o+t.length-1+s}};if(l["!ref"]){var m=we(l["!ref"]);p.e.c=Math.max(p.e.c,m.e.c),p.e.r=Math.max(p.e.r,m.e.r),o==-1&&(o=m.e.r+1,p.e.r=o+t.length-1+s)}else o==-1&&(o=0,p.e.r=t.length-1+s);var v=i.header||[],_=0;t.forEach(function(y,E){yi(y).forEach(function(T){(_=v.indexOf(T))==-1&&(v[_=v.length]=T);var b=y[T],w="z",O="",F=de({c:u+_,r:o+E+s});d=Co(l,F),b&&typeof b=="object"&&!(b instanceof Date)?l[F]=b:(typeof b=="number"?w="n":typeof b=="boolean"?w="b":typeof b=="string"?w="s":b instanceof Date?(w="d",i.cellDates||(w="n",b=ji(b)),O=i.dateNF||ke[14]):b===null&&i.nullError&&(w="e",b=0),d?(d.t=w,d.v=b,delete d.w,delete d.R,O&&(d.z=O)):l[F]=d={t:w,v:b},O&&(d.z=O))})}),p.e.c=Math.max(p.e.c,u+v.length-1);var A=xi(o);if(s)for(_=0;_<v.length;++_)l[Ti(_+u)+A]={t:"s",v:v[_]};return l["!ref"]=qe(p),l}function JR(n,t){return ey(null,n,t)}function Co(n,t,e){if(typeof t=="string"){if(Array.isArray(n)){var i=si(t);return n[i.r]||(n[i.r]=[]),n[i.r][i.c]||(n[i.r][i.c]={t:"z"})}return n[t]||(n[t]={t:"z"})}return typeof t!="number"?Co(n,de(t)):Co(n,de({r:t,c:e||0}))}function t3(n,t){if(typeof t=="number"){if(t>=0&&n.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var e=n.SheetNames.indexOf(t);if(e>-1)return e;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function e3(){return{SheetNames:[],Sheets:{}}}function i3(n,t,e,i){var s=1;if(!e)for(;s<=65535&&n.SheetNames.indexOf(e="Sheet"+s)!=-1;++s,e=void 0);if(!e||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&n.SheetNames.indexOf(e)>=0){var l=e.match(/(^.*?)(\d+)$/);s=l&&+l[2]||0;var o=l&&l[1]||e;for(++s;s<=65535&&n.SheetNames.indexOf(e=o+s)!=-1;++s);}if(j_(e),n.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return n.SheetNames.push(e),n.Sheets[e]=t,e}function n3(n,t,e){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var i=t3(n,t);switch(n.Workbook.Sheets[i]||(n.Workbook.Sheets[i]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}n.Workbook.Sheets[i].Hidden=e}function r3(n,t){return n.z=t,n}function iy(n,t,e){return t?(n.l={Target:t},e&&(n.l.Tooltip=e)):delete n.l,n}function s3(n,t,e){return iy(n,"#"+t,e)}function a3(n,t,e){n.c||(n.c=[]),n.c.push({t,a:e||"SheetJS"})}function l3(n,t,e,i){for(var s=typeof t!="string"?t:we(t),l=typeof t=="string"?t:qe(t),o=s.s.r;o<=s.e.r;++o)for(var u=s.s.c;u<=s.e.c;++u){var f=Co(n,o,u);f.t="n",f.F=l,delete f.v,o==s.s.r&&u==s.s.c&&(f.f=e,i&&(f.D=!0))}return n}var ro={encode_col:Ti,encode_row:xi,encode_cell:de,encode_range:qe,decode_col:Rd,decode_row:Cd,split_cell:AS,decode_cell:si,decode_range:an,format_cell:Cr,sheet_add_aoa:i_,sheet_add_json:ey,sheet_add_dom:$_,aoa_to_sheet:Ja,json_to_sheet:JR,table_to_sheet:K_,table_to_book:OR,sheet_to_csv:Ud,sheet_to_txt:ty,sheet_to_json:Uu,sheet_to_html:W_,sheet_to_formulae:ZR,sheet_to_row_object_array:Uu,sheet_get_cell:Co,book_new:e3,book_append_sheet:i3,book_set_sheet_visibility:n3,cell_set_number_format:r3,cell_set_hyperlink:iy,cell_set_internal_link:s3,cell_add_comment:a3,sheet_set_array_formula:l3,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Di=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),sd=[.001,0,0,.001,0,0],q0=1.35,tn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},ts={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},ny="pdfjs_internal_editor_",Xt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},ie={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},o3={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},hi={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Eu={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},je={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Ba={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Zu={ERRORS:0,WARNINGS:1,INFOS:5},Ro={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},pu={moveTo:0,lineTo:1,curveTo:2,closePath:3},c3={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Ju=Zu.WARNINGS;function u3(n){Number.isInteger(n)&&(Ju=n)}function h3(){return Ju}function th(n){Ju>=Zu.INFOS&&console.log(`Info: ${n}`)}function qt(n){Ju>=Zu.WARNINGS&&console.log(`Warning: ${n}`)}function Ae(n){throw new Error(n)}function Ye(n,t){n||Ae(t)}function f3(n){switch(n?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ry(n,t=null,e=null){if(!n)return null;if(e&&typeof n=="string"&&(e.addDefaultProtocol&&n.startsWith("www.")&&n.match(/\./g)?.length>=2&&(n=`http://${n}`),e.tryConvertEncoding))try{n=v3(n)}catch{}const i=t?URL.parse(n,t):URL.parse(n);return f3(i)?i:null}function sy(n,t,e=!1){const i=URL.parse(n);return i?(i.hash=t,i.href):e&&ry(n,"http://example.com")?n.split("#",1)[0]+`${t?`#${t}`:""}`:""}function Zt(n,t,e,i=!1){return Object.defineProperty(n,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const qs=(function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t})();class Jv extends qs{constructor(t,e){super(t,"PasswordException"),this.code=e}}class W0 extends qs{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class ad extends qs{constructor(t){super(t,"InvalidPDFException")}}class Hu extends qs{constructor(t,e,i){super(t,"ResponseException"),this.status=e,this.missing=i}}class d3 extends qs{constructor(t){super(t,"FormatError")}}class ls extends qs{constructor(t){super(t,"AbortException")}}function ay(n){(typeof n!="object"||n?.length===void 0)&&Ae("Invalid argument for bytesToString");const t=n.length,e=8192;if(t<e)return String.fromCharCode.apply(null,n);const i=[];for(let s=0;s<t;s+=e){const l=Math.min(s+e,t),o=n.subarray(s,l);i.push(String.fromCharCode.apply(null,o))}return i.join("")}function Io(n){typeof n!="string"&&Ae("Invalid argument for stringToBytes");const t=n.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=n.charCodeAt(i)&255;return e}function p3(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function g3(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function m3(){try{return new Function(""),!0}catch{return!1}}class _i{static get isLittleEndian(){return Zt(this,"isLittleEndian",g3())}static get isEvalSupported(){return Zt(this,"isEvalSupported",m3())}static get isOffscreenCanvasSupported(){return Zt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Zt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return Zt(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return Zt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const $0=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));class kt{static makeHexColor(t,e,i){return`#${$0[t]}${$0[e]}${$0[i]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,i=0){const s=t[i],l=t[i+1];t[i]=s*e[0]+l*e[2]+e[4],t[i+1]=s*e[1]+l*e[3]+e[5]}static applyTransformToBezier(t,e,i=0){const s=e[0],l=e[1],o=e[2],u=e[3],f=e[4],d=e[5];for(let p=0;p<6;p+=2){const m=t[i+p],v=t[i+p+1];t[i+p]=m*s+v*o+f,t[i+p+1]=m*l+v*u+d}}static applyInverseTransform(t,e){const i=t[0],s=t[1],l=e[0]*e[3]-e[1]*e[2];t[0]=(i*e[3]-s*e[2]+e[2]*e[5]-e[4]*e[3])/l,t[1]=(-i*e[1]+s*e[0]+e[4]*e[1]-e[5]*e[0])/l}static axialAlignedBoundingBox(t,e,i){const s=e[0],l=e[1],o=e[2],u=e[3],f=e[4],d=e[5],p=t[0],m=t[1],v=t[2],_=t[3];let A=s*p+f,y=A,E=s*v+f,T=E,b=u*m+d,w=b,O=u*_+d,F=O;if(l!==0||o!==0){const z=l*p,L=l*v,G=o*m,V=o*_;A+=G,T+=G,E+=V,y+=V,b+=z,F+=z,O+=L,w+=L}i[0]=Math.min(i[0],A,E,y,T),i[1]=Math.min(i[1],b,O,w,F),i[2]=Math.max(i[2],A,E,y,T),i[3]=Math.max(i[3],b,O,w,F)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const i=t[0],s=t[1],l=t[2],o=t[3],u=i**2+s**2,f=i*l+s*o,d=l**2+o**2,p=(u+d)/2,m=Math.sqrt(p**2-(u*d-f**2));e[0]=Math.sqrt(p+m||1),e[1]=Math.sqrt(p-m||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),s=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>s)return null;const l=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),o=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return l>o?null:[i,l,s,o]}static pointBoundingBox(t,e,i){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}static rectBoundingBox(t,e,i,s,l){l[0]=Math.min(l[0],t,i),l[1]=Math.min(l[1],e,s),l[2]=Math.max(l[2],t,i),l[3]=Math.max(l[3],e,s)}static#t(t,e,i,s,l,o,u,f,d,p){if(d<=0||d>=1)return;const m=1-d,v=d*d,_=v*d,A=m*(m*(m*t+3*d*e)+3*v*i)+_*s,y=m*(m*(m*l+3*d*o)+3*v*u)+_*f;p[0]=Math.min(p[0],A),p[1]=Math.min(p[1],y),p[2]=Math.max(p[2],A),p[3]=Math.max(p[3],y)}static#e(t,e,i,s,l,o,u,f,d,p,m,v){if(Math.abs(d)<1e-12){Math.abs(p)>=1e-12&&this.#t(t,e,i,s,l,o,u,f,-m/p,v);return}const _=p**2-4*m*d;if(_<0)return;const A=Math.sqrt(_),y=2*d;this.#t(t,e,i,s,l,o,u,f,(-p+A)/y,v),this.#t(t,e,i,s,l,o,u,f,(-p-A)/y,v)}static bezierBoundingBox(t,e,i,s,l,o,u,f,d){d[0]=Math.min(d[0],t,u),d[1]=Math.min(d[1],e,f),d[2]=Math.max(d[2],t,u),d[3]=Math.max(d[3],e,f),this.#e(t,i,l,u,e,s,o,f,3*(-t+3*(i-l)+u),6*(t-2*i+l),3*(i-t),d),this.#e(t,i,l,u,e,s,o,f,3*(-e+3*(s-o)+f),6*(e-2*s+o),3*(s-e),d)}}function v3(n){return decodeURIComponent(escape(n))}let K0=null,tx=null;function x3(n){return K0||(K0=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,tx=new Map([["ﬅ","ſt"]])),n.replaceAll(K0,(t,e,i)=>e?e.normalize("NFKC"):tx.get(i))}function ly(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),ay(n)}const Hd="pdfjs_internal_id_";function _3(n,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[i,s,...l]=e;if(!n(i)&&!Number.isInteger(i)||!t(s))return!1;const o=l.length;let u=!0;switch(s.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;u=!1;break;default:return!1}for(const f of l)if(!(typeof f=="number"||u&&f===null))return!1;return!0}function Oi(n,t,e){return Math.min(Math.max(n,t),e)}function oy(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(ay(n))}function y3(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):Io(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...t){return new Promise(e=>{e(n(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((t,e)=>t+e,0)});const yr="http://www.w3.org/2000/svg";class Qa{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Uo(n,t="text"){if(uo(n,document.baseURI)){const e=await fetch(n);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType=t,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(s.response);return}e(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})}class Ho{constructor({viewBox:t,userUnit:e,scale:i,rotation:s,offsetX:l=0,offsetY:o=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=e,this.scale=i,this.rotation=s,this.offsetX=l,this.offsetY=o,i*=e;const f=(t[2]+t[0])/2,d=(t[3]+t[1])/2;let p,m,v,_;switch(s%=360,s<0&&(s+=360),s){case 180:p=-1,m=0,v=0,_=1;break;case 90:p=0,m=1,v=1,_=0;break;case 270:p=0,m=-1,v=-1,_=0;break;case 0:p=1,m=0,v=0,_=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(v=-v,_=-_);let A,y,E,T;p===0?(A=Math.abs(d-t[1])*i+l,y=Math.abs(f-t[0])*i+o,E=(t[3]-t[1])*i,T=(t[2]-t[0])*i):(A=Math.abs(f-t[0])*i+l,y=Math.abs(d-t[1])*i+o,E=(t[2]-t[0])*i,T=(t[3]-t[1])*i),this.transform=[p*i,m*i,v*i,_*i,A-p*i*f-v*i*d,y-m*i*f-_*i*d],this.width=E,this.height=T}get rawDims(){const t=this.viewBox;return Zt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:l=!1}={}){return new Ho({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:l})}convertToViewportPoint(t,e){const i=[t,e];return kt.applyTransform(i,this.transform),i}convertToViewportRectangle(t){const e=[t[0],t[1]];kt.applyTransform(e,this.transform);const i=[t[2],t[3]];return kt.applyTransform(i,this.transform),[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){const i=[t,e];return kt.applyInverseTransform(i,this.transform),i}}class zd extends qs{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function eh(n){const t=n.length;let e=0;for(;e<t&&n[e].trim()==="";)e++;return n.substring(e,e+5).toLowerCase()==="data:"}function Gd(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function A3(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function E3(n,t="document.pdf"){if(typeof n!="string")return t;if(eh(n))return qt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const i=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(n);if(!i)return t;const s=u=>{try{let f=decodeURIComponent(u);return f.includes("/")?(f=f.split("/").at(-1),f.test(/^\.pdf$/i)?f:u):f}catch{return u}},l=/\.pdf$/i,o=i.pathname.split("/").at(-1);if(l.test(o))return s(o);if(i.searchParams.size>0){const u=Array.from(i.searchParams.values()).reverse();for(const d of u)if(l.test(d))return s(d);const f=Array.from(i.searchParams.keys()).reverse();for(const d of f)if(l.test(d))return s(d)}if(i.hash){const f=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(f)return s(f[0])}return t}class ex{started=Object.create(null);times=[];time(t){t in this.started&&qt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||qt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:s,end:l}of this.times)t.push(`${i.padEnd(e)} ${l-s}ms
`);return t.join("")}}function uo(n,t){const e=t?URL.parse(n,t):URL.parse(n);return e?.protocol==="http:"||e?.protocol==="https:"}function wn(n){n.preventDefault()}function Xe(n){n.preventDefault(),n.stopPropagation()}function S3(n){console.log("Deprecated API usage: "+n)}class ld{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const i=parseInt(e[1],10);let s=parseInt(e[2],10);s=s>=1&&s<=12?s-1:0;let l=parseInt(e[3],10);l=l>=1&&l<=31?l:1;let o=parseInt(e[4],10);o=o>=0&&o<=23?o:0;let u=parseInt(e[5],10);u=u>=0&&u<=59?u:0;let f=parseInt(e[6],10);f=f>=0&&f<=59?f:0;const d=e[7]||"Z";let p=parseInt(e[8],10);p=p>=0&&p<=23?p:0;let m=parseInt(e[9],10)||0;return m=m>=0&&m<=59?m:0,d==="-"?(o+=p,u+=m):d==="+"&&(o-=p,u-=m),new Date(Date.UTC(i,s,l,o,u,f))}}function T3(n,{scale:t=1,rotation:e=0}){const{width:i,height:s}=n.attributes.style,l=[0,0,parseInt(i),parseInt(s)];return new Ho({viewBox:l,userUnit:1,scale:t,rotation:e})}function ih(n){if(n.startsWith("#")){const t=parseInt(n.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(t=>parseInt(t)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(qt(`Not a valid color format: "${n}"`),[0,0,0])}function w3(n){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of n.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;n.set(e,ih(i))}t.remove()}function Oe(n){const{a:t,b:e,c:i,d:s,e:l,f:o}=n.getTransform();return[t,e,i,s,l,o]}function $n(n){const{a:t,b:e,c:i,d:s,e:l,f:o}=n.getTransform().invertSelf();return[t,e,i,s,l,o]}function Hs(n,t,e=!1,i=!0){if(t instanceof Ho){const{pageWidth:s,pageHeight:l}=t.rawDims,{style:o}=n,u=_i.isCSSRoundSupported,f=`var(--total-scale-factor) * ${s}px`,d=`var(--total-scale-factor) * ${l}px`,p=u?`round(down, ${f}, var(--scale-round-x))`:`calc(${f})`,m=u?`round(down, ${d}, var(--scale-round-y))`:`calc(${d})`;!e||t.rotation%180===0?(o.width=p,o.height=m):(o.width=m,o.height=p)}i&&n.setAttribute("data-main-rotation",t.rotation)}class ir{constructor(){const{pixelRatio:t}=ir;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,i,s,l=-1){let o=1/0,u=1/0,f=1/0;i=ir.capPixels(i,l),i>0&&(o=Math.sqrt(i/(t*e))),s!==-1&&(u=s/t,f=s/e);const d=Math.min(o,u,f);return this.sx>d||this.sy>d?(this.sx=d,this.sy=d,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,i):i}return t}}const od=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class yo{#t=null;#e=null;#i;#n=null;#s=null;#r=null;#a=null;static#l=null;constructor(t){this.#i=t,yo.#l||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#i._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",wn,{signal:e}),t.addEventListener("pointerdown",yo.#o,{signal:e}));const i=this.#n=document.createElement("div");i.className="buttons",t.append(i);const s=this.#i.toolbarPosition;if(s){const{style:l}=t,o=this.#i._uiManager.direction==="ltr"?1-s[0]:s[0];l.insetInlineEnd=`${100*o}%`,l.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#o(t){t.stopPropagation()}#c(t){this.#i._focusEventsAllowed=!1,Xe(t)}#f(t){this.#i._focusEventsAllowed=!0,Xe(t)}#u(t){const e=this.#i._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#c.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#f.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",wn,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#s?.shown(),this.#r?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#i,i=document.createElement("button");i.classList.add("basic","deleteButton"),i.tabIndex=0,i.setAttribute("data-l10n-id",yo.#l[t]),this.#u(i)&&i.addEventListener("click",s=>{e.delete()},{signal:e._signal}),this.#n.append(i)}get#d(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#u(e),this.#n.append(e,this.#d),this.#s=t}addComment(t){if(this.#r)return;const e=t.render();e&&(this.#u(e),this.#n.append(e,this.#d),this.#r=t,t.toolbar=this)}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#u(e),this.#n.append(e,this.#d)}async addEditSignatureButton(t){const e=this.#a=await t.renderEditButton(this.#i);this.#u(e),this.#n.append(e,this.#d)}async addButton(t,e){switch(t){case"colorPicker":this.addColorPicker(e);break;case"altText":await this.addAltText(e);break;case"editSignature":await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(e);break}}updateEditSignatureButton(t){this.#a&&(this.#a.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class b3{#t=null;#e=null;#i;constructor(t){this.#i=t}#n(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#i._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",wn,{signal:e});const i=this.#t=document.createElement("div");return i.className="buttons",t.append(i),this.#i.hasCommentManager()&&this.#r("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#i.commentSelection("floating_button")}),this.#r("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#i.highlightSelection("floating_button")}),t}#s(t,e){let i=0,s=0;for(const l of t){const o=l.y+l.height;if(o<i)continue;const u=l.x+(e?l.width:0);if(o>i){s=u,i=o;continue}e?u>s&&(s=u):u<s&&(s=u)}return[e?1-s:s,i]}show(t,e,i){const[s,l]=this.#s(e,i),{style:o}=this.#e||=this.#n();t.append(this.#e),o.insetInlineEnd=`${100*s}%`,o.top=`calc(${100*l}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#r(t,e,i,s){const l=document.createElement("button");l.classList.add("basic",t),l.tabIndex=0,l.setAttribute("data-l10n-id",e);const o=document.createElement("span");l.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",i);const u=this.#i._signal;u instanceof AbortSignal&&!u.aborted&&(l.addEventListener("contextmenu",wn,{signal:u}),l.addEventListener("click",s,{signal:u})),this.#t.append(l)}}function cy(n,t,e){for(const i of e)t.addEventListener(i,n[i].bind(n))}class C3{#t=0;get id(){return`${ny}${this.#t++}`}}class Vd{#t=ly();#e=0;#i=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=t;const l=s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return Zt(this,"_isSVGFittingCanvas",l)}async#n(t,e){this.#i||=new Map;let i=this.#i.get(t);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let s;if(typeof e=="string"?(i.url=e,s=await Uo(e,"blob")):e instanceof File?s=i.file=e:e instanceof Blob&&(s=e),s.type==="image/svg+xml"){const l=Vd._isSVGFittingCanvas,o=new FileReader,u=new Image,f=new Promise((d,p)=>{u.onload=()=>{i.bitmap=u,i.isSvg=!0,d()},o.onload=async()=>{const m=i.svgUrl=o.result;u.src=await l?`${m}#svgView(preserveAspectRatio(none))`:m},u.onerror=o.onerror=p});o.readAsDataURL(s),await f}else i.bitmap=await createImageBitmap(s);i.refCounter=1}catch(s){qt(s),i=null}return this.#i.set(t,i),i&&this.#i.set(i.id,i),i}async getFromFile(t){const{lastModified:e,name:i,size:s,type:l}=t;return this.#n(`${e}_${i}_${s}_${l}`,t)}async getFromUrl(t){return this.#n(t,t)}async getFromBlob(t,e){const i=await e;return this.#n(t,i)}async getFromId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:i}=e;return delete e.blobPromise,this.getFromBlob(e.id,i)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#i||=new Map;let i=this.#i.get(t);if(i?.bitmap)return i.refCounter+=1,i;const s=new OffscreenCanvas(e.width,e.height);return s.getContext("2d").drawImage(e,0,0),i={bitmap:s.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#i.set(t,i),this.#i.set(i.id,i),i}getSvgUrl(t){const e=this.#i.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:i}=e;if(!e.url&&!e.file){const s=new OffscreenCanvas(i.width,i.height);s.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=s.convertToBlob()}i.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class R3{#t=[];#e=!1;#i;#n=-1;constructor(t=128){this.#i=t}add({cmd:t,undo:e,post:i,mustExec:s,type:l=NaN,overwriteIfSameType:o=!1,keepUndo:u=!1}){if(s&&t(),this.#e)return;const f={cmd:t,undo:e,post:i,type:l};if(this.#n===-1){this.#t.length>0&&(this.#t.length=0),this.#n=0,this.#t.push(f);return}if(o&&this.#t[this.#n].type===l){u&&(f.undo=this.#t[this.#n].undo),this.#t[this.#n]=f;return}const d=this.#n+1;d===this.#i?this.#t.splice(0,1):(this.#n=d,d<this.#t.length&&this.#t.splice(d)),this.#t.push(f)}undo(){if(this.#n===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1,this.#n-=1}redo(){if(this.#n<this.#t.length-1){this.#n+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#t.length-1}cleanType(t){if(this.#n!==-1){for(let e=this.#n;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#n-e),this.#n=e;return}this.#t.length=0,this.#n=-1}}destroy(){this.#t=null}}class zo{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=_i.platform;for(const[i,s,l={}]of t)for(const o of i){const u=o.startsWith("mac+");e&&u?(this.callbacks.set(o.slice(4),{callback:s,options:l}),this.allKeys.add(o.split("+").at(-1))):!e&&!u&&(this.callbacks.set(o,{callback:s,options:l}),this.allKeys.add(o.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(this.#t(e));if(!i)return;const{callback:s,options:{bubbles:l=!1,args:o=[],checker:u=null}}=i;u&&!u(t,e)||(s.bind(t,...o,e)(),l||Xe(e))}}class jd{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return w3(t),Zt(this,"_colors",t)}convert(t){const e=ih(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,s]of this._colors)if(s.every((l,o)=>l===e[o]))return jd._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?kt.makeHexColor(...e):t}}class os{#t=new AbortController;#e=null;#i=null;#n=new Map;#s=new Map;#r=null;#a=null;#l=null;#o=new R3;#c=null;#f=null;#u=null;#d=0;#g=new Set;#p=null;#h=null;#m=new Set;_editorUndoBar=null;#_=!1;#v=!1;#A=!1;#E=null;#x=null;#S=null;#R=null;#b=!1;#T=null;#N=new C3;#C=!1;#D=!1;#k=!1;#L=null;#F=null;#P=null;#M=null;#U=null;#w=Xt.NONE;#y=new Set;#H=null;#z=null;#V=null;#W=null;#Y=null;#q={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#B=[0,0];#j=null;#X=null;#Z=null;#J=null;#I=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=os.prototype,e=o=>o.#X.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),i=(o,{target:u})=>{if(u instanceof HTMLInputElement){const{type:f}=u;return f!=="text"&&f!=="number"}return!0},s=this.TRANSLATE_SMALL,l=this.TRANSLATE_BIG;return Zt(this,"_keyboardManager",new zo([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(o,{target:u})=>!(u instanceof HTMLButtonElement)&&o.#X.contains(u)&&!o.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(o,{target:u})=>!(u instanceof HTMLButtonElement)&&o.#X.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-l,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[l,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-l],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,l],checker:e}]]))}constructor(t,e,i,s,l,o,u,f,d,p,m,v,_,A,y,E){const T=this._signal=this.#t.signal;this.#X=t,this.#Z=e,this.#J=i,this.#r=s,this.#c=l,this.#z=o,this.#Y=f,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:T}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:T}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:T}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:T}),u._on("setpreference",this.onSetPreference.bind(this),{signal:T}),u._on("switchannotationeditorparams",b=>this.updateParams(b.type,b.value),{signal:T}),window.addEventListener("pointerdown",()=>{this.#D=!0},{capture:!0,signal:T}),window.addEventListener("pointerup",()=>{this.#D=!1},{capture:!0,signal:T}),this.#ot(),this.#ft(),this.#et(),this.#a=f.annotationStorage,this.#E=f.filterFactory,this.#V=d,this.#R=p||null,this.#_=m,this.#v=v,this.#A=_,this.#U=A||null,this.viewParameters={realScale:Qa.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=y||null,this._supportsPinchToZoom=E!==!1}destroy(){this.#I?.resolve(),this.#I=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#s.values())t.destroy();this.#s.clear(),this.#n.clear(),this.#m.clear(),this.#M?.clear(),this.#e=null,this.#y.clear(),this.#o.destroy(),this.#r?.destroy(),this.#c?.destroy(),this.#z?.destroy(),this.#T?.hide(),this.#T=null,this.#P?.destroy(),this.#P=null,this.#i=null,this.#x&&(clearTimeout(this.#x),this.#x=null),this.#j&&(clearTimeout(this.#j),this.#j=null),this._editorUndoBar?.destroy(),this.#Y=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#U}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#A}get hcmFilter(){return Zt(this,"hcmFilter",this.#V?this.#E.addHCMFilter(this.#V.foreground,this.#V.background):"none")}get direction(){return Zt(this,"direction",getComputedStyle(this.#X).direction)}get _highlightColors(){return Zt(this,"_highlightColors",this.#R?new Map(this.#R.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return Zt(this,"highlightColors",null);const e=new Map,i=!!this.#V;for(const[s,l]of t){const o=s.endsWith("_HCM");if(i&&o){e.set(s.replace("_HCM",""),l);continue}!i&&!o&&e.set(s,l)}return Zt(this,"highlightColors",e)}get highlightColorNames(){return Zt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#u=t}setMainHighlightColorPicker(t){this.#P=t}editAltText(t,e=!1){this.#r?.editAltText(this,t,e)}hasCommentManager(){return!!this.#c}editComment(t,e){this.#c?.open(this,t,e)}getSignature(t){this.#z?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#z}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":this.#A=e;break}}onPageChanging({pageNumber:t}){this.#d=t-1}focusMainContainer(){this.#X.focus()}findParent(t,e){for(const i of this.#s.values()){const{x:s,y:l,width:o,height:u}=i.div.getBoundingClientRect();if(t>=s&&t<=s+o&&e>=l&&e<=l+u)return i}return null}disableUserSelect(t=!1){this.#Z.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#m.add(t)}removeShouldRescale(t){this.#m.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Qa.PDF_TO_CSS_UNITS;for(const e of this.#m)e.onScaleChanging();this.#u?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Q({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of this.#s.values())if(i.hasTextLayer(t))return i;return null}highlightSelection(t="",e=!1){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:s,anchorOffset:l,focusNode:o,focusOffset:u}=i,f=i.toString(),p=this.#Q(i).closest(".textLayer"),m=this.getSelectionBoxes(p);if(!m)return;i.empty();const v=this.#tt(p),_=this.#w===Xt.NONE,A=()=>{const y=v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:m,anchorNode:s,anchorOffset:l,focusNode:o,focusOffset:u,text:f});_&&this.showAllEditors("highlight",!0,!0),e&&y?.editComment()};if(_){this.switchToMode(Xt.HIGHLIGHT,A);return}A()}commentSelection(t=""){this.highlightSelection(t,!0)}#at(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=this.#Q(t).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(this.#T||=new b3(this),this.#T.show(i,s,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#a&&!this.#a.has(t.id)&&this.#a.setValue(t.id,t)}a11yAlert(t,e=null){const i=this.#J;i&&(i.setAttribute("data-l10n-id",t),e?i.setAttribute("data-l10n-args",JSON.stringify(e)):i.removeAttribute("data-l10n-args"))}#lt(){const t=document.getSelection();if(!t||t.isCollapsed){this.#H&&(this.#T?.hide(),this.#H=null,this.#O({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#H)return;const s=this.#Q(t).closest(".textLayer");if(!s){this.#H&&(this.#T?.hide(),this.#H=null,this.#O({hasSelectedText:!1}));return}if(this.#T?.hide(),this.#H=e,this.#O({hasSelectedText:!0}),!(this.#w!==Xt.HIGHLIGHT&&this.#w!==Xt.NONE)&&(this.#w===Xt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#b=this.isShiftKeyDown,!this.isShiftKeyDown)){const l=this.#w===Xt.HIGHLIGHT?this.#tt(s):null;if(l?.toggleDrawing(),this.#D){const o=new AbortController,u=this.combinedSignal(o),f=d=>{d.type==="pointerup"&&d.button!==0||(o.abort(),l?.toggleDrawing(!0),d.type==="pointerup"&&this.#$("main_toolbar"))};window.addEventListener("pointerup",f,{signal:u}),window.addEventListener("blur",f,{signal:u})}else l?.toggleDrawing(!0),this.#$("main_toolbar")}}#$(t=""){this.#w===Xt.HIGHLIGHT?this.highlightSelection(t):this.#_&&this.#at()}#ot(){document.addEventListener("selectionchange",this.#lt.bind(this),{signal:this._signal})}#ct(){if(this.#S)return;this.#S=new AbortController;const t=this.combinedSignal(this.#S);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ut(){this.#S?.abort(),this.#S=null}blur(){if(this.isShiftKeyDown=!1,this.#b&&(this.#b=!1,this.#$("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#y)if(e.div.contains(t)){this.#F=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#F)return;const[t,e]=this.#F;this.#F=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#L)return;this.#L=new AbortController;const t=this.combinedSignal(this.#L);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ht(){this.#L?.abort(),this.#L=null}#it(){if(this.#f)return;this.#f=new AbortController;const t=this.combinedSignal(this.#f);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#nt(){this.#f?.abort(),this.#f=null}#ft(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.#it()}removeEditListeners(){this.#ht(),this.#nt()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of this.#h)if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of this.#h)if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of this.#y){const s=i.serialize(!0);s&&e.push(s)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const l of e.items)for(const o of this.#h)if(o.isHandlingMimeForPasting(l.type)){o.paste(l,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(l){qt(`paste: "${l.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const l=[];for(const f of i){const d=await s.deserialize(f);if(!d)return;l.push(d)}const o=()=>{for(const f of l)this.#rt(f);this.#st(l)},u=()=>{for(const f of l)f.remove()};this.addCommands({cmd:o,undo:u,mustExec:!0})}catch(l){qt(`paste: "${l.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#w!==Xt.NONE&&!this.isEditorHandlingKeyboard&&os._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#b&&(this.#b=!1,this.#$("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#O(t){Object.entries(t).some(([i,s])=>this.#q[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#q,t)}),this.#w===Xt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#G([[ie.HIGHLIGHT_FREE,!0]]))}#G(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ct(),this.#it(),this.#O({isEditing:this.#w!==Xt.NONE,isEmpty:this.#K(),hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:this.#o.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ut(),this.#nt(),this.#O({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#h){this.#h=t;for(const e of this.#h)this.#G(e.defaultPropertiesToUpdate)}}getId(){return this.#N.id}get currentLayer(){return this.#s.get(this.#d)}getLayer(t){return this.#s.get(t)}get currentPageIndex(){return this.#d}addLayer(t){this.#s.set(t.pageIndex,t),this.#C?t.enable():t.disable()}removeLayer(t){this.#s.delete(t.pageIndex)}async updateMode(t,e=null,i=!1,s=!1,l=!1){if(this.#w!==t&&!(this.#I&&(await this.#I.promise,!this.#I))){if(this.#I=Promise.withResolvers(),this.#u?.commitOrRemove(),this.#w===Xt.POPUP&&this.#c?.hideSidebar(),this.#w=t,t===Xt.NONE){this.setEditingState(!1),this.#pt(),this._editorUndoBar?.hide(),this.#I.resolve();return}t===Xt.SIGNATURE&&await this.#z?.loadSignatures(),t===Xt.POPUP&&(this.#i||=await this.#Y.getAnnotationsByType(new Set(this.#h.map(o=>o._editorType))),this.#c?.showSidebar(this.#i)),this.setEditingState(!0),await this.#dt(),this.unselectAll();for(const o of this.#s.values())o.updateMode(t);if(!e){i&&this.addNewEditorFromKeyboard(),this.#I.resolve();return}for(const o of this.#n.values())o.annotationElementId===e||o.id===e?(this.setSelected(o),l?o.editComment():s&&o.enterInEditMode()):o.unselect();this.#I.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#w&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#h){switch(t){case ie.CREATE:this.currentLayer.addNewEditor(e);return;case ie.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#W||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const i of this.#y)i.updateParams(t,e);else for(const i of this.#h)i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){for(const l of this.#n.values())l.editorType===t&&l.show(e);(this.#W?.get(ie.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#G([[ie.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#k!==t){this.#k=t;for(const e of this.#s.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#dt(){if(!this.#C){this.#C=!0;const t=[];for(const e of this.#s.values())t.push(e.enable());await Promise.all(t);for(const e of this.#n.values())e.enable()}}#pt(){if(this.unselectAll(),this.#C){this.#C=!1;for(const t of this.#s.values())t.disable();for(const t of this.#n.values())t.disable()}}getEditors(t){const e=[];for(const i of this.#n.values())i.pageIndex===t&&e.push(i);return e}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.focusMainContainer(),this.#x=null},0)),this.#n.delete(t.id),t.annotationElementId&&this.#M?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#g.has(t.annotationElementId))&&this.#a?.remove(t.id)}addDeletedAnnotationElement(t){this.#g.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#g.has(t)}removeDeletedAnnotationElement(t){this.#g.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#rt(t){const e=this.#s.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#G(t.propertiesToUpdate))}get#gt(){let t=null;for(t of this.#y);return t}updateUI(t){this.#gt===t&&this.#G(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#G(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#y.has(t)){this.#y.delete(t),t.unselect(),this.#O({hasSelectedEditor:this.hasSelection});return}this.#y.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.id}),this.#u?.commitOrRemove();for(const e of this.#y)e!==t&&e.unselect();this.#y.clear(),this.#y.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}isSelected(t){return this.#y.has(t)}get firstSelectedEditor(){return this.#y.values().next().value}unselect(t){t.unselect(),this.#y.delete(t),this.#O({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#y.size!==0}get isEnterHandled(){return this.#y.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#o.undo(),this.#O({hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#K()}),this._editorUndoBar?.hide()}redo(){this.#o.redo(),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:this.#o.hasSomethingToRedo(),isEmpty:this.#K()})}addCommands(t){this.#o.add(t),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#K()})}cleanUndoStack(t){this.#o.cleanType(t)}#K(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const t of this.#n.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#y],i=()=>{this._editorUndoBar?.show(s,e.length===1?e[0].editorType:e.length);for(const l of e)l.remove()},s=()=>{for(const l of e)this.#rt(l)};this.addCommands({cmd:i,undo:s,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#st(t){for(const e of this.#y)e.unselect();this.#y.clear();for(const e of t)e.isEmpty()||(this.#y.add(e),e.select());this.#O({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#y)t.commit();this.#st(this.#n.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#w!==Xt.NONE))&&!this.#u?.commitOrRemove()&&this.hasSelection){for(const t of this.#y)t.unselect();this.#y.clear(),this.#O({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#B[0]+=t,this.#B[1]+=e;const[s,l]=this.#B,o=[...this.#y],u=1e3;this.#j&&clearTimeout(this.#j),this.#j=setTimeout(()=>{this.#j=null,this.#B[0]=this.#B[1]=0,this.addCommands({cmd:()=>{for(const f of o)this.#n.has(f.id)&&(f.translateInPage(s,l),f.translationDone())},undo:()=>{for(const f of o)this.#n.has(f.id)&&(f.translateInPage(-s,-l),f.translationDone())},mustExec:!1})},u);for(const f of o)f.translateInPage(t,e),f.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#p=new Map;for(const t of this.#y)this.#p.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#p)return!1;this.disableUserSelect(!1);const t=this.#p;this.#p=null;let e=!1;for(const[{x:s,y:l,pageIndex:o},u]of t)u.newX=s,u.newY=l,u.newPageIndex=o,e||=s!==u.savedX||l!==u.savedY||o!==u.savedPageIndex;if(!e)return!1;const i=(s,l,o,u)=>{if(this.#n.has(s.id)){const f=this.#s.get(u);f?s._setParentAndPosition(f,l,o):(s.pageIndex=u,s.x=l,s.y=o)}};return this.addCommands({cmd:()=>{for(const[s,{newX:l,newY:o,newPageIndex:u}]of t)i(s,l,o,u)},undo:()=>{for(const[s,{savedX:l,savedY:o,savedPageIndex:u}]of t)i(s,l,o,u)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#p)for(const i of this.#p.keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#y.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#w}get imageManager(){return Zt(this,"imageManager",new Vd)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let d=0,p=e.rangeCount;d<p;d++)if(!t.contains(e.getRangeAt(d).commonAncestorContainer))return null;const{x:i,y:s,width:l,height:o}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(d,p,m,v)=>({x:(p-s)/o,y:1-(d+m-i)/l,width:v/o,height:m/l});break;case"180":u=(d,p,m,v)=>({x:1-(d+m-i)/l,y:1-(p+v-s)/o,width:m/l,height:v/o});break;case"270":u=(d,p,m,v)=>({x:1-(p+v-s)/o,y:(d-i)/l,width:v/o,height:m/l});break;default:u=(d,p,m,v)=>({x:(d-i)/l,y:(p-s)/o,width:m/l,height:v/o});break}const f=[];for(let d=0,p=e.rangeCount;d<p;d++){const m=e.getRangeAt(d);if(!m.collapsed)for(const{x:v,y:_,width:A,height:y}of m.getClientRects())A===0||y===0||f.push(u(v,_,A,y))}return f.length===0?null:f}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#l||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#l?.delete(t)}renderAnnotationElement(t){const e=this.#l?.get(t.data.id);if(!e)return;const i=this.#a.getRawValue(e);i&&(this.#w===Xt.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}setMissingCanvas(t,e,i){const s=this.#M?.get(t);s&&(s.setCanvas(e,i),this.#M.delete(t))}addMissingCanvas(t,e){(this.#M||=new Map).set(t,e)}}class tr{#t=null;#e=!1;#i=null;#n=null;#s=null;#r=null;#a=!1;#l=null;#o=null;#c=null;#f=null;#u=!1;static#d=null;static _l10n=null;constructor(t){this.#o=t,this.#u=t._uiManager.useNewAltTextFlow,tr.#d||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){tr._l10n??=t}async render(){const t=this.#i=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#n=document.createElement("span");t.append(e),this.#u?(t.classList.add("new"),t.setAttribute("data-l10n-id",tr.#d.missing),e.setAttribute("data-l10n-id",tr.#d["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#o._uiManager._signal;t.addEventListener("contextmenu",wn,{signal:i}),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:i});const s=l=>{l.preventDefault(),this.#o._uiManager.editAltText(this.#o),this.#u&&this.#o._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return t.addEventListener("click",s,{capture:!0,signal:i}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#a=!0,s(l))},{signal:i}),await this.#p(),t}get#g(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#i&&(this.#i.focus({focusVisible:this.#a}),this.#a=!1)}isEmpty(){return this.#u?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#u?this.#t!==null||!!this.#c:this.isEmpty()}get guessedText(){return this.#c}async setGuessedText(t){this.#t===null&&(this.#c=t,this.#f=await tr._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#u||this.#t){this.#l?.remove(),this.#l=null;return}if(!this.#l){const e=this.#l=document.createElement("div");e.className="noAltTextBadge",this.#o.div.append(e)}this.#l.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#c===e&&(e=this.#f),{altText:e,decorative:this.#e,guessedText:this.#c,textWithDisclaimer:this.#f}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:s,cancel:l=!1}){i&&(this.#c=i,this.#f=s),!(this.#t===t&&this.#e===e)&&(l||(this.#t=t,this.#e=e),this.#p())}toggle(t=!1){this.#i&&(!t&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#i.disabled=!t)}shown(){this.#o._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#i?.remove(),this.#i=null,this.#n=null,this.#s=null,this.#l?.remove(),this.#l=null}async#p(){const t=this.#i;if(!t)return;if(this.#u){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",tr.#d[this.#g]),this.#n?.setAttribute("data-l10n-id",tr.#d[`${this.#g}-label`]),!this.#t){this.#s?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#s?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#s;if(!e){this.#s=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#o.id}`;const s=100,l=this.#o._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#s.classList.add("show"),this.#o._reportTelemetry({action:"alt_text_tooltip"})},s)},{signal:l}),t.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#s?.classList.remove("show")},{signal:l})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#o.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class gu{#t=null;#e=!1;#i=null;#n=null;#s=null;#r=null;#a=!1;constructor(t){this.#i=t,this.toolbar=null}render(){if(!this.#i._uiManager.hasCommentManager())return null;const t=this.#t=document.createElement("button");t.className="comment",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button");const e=this.#i._uiManager._signal;if(!(e instanceof AbortSignal)||e.aborted)return t;t.addEventListener("contextmenu",wn,{signal:e}),t.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:e});const i=s=>{s.preventDefault(),this.edit()};return t.addEventListener("click",i,{capture:!0,signal:e}),t.addEventListener("keydown",s=>{s.target===t&&s.key==="Enter"&&(this.#e=!0,i(s))},{signal:e}),t}edit(){const{bottom:t,left:e,right:i}=this.#i.getClientDimensions(),s={top:t};this.#i._uiManager.direction==="ltr"?s.right=i:s.left=e,this.#i._uiManager.editComment(this.#i,s)}finish(){this.#t&&(this.#t.focus({focusVisible:this.#e}),this.#e=!1)}isDeleted(){return this.#a||this.#s===""}hasBeenEdited(){return this.isDeleted()||this.#s!==this.#n}serialize(){return this.data}get data(){return{text:this.#s,date:this.#r,deleted:this.#a}}set data(t){if(t===null){this.#s="",this.#a=!0;return}this.#s=t,this.#r=new Date,this.#a=!1}setInitialText(t){this.#n=t,this.data=t}toggle(t=!1){this.#t&&(this.#t.disabled=!t)}shown(){}destroy(){this.#t?.remove(),this.#t=null,this.#s="",this.#r=null,this.#i=null,this.#e=!1,this.#a=!1}}class nh{#t;#e=!1;#i=null;#n;#s;#r;#a;#l=null;#o;#c=null;#f;#u=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:i=null,onPinchStart:s=null,onPinching:l=null,onPinchEnd:o=null,signal:u}){this.#t=t,this.#i=i,this.#n=e,this.#s=s,this.#r=l,this.#a=o,this.#f=new AbortController,this.#o=AbortSignal.any([u,this.#f.signal]),t.addEventListener("touchstart",this.#d.bind(this),{passive:!1,signal:this.#o})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/ir.pixelRatio}#d(t){if(this.#n?.())return;if(t.touches.length===1){if(this.#l)return;const s=this.#l=new AbortController,l=AbortSignal.any([this.#o,s.signal]),o=this.#t,u={capture:!0,signal:l,passive:!1},f=d=>{d.pointerType==="touch"&&(this.#l?.abort(),this.#l=null)};o.addEventListener("pointerdown",d=>{d.pointerType==="touch"&&(Xe(d),f(d))},u),o.addEventListener("pointerup",f,u),o.addEventListener("pointercancel",f,u);return}if(!this.#u){this.#u=new AbortController;const s=AbortSignal.any([this.#o,this.#u.signal]),l=this.#t,o={signal:s,capture:!1,passive:!1};l.addEventListener("touchmove",this.#g.bind(this),o);const u=this.#p.bind(this);l.addEventListener("touchend",u,o),l.addEventListener("touchcancel",u,o),o.capture=!0,l.addEventListener("pointerdown",Xe,o),l.addEventListener("pointermove",Xe,o),l.addEventListener("pointercancel",Xe,o),l.addEventListener("pointerup",Xe,o),this.#s?.()}if(Xe(t),t.touches.length!==2||this.#i?.()){this.#c=null;return}let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]),this.#c={touch0X:e.screenX,touch0Y:e.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#g(t){if(!this.#c||t.touches.length!==2)return;Xe(t);let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]);const{screenX:s,screenY:l}=e,{screenX:o,screenY:u}=i,f=this.#c,{touch0X:d,touch0Y:p,touch1X:m,touch1Y:v}=f,_=m-d,A=v-p,y=o-s,E=u-l,T=Math.hypot(y,E)||1,b=Math.hypot(_,A)||1;if(!this.#e&&Math.abs(b-T)<=nh.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(f.touch0X=s,f.touch0Y=l,f.touch1X=o,f.touch1Y=u,!this.#e){this.#e=!0;return}const w=[(s+o)/2,(l+u)/2];this.#r?.(w,b,T)}#p(t){t.touches.length>=2||(this.#u&&(this.#u.abort(),this.#u=null,this.#a?.()),this.#c&&(Xe(t),this.#c=null,this.#e=!1))}destroy(){this.#f?.abort(),this.#f=null,this.#l?.abort(),this.#l=null}}class Ut{#t=null;#e=null;#i=null;#n=null;#s=!1;#r=null;#a="";#l=!1;#o=null;#c=null;#f=null;#u=null;#d="";#g=!1;#p=null;#h=!1;#m=!1;#_=!1;#v=null;#A=0;#E=0;#x=null;#S=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#R=!1;#b=Ut._zIndex++;static _borderLineWidth=-1;static _colorManager=new jd;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=Ut.prototype._resizeWithKeyboard,e=os.TRANSLATE_SMALL,i=os.TRANSLATE_BIG;return Zt(this,"_resizerKeyboardManager",new zo([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],Ut.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null;const{rotation:e,rawDims:{pageWidth:i,pageHeight:s,pageX:l,pageY:o}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[l,o];const[u,f]=this.parentDimensions;this.x=t.x/u,this.y=t.y/f,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Zt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new D3({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Ut._l10n??=t,Ut._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Ut._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);Ut._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Ae("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#R}set _isDraggable(t){this.#R=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#b}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):this.#B(),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,s){const[l,o]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(t+i)/l,this.y=(e+s)/o,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[i,s]=this.parentDimensions;this.setAt(t*i,e*s,this.width*i,this.height*s),this._onTranslated()}#T([t,e],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/t,this.y+=s/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#T(this.parentDimensions,t,e)}translateInPage(t,e){this.#p||=[this.x,this.y,this.width,this.height],this.#T(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#p||=[this.x,this.y,this.width,this.height];const{div:i,parentDimensions:[s,l]}=this;if(this.x+=t/s,this.y+=e/l,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:m,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,m,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:u}=this;const[f,d]=this.getBaseTranslation();o+=f,u+=d;const{style:p}=i;p.left=`${(100*o).toFixed(2)}%`,p.top=`${(100*u).toFixed(2)}%`,this._onTranslating(o,u),i.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#p&&(this.#p[0]!==this.x||this.#p[1]!==this.y)}get _hasBeenResized(){return!!this.#p&&(this.#p[2]!==this.width||this.#p[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=Ut,s=i/t,l=i/e;switch(this.rotation){case 90:return[-s,l];case 180:return[s,l];case 270:return[s,-l];default:return[-s,-l]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[i,s]}=this;let{x:l,y:o,width:u,height:f}=this;if(u*=i,f*=s,l*=i,o*=s,this._mustFixPosition)switch(t){case 0:l=Oi(l,0,i-u),o=Oi(o,0,s-f);break;case 90:l=Oi(l,0,i-f),o=Oi(o,u,s);break;case 180:l=Oi(l,u,i),o=Oi(o,f,s);break;case 270:l=Oi(l,f,i),o=Oi(o,0,s-u);break}this.x=l/=i,this.y=o/=s;const[d,p]=this.getBaseTranslation();l+=d,o+=p,e.left=`${(100*l).toFixed(2)}%`,e.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}static#N(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return Ut.#N(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return Ut.#N(t,e,360-this.parentRotation)}#C(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(t,e){const[i,s]=this.parentDimensions,{style:l}=this.div;l.width=`${(100*t/i).toFixed(2)}%`,this.#l||(l.height=`${(100*e/s).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:i}=t,s=i.endsWith("%"),l=!this.#l&&e.endsWith("%");if(s&&l)return;const[o,u]=this.parentDimensions;s||(t.width=`${(100*parseFloat(i)/o).toFixed(2)}%`),!this.#l&&!l&&(t.height=`${(100*parseFloat(e)/u).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#D(){if(this.#o)return;this.#o=document.createElement("div"),this.#o.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const s=document.createElement("div");this.#o.append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",this.#k.bind(this,i),{signal:e}),s.addEventListener("contextmenu",wn,{signal:e}),s.tabIndex=-1}this.div.prepend(this.#o)}#k(t,e){e.preventDefault();const{isMac:i}=_i.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#i?.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,this.#c=[e.screenX,e.screenY];const l=new AbortController,o=this._uiManager.combinedSignal(l);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#P.bind(this,t),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",Xe,{passive:!1,signal:o}),window.addEventListener("contextmenu",wn,{signal:o}),this.#f={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,f=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const d=()=>{l.abort(),this.parent.togglePointerEvents(!0),this.#i?.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=u,this.div.style.cursor=f,this.#F()};window.addEventListener("pointerup",d,{signal:o}),window.addEventListener("blur",d,{signal:o})}#L(t,e,i,s){this.width=i,this.height=s,this.x=t,this.y=e;const[l,o]=this.parentDimensions;this.setDims(l*i,o*s),this.fixAndSetPosition(),this._onResized()}_onResized(){}#F(){if(!this.#f)return;const{savedX:t,savedY:e,savedWidth:i,savedHeight:s}=this.#f;this.#f=null;const l=this.x,o=this.y,u=this.width,f=this.height;l===t&&o===e&&u===i&&f===s||this.addCommands({cmd:this.#L.bind(this,l,o,u,f),undo:this.#L.bind(this,t,e,i,s),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#P(t,e){const[i,s]=this.parentDimensions,l=this.x,o=this.y,u=this.width,f=this.height,d=Ut.MIN_SIZE/i,p=Ut.MIN_SIZE/s,m=this.#C(this.rotation),v=(Y,nt)=>[m[0]*Y+m[2]*nt,m[1]*Y+m[3]*nt],_=this.#C(360-this.rotation),A=(Y,nt)=>[_[0]*Y+_[2]*nt,_[1]*Y+_[3]*nt];let y,E,T=!1,b=!1;switch(t){case"topLeft":T=!0,y=(Y,nt)=>[0,0],E=(Y,nt)=>[Y,nt];break;case"topMiddle":y=(Y,nt)=>[Y/2,0],E=(Y,nt)=>[Y/2,nt];break;case"topRight":T=!0,y=(Y,nt)=>[Y,0],E=(Y,nt)=>[0,nt];break;case"middleRight":b=!0,y=(Y,nt)=>[Y,nt/2],E=(Y,nt)=>[0,nt/2];break;case"bottomRight":T=!0,y=(Y,nt)=>[Y,nt],E=(Y,nt)=>[0,0];break;case"bottomMiddle":y=(Y,nt)=>[Y/2,nt],E=(Y,nt)=>[Y/2,0];break;case"bottomLeft":T=!0,y=(Y,nt)=>[0,nt],E=(Y,nt)=>[Y,0];break;case"middleLeft":b=!0,y=(Y,nt)=>[0,nt/2],E=(Y,nt)=>[Y,nt/2];break}const w=y(u,f),O=E(u,f);let F=v(...O);const z=Ut._round(l+F[0]),L=Ut._round(o+F[1]);let G=1,V=1,Q,K;if(e.fromKeyboard)({deltaX:Q,deltaY:K}=e);else{const{screenX:Y,screenY:nt}=e,[Tt,st]=this.#c;[Q,K]=this.screenToPageTranslation(Y-Tt,nt-st),this.#c[0]=Y,this.#c[1]=nt}if([Q,K]=A(Q/i,K/s),T){const Y=Math.hypot(u,f);G=V=Math.max(Math.min(Math.hypot(O[0]-w[0]-Q,O[1]-w[1]-K)/Y,1/u,1/f),d/u,p/f)}else b?G=Oi(Math.abs(O[0]-w[0]-Q),d,1)/u:V=Oi(Math.abs(O[1]-w[1]-K),p,1)/f;const ut=Ut._round(u*G),ht=Ut._round(f*V);F=v(...E(ut,ht));const bt=z-F[0],Et=L-F[1];this.#p||=[this.x,this.y,this.width,this.height],this.width=ut,this.height=ht,this.x=bt,this.y=Et,this.setDims(i*ut,s*ht),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#i?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#m)return this._editToolbar;this._editToolbar=new yo(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,i]of t)await this._editToolbar.addButton(e,i);return this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#i?.destroy())}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#i||(tr.initialize(Ut._l10n),this.#i=new tr(this),this.#t&&(this.#i.data=this.#t,this.#t=null)),this.#i}get altTextData(){return this.#i?.data}set altTextData(t){this.#i&&(this.#i.data=t)}get guessedAltText(){return this.#i?.guessedText}async setGuessedAltText(t){await this.#i?.setGuessedText(t)}serializeAltText(t){return this.#i?.serialize(t)}hasAltText(){return!!this.#i&&!this.#i.isEmpty()}hasAltTextData(){return this.#i?.hasData()??!1}addCommentButton(){return this.#n?this.#n:this.#n=new gu(this)}get commentColor(){return null}get comment(){const t=this.#n;return{text:t.data.text,date:t.data.date,deleted:t.isDeleted(),color:this.commentColor}}set comment(t){this.#n||(this.#n=new gu(this)),this.#n.data=t}setCommentData(t){this.#n||(this.#n=new gu(this)),this.#n.setInitialText(t)}get hasEditedComment(){return this.#n?.hasBeenEdited()}async editComment(){this.#n||(this.#n=new gu(this)),this.#n.edit()}addComment(t){if(this.hasEditedComment){const[,,,s]=t.rect,[l]=this.pageDimensions,[o]=this.pageTranslation,u=o+l+1,f=s-100,d=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,f,d,s]}}}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#s?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#z();const[e,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*i/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[s,l]=this.getInitialTranslation();return this.translate(s,l),cy(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#S||=new nh({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#M.bind(this),onPinching:this.#U.bind(this),onPinchEnd:this.#w.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),t}#M(){this.#f={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#i?.toggle(!1),this.parent.togglePointerEvents(!1)}#U(t,e,i){let l=.7*(i/e)+1-.7;if(l===1)return;const o=this.#C(this.rotation),u=(z,L)=>[o[0]*z+o[2]*L,o[1]*z+o[3]*L],[f,d]=this.parentDimensions,p=this.x,m=this.y,v=this.width,_=this.height,A=Ut.MIN_SIZE/f,y=Ut.MIN_SIZE/d;l=Math.max(Math.min(l,1/v,1/_),A/v,y/_);const E=Ut._round(v*l),T=Ut._round(_*l);if(E===v&&T===_)return;this.#p||=[p,m,v,_];const b=u(v/2,_/2),w=Ut._round(p+b[0]),O=Ut._round(m+b[1]),F=u(E/2,T/2);this.x=w-F[0],this.y=O-F[1],this.width=E,this.height=T,this.setDims(f*E,d*T),this.fixAndSetPosition(),this._onResizing()}#w(){this.#i?.toggle(!0),this.parent.togglePointerEvents(!0),this.#F()}pointerdown(t){const{isMac:e}=_i.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#H(t);return}this.#y(t)}#y(t){const{isMac:e}=_i.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#H(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let i=!1;const s=new AbortController,l=this._uiManager.combinedSignal(s),o={capture:!0,passive:!1,signal:l},u=d=>{s.abort(),this.#r=null,this.#g=!1,this._uiManager.endDragSession()||this.#y(d),i&&this._onStopDragging()};e&&(this.#A=t.clientX,this.#E=t.clientY,this.#r=t.pointerId,this.#a=t.pointerType,window.addEventListener("pointermove",d=>{i||(i=!0,this._onStartDragging());const{clientX:p,clientY:m,pointerId:v}=d;if(v!==this.#r){Xe(d);return}const[_,A]=this.screenToPageTranslation(p-this.#A,m-this.#E);this.#A=p,this.#E=m,this._uiManager.dragSelectedEditors(_,A)},o),window.addEventListener("touchmove",Xe,o),window.addEventListener("pointerdown",d=>{d.pointerType===this.#a&&(this.#S||d.isPrimary)&&u(d),Xe(d)},o));const f=d=>{if(!this.#r||this.#r===d.pointerId){u(d);return}Xe(d)};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,i=this.rotation){const s=this.parentScale,[l,o]=this.pageDimensions,[u,f]=this.pageTranslation,d=t/s,p=e/s,m=this.x*l,v=this.y*o,_=this.width*l,A=this.height*o;switch(i){case 0:return[m+d+u,o-v-p-A+f,m+d+_+u,o-v-p+f];case 90:return[m+p+u,o-v+d+f,m+p+A+u,o-v+d+_+f];case 180:return[m-d-_+u,o-v+p+f,m-d+u,o-v+p+A+f];case 270:return[m-p-A+u,o-v-d-_+f,m-p+u,o-v-d+f];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,s,l,o]=t,u=l-i,f=o-s;switch(this.rotation){case 0:return[i,e-o,u,f];case 90:return[i,e-s,f,u];case 180:return[l,e-s,u,f];case 270:return[l,e-o,f,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#m=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#m=!1,!0):!1}isInEditMode(){return this.#m}shouldGetKeyboardEvents(){return this.#_}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:i,right:s}=this.getClientDimensions(),{innerHeight:l,innerWidth:o}=window;return e<o&&s>0&&t<l&&i>0}#z(){if(this.#u||!this.div)return;this.#u=new AbortController;const t=this._uiManager.combinedSignal(this.#u);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#z()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){Ae("An editor must be serializable")}static async deserialize(t,e,i){const s=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i,annotationElementId:t.annotationElementId});s.rotation=t.rotation,s.#t=t.accessibilityData,s._isCopy=t.isCopy||!1;const[l,o]=s.pageDimensions,[u,f,d,p]=s.getRectInCurrentCoords(t.rect,o);return s.x=u/l,s.y=f/o,s.width=d/l,s.height=p/o,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#u?.abort(),this.#u=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#B(),this.removeEditToolbar(),this.#x){for(const t of this.#x.values())clearTimeout(t);this.#x=null}this.parent=null,this.#S?.destroy(),this.#S=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#D(),this.#o.classList.remove("hidden"))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#f={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#o.children;if(!this.#e){this.#e=Array.from(e);const o=this.#V.bind(this),u=this.#W.bind(this),f=this._uiManager._signal;for(const d of this.#e){const p=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",o,{signal:f}),d.addEventListener("blur",u,{signal:f}),d.addEventListener("focus",this.#Y.bind(this,p),{signal:f}),d.setAttribute("data-l10n-id",Ut._l10nResizer[p])}}const i=this.#e[0];let s=0;for(const o of e){if(o===i)break;s++}const l=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(l!==s){if(l<s)for(let u=0;u<s-l;u++)this.#o.append(this.#o.firstChild);else if(l>s)for(let u=0;u<l-s;u++)this.#o.firstChild.before(this.#o.lastChild);let o=0;for(const u of e){const d=this.#e[o++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",Ut._l10nResizer[d])}}this.#q(0),this.#_=!0,this.#o.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#V(t){Ut._resizerKeyboardManager.exec(this,t)}#W(t){this.#_&&t.relatedTarget?.parentNode!==this.#o&&this.#B()}#Y(t){this.#d=this.#_?t:""}#q(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#_&&this.#P(this.#d,{deltaX:t,deltaY:e,fromKeyboard:!0})}#B(){this.#_=!1,this.#q(-1),this.#F()}_stopResizingWithKeyboard(){this.#B(),this.div.focus()}select(){if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#i?.toggleAltTextBadge(!1)}}unselect(){this.isSelected&&(this.isSelected=!1,this.#o?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#i?.toggleAltTextBadge(!0))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#h}set isEditing(t){this.#h=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){this.#l=!0;const i=t/e,{style:s}=this.div;s.aspectRatio=i,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#x||=new Map;const{action:i}=t;let s=this.#x.get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(t),this.#x.delete(i),this.#x.size===0&&(this.#x=null)},Ut._telemetryTimeout),this.#x.set(i,s);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#s=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#s=!0}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class D3 extends Ut{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const ix=3285377520,yn=4294901760,Kn=65535;class uy{constructor(t){this.h1=t?t&4294967295:ix,this.h2=t?t&4294967295:ix}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let y=0,E=t.length;y<E;y++){const T=t.charCodeAt(y);T<=255?e[i++]=T:(e[i++]=T>>>8,e[i++]=T&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,l=i-s*4,o=new Uint32Array(e.buffer,0,s);let u=0,f=0,d=this.h1,p=this.h2;const m=3432918353,v=461845907,_=m&Kn,A=v&Kn;for(let y=0;y<s;y++)y&1?(u=o[y],u=u*m&yn|u*_&Kn,u=u<<15|u>>>17,u=u*v&yn|u*A&Kn,d^=u,d=d<<13|d>>>19,d=d*5+3864292196):(f=o[y],f=f*m&yn|f*_&Kn,f=f<<15|f>>>17,f=f*v&yn|f*A&Kn,p^=f,p=p<<13|p>>>19,p=p*5+3864292196);switch(u=0,l){case 3:u^=e[s*4+2]<<16;case 2:u^=e[s*4+1]<<8;case 1:u^=e[s*4],u=u*m&yn|u*_&Kn,u=u<<15|u>>>17,u=u*v&yn|u*A&Kn,s&1?d^=u:p^=u}this.h1=d,this.h2=p}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&yn|t*36045&Kn,e=e*4283543511&yn|((e<<16|t>>>16)*2950163797&yn)>>>16,t^=e>>>1,t=t*444984403&yn|t*60499&Kn,e=e*3301882366&yn|((e<<16|t>>>16)*3120437893&yn)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const cd=Object.freeze({map:null,hash:"",transfer:void 0});class Xd{#t=!1;#e=null;#i=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=this.#i.get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return this.#i.get(t)}remove(t){if(this.#i.delete(t),this.#i.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of this.#i.values())if(e instanceof Ut)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=this.#i.get(t);let s=!1;if(i!==void 0)for(const[l,o]of Object.entries(e))i[l]!==o&&(s=!0,i[l]=o);else s=!0,this.#i.set(t,e);s&&this.#n(),e instanceof Ut&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return this.#i.has(t)}get size(){return this.#i.size}#n(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new hy(this)}get serializable(){if(this.#i.size===0)return cd;const t=new Map,e=new uy,i=[],s=Object.create(null);let l=!1;for(const[o,u]of this.#i){const f=u instanceof Ut?u.serialize(!1,s):u;f&&(t.set(o,f),e.update(`${o}:${JSON.stringify(f)}`),l||=!!f.bitmap)}if(l)for(const o of t.values())o.bitmap&&i.push(o.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:cd}get editorStats(){let t=null;const e=new Map;for(const i of this.#i.values()){if(!(i instanceof Ut))continue;const s=i.telemetryFinalData;if(!s)continue;const{type:l}=s;e.has(l)||e.set(l,Object.getPrototypeOf(i).constructor),t||=Object.create(null);const o=t[l]||=new Map;for(const[u,f]of Object.entries(s)){if(u==="type")continue;let d=o.get(u);d||(d=new Map,o.set(u,d));const p=d.get(f)??0;d.set(f,p+1)}}for(const[i,s]of e)t[i]=s.computeTelemetryFinalData(t[i]);return t}resetModifiedIds(){this.#e=null}get modifiedIds(){if(this.#e)return this.#e;const t=[];for(const e of this.#i.values())!(e instanceof Ut)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#i.entries()}}class hy extends Xd{#t;constructor(t){super();const{map:e,hash:i,transfer:s}=t.serializable,l=structuredClone(e,s?{transfer:s}:null);this.#t={map:l,hash:i,transfer:s}}get print(){Ae("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return Zt(this,"modifiedIds",{ids:new Set,hash:""})}}class O3{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:i}){if(!(!t||this.#t.has(t.loadedName))){if(Ye(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:l,style:o}=t,u=new FontFace(s,l,o);this.addNativeFontFace(u);try{await u.load(),this.#t.add(s),i?.(t)}catch{qt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}Ae("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(s){throw qt(`Failed to load font '${i.family}': '${s}'.`),t.disableFontFace=!0,s}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,s)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return Zt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return Zt(this,"isSyncFontLoadingSupported",Di||_i.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Ye(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const l=i.shift();setTimeout(l.callback,0)}}const{loadingRequests:i}=this,s={done:!1,complete:e,callback:t};return i.push(s),s}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Zt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(O,F){return O.charCodeAt(F)<<24|O.charCodeAt(F+1)<<16|O.charCodeAt(F+2)<<8|O.charCodeAt(F+3)&255}function s(O,F,z,L){const G=O.substring(0,F),V=O.substring(F+z);return G+L+V}let l,o;const u=this._document.createElement("canvas");u.width=1,u.height=1;const f=u.getContext("2d");let d=0;function p(O,F){if(++d>30){qt("Load test font never loaded."),F();return}if(f.font="30px "+O,f.fillText(".",0,20),f.getImageData(0,0,1,1).data[3]>0){F();return}setTimeout(p.bind(null,O,F))}const m=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=s(v,976,m.length,m);const A=16,y=1482184792;let E=i(v,A);for(l=0,o=m.length-3;l<o;l+=4)E=E-y+i(m,l)|0;l<m.length&&(E=E-y+i(m+"XXX",l)|0),v=s(v,A,4,p3(E));const T=`url(data:font/opentype;base64,${btoa(v)});`,b=`@font-face {font-family:"${m}";src:${T}}`;this.insertRule(b);const w=this._document.createElement("div");w.style.visibility="hidden",w.style.width=w.style.height="10px",w.style.position="absolute",w.style.top=w.style.left="0px";for(const O of[t.loadedName,m]){const F=this._document.createElement("span");F.textContent="Hi",F.style.fontFamily=O,w.append(F)}this._document.body.append(w),p(m,()=>{w.remove(),e.complete()})}}class M3{constructor(t,e=null){this.compiledGlyphs=Object.create(null);for(const i in t)this[i]=t[i];this._inspectFont=e}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${oy(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const i=this.loadedName+"_path_"+e;let s;try{s=t.get(i)}catch(o){qt(`getPathGenerator - ignoring character: "${o}".`)}const l=new Path2D(s||"");return this.fontExtraProperties||t.delete(i),this.compiledGlyphs[e]=l}}function N3(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(Di)return n;const t=URL.parse(n,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function L3(n){if(Di&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Io(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n?.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function mu(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const ud=n=>typeof n=="object"&&Number.isInteger(n?.num)&&n.num>=0&&Number.isInteger(n?.gen)&&n.gen>=0,F3=n=>typeof n=="object"&&typeof n?.name=="string",k3=_3.bind(null,ud,F3);class P3{#t=new Map;#e=Promise.resolve();postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[s]of this.#t)s.call(this,i)})}addEventListener(t,e,i=null){let s=null;if(i?.signal instanceof AbortSignal){const{signal:l}=i;if(l.aborted){qt("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(t,e);s=()=>l.removeEventListener("abort",o),l.addEventListener("abort",o)}this.#t.set(e,s)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const vu={DATA:1,ERROR:2},Ve={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function nx(){}function zi(n){if(n instanceof ls||n instanceof ad||n instanceof Jv||n instanceof Hu||n instanceof W0)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Ae('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new ls(n.message);case"InvalidPDFException":return new ad(n.message);case"PasswordException":return new Jv(n.message,n.code);case"ResponseException":return new Hu(n.message,n.status,n.missing);case"UnknownErrorException":return new W0(n.message,n.details)}return new W0(n.message,n.toString())}class ho{#t=new AbortController;constructor(t,e,i){this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#n(t);return}if(t.callback){const i=t.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],t.callback===vu.DATA)s.resolve(t.data);else if(t.callback===vu.ERROR)s.reject(zi(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,s=t.sourceName,l=this.comObj;Promise.try(e,t.data).then(function(o){l.postMessage({sourceName:i,targetName:s,callback:vu.DATA,callbackId:t.callbackId,data:o})},function(o){l.postMessage({sourceName:i,targetName:s,callback:vu.ERROR,callbackId:t.callbackId,reason:zi(o)})});return}if(t.streamId){this.#i(t);return}e(t.data)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const s=this.callbackId++,l=Promise.withResolvers();this.callbackCapabilities[s]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:s,data:e},i)}catch(o){l.reject(o)}return l.promise}sendWithStream(t,e,i,s){const l=this.streamId++,o=this.sourceName,u=this.targetName,f=this.comObj;return new ReadableStream({start:d=>{const p=Promise.withResolvers();return this.streamControllers[l]={controller:d,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},f.postMessage({sourceName:o,targetName:u,action:t,streamId:l,data:e,desiredSize:d.desiredSize},s),p.promise},pull:d=>{const p=Promise.withResolvers();return this.streamControllers[l].pullCall=p,f.postMessage({sourceName:o,targetName:u,stream:Ve.PULL,streamId:l,desiredSize:d.desiredSize}),p.promise},cancel:d=>{Ye(d instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[l].cancelCall=p,this.streamControllers[l].isClosed=!0,f.postMessage({sourceName:o,targetName:u,stream:Ve.CANCEL,streamId:l,reason:zi(d)}),p.promise}},i)}#i(t){const e=t.streamId,i=this.sourceName,s=t.sourceName,l=this.comObj,o=this,u=this.actionHandler[t.action],f={enqueue(d,p=1,m){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=p,v>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),l.postMessage({sourceName:i,targetName:s,stream:Ve.ENQUEUE,streamId:e,chunk:d},m)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:i,targetName:s,stream:Ve.CLOSE,streamId:e}),delete o.streamSinks[e])},error(d){Ye(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:i,targetName:s,stream:Ve.ERROR,streamId:e,reason:zi(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};f.sinkCapability.resolve(),f.ready=f.sinkCapability.promise,this.streamSinks[e]=f,Promise.try(u,t.data,f).then(function(){l.postMessage({sourceName:i,targetName:s,stream:Ve.START_COMPLETE,streamId:e,success:!0})},function(d){l.postMessage({sourceName:i,targetName:s,stream:Ve.START_COMPLETE,streamId:e,reason:zi(d)})})}#n(t){const e=t.streamId,i=this.sourceName,s=t.sourceName,l=this.comObj,o=this.streamControllers[e],u=this.streamSinks[e];switch(t.stream){case Ve.START_COMPLETE:t.success?o.startCall.resolve():o.startCall.reject(zi(t.reason));break;case Ve.PULL_COMPLETE:t.success?o.pullCall.resolve():o.pullCall.reject(zi(t.reason));break;case Ve.PULL:if(!u){l.postMessage({sourceName:i,targetName:s,stream:Ve.PULL_COMPLETE,streamId:e,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||nx).then(function(){l.postMessage({sourceName:i,targetName:s,stream:Ve.PULL_COMPLETE,streamId:e,success:!0})},function(d){l.postMessage({sourceName:i,targetName:s,stream:Ve.PULL_COMPLETE,streamId:e,reason:zi(d)})});break;case Ve.ENQUEUE:if(Ye(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(t.chunk);break;case Ve.CLOSE:if(Ye(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#s(o,e);break;case Ve.ERROR:Ye(o,"error should have stream controller"),o.controller.error(zi(t.reason)),this.#s(o,e);break;case Ve.CANCEL_COMPLETE:t.success?o.cancelCall.resolve():o.cancelCall.reject(zi(t.reason)),this.#s(o,e);break;case Ve.CANCEL:if(!u)break;const f=zi(t.reason);Promise.try(u.onCancel||nx,f).then(function(){l.postMessage({sourceName:i,targetName:s,stream:Ve.CANCEL_COMPLETE,streamId:e,success:!0})},function(d){l.postMessage({sourceName:i,targetName:s,stream:Ve.CANCEL_COMPLETE,streamId:e,reason:zi(d)})}),u.sinkCapability.reject(f),u.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#s(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class fy{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Ae("Abstract method `_createCanvas` called.")}}class B3 extends fy{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}class dy{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Ae("Abstract method `_fetch` called.")}}class rx extends dy{async _fetch(t){const e=await Uo(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):Io(e)}}class py{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,s,l){return"none"}destroy(t=!1){}}class I3 extends py{#t;#e;#i;#n;#s;#r;#a=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#n=t,this.#s=e}get#l(){return this.#e||=new Map}get#o(){return this.#r||=new Map}get#c(){if(!this.#i){const t=this.#s.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const i=this.#s.createElementNS(yr,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#i=this.#s.createElementNS(yr,"defs"),t.append(i),i.append(this.#i),this.#s.body.append(t)}return this.#i}#f(t){if(t.length===1){const f=t[0],d=new Array(256);for(let m=0;m<256;m++)d[m]=f[m]/255;const p=d.join(",");return[p,p,p]}const[e,i,s]=t,l=new Array(256),o=new Array(256),u=new Array(256);for(let f=0;f<256;f++)l[f]=e[f]/255,o[f]=i[f]/255,u[f]=s[f]/255;return[l.join(","),o.join(","),u.join(",")]}#u(t){if(this.#t===void 0){this.#t="";const e=this.#s.URL;e!==this.#s.baseURI&&(eh(e)?qt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=sy(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#l.get(t);if(e)return e;const[i,s,l]=this.#f(t),o=t.length===1?i:`${i}${s}${l}`;if(e=this.#l.get(o),e)return this.#l.set(t,e),e;const u=`g_${this.#n}_transfer_map_${this.#a++}`,f=this.#u(u);this.#l.set(t,f),this.#l.set(o,f);const d=this.#p(u);return this.#m(i,s,l,d),f}addHCMFilter(t,e){const i=`${t}-${e}`,s="base";let l=this.#o.get(s);if(l?.key===i||(l?(l.filter?.remove(),l.key=i,l.url="none",l.filter=null):(l={key:i,url:"none",filter:null},this.#o.set(s,l)),!t||!e))return l.url;const o=this.#v(t);t=kt.makeHexColor(...o);const u=this.#v(e);if(e=kt.makeHexColor(...u),this.#c.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return l.url;const f=new Array(256);for(let _=0;_<=255;_++){const A=_/255;f[_]=A<=.03928?A/12.92:((A+.055)/1.055)**2.4}const d=f.join(","),p=`g_${this.#n}_hcm_filter`,m=l.filter=this.#p(p);this.#m(d,d,d,m),this.#g(m);const v=(_,A)=>{const y=o[_]/255,E=u[_]/255,T=new Array(A+1);for(let b=0;b<=A;b++)T[b]=y+b/A*(E-y);return T.join(",")};return this.#m(v(0,5),v(1,5),v(2,5),m),l.url=this.#u(p),l.url}addAlphaFilter(t){let e=this.#l.get(t);if(e)return e;const[i]=this.#f([t]),s=`alpha_${i}`;if(e=this.#l.get(s),e)return this.#l.set(t,e),e;const l=`g_${this.#n}_alpha_map_${this.#a++}`,o=this.#u(l);this.#l.set(t,o),this.#l.set(s,o);const u=this.#p(l);return this.#_(i,u),o}addLuminosityFilter(t){let e=this.#l.get(t||"luminosity");if(e)return e;let i,s;if(t?([i]=this.#f([t]),s=`luminosity_${i}`):s="luminosity",e=this.#l.get(s),e)return this.#l.set(t,e),e;const l=`g_${this.#n}_luminosity_map_${this.#a++}`,o=this.#u(l);this.#l.set(t,o),this.#l.set(s,o);const u=this.#p(l);return this.#d(u),t&&this.#_(i,u),o}addHighlightHCMFilter(t,e,i,s,l){const o=`${e}-${i}-${s}-${l}`;let u=this.#o.get(t);if(u?.key===o||(u?(u.filter?.remove(),u.key=o,u.url="none",u.filter=null):(u={key:o,url:"none",filter:null},this.#o.set(t,u)),!e||!i))return u.url;const[f,d]=[e,i].map(this.#v.bind(this));let p=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),m=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[v,_]=[s,l].map(this.#v.bind(this));m<p&&([p,m,v,_]=[m,p,_,v]),this.#c.style.color="";const A=(T,b,w)=>{const O=new Array(256),F=(m-p)/w,z=T/255,L=(b-T)/(255*w);let G=0;for(let V=0;V<=w;V++){const Q=Math.round(p+V*F),K=z+V*L;for(let ut=G;ut<=Q;ut++)O[ut]=K;G=Q+1}for(let V=G;V<256;V++)O[V]=O[G-1];return O.join(",")},y=`g_${this.#n}_hcm_${t}_filter`,E=u.filter=this.#p(y);return this.#g(E),this.#m(A(v[0],_[0],5),A(v[1],_[1],5),A(v[2],_[2],5),E),u.url=this.#u(y),u.url}destroy(t=!1){t&&this.#r?.size||(this.#i?.parentNode.parentNode.remove(),this.#i=null,this.#e?.clear(),this.#e=null,this.#r?.clear(),this.#r=null,this.#a=0)}#d(t){const e=this.#s.createElementNS(yr,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#g(t){const e=this.#s.createElementNS(yr,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#p(t){const e=this.#s.createElementNS(yr,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#c.append(e),e}#h(t,e,i){const s=this.#s.createElementNS(yr,e);s.setAttribute("type","discrete"),s.setAttribute("tableValues",i),t.append(s)}#m(t,e,i,s){const l=this.#s.createElementNS(yr,"feComponentTransfer");s.append(l),this.#h(l,"feFuncR",t),this.#h(l,"feFuncG",e),this.#h(l,"feFuncB",i)}#_(t,e){const i=this.#s.createElementNS(yr,"feComponentTransfer");e.append(i),this.#h(i,"feFuncA",t)}#v(t){return this.#c.style.color=t,ih(getComputedStyle(this.#c).getPropertyValue("color"))}}class gy{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Ae("Abstract method `_fetch` called.")}}class sx extends gy{async _fetch(t){const e=await Uo(t,"arraybuffer");return new Uint8Array(e)}}class my{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){Ae("Abstract method `_fetch` called.")}}class ax extends my{async _fetch(t){const e=await Uo(t,"arraybuffer");return new Uint8Array(e)}}Di&&qt("Please use the `legacy` build in Node.js environments.");async function Yd(n){const e=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(e)}class U3 extends py{}class H3 extends fy{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class z3 extends dy{async _fetch(t){return Yd(t)}}class G3 extends gy{async _fetch(t){return Yd(t)}}class V3 extends my{async _fetch(t){return Yd(t)}}const ka="__forcedDependency";class j3{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[ka]:[]};#i=new Map;#n=[];#s=[];#r=[[1,0,0,1,0,0]];#a=[-1/0,-1/0,1/0,1/0];#l=new Float64Array([1/0,1/0,-1/0,-1/0]);#o=-1;#c=new Set;#f=new Map;#u=new Map;#d;#g;constructor(t){this.#d=t.width,this.#g=t.height}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[ka]:{__proto__:this.#e[ka]}},this.#a={__proto__:this.#a},this.#n.push([t,null]),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#a=Object.getPrototypeOf(this.#a);const i=this.#n.pop();return i!==void 0&&(i[1]=t),this}recordOpenMarker(t){return this.#n.push([t,null]),this}getOpenMarker(){return this.#n.length===0?null:this.#n.at(-1)[0]}recordCloseMarker(t){const e=this.#n.pop();return e!==void 0&&(e[1]=t),this}beginMarkedContent(t){return this.#s.push([t,null]),this}endMarkedContent(t){const e=this.#s.pop();return e!==void 0&&(e[1]=t),this}pushBaseTransform(t){return this.#r.push(kt.multiplyByDOMMatrix(this.#r.at(-1),t.getTransform())),this}popBaseTransform(){return this.#r.length>1&&this.#r.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#i.set(t,e),this}recordFutureForcedDependency(t,e){return this.recordIncrementalData(ka,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#c)this.recordFutureForcedDependency(ka,t);return this}resetBBox(t){return this.#o=t,this.#l[0]=1/0,this.#l[1]=1/0,this.#l[2]=-1/0,this.#l[3]=-1/0,this}get hasPendingBBox(){return this.#o!==-1}recordClipBox(t,e,i,s,l,o){const u=kt.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform()),f=[1/0,1/0,-1/0,-1/0];kt.axialAlignedBoundingBox([i,l,s,o],u,f);const d=kt.intersect(this.#a,f);return d?(this.#a[0]=d[0],this.#a[1]=d[1],this.#a[2]=d[2],this.#a[3]=d[3]):(this.#a[0]=this.#a[1]=1/0,this.#a[2]=this.#a[3]=-1/0),this}recordBBox(t,e,i,s,l,o){const u=this.#a;if(u[0]===1/0)return this;const f=kt.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform());if(u[0]===-1/0)return kt.axialAlignedBoundingBox([i,l,s,o],f,this.#l),this;const d=[1/0,1/0,-1/0,-1/0];return kt.axialAlignedBoundingBox([i,l,s,o],f,d),this.#l[0]=Math.min(this.#l[0],Math.max(d[0],u[0])),this.#l[1]=Math.min(this.#l[1],Math.max(d[1],u[1])),this.#l[2]=Math.max(this.#l[2],Math.min(d[2],u[2])),this.#l[3]=Math.max(this.#l[3],Math.min(d[3],u[3])),this}recordCharacterBBox(t,e,i,s=1,l=0,o=0,u){const f=i.bbox;let d,p;if(f&&(d=f[2]!==f[0]&&f[3]!==f[1]&&this.#u.get(i),d!==!1&&(p=[0,0,0,0],kt.axialAlignedBoundingBox(f,i.fontMatrix,p),(s!==1||l!==0||o!==0)&&kt.scaleMinMax([s,0,0,-s,l,o],p),d)))return this.recordBBox(t,e,p[0],p[2],p[1],p[3]);if(!u)return this.recordFullPageBBox(t);const m=u();return f&&p&&d===void 0&&(d=p[0]<=l-m.actualBoundingBoxLeft&&p[2]>=l+m.actualBoundingBoxRight&&p[1]<=o-m.actualBoundingBoxAscent&&p[3]>=o+m.actualBoundingBoxDescent,this.#u.set(i,d),d)?this.recordBBox(t,e,p[0],p[2],p[1],p[3]):this.recordBBox(t,e,l-m.actualBoundingBoxLeft,l+m.actualBoundingBoxRight,o-m.actualBoundingBoxAscent,o+m.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#l[0]=Math.max(0,this.#a[0]),this.#l[1]=Math.max(0,this.#a[1]),this.#l[2]=Math.min(this.#d,this.#a[2]),this.#l[3]=Math.min(this.#g,this.#a[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const i=this.#c,s=this.#t,l=this.#e;for(const o of e)o in this.#t?i.add(s[o]):o in l&&l[o].forEach(i.add,i);return this}copyDependenciesFromIncrementalOperation(t,e){const i=this.#f,s=this.#c;for(const l of this.#e[e])i.get(l).dependencies.forEach(s.add,s.add(l));return this}recordNamedDependency(t,e){return this.#i.has(e)&&this.#c.add(this.#i.get(e)),this}recordOperation(t,e=!1){this.recordDependencies(t,[ka]);const i=new Set(this.#c),s=this.#n.concat(this.#s),l=this.#o===t?{minX:this.#l[0],minY:this.#l[1],maxX:this.#l[2],maxY:this.#l[3]}:null;return this.#f.set(t,{bbox:l,pairs:s,dependencies:i}),e||(this.#o=-1),this.#c.clear(),this}bboxToClipBoxDropOperation(t){return this.#o!==-1&&(this.#o=-1,this.#a[0]=Math.max(this.#a[0],this.#l[0]),this.#a[1]=Math.max(this.#a[1],this.#l[1]),this.#a[2]=Math.min(this.#a[2],this.#l[2]),this.#a[3]=Math.min(this.#a[3],this.#l[3])),this.#c.clear(),this}_takePendingDependencies(){const t=this.#c;return this.#c=new Set,t}_extractOperation(t){const e=this.#f.get(t);return this.#f.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#c.add(e)}take(){return this.#u.clear(),Array.from(this.#f,([t,{bbox:e,pairs:i,dependencies:s}])=>(i.forEach(l=>l.forEach(s.add,s)),s.delete(t),{minX:(e?.minX??0)/this.#d,maxX:(e?.maxX??this.#d)/this.#d,minY:(e?.minY??0)/this.#g,maxY:(e?.maxY??this.#g)/this.#g,dependencies:Array.from(s).sort((l,o)=>l-o),idx:t}))}}class zu{#t;#e;#i=0;#n;#s=0;constructor(t,e){if(t instanceof zu)return t;this.#t=t,this.#n=t._takePendingDependencies(),this.#e=e}save(t){return this.#s++,this.#t.save(this.#e),this}restore(t){return this.#s>0&&(this.#t.restore(this.#e),this.#s--),this}recordOpenMarker(t){return this.#i++,this}getOpenMarker(){return this.#i>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#i--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#t.hasPendingBBox||this.#t.resetBBox(this.#e),this}get hasPendingBBox(){return this.#t.hasPendingBBox}recordClipBox(t,e,i,s,l,o){return this.#t.recordClipBox(this.#e,e,i,s,l,o),this}recordBBox(t,e,i,s,l,o){return this.#t.recordBBox(this.#e,e,i,s,l,o),this}recordCharacterBBox(t,e,i,s,l,o,u){return this.#t.recordCharacterBBox(this.#e,e,i,s,l,o,u),this}recordFullPageBBox(t){return this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}copyDependenciesFromIncrementalOperation(t,e){return this.#t.copyDependenciesFromIncrementalOperation(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){this.#t.recordOperation(this.#e,!0);const e=this.#t._extractOperation(this.#e);for(const i of e.dependencies)this.#n.add(i);return this.#n.delete(this.#e),this.#n.delete(null),this}bboxToClipBoxDropOperation(t){return this.#t.bboxToClipBoxDropOperation(this.#e),this}recordNestedDependencies(){this.#t._pushPendingDependencies(this.#n)}take(){throw new Error("Unreachable")}}const An={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation"],transform:["transform"],transformAndFill:["transform","fillColor"]},gi={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function hd(n,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],s=new Path2D;s.rect(t[0],t[1],e,i),n.clip(s)}class qd{isModifyingCurrentTransform(){return!1}getPattern(){Ae("Abstract method `getPattern` called.")}}class X3 extends qd{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)e.addColorStop(i[0],i[1]);return e}getPattern(t,e,i,s){let l;if(s===gi.STROKE||s===gi.FILL){const o=e.current.getClippedPathBoundingBox(s,Oe(t))||[0,0,0,0],u=Math.ceil(o[2]-o[0])||1,f=Math.ceil(o[3]-o[1])||1,d=e.cachedCanvases.getCanvas("pattern",u,f),p=d.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-o[0],-o[1]),i=kt.transform(i,[1,0,0,1,o[0],o[1]]),p.transform(...e.baseTransform),this.matrix&&p.transform(...this.matrix),hd(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),l=t.createPattern(d.canvas,"no-repeat");const m=new DOMMatrix(i);l.setTransform(m)}else hd(t,this._bbox),l=this._createGradient(t);return l}}function Q0(n,t,e,i,s,l,o,u){const f=t.coords,d=t.colors,p=n.data,m=n.width*4;let v;f[e+1]>f[i+1]&&(v=e,e=i,i=v,v=l,l=o,o=v),f[i+1]>f[s+1]&&(v=i,i=s,s=v,v=o,o=u,u=v),f[e+1]>f[i+1]&&(v=e,e=i,i=v,v=l,l=o,o=v);const _=(f[e]+t.offsetX)*t.scaleX,A=(f[e+1]+t.offsetY)*t.scaleY,y=(f[i]+t.offsetX)*t.scaleX,E=(f[i+1]+t.offsetY)*t.scaleY,T=(f[s]+t.offsetX)*t.scaleX,b=(f[s+1]+t.offsetY)*t.scaleY;if(A>=b)return;const w=d[l],O=d[l+1],F=d[l+2],z=d[o],L=d[o+1],G=d[o+2],V=d[u],Q=d[u+1],K=d[u+2],ut=Math.round(A),ht=Math.round(b);let bt,Et,Y,nt,Tt,st,M,q;for(let D=ut;D<=ht;D++){if(D<E){const _t=D<A?0:(A-D)/(A-E);bt=_-(_-y)*_t,Et=w-(w-z)*_t,Y=O-(O-L)*_t,nt=F-(F-G)*_t}else{let _t;D>b?_t=1:E===b?_t=0:_t=(E-D)/(E-b),bt=y-(y-T)*_t,Et=z-(z-V)*_t,Y=L-(L-Q)*_t,nt=G-(G-K)*_t}let k;D<A?k=0:D>b?k=1:k=(A-D)/(A-b),Tt=_-(_-T)*k,st=w-(w-V)*k,M=O-(O-Q)*k,q=F-(F-K)*k;const U=Math.round(Math.min(bt,Tt)),j=Math.round(Math.max(bt,Tt));let J=m*D+U*4;for(let _t=U;_t<=j;_t++)k=(bt-_t)/(bt-Tt),k<0?k=0:k>1&&(k=1),p[J++]=Et-(Et-st)*k|0,p[J++]=Y-(Y-M)*k|0,p[J++]=nt-(nt-q)*k|0,p[J++]=255}}function Y3(n,t,e){const i=t.coords,s=t.colors;let l,o;switch(t.type){case"lattice":const u=t.verticesPerRow,f=Math.floor(i.length/u)-1,d=u-1;for(l=0;l<f;l++){let p=l*u;for(let m=0;m<d;m++,p++)Q0(n,e,i[p],i[p+1],i[p+u],s[p],s[p+1],s[p+u]),Q0(n,e,i[p+u+1],i[p+1],i[p+u],s[p+u+1],s[p+1],s[p+u])}break;case"triangles":for(l=0,o=i.length;l<o;l+=3)Q0(n,e,i[l],i[l+1],i[l+2],s[l],s[l+1],s[l+2]);break;default:throw new Error("illegal figure")}}class q3 extends qd{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,i){const u=Math.floor(this._bounds[0]),f=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-u,p=Math.ceil(this._bounds[3])-f,m=Math.min(Math.ceil(Math.abs(d*t[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(p*t[1]*1.1)),3e3),_=d/m,A=p/v,y={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-f,scaleX:1/_,scaleY:1/A},E=m+4,T=v+4,b=i.getCanvas("mesh",E,T),w=b.context,O=w.createImageData(m,v);if(e){const z=O.data;for(let L=0,G=z.length;L<G;L+=4)z[L]=e[0],z[L+1]=e[1],z[L+2]=e[2],z[L+3]=255}for(const z of this._figures)Y3(O,z,y);return w.putImageData(O,2,2),{canvas:b.canvas,offsetX:u-2*_,offsetY:f-2*A,scaleX:_,scaleY:A}}isModifyingCurrentTransform(){return!0}getPattern(t,e,i,s){hd(t,this._bbox);const l=new Float32Array(2);if(s===gi.SHADING)kt.singularValueDecompose2dScale(Oe(t),l);else if(this.matrix){kt.singularValueDecompose2dScale(this.matrix,l);const[u,f]=l;kt.singularValueDecompose2dScale(e.baseTransform,l),l[0]*=u,l[1]*=f}else kt.singularValueDecompose2dScale(e.baseTransform,l);const o=this._createMeshCanvas(l,s===gi.SHADING?null:this._background,e.cachedCanvases);return s!==gi.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(o.offsetX,o.offsetY),t.scale(o.scaleX,o.scaleY),t.createPattern(o.canvas,"no-repeat")}}class W3 extends qd{getPattern(){return"hotpink"}}function $3(n){switch(n[0]){case"RadialAxial":return new X3(n);case"Mesh":return new q3(n);case"Dummy":return new W3}throw new Error(`Unknown IR type: ${n[0]}`)}const lx={COLORED:1,UNCOLORED:2};class Wd{static MAX_PATTERN_SIZE=3e3;constructor(t,e,i,s){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=i,this.baseTransform=s}createPatternCanvas(t){const{bbox:e,operatorList:i,paintType:s,tilingType:l,color:o,canvasGraphicsFactory:u}=this;let{xstep:f,ystep:d}=this;f=Math.abs(f),d=Math.abs(d),th("TilingType: "+l);const p=e[0],m=e[1],v=e[2],_=e[3],A=v-p,y=_-m,E=new Float32Array(2);kt.singularValueDecompose2dScale(this.matrix,E);const[T,b]=E;kt.singularValueDecompose2dScale(this.baseTransform,E);const w=T*E[0],O=b*E[1];let F=A,z=y,L=!1,G=!1;const V=Math.ceil(f*w),Q=Math.ceil(d*O),K=Math.ceil(A*w),ut=Math.ceil(y*O);V>=K?F=f:L=!0,Q>=ut?z=d:G=!0;const ht=this.getSizeAndScale(F,this.ctx.canvas.width,w),bt=this.getSizeAndScale(z,this.ctx.canvas.height,O),Et=t.cachedCanvases.getCanvas("pattern",ht.size,bt.size),Y=Et.context,nt=u.createCanvasGraphics(Y);if(nt.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(nt,s,o),Y.translate(-ht.scale*p,-bt.scale*m),nt.transform(0,ht.scale,0,0,bt.scale,0,0),Y.save(),nt.dependencyTracker?.save(),this.clipBbox(nt,p,m,v,_),nt.baseTransform=Oe(nt.ctx),nt.executeOperatorList(i),nt.endDrawing(),nt.dependencyTracker?.restore().recordNestedDependencies?.(),Y.restore(),L||G){const Tt=Et.canvas;L&&(F=f),G&&(z=d);const st=this.getSizeAndScale(F,this.ctx.canvas.width,w),M=this.getSizeAndScale(z,this.ctx.canvas.height,O),q=st.size,D=M.size,k=t.cachedCanvases.getCanvas("pattern-workaround",q,D),U=k.context,j=L?Math.floor(A/f):0,J=G?Math.floor(y/d):0;for(let _t=0;_t<=j;_t++)for(let At=0;At<=J;At++)U.drawImage(Tt,q*_t,D*At,q,D,0,0,q,D);return{canvas:k.canvas,scaleX:st.scale,scaleY:M.scale,offsetX:p,offsetY:m}}return{canvas:Et.canvas,scaleX:ht.scale,scaleY:bt.scale,offsetX:p,offsetY:m}}getSizeAndScale(t,e,i){const s=Math.max(Wd.MAX_PATTERN_SIZE,e);let l=Math.ceil(t*i);return l>=s?l=s:i=l/t,{scale:i,size:l}}clipBbox(t,e,i,s,l){const o=s-e,u=l-i;t.ctx.rect(e,i,o,u),kt.axialAlignedBoundingBox([e,i,s,l],Oe(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const s=t.ctx,l=t.current;switch(e){case lx.COLORED:const{fillStyle:o,strokeStyle:u}=this.ctx;s.fillStyle=l.fillColor=o,s.strokeStyle=l.strokeColor=u;break;case lx.UNCOLORED:s.fillStyle=s.strokeStyle=i,l.fillColor=l.strokeColor=i;break;default:throw new d3(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,i,s){let l=i;s!==gi.SHADING&&(l=kt.transform(l,e.baseTransform),this.matrix&&(l=kt.transform(l,this.matrix)));const o=this.createPatternCanvas(e);let u=new DOMMatrix(l);u=u.translate(o.offsetX,o.offsetY),u=u.scale(1/o.scaleX,1/o.scaleY);const f=t.createPattern(o.canvas,"repeat");return f.setTransform(u),f}}function K3({src:n,srcPos:t=0,dest:e,width:i,height:s,nonBlackColor:l=4294967295,inverseDecode:o=!1}){const u=_i.isLittleEndian?4278190080:255,[f,d]=o?[l,u]:[u,l],p=i>>3,m=i&7,v=n.length;e=new Uint32Array(e.buffer);let _=0;for(let A=0;A<s;A++){for(const E=t+p;t<E;t++){const T=t<v?n[t]:255;e[_++]=T&128?d:f,e[_++]=T&64?d:f,e[_++]=T&32?d:f,e[_++]=T&16?d:f,e[_++]=T&8?d:f,e[_++]=T&4?d:f,e[_++]=T&2?d:f,e[_++]=T&1?d:f}if(m===0)continue;const y=t<v?n[t++]:255;for(let E=0;E<m;E++)e[_++]=y&1<<7-E?d:f}return{srcPos:t,destPos:_}}const ox=16,cx=100,Q3=15,ux=10,Gi=16,Z0=new DOMMatrix,nn=new Float32Array(2),za=new Float32Array([1/0,1/0,-1/0,-1/0]);function Z3(n,t){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){t.save(),this.__originalSave()},n.restore=function(){t.restore(),this.__originalRestore()},n.translate=function(e,i){t.translate(e,i),this.__originalTranslate(e,i)},n.scale=function(e,i){t.scale(e,i),this.__originalScale(e,i)},n.transform=function(e,i,s,l,o,u){t.transform(e,i,s,l,o,u),this.__originalTransform(e,i,s,l,o,u)},n.setTransform=function(e,i,s,l,o,u){t.setTransform(e,i,s,l,o,u),this.__originalSetTransform(e,i,s,l,o,u)},n.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},n.rotate=function(e){t.rotate(e),this.__originalRotate(e)},n.clip=function(e){t.clip(e),this.__originalClip(e)},n.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},n.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},n.bezierCurveTo=function(e,i,s,l,o,u){t.bezierCurveTo(e,i,s,l,o,u),this.__originalBezierCurveTo(e,i,s,l,o,u)},n.rect=function(e,i,s,l){t.rect(e,i,s,l),this.__originalRect(e,i,s,l)},n.closePath=function(){t.closePath(),this.__originalClosePath()},n.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class J3{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let s;return this.cache[t]!==void 0?(s=this.cache[t],this.canvasFactory.reset(s,e,i)):(s=this.canvasFactory.create(e,i),this.cache[t]=s),s}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function xu(n,t,e,i,s,l,o,u,f,d){const[p,m,v,_,A,y]=Oe(n);if(m===0&&v===0){const b=o*p+A,w=Math.round(b),O=u*_+y,F=Math.round(O),z=(o+f)*p+A,L=Math.abs(Math.round(z)-w)||1,G=(u+d)*_+y,V=Math.abs(Math.round(G)-F)||1;return n.setTransform(Math.sign(p),0,0,Math.sign(_),w,F),n.drawImage(t,e,i,s,l,0,0,L,V),n.setTransform(p,m,v,_,A,y),[L,V]}if(p===0&&_===0){const b=u*v+A,w=Math.round(b),O=o*m+y,F=Math.round(O),z=(u+d)*v+A,L=Math.abs(Math.round(z)-w)||1,G=(o+f)*m+y,V=Math.abs(Math.round(G)-F)||1;return n.setTransform(0,Math.sign(m),Math.sign(v),0,w,F),n.drawImage(t,e,i,s,l,0,0,V,L),n.setTransform(p,m,v,_,A,y),[V,L]}n.drawImage(t,e,i,s,l,o,u,f,d);const E=Math.hypot(p,m),T=Math.hypot(v,_);return[E*f,T*d]}class hx{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=sd;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=hi.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,i){i?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=za.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=gi.FILL,e=null){const i=this.minMax.slice();if(t===gi.STROKE){e||Ae("Stroke bounding box must include transform."),kt.singularValueDecompose2dScale(e,nn);const s=nn[0]*this.lineWidth/2,l=nn[1]*this.lineWidth/2;i[0]-=s,i[1]-=l,i[2]+=s,i[3]+=l}return i}updateClipFromPath(){const t=kt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(za,0)}getClippedPathBoundingBox(t=gi.FILL,e=null){return kt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function fx(n,t){if(t instanceof ImageData){n.putImageData(t,0,0);return}const e=t.height,i=t.width,s=e%Gi,l=(e-s)/Gi,o=s===0?l:l+1,u=n.createImageData(i,Gi);let f=0,d;const p=t.data,m=u.data;let v,_,A,y;if(t.kind===Eu.GRAYSCALE_1BPP){const E=p.byteLength,T=new Uint32Array(m.buffer,0,m.byteLength>>2),b=T.length,w=i+7>>3,O=4294967295,F=_i.isLittleEndian?4278190080:255;for(v=0;v<o;v++){for(A=v<l?Gi:s,d=0,_=0;_<A;_++){const z=E-f;let L=0;const G=z>w?i:z*8-7,V=G&-8;let Q=0,K=0;for(;L<V;L+=8)K=p[f++],T[d++]=K&128?O:F,T[d++]=K&64?O:F,T[d++]=K&32?O:F,T[d++]=K&16?O:F,T[d++]=K&8?O:F,T[d++]=K&4?O:F,T[d++]=K&2?O:F,T[d++]=K&1?O:F;for(;L<G;L++)Q===0&&(K=p[f++],Q=128),T[d++]=K&Q?O:F,Q>>=1}for(;d<b;)T[d++]=0;n.putImageData(u,0,v*Gi)}}else if(t.kind===Eu.RGBA_32BPP){for(_=0,y=i*Gi*4,v=0;v<l;v++)m.set(p.subarray(f,f+y)),f+=y,n.putImageData(u,0,_),_+=Gi;v<o&&(y=i*s*4,m.set(p.subarray(f,f+y)),n.putImageData(u,0,_))}else if(t.kind===Eu.RGB_24BPP)for(A=Gi,y=i*A,v=0;v<o;v++){for(v>=l&&(A=s,y=i*A),d=0,_=y;_--;)m[d++]=p[f++],m[d++]=p[f++],m[d++]=p[f++],m[d++]=255;n.putImageData(u,0,v*Gi)}else throw new Error(`bad image kind: ${t.kind}`)}function dx(n,t){if(t.bitmap){n.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,s=e%Gi,l=(e-s)/Gi,o=s===0?l:l+1,u=n.createImageData(i,Gi);let f=0;const d=t.data,p=u.data;for(let m=0;m<o;m++){const v=m<l?Gi:s;({srcPos:f}=K3({src:d,srcPos:f,dest:p,width:i,height:v,nonBlackColor:0})),n.putImageData(u,0,m*Gi)}}function so(n,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)n[i]!==void 0&&(t[i]=n[i]);n.setLineDash!==void 0&&(t.setLineDash(n.getLineDash()),t.lineDashOffset=n.lineDashOffset)}function _u(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:t}=n;t!=="none"&&t!==""&&(n.filter="none")}function px(n,t){if(t)return!0;kt.singularValueDecompose2dScale(n,nn);const e=Math.fround(ir.pixelRatio*Qa.PDF_TO_CSS_UNITS);return nn[0]<=e&&nn[1]<=e}const tD=["butt","round","square"],eD=["miter","round","bevel"],iD={},gx={};class qa{constructor(t,e,i,s,l,{optionalContentConfig:o,markedContentStack:u=null},f,d,p){this.ctx=t,this.current=new hx(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=s,this.filterFactory=l,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=o,this.cachedCanvases=new J3(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=f,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(t,e,i=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):i}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:s=null}){const l=this.ctx.canvas.width,o=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,l,o),this.ctx.fillStyle=u,i){const f=this.cachedCanvases.getCanvas("transparent",l,o);this.compositeCtx=this.ctx,this.transparentCanvas=f.canvas,this.ctx=f.context,this.ctx.save(),this.ctx.transform(...Oe(this.compositeCtx))}this.ctx.save(),_u(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Oe(this.ctx)}executeOperatorList(t,e,i,s,l){const o=t.argsArray,u=t.fnArray;let f=e||0;const d=o.length;if(d===f)return f;const p=d-f>ux&&typeof i=="function",m=p?Date.now()+Q3:0;let v=0;const _=this.commonObjs,A=this.objs;let y,E;for(;;){if(s!==void 0&&f===s.nextBreakPoint)return s.breakIt(f,i),f;if(!l||l.has(f))if(y=u[f],E=o[f]??null,y!==Ro.dependency)E===null?this[y](f):this[y](f,...E);else for(const T of E){this.dependencyTracker?.recordNamedData(T,f);const b=T.startsWith("g_")?_:A;if(!b.has(T))return b.get(T,i),f}if(f++,f===d)return f;if(p&&++v>ux){if(Date.now()>m)return i(),f;v=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const i=t.width??t.displayWidth,s=t.height??t.displayHeight;let l=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),u=i,f=s,d="prescale1",p,m;for(;l>2&&u>1||o>2&&f>1;){let v=u,_=f;l>2&&u>1&&(v=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),l/=u/v),o>2&&f>1&&(_=f>=16384?Math.floor(f/2)-1||1:Math.ceil(f)/2,o/=f/_),p=this.cachedCanvases.getCanvas(d,v,_),m=p.context,m.clearRect(0,0,v,_),m.drawImage(t,0,0,u,f,0,0,v,_),t=p.canvas,u=v,f=_,d=d==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:f}}_createMaskCanvas(t,e){const i=this.ctx,{width:s,height:l}=e,o=this.current.fillColor,u=this.current.patternFill,f=Oe(i);let d,p,m,v;if((e.bitmap||e.data)&&e.count>1){const Q=e.bitmap||e.data.buffer;p=JSON.stringify(u?f:[f.slice(0,4),o]),d=this._cachedBitmapsMap.get(Q),d||(d=new Map,this._cachedBitmapsMap.set(Q,d));const K=d.get(p);if(K&&!u){const ut=Math.round(Math.min(f[0],f[2])+f[4]),ht=Math.round(Math.min(f[1],f[3])+f[5]);return this.dependencyTracker?.recordDependencies(t,An.transformAndFill),{canvas:K,offsetX:ut,offsetY:ht}}m=K}m||(v=this.cachedCanvases.getCanvas("maskCanvas",s,l),dx(v.context,e));let _=kt.transform(f,[1/s,0,0,-1/l,0,0]);_=kt.transform(_,[1,0,0,1,0,-l]);const A=za.slice();kt.axialAlignedBoundingBox([0,0,s,l],_,A);const[y,E,T,b]=A,w=Math.round(T-y)||1,O=Math.round(b-E)||1,F=this.cachedCanvases.getCanvas("fillCanvas",w,O),z=F.context,L=y,G=E;z.translate(-L,-G),z.transform(..._),m||(m=this._scaleImage(v.canvas,$n(z)),m=m.img,d&&u&&d.set(p,m)),z.imageSmoothingEnabled=px(Oe(z),e.interpolate),xu(z,m,0,0,m.width,m.height,0,0,s,l),z.globalCompositeOperation="source-in";const V=kt.transform($n(z),[1,0,0,1,-L,-G]);return z.fillStyle=u?o.getPattern(i,this,V,gi.FILL):o,z.fillRect(0,0,s,l),d&&!u&&(this.cachedCanvases.delete("fillCanvas"),d.set(p,F.canvas)),this.dependencyTracker?.recordDependencies(t,An.transformAndFill),{canvas:F.canvas,offsetX:Math.round(L),offsetY:Math.round(G)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=tD[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=eD[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,i){this.dependencyTracker?.recordSimpleData("dash",t);const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=i)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[i,s]of e)switch(i){case"LW":this.setLineWidth(t,s);break;case"LC":this.setLineCap(t,s);break;case"LJ":this.setLineJoin(t,s);break;case"ML":this.setMiterLimit(t,s);break;case"D":this.setDash(t,s[0],s[1]);break;case"RI":this.setRenderingIntent(t,s);break;case"FL":this.setFlatness(t,s);break;case"Font":this.setFont(t,s[0],s[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=s;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=s;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=s;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,i=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,l=this.cachedCanvases.getCanvas(s,e,i);this.suspendedCtx=this.ctx;const o=this.ctx=l.context;o.setTransform(this.suspendedCtx.getTransform()),so(this.suspendedCtx,o),Z3(o,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),so(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,s){const l=s[0],o=s[1],u=s[2]-l,f=s[3]-o;u===0||f===0||(this.genericComposeSMask(e.context,i,u,f,e.subtype,e.backdrop,e.transferMap,l,o,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,s,l,o,u,f,d,p,m){let v=t.canvas,_=f-p,A=d-m;if(o)if(_<0||A<0||_+i>v.width||A+s>v.height){const E=this.cachedCanvases.getCanvas("maskExtension",i,s),T=E.context;T.drawImage(v,-_,-A),T.globalCompositeOperation="destination-atop",T.fillStyle=o,T.fillRect(0,0,i,s),T.globalCompositeOperation="source-over",v=E.canvas,_=A=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const E=new Path2D;E.rect(_,A,i,s),t.clip(E),t.globalCompositeOperation="destination-atop",t.fillStyle=o,t.fillRect(_,A,i,s),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),l==="Alpha"&&u?e.filter=this.filterFactory.addAlphaFilter(u):l==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(u));const y=new Path2D;y.rect(f,d,i,s),e.clip(y),e.globalCompositeOperation="destination-in",e.drawImage(v,_,A,i,s,f,d,i,s),e.restore()}save(t){this.inSMaskMode&&so(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&so(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,i,s,l,o,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,i,s,l,o,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i,s){let[l]=i;if(!s){l||=i[0]=new Path2D,this[e](t,l);return}if(this.dependencyTracker!==null){const o=e===Ro.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,s[0]-o,s[2]+o,s[1]-o,s[3]+o).recordDependencies(t,["transform"])}if(!(l instanceof Path2D)){const o=i[0]=new Path2D;for(let u=0,f=l.length;u<f;)switch(l[u++]){case pu.moveTo:o.moveTo(l[u++],l[u++]);break;case pu.lineTo:o.lineTo(l[u++],l[u++]);break;case pu.curveTo:o.bezierCurveTo(l[u++],l[u++],l[u++],l[u++],l[u++],l[u++]);break;case pu.closePath:o.closePath();break;default:qt(`Unrecognized drawing path operator: ${l[u-1]}`);break}l=o}kt.axialAlignedBoundingBox(s,Oe(this.ctx),this.current.minMax),this[e](t,l),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,i=!0){const s=this.ctx,l=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof l=="object"&&l?.getPattern){const o=l.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=l.getPattern(s,this,$n(s),gi.STROKE),o){const u=new Path2D;u.addPath(e,s.getTransform().invertSelf().multiplySelf(o)),e=u}this.rescaleAndStroke(e,!1),s.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,An.stroke),i&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(gi.STROKE,Oe(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,i=!0){const s=this.ctx,l=this.current.fillColor,o=this.current.patternFill;let u=!1;if(o){const d=l.isModifyingCurrentTransform()?s.getTransform():null;if(this.dependencyTracker?.save(t),s.save(),s.fillStyle=l.getPattern(s,this,$n(s),gi.FILL),d){const p=new Path2D;p.addPath(e,s.getTransform().invertSelf().multiplySelf(d)),e=p}u=!0}const f=this.current.getClippedPathBoundingBox();this.contentVisible&&f!==null&&(this.pendingEOFill?(s.fill(e,"evenodd"),this.pendingEOFill=!1):s.fill(e)),this.dependencyTracker?.recordDependencies(t,An.fill),u&&(s.restore(),this.dependencyTracker?.restore(t)),i&&this.consumePath(t,e,f)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,An.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=iD}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=gx}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,i=this.ctx;if(this.dependencyTracker){const{dependencyTracker:s}=this;e!==void 0&&s.recordFutureForcedDependency("textClip",s.getOpenMarker()).recordFutureForcedDependency("textClip",t),s.recordCloseMarker(t)}if(e!==void 0){const s=new Path2D,l=i.getTransform().invertSelf();for(const{transform:o,x:u,y:f,fontSize:d,path:p}of e)p&&s.addPath(p,new DOMMatrix(o).preMultiplySelf(l).translate(u,f).scale(d,-d));i.clip(s)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,i){this.dependencyTracker?.recordSimpleData("font",t).recordNamedDependency(t,e);const s=this.commonObjs.get(e),l=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(l.fontMatrix=s.fontMatrix||sd,(l.fontMatrix[0]===0||l.fontMatrix[3]===0)&&qt("Invalid font matrix for font "+e),i<0?(i=-i,l.fontDirection=-1):l.fontDirection=1,this.current.font=s,this.current.fontSize=i,s.isType3Font)return;const o=s.loadedName||"sans-serif",u=s.systemFontInfo?.css||`"${o}", ${s.fallbackName}`;let f="normal";s.black?f="900":s.bold&&(f="bold");const d=s.italic?"italic":"normal";let p=i;i<ox?p=ox:i>cx&&(p=cx),this.current.fontSizeScale=i/p,this.ctx.font=`${d} ${f} ${p}px ${u}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=i}setLeadingMoveText(t,e,i){this.setLeading(t,-i),this.moveText(t,e,i)}setTextMatrix(t,e){this.dependencyTracker?.recordSimpleData("textMatrix",t);const{current:i}=this;i.textMatrix=e,i.textMatrixScale=Math.hypot(e[0],e[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#i(t,e,i){const s=new Path2D;return s.addPath(t,new DOMMatrix(i).invertSelf().multiplySelf(e)),s}paintChar(t,e,i,s,l,o){const u=this.ctx,f=this.current,d=f.font,p=f.textRenderingMode,m=f.fontSize/f.fontSizeScale,v=p&hi.FILL_STROKE_MASK,_=!!(p&hi.ADD_TO_PATH_FLAG),A=f.patternFill&&!d.missingFile,y=f.patternStroke&&!d.missingFile;let E;if((d.disableFontFace||_||A||y)&&!d.missingFile&&(E=d.getPathGenerator(this.commonObjs,e)),E&&(d.disableFontFace||A||y)){u.save(),u.translate(i,s),u.scale(m,-m),this.dependencyTracker?.recordCharacterBBox(t,u,d);let T;if(v===hi.FILL||v===hi.FILL_STROKE)if(l){T=u.getTransform(),u.setTransform(...l);const b=this.#i(E,T,l);u.fill(b)}else u.fill(E);if(v===hi.STROKE||v===hi.FILL_STROKE)if(o){T||=u.getTransform(),u.setTransform(...o);const{a:b,b:w,c:O,d:F}=T,z=kt.inverseTransform(o),L=kt.transform([b,w,O,F,0,0],z);kt.singularValueDecompose2dScale(L,nn),u.lineWidth*=Math.max(nn[0],nn[1])/m,u.stroke(this.#i(E,T,o))}else u.lineWidth/=m,u.stroke(E);u.restore()}else(v===hi.FILL||v===hi.FILL_STROKE)&&(u.fillText(e,i,s),this.dependencyTracker?.recordCharacterBBox(t,u,d,m,i,s,()=>u.measureText(e))),(v===hi.STROKE||v===hi.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,d,m,i,s,()=>u.measureText(e)).recordDependencies(t,An.stroke),u.strokeText(e,i,s));_&&((this.pendingTextPaths||=[]).push({transform:Oe(u),x:i,y:s,fontSize:m,path:E}),this.dependencyTracker?.recordCharacterBBox(t,u,d,m,i,s))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<e.length;s+=4)if(e[s]>0&&e[s]<255){i=!0;break}return Zt(this,"isFontSubpixelAAEnabled",i)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,An.showText).copyDependenciesFromIncrementalOperation(t,"sameLineText").resetBBox(t),this.current.textRenderingMode&hi.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,s=i.font;if(s.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordOperation(t).recordIncrementalData("sameLineText",t);return}const l=i.fontSize;if(l===0){this.dependencyTracker?.recordOperation(t);return}const o=this.ctx,u=i.fontSizeScale,f=i.charSpacing,d=i.wordSpacing,p=i.fontDirection,m=i.textHScale*p,v=e.length,_=s.vertical,A=_?1:-1,y=s.defaultVMetrics,E=l*i.fontMatrix[0],T=i.textRenderingMode===hi.FILL&&!s.disableFontFace&&!i.patternFill;o.save(),i.textMatrix&&o.transform(...i.textMatrix),o.translate(i.x,i.y+i.textRise),p>0?o.scale(m,-1):o.scale(m,1);let b,w;if(i.patternFill){o.save();const G=i.fillColor.getPattern(o,this,$n(o),gi.FILL);b=Oe(o),o.restore(),o.fillStyle=G}if(i.patternStroke){o.save();const G=i.strokeColor.getPattern(o,this,$n(o),gi.STROKE);w=Oe(o),o.restore(),o.strokeStyle=G}let O=i.lineWidth;const F=i.textMatrixScale;if(F===0||O===0){const G=i.textRenderingMode&hi.FILL_STROKE_MASK;(G===hi.STROKE||G===hi.FILL_STROKE)&&(O=this.getSinglePixelWidth())}else O/=F;if(u!==1&&(o.scale(u,u),O/=u),o.lineWidth=O,s.isInvalidPDFjsFont){const G=[];let V=0;for(const K of e)G.push(K.unicode),V+=K.width;const Q=G.join("");if(o.fillText(Q,0,0),this.dependencyTracker!==null){const K=o.measureText(Q);this.dependencyTracker.recordBBox(t,this.ctx,-K.actualBoundingBoxLeft,K.actualBoundingBoxRight,-K.actualBoundingBoxAscent,K.actualBoundingBoxDescent).recordOperation(t).recordIncrementalData("sameLineText",t)}i.x+=V*E*m,o.restore(),this.compose();return}let z=0,L;for(L=0;L<v;++L){const G=e[L];if(typeof G=="number"){z+=A*G*l/1e3;continue}let V=!1;const Q=(G.isSpace?d:0)+f,K=G.fontChar,ut=G.accent;let ht,bt,Et=G.width;if(_){const Tt=G.vmetric||y,st=-(G.vmetric?Tt[1]:Et*.5)*E,M=Tt[2]*E;Et=Tt?-Tt[0]:Et,ht=st/u,bt=(z+M)/u}else ht=z/u,bt=0;let Y;if(s.remeasure&&Et>0){Y=o.measureText(K);const Tt=Y.width*1e3/l*u;if(Et<Tt&&this.isFontSubpixelAAEnabled){const st=Et/Tt;V=!0,o.save(),o.scale(st,1),ht/=st}else Et!==Tt&&(ht+=(Et-Tt)/2e3*l/u)}if(this.contentVisible&&(G.isInFont||s.missingFile)){if(T&&!ut)o.fillText(K,ht,bt),this.dependencyTracker?.recordCharacterBBox(t,o,Y?{bbox:null}:s,l/u,ht,bt,()=>Y??o.measureText(K));else if(this.paintChar(t,K,ht,bt,b,w),ut){const Tt=ht+l*ut.offset.x/u,st=bt-l*ut.offset.y/u;this.paintChar(t,ut.fontChar,Tt,st,b,w)}}const nt=_?Et*E-Q*p:Et*E+Q*p;z+=nt,V&&o.restore()}_?i.y-=z:i.x+=z*m,o.restore(),this.compose(),this.dependencyTracker?.recordOperation(t).recordIncrementalData("sameLineText",t)}showType3Text(t,e){const i=this.ctx,s=this.current,l=s.font,o=s.fontSize,u=s.fontDirection,f=l.vertical?1:-1,d=s.charSpacing,p=s.wordSpacing,m=s.textHScale*u,v=s.fontMatrix||sd,_=e.length,A=s.textRenderingMode===hi.INVISIBLE;let y,E,T,b;if(A||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),s.textMatrix&&i.transform(...s.textMatrix),i.translate(s.x,s.y+s.textRise),i.scale(m,u);const w=this.dependencyTracker;for(this.dependencyTracker=w?new zu(w,t):null,y=0;y<_;++y){if(E=e[y],typeof E=="number"){b=f*E*o/1e3,this.ctx.translate(b,0),s.x+=b*m;continue}const O=(E.isSpace?p:0)+d,F=l.charProcOperatorList[E.operatorListId];F?this.contentVisible&&(this.save(),i.scale(o,o),i.transform(...v),this.executeOperatorList(F),this.restore()):qt(`Type3 character "${E.operatorListId}" is not available.`);const z=[E.width,0];kt.applyTransform(z,v),T=z[0]*o+O,i.translate(T,0),s.x+=T*m}i.restore(),w&&(this.dependencyTracker.recordNestedDependencies(),this.dependencyTracker=w)}setCharWidth(t,e,i){}setCharWidthAndBounds(t,e,i,s,l,o,u){const f=new Path2D;f.rect(s,l,o-s,u-l),this.ctx.clip(f),this.dependencyTracker?.recordBBox(t,this.ctx,s,o,l,u).recordClipBox(t,this.ctx,s,o,l,u),this.endPath(t)}getColorN_Pattern(t,e){let i;if(e[0]==="TilingPattern"){const s=this.baseTransform||Oe(this.ctx),l={createCanvasGraphics:o=>new qa(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new zu(this.dependencyTracker,t):null)};i=new Wd(e,this.ctx,l,s)}else i=this._getPattern(t,e[1],e[2]);return i}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,i=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=$3(this.getObject(t,e)),this.cachedPatterns.set(e,s)),i&&(s.matrix=i),s}shadingFill(t,e){if(!this.contentVisible)return;const i=this.ctx;this.save(t);const s=this._getPattern(t,e);i.fillStyle=s.getPattern(i,this,$n(i),gi.SHADING);const l=$n(i);if(l){const{width:o,height:u}=i.canvas,f=za.slice();kt.axialAlignedBoundingBox([0,0,o,u],l,f);const[d,p,m,v]=f;this.ctx.fillRect(d,p,m-d,v-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,An.transform).recordDependencies(t,An.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Ae("Should not call beginInlineImage")}beginImageData(){Ae("Should not call beginImageData")}paintFormXObjectBegin(t,e,i){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=Oe(this.ctx),i)){kt.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[s,l,o,u]=i,f=new Path2D;f.rect(s,l,o-s,u-l),this.ctx.clip(f),this.dependencyTracker?.recordClipBox(t,this.ctx,s,o,l,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;e.isolated||th("TODO: Support non-isolated groups."),e.knockout&&qt("Knockout groups not supported.");const s=Oe(i);if(e.matrix&&i.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let l=za.slice();kt.axialAlignedBoundingBox(e.bbox,Oe(i),l);const o=[0,0,i.canvas.width,i.canvas.height];l=kt.intersect(l,o)||[0,0,0,0];const u=Math.floor(l[0]),f=Math.floor(l[1]),d=Math.max(Math.ceil(l[2])-u,1),p=Math.max(Math.ceil(l[3])-f,1);this.current.startNewPathAndClipBox([0,0,d,p]);let m="groupAt"+this.groupLevel;e.smask&&(m+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(m,d,p),_=v.context;_.translate(-u,-f),_.transform(...s);let A=new Path2D;const[y,E,T,b]=e.bbox;if(A.rect(y,E,T-y,b-E),e.matrix){const w=new Path2D;w.addPath(A,new DOMMatrix(e.matrix)),A=w}_.clip(A),e.smask&&this.smaskStack.push({canvas:v.canvas,context:_,offsetX:u,offsetY:f,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(i.setTransform(1,0,0,1,0,0),i.translate(u,f),i.save()),so(i,_),this.ctx=_,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const l=Oe(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...l);const o=za.slice();kt.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],l,o),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(t,e,i,s,l,o){if(this.#t(),_u(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const u=i[2]-i[0],f=i[3]-i[1];if(o&&this.annotationCanvasMap){s=s.slice(),s[4]-=i[0],s[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=u,i[3]=f,kt.singularValueDecompose2dScale(Oe(this.ctx),nn);const{viewportScale:d}=this,p=Math.ceil(u*this.outputScaleX*d),m=Math.ceil(f*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(p,m);const{canvas:v,context:_}=this.annotationCanvas;this.annotationCanvasMap.set(e,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=_,this.ctx.save(),this.ctx.setTransform(nn[0],0,0,-nn[1],0,f*nn[1]),_u(this.ctx)}else{_u(this.ctx),this.endPath(t);const d=new Path2D;d.rect(i[0],i[1],u,f),this.ctx.clip(d)}}this.current=new hx(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...s),this.transform(t,...l)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const i=e.count;e=this.getObject(t,e.data,e),e.count=i;const s=this.ctx,l=this._createMaskCanvas(t,e),o=l.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(o,l.offsetX,l.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,l.offsetX,l.offsetX+o.width,l.offsetY,l.offsetY+o.height).recordOperation(t),s.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i,s=0,l=0,o,u){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const f=this.ctx;f.save();const d=Oe(f);f.transform(i,s,l,o,0,0);const p=this._createMaskCanvas(t,e);f.setTransform(1,0,0,1,p.offsetX-d[4],p.offsetY-d[5]),this.dependencyTracker?.resetBBox(t);for(let m=0,v=u.length;m<v;m+=2){const _=kt.transform(d,[i,s,l,o,u[m],u[m+1]]);f.drawImage(p.canvas,_[4],_[5]),this.dependencyTracker?.recordBBox(t,this.ctx,_[4],_[4]+p.canvas.width,_[5],_[5]+p.canvas.height)}f.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx,s=this.current.fillColor,l=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,An.transformAndFill);for(const o of e){const{data:u,width:f,height:d,transform:p}=o,m=this.cachedCanvases.getCanvas("maskCanvas",f,d),v=m.context;v.save();const _=this.getObject(t,u,o);dx(v,_),v.globalCompositeOperation="source-in",v.fillStyle=l?s.getPattern(v,this,$n(i),gi.FILL):s,v.fillRect(0,0,f,d),v.restore(),i.save(),i.transform(...p),i.scale(1,-1),xu(i,m.canvas,0,0,f,d,0,-1,1,1),this.dependencyTracker?.recordBBox(t,i,0,f,0,d),i.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const i=this.getObject(t,e);if(!i){qt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,i)}paintImageXObjectRepeat(t,e,i,s,l){if(!this.contentVisible)return;const o=this.getObject(t,e);if(!o){qt("Dependent image isn't ready yet");return}const u=o.width,f=o.height,d=[];for(let p=0,m=l.length;p<m;p+=2)d.push({transform:[i,0,0,s,l[p],l[p+1]],x:0,y:0,w:u,h:f});this.paintInlineImageXObjectGroup(t,o,d)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:s}=t,l=this.cachedCanvases.getCanvas("inlineImage",i,s),o=l.context;return o.filter=this.current.transferMaps,o.drawImage(e,0,0),o.filter="none",l.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const i=e.width,s=e.height,l=this.ctx;this.save(t);const{filter:o}=l;o!=="none"&&o!==""&&(l.filter="none"),l.scale(1/i,-1/s);let u;if(e.bitmap)u=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)u=e;else{const p=this.cachedCanvases.getCanvas("inlineImage",i,s).context;fx(p,e),u=this.applyTransferMapsToCanvas(p)}const f=this._scaleImage(u,$n(l));l.imageSmoothingEnabled=px(Oe(l),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,l,0,i,-s,0).recordDependencies(t,An.imageXObject).recordOperation(t),xu(l,f.img,0,0,f.paintWidth,f.paintHeight,0,-s,i,s),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,i){if(!this.contentVisible)return;const s=this.ctx;let l;if(e.bitmap)l=e.bitmap;else{const o=e.width,u=e.height,d=this.cachedCanvases.getCanvas("inlineImage",o,u).context;fx(d,e),l=this.applyTransferMapsToCanvas(d)}this.dependencyTracker?.resetBBox(t);for(const o of i)s.save(),s.transform(...o.transform),s.scale(1,-1),xu(s,l,o.x,o.y,o.w,o.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,s,0,1,-1,0),s.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,An.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,i){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,i){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,i){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const l=this.ctx;this.pendingClip?(s||(this.pendingClip===gx?l.clip(e,"evenodd"):l.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Oe(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),s=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:s,d:l}=this.ctx.getTransform();let o,u;if(i===0&&s===0){const f=Math.abs(e),d=Math.abs(l);if(f===d)if(t===0)o=u=1/f;else{const p=f*t;o=u=p<1?1/p:1}else if(t===0)o=1/f,u=1/d;else{const p=f*t,m=d*t;o=p<1?1/p:1,u=m<1?1/m:1}}else{const f=Math.abs(e*l-i*s),d=Math.hypot(e,i),p=Math.hypot(s,l);if(t===0)o=p/f,u=d/f;else{const m=t*f;o=p>m?p/m:1,u=d>m?d/m:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:i,current:{lineWidth:s}}=this,[l,o]=this.getScaleForStroking();if(l===o){i.lineWidth=(s||1)*l,i.stroke(t);return}const u=i.getLineDash();e&&i.save(),i.scale(l,o),Z0.a=1/l,Z0.d=1/o;const f=new Path2D;if(f.addPath(t,Z0),u.length>0){const d=Math.max(l,o);i.setLineDash(u.map(p=>p/d)),i.lineDashOffset/=d}i.lineWidth=s||1,i.stroke(f),e&&i.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const n in Ro)qa.prototype[n]!==void 0&&(qa.prototype[Ro[n]]=qa.prototype[n]);class Wa{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class nD{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const Ia=Symbol("INTERNAL");class rD{#t=!1;#e=!1;#i=!1;#n=!0;constructor(t,{name:e,intent:i,usage:s,rbGroups:l}){this.#t=!!(t&tn.DISPLAY),this.#e=!!(t&tn.PRINT),this.name=e,this.intent=i,this.usage=s,this.rbGroups=l}get visible(){if(this.#i)return this.#n;if(!this.#n)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,i=!1){t!==Ia&&Ae("Internal method `_setVisible` called."),this.#i=i,this.#n=e}}class sD{#t=null;#e=new Map;#i=null;#n=null;constructor(t,e=tn.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#n=t.order;for(const i of t.groups)this.#e.set(i.id,new rD(e,i));if(t.baseState==="OFF")for(const i of this.#e.values())i._setVisible(Ia,!1);for(const i of t.on)this.#e.get(i)._setVisible(Ia,!0);for(const i of t.off)this.#e.get(i)._setVisible(Ia,!1);this.#i=this.getHash()}}#s(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let s=1;s<e;s++){const l=t[s];let o;if(Array.isArray(l))o=this.#s(l);else if(this.#e.has(l))o=this.#e.get(l).visible;else return qt(`Optional content group not found: ${l}`),!0;switch(i){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return i==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return th("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(qt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#s(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return qt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return qt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return qt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return qt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return qt(`Unknown optional content policy ${t.policy}.`),!0}return qt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,i=!0){const s=this.#e.get(t);if(!s){qt(`Optional content group not found: ${t}`);return}if(i&&e&&s.rbGroups.length)for(const l of s.rbGroups)for(const o of l)o!==t&&this.#e.get(o)?._setVisible(Ia,!1,!0);s._setVisible(Ia,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let i;for(const s of t){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const l=this.#e.get(s);if(l)switch(i){case"ON":this.setVisibility(s,!0,e);break;case"OFF":this.setVisibility(s,!1,e);break;case"Toggle":this.setVisibility(s,!l.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#e.size?this.#n?this.#n.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new uy;for(const[e,i]of this.#e)t.update(`${e}:${i.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class aD{constructor(t,{disableRange:e=!1,disableStream:i=!1}){Ye(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:l,progressiveDone:o,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=u,l?.length>0){const f=l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer;this._queuedChunks.push(f)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((f,d)=>{this._onReceiveData({begin:f,chunk:d})}),t.addProgressListener((f,d)=>{this._onProgress({loaded:f,total:d})}),t.addProgressiveReadListener(f=>{this._onReceiveData({chunk:f})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const s=this._rangeReaders.some(function(l){return l._begin!==t?!1:(l._enqueue(i),!0)});Ye(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Ye(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new lD(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new oD(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class lD{constructor(t,e,i=!1,s=null){this._stream=t,this._done=i||!1,this._filename=Gd(s)?s:null,this._queuedChunks=e||[],this._loaded=0;for(const l of this._queuedChunks)this._loaded+=l.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class oD{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function cD(n){let t=!0,e=i("filename\\*","i").exec(n);if(e){e=e[1];let p=u(e);return p=unescape(p),p=f(p),p=d(p),l(p)}if(e=o(n),e){const p=d(e);return l(p)}if(e=i("filename","i").exec(n),e){e=e[1];let p=u(e);return p=d(p),l(p)}function i(p,m){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function s(p,m){if(p){if(!/^[\x00-\xFF]+$/.test(m))return m;try{const v=new TextDecoder(p,{fatal:!0}),_=Io(m);m=v.decode(_),t=!1}catch{}}return m}function l(p){return t&&/[\x80-\xff]/.test(p)&&(p=s("utf-8",p),t&&(p=s("iso-8859-1",p))),p}function o(p){const m=[];let v;const _=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=_.exec(p))!==null;){let[,y,E,T]=v;if(y=parseInt(y,10),y in m){if(y===0)break;continue}m[y]=[E,T]}const A=[];for(let y=0;y<m.length&&y in m;++y){let[E,T]=m[y];T=u(T),E&&(T=unescape(T),y===0&&(T=f(T))),A.push(T)}return A.join("")}function u(p){if(p.startsWith('"')){const m=p.slice(1).split('\\"');for(let v=0;v<m.length;++v){const _=m[v].indexOf('"');_!==-1&&(m[v]=m[v].slice(0,_),m.length=v+1),m[v]=m[v].replaceAll(/\\(.)/g,"$1")}p=m.join('"')}return p}function f(p){const m=p.indexOf("'");if(m===-1)return p;const v=p.slice(0,m),A=p.slice(m+1).replace(/^[^']*'/,"");return s(v,A)}function d(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,v,_,A){if(_==="q"||_==="Q")return A=A.replaceAll("_"," "),A=A.replaceAll(/=([0-9a-fA-F]{2})/g,function(y,E){return String.fromCharCode(parseInt(E,16))}),s(v,A);try{A=atob(A)}catch{}return s(v,A)})}return""}function vy(n,t){const e=new Headers;if(!n||!t||typeof t!="object")return e;for(const i in t){const s=t[i];s!==void 0&&e.append(i,s)}return e}function rh(n){return URL.parse(n)?.origin??null}function xy({responseHeaders:n,isHttp:t,rangeChunkSize:e,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},l=parseInt(n.get("Content-Length"),10);return!Number.isInteger(l)||(s.suggestedLength=l,l<=2*e)||i||!t||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function _y(n){const t=n.get("Content-Disposition");if(t){let e=cD(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Gd(e))return e}return null}function Go(n,t){return new Hu(`Unexpected server response (${n}) while retrieving PDF "${t}".`,n,n===404||n===0&&t.startsWith("file:"))}function yy(n){return n===200||n===206}function Ay(n,t,e){return{method:"GET",headers:n,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function Ey(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(qt(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class uD{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=vy(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Ye(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new hD(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new fD(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class hD{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const i=new Headers(t.headers),s=e.url;fetch(s,Ay(i,this._withCredentials,this._abortController)).then(l=>{if(t._responseOrigin=rh(l.url),!yy(l.status))throw Go(l.status,s);this._reader=l.body.getReader(),this._headersCapability.resolve();const o=l.headers,{allowRangeRequests:u,suggestedLength:f}=xy({responseHeaders:o,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=f||this._contentLength,this._filename=_y(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new ls("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Ey(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class fD{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const s=t.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const l=new Headers(t.headers);l.append("Range",`bytes=${e}-${i-1}`);const o=s.url;fetch(o,Ay(l,this._withCredentials,this._abortController)).then(u=>{const f=rh(u.url);if(f!==t._responseOrigin)throw new Error(`Expected range response-origin "${f}" to match "${t._responseOrigin}".`);if(!yy(u.status))throw Go(u.status,o);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:Ey(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const J0=200,td=206;function dD(n){const t=n.response;return typeof t!="string"?t:Io(t).buffer}class pD{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:i}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=vy(this.isHttp,e),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,s=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[l,o]of this.headers)e.setRequestHeader(l,o);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.expectedStatus=td):s.expectedStatus=J0,e.responseType="arraybuffer",Ye(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),s.onHeadersReceived=t.onHeadersReceived,s.onDone=t.onDone,s.onError=t.onError,s.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){const i=this.pendingRequests[t];i&&i.onProgress?.(e)}onStateChange(t,e){const i=this.pendingRequests[t];if(!i)return;const s=i.xhr;if(s.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),s.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],s.status===0&&this.isHttp){i.onError(s.status);return}const l=s.status||J0;if(!(l===J0&&i.expectedStatus===td)&&l!==i.expectedStatus){i.onError(s.status);return}const u=dD(s);if(l===td){const f=s.getResponseHeader("Content-Range"),d=/bytes (\d+)-(\d+)\/(\d+)/.exec(f);d?i.onDone({begin:parseInt(d[1],10),chunk:u}):(qt('Missing or invalid "Content-Range" header.'),i.onError(0))}else u?i.onDone({begin:0,chunk:u}):i.onError(s.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class gD{constructor(t){this._source=t,this._manager=new pD(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Ye(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new mD(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new vD(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class mD{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=rh(e.responseURL);const i=e.getAllResponseHeaders(),s=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[f,...d]=u.split(": ");return[f,d.join(": ")]}):[]),{allowRangeRequests:l,suggestedLength:o}=xy({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});l&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=_y(s),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Go(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class vD{constructor(t,e,i){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=rh(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=Go(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const xD=/^[a-z][a-z0-9\-+.]+:/i;function _D(n){if(xD.test(n))return new URL(n);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(n))}class yD{constructor(t){this.source=t,this.url=_D(t.url),Ye(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Ye(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new AD(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new ED(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class AD{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=Go(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new ls("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class ED{constructor(t,e,i){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=t.source;this._isStreamingSupported=!s.disableStream;const l=process.getBuiltinModule("fs");this._setReadableStream(l.createReadStream(this._url,{start:e,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const ao=Symbol("INITIAL_DATA");class Sy{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:ao}}get(t,e=null){if(e){const s=this.#e(t);return s.promise.then(()=>e(s.data)),null}const i=this.#t[t];if(!i||i.data===ao)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=this.#t[t];return!!e&&e.data!==ao}delete(t){const e=this.#t[t];return!e||e.data===ao?!1:(delete this.#t[t],!0)}resolve(t,e=null){const i=this.#e(t);i.data=e,i.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==ao&&(yield[t,e])}}}const SD=1e5,mx=30;class Ri{#t=Promise.withResolvers();#e=null;#i=!1;#n=!!globalThis.FontInspector?.enabled;#s=null;#r=null;#a=0;#l=0;#o=null;#c=null;#f=0;#u=0;#d=Object.create(null);#g=[];#p=null;#h=[];#m=new WeakMap;#_=null;static#v=new Map;static#A=new Map;static#E=new WeakMap;static#x=null;static#S=new Set;constructor({textContentSource:t,container:e,viewport:i}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(f){f.enqueue(t),f.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#c=e,this.#u=i.scale*ir.pixelRatio,this.#f=i.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:s,pageHeight:l,pageX:o,pageY:u}=i.rawDims;this.#_=[1,0,0,-1,-o,u+l],this.#l=s,this.#a=l,Ri.#D(),Hs(e,i),this.#t.promise.finally(()=>{Ri.#S.delete(this),this.#r=null,this.#d=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=_i.platform;return Zt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#o.read().then(({value:e,done:i})=>{if(i){this.#t.resolve();return}this.#s??=e.lang,Object.assign(this.#d,e.styles),this.#R(e.items),t()},this.#t.reject)};return this.#o=this.#p.getReader(),Ri.#S.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const i=t.scale*ir.pixelRatio,s=t.rotation;if(s!==this.#f&&(e?.(),this.#f=s,Hs(this.#c,{rotation:s})),i!==this.#u){e?.(),this.#u=i;const l={div:null,properties:null,ctx:Ri.#N(this.#s)};for(const o of this.#h)l.properties=this.#m.get(o),l.div=o,this.#T(l)}}cancel(){const t=new ls("TextLayer task cancelled.");this.#o?.cancel(t).catch(()=>{}),this.#o=null,this.#t.reject(t)}get textDivs(){return this.#h}get textContentItemsStr(){return this.#g}#R(t){if(this.#i)return;this.#r.ctx??=Ri.#N(this.#s);const e=this.#h,i=this.#g;for(const s of t){if(e.length>SD){qt("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const l=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),s.id&&this.#e.setAttribute("id",`${s.id}`),l.append(this.#e)}else s.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}i.push(s.str),this.#b(s)}}#b(t){const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#h.push(e);const s=kt.transform(this.#_,t.transform);let l=Math.atan2(s[1],s[0]);const o=this.#d[t.fontName];o.vertical&&(l+=Math.PI/2);let u=this.#n&&o.fontSubstitution||o.fontFamily;u=Ri.fontFamilyMap.get(u)||u;const f=Math.hypot(s[2],s[3]),d=f*Ri.#k(u,o,this.#s);let p,m;l===0?(p=s[4],m=s[5]-d):(p=s[4]+d*Math.sin(l),m=s[5]-d*Math.cos(l));const v="calc(var(--total-scale-factor) *",_=e.style;this.#e===this.#c?(_.left=`${(100*p/this.#l).toFixed(2)}%`,_.top=`${(100*m/this.#a).toFixed(2)}%`):(_.left=`${v}${p.toFixed(2)}px)`,_.top=`${v}${m.toFixed(2)}px)`),_.fontSize=`${v}${(Ri.#x*f).toFixed(2)}px)`,_.fontFamily=u,i.fontSize=f,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#n&&(e.dataset.fontName=o.fontSubstitutionLoadedName||t.fontName),l!==0&&(i.angle=l*(180/Math.PI));let A=!1;if(t.str.length>1)A=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const y=Math.abs(t.transform[0]),E=Math.abs(t.transform[3]);y!==E&&Math.max(y,E)/Math.min(y,E)>1.5&&(A=!0)}if(A&&(i.canvasWidth=o.vertical?t.height:t.width),this.#m.set(e,i),this.#r.div=e,this.#r.properties=i,this.#T(this.#r),i.hasText&&this.#e.append(e),i.hasEOL){const y=document.createElement("br");y.setAttribute("role","presentation"),this.#e.append(y)}}#T(t){const{div:e,properties:i,ctx:s}=t,{style:l}=e;let o="";if(Ri.#x>1&&(o=`scale(${1/Ri.#x})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:u}=l,{canvasWidth:f,fontSize:d}=i;Ri.#C(s,d*this.#u,u);const{width:p}=s.measureText(e.textContent);p>0&&(o=`scaleX(${f*this.#u/p}) ${o}`)}i.angle!==0&&(o=`rotate(${i.angle}deg) ${o}`),o.length>0&&(l.transform=o)}static cleanup(){if(!(this.#S.size>0)){this.#v.clear();for(const{canvas:t}of this.#A.values())t.remove();this.#A.clear()}}static#N(t=null){let e=this.#A.get(t||="");if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#A.set(t,e),this.#E.set(e,{size:0,family:""})}return e}static#C(t,e,i){const s=this.#E.get(t);e===s.size&&i===s.family||(t.font=`${e}px ${i}`,s.size=e,s.family=i)}static#D(){if(this.#x!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#x=t.getBoundingClientRect().height,t.remove()}static#k(t,e,i){const s=this.#v.get(t);if(s)return s;const l=this.#N(i);l.canvas.width=l.canvas.height=mx,this.#C(l,mx,t);const o=l.measureText(""),u=o.fontBoundingBoxAscent,f=Math.abs(o.fontBoundingBoxDescent);l.canvas.width=l.canvas.height=0;let d=.8;return u?d=u/(u+f):(_i.platform.isFirefox&&qt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?d=e.ascent:e.descent&&(d=1+e.descent)),this.#v.set(t,d),d}}class Do{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function s(l){if(!l)return;let o=null;const u=l.name;if(u==="#text")o=l.value;else if(Do.shouldBuildText(u))l?.attributes?.textContent?o=l.attributes.textContent:l.value&&(o=l.value);else return;if(o!==null&&e.push({str:o}),!!l.children)for(const f of l.children)s(f)}return s(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const TD=100;function Ty(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const t=new $d,{docId:e}=t,i=n.url?N3(n.url):null,s=n.data?L3(n.data):null,l=n.httpHeaders||null,o=n.withCredentials===!0,u=n.password??null,f=n.range instanceof wy?n.range:null,d=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let p=n.worker instanceof Oo?n.worker:null;const m=n.verbosity,v=typeof n.docBaseUrl=="string"&&!eh(n.docBaseUrl)?n.docBaseUrl:null,_=mu(n.cMapUrl),A=n.cMapPacked!==!1,y=n.CMapReaderFactory||(Di?z3:rx),E=mu(n.iccUrl),T=mu(n.standardFontDataUrl),b=n.StandardFontDataFactory||(Di?G3:sx),w=mu(n.wasmUrl),O=n.WasmFactory||(Di?V3:ax),F=n.stopAtErrors!==!0,z=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,L=n.isEvalSupported!==!1,G=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Di,V=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Di&&(_i.platform.isFirefox||!globalThis.chrome),Q=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,K=typeof n.disableFontFace=="boolean"?n.disableFontFace:Di,ut=n.fontExtraProperties===!0,ht=n.enableXfa===!0,bt=n.ownerDocument||globalThis.document,Et=n.disableRange===!0,Y=n.disableStream===!0,nt=n.disableAutoFetch===!0,Tt=n.pdfBug===!0,st=n.CanvasFactory||(Di?H3:B3),M=n.FilterFactory||(Di?U3:I3),q=n.enableHWA===!0,D=n.useWasm!==!1,k=f?f.length:n.length??NaN,U=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Di&&!K,j=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(y===rx&&b===sx&&O===ax&&_&&T&&w&&uo(_,document.baseURI)&&uo(T,document.baseURI)&&uo(w,document.baseURI)),J=null;u3(m);const _t={canvasFactory:new st({ownerDocument:bt,enableHWA:q}),filterFactory:new M({docId:e,ownerDocument:bt}),cMapReaderFactory:j?null:new y({baseUrl:_,isCompressed:A}),standardFontDataFactory:j?null:new b({baseUrl:T}),wasmFactory:j?null:new O({baseUrl:w})};p||(p=Oo.create({verbosity:m,port:Wa.workerPort}),t._worker=p);const At={docId:e,apiVersion:"5.4.149",data:s,password:u,disableAutoFetch:nt,rangeChunkSize:d,length:k,docBaseUrl:v,enableXfa:ht,evaluatorOptions:{maxImageSize:z,disableFontFace:K,ignoreErrors:F,isEvalSupported:L,isOffscreenCanvasSupported:G,isImageDecoderSupported:V,canvasMaxAreaInBytes:Q,fontExtraProperties:ut,useSystemFonts:U,useWasm:D,useWorkerFetch:j,cMapUrl:_,iccUrl:E,standardFontDataUrl:T,wasmUrl:w}},vt={ownerDocument:bt,pdfBug:Tt,styleElement:J,loadingParams:{disableAutoFetch:nt,enableXfa:ht}};return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const gt=p.messageHandler.sendWithPromise("GetDocRequest",At,s?[s.buffer]:null);let Pt;if(f)Pt=new aD(f,{disableRange:Et,disableStream:Y});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");const It=uo(i)?uD:Di?yD:gD;Pt=new It({url:i,length:k,httpHeaders:l,withCredentials:o,rangeChunkSize:d,disableRange:Et,disableStream:Y})}return gt.then(It=>{if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const ee=new ho(e,It,p.port),jt=new CD(ee,t,Pt,vt,_t,q);t._transport=jt,ee.send("Ready",null)})}).catch(t._capability.reject),t}class $d{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${$d.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class wy{#t=Promise.withResolvers();#e=[];#i=[];#n=[];#s=[];constructor(t,e,i=!1,s=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=s}addRangeListener(t){this.#s.push(t)}addProgressListener(t){this.#n.push(t)}addProgressiveReadListener(t){this.#i.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const i of this.#s)i(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const i of this.#n)i(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#i)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){Ae("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class wD{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Zt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class bD{#t=!1;constructor(t,e,i,s=!1){this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=s?new ex:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new Sy,this._intentStates=new Map,this.destroyed=!1,this.recordedGroups=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:l=!1}={}){return new Ho({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:l})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Zt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:i,intent:s="display",annotationMode:l=ts.ENABLE,transform:o=null,background:u=null,optionalContentConfigPromise:f=null,annotationCanvasMap:d=null,pageColors:p=null,printAnnotationStorage:m=null,isEditing:v=!1,recordOperations:_=!1,filteredOperationIndexes:A=null}){this._stats?.time("Overall");const y=this._transport.getRenderingIntent(s,l,m,v),{renderingIntent:E,cacheKey:T}=y;this.#t=!1,f||=this._transport.getOptionalContentConfig(E);let b=this._intentStates.get(T);b||(b=Object.create(null),this._intentStates.set(T,b)),b.streamReaderCancelTimeout&&(clearTimeout(b.streamReaderCancelTimeout),b.streamReaderCancelTimeout=null);const w=!!(E&tn.PRINT);b.displayReadyCapability||(b.displayReadyCapability=Promise.withResolvers(),b.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(y));const O=!this.recordedGroups&&(_||this._pdfBug&&globalThis.StepperManager?.enabled),F=G=>{if(b.renderTasks.delete(z),O){const V=z.gfx?.dependencyTracker.take();V?(z.stepper?.setOperatorGroups(V),_&&(this.recordedGroups=V)):_&&(this.recordedGroups=[])}w&&(this.#t=!0),this.#e(),G?(z.capability.reject(G),this._abortOperatorList({intentState:b,reason:G instanceof Error?G:new Error(G)})):z.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},z=new Ga({callback:F,params:{canvas:e,canvasContext:t,dependencyTracker:O?new j3(e):null,viewport:i,transform:o,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:d,operatorList:b.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!w,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,filteredOperationIndexes:A});(b.renderTasks||=new Set).add(z);const L=z.task;return Promise.all([b.displayReadyCapability.promise,f]).then(([G,V])=>{if(this.destroyed){F();return}if(this._stats?.time("Rendering"),!(V.renderingIntent&E))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");z.initializeGraphics({transparency:G,optionalContentConfig:V}),z.operatorListChanged()}).catch(F),L}getOperatorList({intent:t="display",annotationMode:e=ts.ENABLE,printAnnotationStorage:i=null,isEditing:s=!1}={}){function l(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(f))}const o=this._transport.getRenderingIntent(t,e,i,s,!0);let u=this._intentStates.get(o.cacheKey);u||(u=Object.create(null),this._intentStates.set(o.cacheKey,u));let f;return u.opListReadCapability||(f=Object.create(null),f.operatorListChanged=l,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(f),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Do.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,s){function l(){o.read().then(function({value:f,done:d}){if(d){i(u);return}u.lang??=f.lang,Object.assign(u.styles,f.styles),u.items.push(...f.items),l()},s)}const o=e.getReader(),u={items:[],styles:Object.create(null),lang:null};l()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new ex),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const i=this._intentStates.get(e);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,s=t.length;i<s;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:s}){const{map:l,transfer:o}=i,f=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:l,modifiedIds:s},o).getReader(),d=this._intentStates.get(e);d.streamReader=f;const p=()=>{f.read().then(({value:m,done:v})=>{if(v){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(m,d),p())},m=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(const v of d.renderTasks)v.operatorListChanged();this.#e()}if(d.displayReadyCapability)d.displayReadyCapability.reject(m);else if(d.opListReadCapability)d.opListReadCapability.reject(m);else throw m}})};p()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof zd){let s=TD;e.extraDelay>0&&e.extraDelay<1e3&&(s+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},s);return}}if(t.streamReader.cancel(new ls(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[s,l]of this._intentStates)if(l===t){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}var es,kn,Er,Ls,Vu,Fs,ks,Li,Su,by,Cy,fo,$a,Tu;const Re=class Re{constructor({name:t=null,port:e=null,verbosity:i=h3()}={}){qn(this,Li);qn(this,es,Promise.withResolvers());qn(this,kn,null);qn(this,Er,null);qn(this,Ls,null);if(this.name=t,this.destroyed=!1,this.verbosity=i,e){if(Ce(Re,ks).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Ce(Re,ks).set(e,this),Wn(this,Li,by).call(this,e)}else Wn(this,Li,Cy).call(this)}get promise(){return Ce(this,es).promise}get port(){return Ce(this,Er)}get messageHandler(){return Ce(this,kn)}destroy(){this.destroyed=!0,Ce(this,Ls)?.terminate(),Hi(this,Ls,null),Ce(Re,ks).delete(Ce(this,Er)),Hi(this,Er,null),Ce(this,kn)?.destroy(),Hi(this,kn,null)}static create(t){const e=Ce(this,ks).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Re(t)}static get workerSrc(){if(Wa.workerSrc)return Wa.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Zt(this,"_setupFakeWorkerGlobal",(async()=>Ce(this,$a,Tu)?Ce(this,$a,Tu):(await import(this.workerSrc)).WorkerMessageHandler)())}};es=new WeakMap,kn=new WeakMap,Er=new WeakMap,Ls=new WeakMap,Vu=new WeakMap,Fs=new WeakMap,ks=new WeakMap,Li=new WeakSet,Su=function(){Ce(this,es).resolve(),Ce(this,kn).send("configure",{verbosity:this.verbosity})},by=function(t){Hi(this,Er,t),Hi(this,kn,new ho("main","worker",t)),Ce(this,kn).on("ready",()=>{}),Wn(this,Li,Su).call(this)},Cy=function(){if(Ce(Re,Fs)||Ce(Re,$a,Tu)){Wn(this,Li,fo).call(this);return}let{workerSrc:t}=Re;try{Re._isSameOrigin(window.location,t)||(t=Re._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new ho("main","worker",e),s=()=>{l.abort(),i.destroy(),e.terminate(),this.destroyed?Ce(this,es).reject(new Error("Worker was destroyed")):Wn(this,Li,fo).call(this)},l=new AbortController;e.addEventListener("error",()=>{Ce(this,Ls)||s()},{signal:l.signal}),i.on("test",u=>{if(l.abort(),this.destroyed||!u){s();return}Hi(this,kn,i),Hi(this,Er,e),Hi(this,Ls,e),Wn(this,Li,Su).call(this)}),i.on("ready",u=>{if(l.abort(),this.destroyed){s();return}try{o()}catch{Wn(this,Li,fo).call(this)}});const o=()=>{const u=new Uint8Array;i.send("test",u,[u.buffer])};o();return}catch{th("The worker has been disabled.")}Wn(this,Li,fo).call(this)},fo=function(){Ce(Re,Fs)||(qt("Setting up fake worker."),Hi(Re,Fs,!0)),Re._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Ce(this,es).reject(new Error("Worker was destroyed"));return}const e=new P3;Hi(this,Er,e);const i=`fake${km(Re,Vu)._++}`,s=new ho(i+"_worker",i,e);t.setup(s,e),Hi(this,kn,new ho(i,i+"_worker",e)),Wn(this,Li,Su).call(this)}).catch(t=>{Ce(this,es).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},$a=new WeakSet,Tu=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},qn(Re,$a),qn(Re,Vu,0),qn(Re,Fs,!1),qn(Re,ks,new WeakMap),Di&&(Hi(Re,Fs,!0),Wa.workerSrc||="./pdf.worker.mjs"),Re._isSameOrigin=(t,e)=>{const i=URL.parse(t);if(!i?.origin||i.origin==="null")return!1;const s=new URL(e,i);return i.origin===s.origin},Re._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Re.fromPort=t=>{if(S3("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Re.create(t)};let Oo=Re;class CD{#t=new Map;#e=new Map;#i=new Map;#n=new Map;#s=null;constructor(t,e,i,s,l,o){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new Sy,this.fontLoader=new O3({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=l.canvasFactory,this.filterFactory=l.filterFactory,this.cMapReaderFactory=l.cMapReaderFactory,this.standardFontDataFactory=l.standardFontDataFactory,this.wasmFactory=l.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=o,this.setupMessageHandler()}#r(t,e=null){const i=this.#t.get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,s),s}get annotationStorage(){return Zt(this,"annotationStorage",new Xd)}getRenderingIntent(t,e=ts.ENABLE,i=null,s=!1,l=!1){let o=tn.DISPLAY,u=cd;switch(t){case"any":o=tn.ANY;break;case"display":break;case"print":o=tn.PRINT;break;default:qt(`getRenderingIntent - invalid intent: ${t}`)}const f=o&tn.PRINT&&i instanceof hy?i:this.annotationStorage;switch(e){case ts.DISABLE:o+=tn.ANNOTATIONS_DISABLE;break;case ts.ENABLE:break;case ts.ENABLE_FORMS:o+=tn.ANNOTATIONS_FORMS;break;case ts.ENABLE_STORAGE:o+=tn.ANNOTATIONS_STORAGE,u=f.serializable;break;default:qt(`getRenderingIntent - invalid annotationMode: ${e}`)}s&&(o+=tn.IS_EDITING),l&&(o+=tn.OPLIST);const{ids:d,hash:p}=f.modifiedIds,m=[o,u.hash,p];return{renderingIntent:o,cacheKey:m.join("_"),annotationStorageSerializable:u,modifiedIds:d}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of this.#e.values())t.push(i._destroy());this.#e.clear(),this.#i.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),Ri.cleanup(),this._networkStream?.cancelAllRequests(new ls("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,s)=>{Ye(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=l=>{this._lastProgress={loaded:l.loaded,total:l.total}},s.onPull=()=>{this._fullReader.read().then(function({value:l,done:o}){if(o){s.close();return}Ye(l instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{s.error(l)})},s.onCancel=l=>{this._fullReader.cancel(l),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("ReaderHeadersReady",async i=>{await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:l,contentLength:o}=this._fullReader;return(!s||!l)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{e.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:s,isRangeSupported:l,contentLength:o}}),t.on("GetRangeReader",(i,s)=>{Ye(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const l=this._networkStream.getRangeReader(i.begin,i.end);if(!l){s.close();return}s.onPull=()=>{l.read().then(function({value:o,done:u}){if(u){s.close();return}Ye(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{l.cancel(o),s.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new wD(i,this))}),t.on("DocException",i=>{e._capability.reject(zi(i))}),t.on("PasswordRequest",i=>{this.#s=Promise.withResolvers();try{if(!e.onPassword)throw zi(i);const s=l=>{l instanceof Error?this.#s.reject(l):this.#s.resolve({password:l})};e.onPassword(s,i.code)}catch(s){this.#s.reject(s)}return this.#s.promise}),t.on("DataLoaded",i=>{e.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;this.#e.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,s,l])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":if("error"in l){const d=l.error;qt(`Error during font loading: ${d}`),this.commonObjs.resolve(i,d);break}const o=this._params.pdfBug&&globalThis.FontInspector?.enabled?(d,p)=>globalThis.FontInspector.fontAdded(d,p):null,u=new M3(l,o);this.fontLoader.bind(u).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!u.fontExtraProperties&&u.data&&(u.data=null),this.commonObjs.resolve(i,u)});break;case"CopyLocalImage":const{imageRef:f}=l;Ye(f,"The imageRef must be defined.");for(const d of this.#e.values())for(const[,p]of d.objs)if(p?.ref===f)return p.dataLen?(this.commonObjs.resolve(i,structuredClone(p)),p.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,l);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),t.on("obj",([i,s,l,o])=>{if(this.destroyed)return;const u=this.#e.get(s);if(!u.objs.has(i)){if(u._intentStates.size===0){o?.bitmap?.close();return}switch(l){case"Image":case"Pattern":u.objs.resolve(i,o);break;default:throw new Error(`Got unknown object type ${l}`)}}}),t.on("DocProgress",i=>{this.destroyed||e.onProgress?.({loaded:i.loaded,total:i.total})}),t.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[i.type];if(!s)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&qt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=this.#i.get(e);if(i)return i;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(l=>{if(this.destroyed)throw new Error("Transport destroyed");l.refStr&&this.#n.set(l.refStr,t);const o=new bD(e,l,this,this._params.pdfBug);return this.#e.set(e,o),o});return this.#i.set(e,s),s}getPageIndex(t){return ud(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#r("GetFieldObjects")}hasJSActions(){return this.#r("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#r("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#r("GetOptionalContentConfig").then(e=>new sD(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(s=>({info:s[0],metadata:s[1]?new nD(s[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),Ri.cleanup()}}cachedPageNumber(t){if(!ud(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#n.get(e)??null}}class RD{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class Ga{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:i,commonObjs:s,annotationCanvasMap:l,operatorList:o,pageIndex:u,canvasFactory:f,filterFactory:d,useRequestAnimationFrame:p=!1,pdfBug:m=!1,pageColors:v=null,enableHWA:_=!1,filteredOperationIndexes:A=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=l,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=u,this.canvasFactory=f,this.filterFactory=d,this._pdfBug=m,this.pageColors=v,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new RD(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=_,this._dependencyTracker=e.dependencyTracker,this._filteredOperationIndexes=A}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(Ga.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Ga.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:i,transform:s,background:l,dependencyTracker:o}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new qa(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:s,viewport:i,transparency:t,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Ga.#e.delete(this._canvas),t||=new zd(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._filteredOperationIndexes),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Ga.#e.delete(this._canvas),this.callback())))}}const DD="5.4.149",OD="9e2e9e209";class Sn{#t=null;#e=null;#i;#n=null;#s=!1;#r=!1;#a=null;#l;#o=null;#c=null;static#f=null;static get _keyboardManager(){return Zt(this,"_keyboardManager",new zo([[["Escape","mac+Escape"],Sn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Sn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Sn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Sn.prototype._moveToPrevious],[["Home","mac+Home"],Sn.prototype._moveToBeginning],[["End","mac+End"],Sn.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#r=!1,this.#a=t):this.#r=!0,this.#c=t?._uiManager||e,this.#l=this.#c._eventBus,this.#i=t?.color?.toUpperCase()||this.#c?.highlightColors.values().next().value||"#FFFF98",Sn.#f||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#a&&(t.ariaControls=`${this.#a.id}_colorpicker_dropdown`);const e=this.#c._signal;t.addEventListener("click",this.#p.bind(this),{signal:e}),t.addEventListener("keydown",this.#g.bind(this),{signal:e});const i=this.#e=document.createElement("span");return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=this.#i,t.append(i),t}renderMainDropdown(){const t=this.#n=this.#u();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#u(){const t=document.createElement("div"),e=this.#c._signal;t.addEventListener("contextmenu",wn,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#a&&(t.id=`${this.#a.id}_colorpicker_dropdown`);for(const[i,s]of this.#c.highlightColors){const l=document.createElement("button");l.tabIndex="0",l.role="option",l.setAttribute("data-color",s),l.title=i,l.setAttribute("data-l10n-id",Sn.#f[i]);const o=document.createElement("span");l.append(o),o.className="swatch",o.style.backgroundColor=s,l.ariaSelected=s===this.#i,l.addEventListener("click",this.#d.bind(this,s),{signal:e}),t.append(l)}return t.addEventListener("keydown",this.#g.bind(this),{signal:e}),t}#d(t,e){e.stopPropagation(),this.#l.dispatch("switchannotationeditorparams",{source:this,type:ie.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#p(t);return}const e=t.target.getAttribute("data-color");e&&this.#d(e,t)}_moveToNext(t){if(!this.#m){this.#p(t);return}if(t.target===this.#t){this.#n.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#n?.firstChild||t.target===this.#t){this.#m&&this._hideDropdownFromKeyboard();return}this.#m||this.#p(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#m){this.#p(t);return}this.#n.firstChild?.focus()}_moveToEnd(t){if(!this.#m){this.#p(t);return}this.#n.lastChild?.focus()}#g(t){Sn._keyboardManager.exec(this,t)}#p(t){if(this.#m){this.hideDropdown();return}if(this.#s=t.detail===0,this.#o||(this.#o=new AbortController,window.addEventListener("pointerdown",this.#h.bind(this),{signal:this.#c.combinedSignal(this.#o)})),this.#t.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const e=this.#n=this.#u();this.#t.append(e)}#h(t){this.#n?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#o?.abort(),this.#o=null}get#m(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#m){this.#a?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#s})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#n)return;const e=this.#c.highlightColors.values();for(const i of this.#n.children)i.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#n?.remove(),this.#n=null}}class Mo{#t=null;#e=null;#i=null;static#n=null;constructor(t){this.#e=t,this.#i=t._uiManager,Mo.#n||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,colorValue:i}=this.#e,s=this.#t=document.createElement("input");return s.type="color",s.value=i||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",Mo.#n[t]),s.addEventListener("input",()=>{this.#i.updateParams(e,s.value)},{signal:this.#i._signal}),s}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function vx(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function lo(n){return Math.max(0,Math.min(255,255*n))}class xx{static CMYK_G([t,e,i,s]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+s)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=lo(t),[t,t,t]}static G_HTML([t]){const e=vx(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(lo)}static RGB_HTML(t){return`#${t.map(vx).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,s]){return["RGB",1-Math.min(1,t+s),1-Math.min(1,i+s),1-Math.min(1,e+s)]}static CMYK_rgb([t,e,i,s]){return[lo(1-Math.min(1,t+s)),lo(1-Math.min(1,i+s)),lo(1-Math.min(1,e+s))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const s=1-t,l=1-e,o=1-i,u=Math.min(s,l,o);return["CMYK",s,l,o,u]}}class MD{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${t}px`),s.setAttribute("height",`${e}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${t} ${e}`),s}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Ae("Abstract method `_createSVG` called.")}}class Gu extends MD{_createSVG(t){return document.createElementNS(yr,t)}}class Ry{static setupStorage(t,e,i,s,l){const o=s.getValue(e,{value:null});switch(i.name){case"textarea":if(o.value!==null&&(t.textContent=o.value),l==="print")break;t.addEventListener("input",u=>{s.setValue(e,{value:u.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(o.value===i.attributes.xfaOn?t.setAttribute("checked",!0):o.value===i.attributes.xfaOff&&t.removeAttribute("checked"),l==="print")break;t.addEventListener("change",u=>{s.setValue(e,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&t.setAttribute("value",o.value),l==="print")break;t.addEventListener("input",u=>{s.setValue(e,{value:u.target.value})})}break;case"select":if(o.value!==null){t.setAttribute("value",o.value);for(const u of i.children)u.attributes.value===o.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const f=u.target.options,d=f.selectedIndex===-1?"":f[f.selectedIndex].value;s.setValue(e,{value:d})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:s,linkService:l}){const{attributes:o}=e,u=t instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${s}`);for(const[f,d]of Object.entries(o))if(d!=null)switch(f){case"class":d.length&&t.setAttribute(f,d.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",d);break;case"style":Object.assign(t.style,d);break;case"textContent":t.textContent=d;break;default:(!u||f!=="href"&&f!=="newWindow")&&t.setAttribute(f,d)}u&&l.addLinkAttributes(t,o.href,o.newWindow),i&&o.dataId&&this.setupStorage(t,o.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,s=t.xfaHtml,l=t.intent||"display",o=document.createElement(s.name);s.attributes&&this.setAttributes({html:o,element:s,intent:l,linkService:i});const u=l!=="richText",f=t.div;if(f.append(o),t.viewport){const m=`matrix(${t.viewport.transform.join(",")})`;f.style.transform=m}u&&f.setAttribute("class","xfaLayer xfaFont");const d=[];if(s.children.length===0){if(s.value){const m=document.createTextNode(s.value);o.append(m),u&&Do.shouldBuildText(s.name)&&d.push(m)}return{textDivs:d}}const p=[[s,-1,o]];for(;p.length>0;){const[m,v,_]=p.at(-1);if(v+1===m.children.length){p.pop();continue}const A=m.children[++p.at(-1)[1]];if(A===null)continue;const{name:y}=A;if(y==="#text"){const T=document.createTextNode(A.value);d.push(T),_.append(T);continue}const E=A?.attributes?.xmlns?document.createElementNS(A.attributes.xmlns,y):document.createElement(y);if(_.append(E),A.attributes&&this.setAttributes({html:E,element:A,storage:e,intent:l,linkService:i}),A.children?.length>0)p.push([A,-1,E]);else if(A.value){const T=document.createTextNode(A.value);u&&Do.shouldBuildText(y)&&d.push(T),E.append(T)}}for(const m of f.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:d}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const ND=9,zs=new WeakSet,LD=new Date().getTimezoneOffset()*60*1e3;class _x{static create(t){switch(t.data.annotationType){case je.LINK:return new Kd(t);case je.TEXT:return new FD(t);case je.WIDGET:switch(t.data.fieldType){case"Tx":return new kD(t);case"Btn":return t.data.radioButton?new Dy(t):t.data.checkBox?new BD(t):new ID(t);case"Ch":return new UD(t);case"Sig":return new PD(t)}return new Ws(t);case je.POPUP:return new fd(t);case je.FREETEXT:return new Oy(t);case je.LINE:return new zD(t);case je.SQUARE:return new GD(t);case je.CIRCLE:return new VD(t);case je.POLYLINE:return new My(t);case je.CARET:return new XD(t);case je.INK:return new Qd(t);case je.POLYGON:return new jD(t);case je.HIGHLIGHT:return new Ny(t);case je.UNDERLINE:return new YD(t);case je.SQUIGGLY:return new qD(t);case je.STRIKEOUT:return new WD(t);case je.STAMP:return new Ly(t);case je.FILEATTACHMENT:return new $D(t);default:return new Ue(t)}}}class Ue{#t=null;#e=!1;#i=null;constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Ue._hasPopupData(this.data)}get hasCommentButton(){return this.enableComment&&this._isEditable&&this.hasPopupElement}get commentButtonPosition(){const{quadPoints:t,rect:e}=this.data;let i=-1/0,s=-1/0;if(t?.length>=8){for(let l=0;l<t.length;l+=8)t[l+1]>s?(s=t[l+1],i=t[l+2]):t[l+1]===s&&(i=Math.max(i,t[l+2]));return[i,s]}return e?[e[2],e[3]]:null}get commentButtonColor(){if(!this.data.color)return null;const[t,e,i]=this.data.color,l=255*(1-(this.data.opacity??1));return this.#n(Math.min(t+l,255),Math.min(e+l,255),Math.min(i+l,255))}#n(t,e,i){t/=255,e/=255,i/=255;const s=Math.max(t,e,i),l=Math.min(t,e,i),o=(s+l)/2,u=((1+Math.sqrt(o))/2*100).toFixed(2);if(s===l)return`hsl(0, 0%, ${u}%)`;const f=s-l;let d;s===t?d=(e-i)/f+(e<i?6:0):s===e?d=(i-t)/f+2:d=(t-e)/f+4,d=(d*60).toFixed(2);const p=(f/(1-Math.abs(2*o-1))*100).toFixed(2);return`hsl(${d}, ${p}%, ${u}%)`}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:i,pageHeight:s,pageX:l,pageY:o}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-l)/i,t[1]=100*(t[1]-o)/s,t}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:i}=t;e&&this.#s(e);let s=this.#i?.popup||this.popup;!s&&i?.text&&(this._createPopup(i),s=this.#i.popup),s&&(s.updateEdited(t),i?.deleted&&(s.remove(),this.#i=null,this.popup=null))}resetEdited(){this.#t&&(this.#s(this.#t.rect),this.#i?.popup.resetEdited(),this.#t=null)}#s(t){const{container:{style:e},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:l,pageHeight:o,pageX:u,pageY:f}}}}=this;i?.splice(0,4,...t),e.left=`${100*(t[0]-u)/l}%`,e.top=`${100*(o-t[3]+f)/o}%`,s===0?(e.width=`${100*(t[2]-t[0])/l}%`,e.height=`${100*(t[3]-t[1])/o}%`):this.setRotation(s)}_createContainer(t){const{data:e,parent:{page:i,viewport:s}}=this,l=document.createElement("section");l.setAttribute("data-annotation-id",e.id),!(this instanceof Ws)&&!(this instanceof Kd)&&(l.tabIndex=0);const{style:o}=l;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(l.title=e.alternativeText),e.noRotate&&l.classList.add("norotate"),!e.rect||this instanceof fd){const{rotation:y}=e;return!e.hasOwnCanvas&&y!==0&&this.setRotation(y,l),l}const{width:u,height:f}=this;if(!t&&e.borderStyle.width>0){o.borderWidth=`${e.borderStyle.width}px`;const y=e.borderStyle.horizontalCornerRadius,E=e.borderStyle.verticalCornerRadius;if(y>0||E>0){const b=`calc(${y}px * var(--total-scale-factor)) / calc(${E}px * var(--total-scale-factor))`;o.borderRadius=b}else if(this instanceof Dy){const b=`calc(${u}px * var(--total-scale-factor)) / calc(${f}px * var(--total-scale-factor))`;o.borderRadius=b}switch(e.borderStyle.style){case Ba.SOLID:o.borderStyle="solid";break;case Ba.DASHED:o.borderStyle="dashed";break;case Ba.BEVELED:qt("Unimplemented border style: beveled");break;case Ba.INSET:qt("Unimplemented border style: inset");break;case Ba.UNDERLINE:o.borderBottomStyle="solid";break}const T=e.borderColor||null;T?(this.#e=!0,o.borderColor=kt.makeHexColor(T[0]|0,T[1]|0,T[2]|0)):o.borderWidth=0}const d=kt.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:p,pageHeight:m,pageX:v,pageY:_}=s.rawDims;o.left=`${100*(d[0]-v)/p}%`,o.top=`${100*(d[1]-_)/m}%`;const{rotation:A}=e;return e.hasOwnCanvas||A===0?(o.width=`${100*u/p}%`,o.height=`${100*f/m}%`):this.setRotation(A,l),l}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims;let{width:l,height:o}=this;t%180!==0&&([l,o]=[o,l]),e.style.width=`${100*l/i}%`,e.style.height=`${100*o/s}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,s)=>{const l=s.detail[e],o=l[0],u=l.slice(1);s.target.style[i]=xx[`${o}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[i]:xx[`${o}_rgb`](u)})};return Zt(this,"_commonActions",{display:e=>{const{display:i}=e.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const s of Object.keys(e.detail))(t[s]||i[s])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[s,l]of Object.entries(e)){const o=i[s];if(o){const u={detail:{[s]:l},target:t};o(u),delete e[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,s,l]=this.data.rect.map(y=>Math.fround(y));if(t.length===8){const[y,E,T,b]=t.subarray(2,6);if(s===y&&l===E&&e===T&&i===b)return}const{style:o}=this.container;let u;if(this.#e){const{borderColor:y,borderWidth:E}=o;o.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${y}" stroke-width="${E}">`],this.container.classList.add("hasBorder")}const f=s-e,d=l-i,{svgFactory:p}=this,m=p.createElement("svg");m.classList.add("quadrilateralsContainer"),m.setAttribute("width",0),m.setAttribute("height",0),m.role="none";const v=p.createElement("defs");m.append(v);const _=p.createElement("clipPath"),A=`clippath_${this.data.id}`;_.setAttribute("id",A),_.setAttribute("clipPathUnits","objectBoundingBox"),v.append(_);for(let y=2,E=t.length;y<E;y+=8){const T=t[y],b=t[y+1],w=t[y+2],O=t[y+3],F=p.createElement("rect"),z=(w-e)/f,L=(l-b)/d,G=(T-w)/f,V=(b-O)/d;F.setAttribute("x",z),F.setAttribute("y",L),F.setAttribute("width",G),F.setAttribute("height",V),_.append(F),u?.push(`<rect vector-effect="non-scaling-stroke" x="${z}" y="${L}" width="${G}" height="${V}"/>`)}this.#e&&(u.push("</g></svg>')"),o.backgroundImage=u.join("")),this.container.append(m),this.container.style.clipPath=`url(#${A})`}_createPopup(t=null){const{data:e}=this;let i,s;t?(i={str:t.text},s=t.date):(i=e.contentsObj,s=e.modificationDate);const l=this.#i=new fd({data:{color:e.color,titleObj:e.titleObj,modificationDate:s,contentsObj:i,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]});this.parent.div.append(l.render())}get hasPopupElement(){return!!(this.#i||this.popup||this.data.popupRef)}render(){Ae("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[t];if(s)for(const{page:l,id:o,exportValues:u}of s){if(l===-1||o===e)continue;const f=typeof u=="string"?u:null,d=document.querySelector(`[data-element-id="${o}"]`);if(d&&!zs.has(d)){qt(`_getElementsByName - element not allowed: ${o}`);continue}i.push({id:o,exportValue:f,domElement:d})}return i}for(const s of document.getElementsByName(t)){const{exportValue:l}=s,o=s.getAttribute("data-element-id");o!==e&&zs.has(s)&&i.push({id:o,exportValue:l,domElement:s})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class Kd extends Ue{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let s=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),s=!0):t.attachment?(this.#e(i,t.attachment,t.overlaidText,t.attachmentDest),s=!0):t.setOCGState?(this.#i(i,t.setOCGState,t.overlaidText),s=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),s=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(i,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(i),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,i=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),i&&(t.title=i)}_bindNamedAction(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),i&&(t.title=i),this.#t()}#e(t,e,i="",s=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:i&&(t.title=i),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,s),!1),this.#t()}#i(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),i&&(t.title=i),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(e.actions)){const l=i.get(s);l&&(t[l]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:s}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){qt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{i?.();const{fields:s,refs:l,include:o}=e,u=[];if(s.length!==0||l.length!==0){const p=new Set(l);for(const m of s){const v=this._fieldObjects[m]||[];for(const{id:_}of v)p.add(_)}for(const m of Object.values(this._fieldObjects))for(const v of m)p.has(v.id)===o&&u.push(v)}else for(const p of Object.values(this._fieldObjects))u.push(...p);const f=this.annotationStorage,d=[];for(const p of u){const{id:m}=p;switch(d.push(m),p.type){case"text":{const _=p.defaultValue||"";f.setValue(m,{value:_});break}case"checkbox":case"radiobutton":{const _=p.defaultValue===p.exportValues;f.setValue(m,{value:_});break}case"combobox":case"listbox":{const _=p.defaultValue||"";f.setValue(m,{value:_});break}default:continue}const v=document.querySelector(`[data-element-id="${m}"]`);if(v){if(!zs.has(v)){qt(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}}),!1}}}class FD extends Ue{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Ws extends Ue{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return _i.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,s,l){i.includes("mouse")?t.addEventListener(i,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:l(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):t.addEventListener(i,o=>{if(i==="blur"){if(!e.focused||!o.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}l&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:l(o)}})})}_setEventListeners(t,e,i,s){for(const[l,o]of i)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,l,o,s),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":kt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||ND,l=t.style;let o;const u=2,f=d=>Math.round(10*d)/10;if(this.data.multiLine){const d=Math.abs(this.data.rect[3]-this.data.rect[1]-u),p=Math.round(d/(q0*s))||1,m=d/p;o=Math.min(s,f(m/q0))}else{const d=Math.abs(this.data.rect[3]-this.data.rect[1]-u);o=Math.min(s,f(d/q0))}l.fontSize=`calc(${o}px * var(--total-scale-factor))`,l.color=kt.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(l.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class kD extends Ws{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,s){const l=this.annotationStorage;for(const o of this._getElementsByName(t.name,t.id))o.domElement&&(o.domElement[e]=i),l.setValue(o.id,{[s]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const s=t.getValue(e,{value:this.data.fieldValue});let l=s.value||"";const o=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;o&&l.length>o&&(l=l.slice(0,o));let u=s.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const f={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=u??l,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",u??l),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),zs.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:d,datetimeType:p,timeStep:m}=this.data,v=!!p&&this.enableScripting;d&&(i.title=d),this._setRequired(i,this.data.required),o&&(i.maxLength=o),i.addEventListener("input",A=>{t.setValue(e,{value:A.target.value}),this.setPropertyOnSiblings(i,"value",A.target.value,"value"),f.formattedValue=null}),i.addEventListener("resetform",A=>{const y=this.data.defaultFieldValue??"";i.value=f.userValue=y,f.formattedValue=null});let _=A=>{const{formattedValue:y}=f;y!=null&&(A.target.value=y),A.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",y=>{if(f.focused)return;const{target:E}=y;if(v&&(E.type=p,m&&(E.step=m)),f.userValue){const T=f.userValue;if(v)if(p==="time"){const b=new Date(T),w=[b.getHours(),b.getMinutes(),b.getSeconds()];E.value=w.map(O=>O.toString().padStart(2,"0")).join(":")}else E.value=new Date(T-LD).toISOString().split(p==="date"?"T":".",1)[0];else E.value=T}f.lastCommittedValue=E.value,f.commitKey=1,this.data.actions?.Focus||(f.focused=!0)}),i.addEventListener("updatefromsandbox",y=>{this.showElementAndHideCanvas(y.target);const E={value(T){f.userValue=T.detail.value??"",v||t.setValue(e,{value:f.userValue.toString()}),T.target.value=f.userValue},formattedValue(T){const{formattedValue:b}=T.detail;f.formattedValue=b,b!=null&&T.target!==document.activeElement&&(T.target.value=b);const w={formattedValue:b};v&&(w.value=b),t.setValue(e,w)},selRange(T){T.target.setSelectionRange(...T.detail.selRange)},charLimit:T=>{const{charLimit:b}=T.detail,{target:w}=T;if(b===0){w.removeAttribute("maxLength");return}w.setAttribute("maxLength",b);let O=f.userValue;!O||O.length<=b||(O=O.slice(0,b),w.value=f.userValue=O,t.setValue(e,{value:O}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:O,willCommit:!0,commitKey:1,selStart:w.selectionStart,selEnd:w.selectionEnd}}))}};this._dispatchEventFromSandbox(E,y)}),i.addEventListener("keydown",y=>{f.commitKey=1;let E=-1;if(y.key==="Escape"?E=0:y.key==="Enter"&&!this.data.multiLine?E=2:y.key==="Tab"&&(f.commitKey=3),E===-1)return;const{value:T}=y.target;f.lastCommittedValue!==T&&(f.lastCommittedValue=T,f.userValue=T,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:T,willCommit:!0,commitKey:E,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}}))});const A=_;_=null,i.addEventListener("blur",y=>{if(!f.focused||!y.relatedTarget)return;this.data.actions?.Blur||(f.focused=!1);const{target:E}=y;let{value:T}=E;if(v){if(T&&p==="time"){const b=T.split(":").map(w=>parseInt(w,10));T=new Date(2e3,0,1,b[0],b[1],b[2]||0).valueOf(),E.step=""}else T=new Date(T).valueOf();E.type="text"}f.userValue=T,f.lastCommittedValue!==T&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:T,willCommit:!0,commitKey:f.commitKey,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}}),A(y)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",y=>{f.lastCommittedValue=null;const{data:E,target:T}=y,{value:b,selectionStart:w,selectionEnd:O}=T;let F=w,z=O;switch(y.inputType){case"deleteWordBackward":{const L=b.substring(0,w).match(/\w*[^\w]*$/);L&&(F-=L[0].length);break}case"deleteWordForward":{const L=b.substring(w).match(/^[^\w]*\w*/);L&&(z+=L[0].length);break}case"deleteContentBackward":w===O&&(F-=1);break;case"deleteContentForward":w===O&&(z+=1);break}y.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:b,change:E||"",willCommit:!1,selStart:F,selEnd:z}})}),this._setEventListeners(i,f,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],y=>y.target.value)}if(_&&i.addEventListener("blur",_),this.data.comb){const y=(this.data.rect[2]-this.data.rect[0])/o;i.classList.add("comb"),i.style.letterSpacing=`calc(${y}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class PD extends Ws{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class BD extends Ws{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",t.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const l=document.createElement("input");return zs.add(l),l.setAttribute("data-element-id",i),l.disabled=e.readOnly,this._setRequired(l,this.data.required),l.type="checkbox",l.name=e.fieldName,s&&l.setAttribute("checked",!0),l.setAttribute("exportValue",e.exportValue),l.tabIndex=0,l.addEventListener("change",o=>{const{name:u,checked:f}=o.target;for(const d of this._getElementsByName(u,i)){const p=f&&d.exportValue===e.exportValue;d.domElement&&(d.domElement.checked=p),t.setValue(d.id,{value:p})}t.setValue(i,{value:f})}),l.addEventListener("resetform",o=>{const u=e.defaultFieldValue||"Off";o.target.checked=u===e.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",o=>{const u={value(f){f.target.checked=f.detail.value!=="Off",t.setValue(i,{value:f.target.checked})}};this._dispatchEventFromSandbox(u,o)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class Dy extends Ws{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof s=="string"&&(s=s!==e.buttonValue,t.setValue(i,{value:s})),s)for(const o of this._getElementsByName(e.fieldName,i))t.setValue(o.id,{value:!1});const l=document.createElement("input");if(zs.add(l),l.setAttribute("data-element-id",i),l.disabled=e.readOnly,this._setRequired(l,this.data.required),l.type="radio",l.name=e.fieldName,s&&l.setAttribute("checked",!0),l.tabIndex=0,l.addEventListener("change",o=>{const{name:u,checked:f}=o.target;for(const d of this._getElementsByName(u,i))t.setValue(d.id,{value:!1});t.setValue(i,{value:f})}),l.addEventListener("resetform",o=>{const u=e.defaultFieldValue;o.target.checked=u!=null&&u===e.buttonValue}),this.enableScripting&&this.hasJSActions){const o=e.buttonValue;l.addEventListener("updatefromsandbox",u=>{const f={value:d=>{const p=o===d.detail.value;for(const m of this._getElementsByName(d.target.name)){const v=p&&m.id===i;m.domElement&&(m.domElement.checked=v),t.setValue(m.id,{value:v})}}};this._dispatchEventFromSandbox(f,u)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class ID extends Kd{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class UD extends Ws{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),s=document.createElement("select");zs.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let l=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",p=>{const m=this.data.defaultFieldValue;for(const v of s.options)v.selected=v.value===m});for(const p of this.data.options){const m=document.createElement("option");m.textContent=p.displayValue,m.value=p.exportValue,i.value.includes(p.exportValue)&&(m.setAttribute("selected",!0),l=!1),s.append(m)}let o=null;if(l){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),s.prepend(p),o=()=>{p.remove(),s.removeEventListener("input",o),o=null},s.addEventListener("input",o)}const u=p=>{const m=p?"value":"textContent",{options:v,multiple:_}=s;return _?Array.prototype.filter.call(v,A=>A.selected).map(A=>A[m]):v.selectedIndex===-1?null:v[v.selectedIndex][m]};let f=u(!1);const d=p=>{const m=p.target.options;return Array.prototype.map.call(m,v=>({displayValue:v.textContent,exportValue:v.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",p=>{const m={value(v){o?.();const _=v.detail.value,A=new Set(Array.isArray(_)?_:[_]);for(const y of s.options)y.selected=A.has(y.value);t.setValue(e,{value:u(!0)}),f=u(!1)},multipleSelection(v){s.multiple=!0},remove(v){const _=s.options,A=v.detail.remove;_[A].selected=!1,s.remove(A),_.length>0&&Array.prototype.findIndex.call(_,E=>E.selected)===-1&&(_[0].selected=!0),t.setValue(e,{value:u(!0),items:d(v)}),f=u(!1)},clear(v){for(;s.length!==0;)s.remove(0);t.setValue(e,{value:null,items:[]}),f=u(!1)},insert(v){const{index:_,displayValue:A,exportValue:y}=v.detail.insert,E=s.children[_],T=document.createElement("option");T.textContent=A,T.value=y,E?E.before(T):s.append(T),t.setValue(e,{value:u(!0),items:d(v)}),f=u(!1)},items(v){const{items:_}=v.detail;for(;s.length!==0;)s.remove(0);for(const A of _){const{displayValue:y,exportValue:E}=A,T=document.createElement("option");T.textContent=y,T.value=E,s.append(T)}s.options.length>0&&(s.options[0].selected=!0),t.setValue(e,{value:u(!0),items:d(v)}),f=u(!1)},indices(v){const _=new Set(v.detail.indices);for(const A of v.target.options)A.selected=_.has(A.index);t.setValue(e,{value:u(!0)}),f=u(!1)},editable(v){v.target.disabled=!v.detail.editable}};this._dispatchEventFromSandbox(m,p)}),s.addEventListener("input",p=>{const m=u(!0),v=u(!1);t.setValue(e,{value:m}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:f,change:v,changeEx:m,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):s.addEventListener("input",function(p){t.setValue(e,{value:u(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class fd extends Ue{constructor(t){const{data:e,elements:i}=t;super(t,{isRenderable:Ue._hasPopupData(e)}),this.elements=i,this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=new HD({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,eventBus:this.linkService.eventBus}),i=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",i.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(s=>`${Hd}${s}`).join(",")),this.container}}class HD{#t=this.#F.bind(this);#e=this.#w.bind(this);#i=this.#U.bind(this);#n=this.#M.bind(this);#s=null;#r=null;#a=null;#l=null;#o=null;#c=null;#f=null;#u=null;#d=!1;#g=null;#p=null;#h=null;#m=null;#_=null;#v=null;#A=null;#E=null;#x=null;#S=null;#R=!1;constructor({container:t,color:e,elements:i,titleObj:s,modificationDate:l,contentsObj:o,richText:u,parent:f,rect:d,parentRect:p,open:m,eventBus:v=null}){this.#r=t,this.#x=s,this.#a=o,this.#E=u,this.#f=f,this.#s=e,this.#A=d,this.#u=p,this.#o=i,this.#c=v,this.#l=ld.toDateObject(l),this.trigger=i.flatMap(_=>_.getElementsToTriggerPopup()),this.#b(),this.#r.hidden=!0,m&&this.#M()}#b(){if(this.#p)return;this.#p=new AbortController;const{signal:t}=this.#p;for(const e of this.trigger)e.addEventListener("click",this.#n,{signal:t}),e.addEventListener("mouseenter",this.#i,{signal:t}),e.addEventListener("mouseleave",this.#e,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#o)e.container?.addEventListener("keydown",this.#t,{signal:t});this.#N()}#T(){const t=this.#o.find(e=>e.hasCommentButton);t&&(this.#_=t._normalizePoint(t.commentButtonPosition),this.#v=t.commentButtonColor)}#N(){if(this.#m||(this.#_||this.#T(),!this.#_))return;const t=this.#m=document.createElement("button");t.className="annotationCommentButton";const e=this.#o[0].container;t.style.zIndex=e.style.zIndex+1,t.tabIndex=0;const{signal:i}=this.#p;t.addEventListener("hover",this.#n,{signal:i}),t.addEventListener("keydown",this.#t,{signal:i}),t.addEventListener("click",()=>{const[{data:{id:l},annotationEditorType:o}]=this.#o;this.#c?.dispatch("switchannotationeditormode",{source:this,editId:l,mode:o,editComment:!0})},{signal:i});const{style:s}=t;s.left=`calc(${this.#_[0]}%)`,s.top=`calc(${this.#_[1]}% - var(--comment-button-dim))`,this.#v&&(s.backgroundColor=this.#v),e.after(t)}render(){if(this.#g)return;const t=this.#g=document.createElement("div");if(t.className="popup",this.#s){const s=t.style.outlineColor=kt.makeHexColor(...this.#s);t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#x?.str){const s=document.createElement("span");s.className="title",e.append(s),{dir:s.dir,str:s.textContent}=this.#x}if(t.append(e),this.#l){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#l.valueOf()})),s.dateTime=this.#l.toISOString(),e.append(s)}const i=this.#C;if(i)Ry.render({xfaHtml:i,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(this.#a);t.append(s)}this.#r.append(t)}get#C(){const t=this.#E,e=this.#a;return t?.str&&(!e?.str||e.str===t.str)&&this.#E.html||null}get#D(){return this.#C?.attributes?.style?.fontSize||0}get#k(){return this.#C?.attributes?.style?.color||null}#L(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},s={style:{color:this.#k,fontSize:this.#D?`calc(${this.#D}px * var(--total-scale-factor))`:""}};for(const l of t.split(`
`))e.push({name:"span",value:l,attributes:s});return i}_formatContents({str:t,dir:e}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=e;const s=t.split(/(?:\r\n?|\n)/);for(let l=0,o=s.length;l<o;++l){const u=s[l];i.append(document.createTextNode(u)),l<o-1&&i.append(document.createElement("br"))}return i}#F(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#d)&&this.#M()}updateEdited({rect:t,popup:e,deleted:i}){if(i||e?.deleted){this.remove();return}this.#b(),this.#S||={contentsObj:this.#a,richText:this.#E},t&&(this.#h=null),e&&(this.#E=this.#L(e.text),this.#l=ld.toDateObject(e.date),this.#a=null),this.#g?.remove(),this.#g=null}resetEdited(){this.#S&&({contentsObj:this.#a,richText:this.#E}=this.#S,this.#S=null,this.#g?.remove(),this.#g=null,this.#h=null)}remove(){this.#p?.abort(),this.#p=null,this.#g?.remove(),this.#g=null,this.#R=!1,this.#d=!1;for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#P(){if(this.#h!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:s,pageY:l}}}=this.#f;let o=!!this.#u,u=o?this.#u:this.#A;for(const A of this.#o)if(!u||kt.intersect(A.data.rect,u)!==null){u=A.data.rect,o=!0;break}const f=kt.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),p=o?u[2]-u[0]+5:0,m=f[0]+p,v=f[1];this.#h=[100*(m-s)/e,100*(v-l)/i];const{style:_}=this.#r;_.left=`${this.#h[0]}%`,_.top=`${this.#h[1]}%`}#M(){this.#d=!this.#d,this.#d?(this.#U(),this.#r.addEventListener("click",this.#n),this.#r.addEventListener("keydown",this.#t)):(this.#w(),this.#r.removeEventListener("click",this.#n),this.#r.removeEventListener("keydown",this.#t))}#U(){this.#g||this.render(),this.isVisible?this.#d&&this.#r.classList.add("focused"):(this.#P(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#w(){this.#r.classList.remove("focused"),!(this.#d||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#R=this.isVisible,this.#R&&(this.#r.hidden=!0)}maybeShow(){this.#b(),this.#R&&(this.#g||this.#U(),this.#R=!1,this.#r.hidden=!1)}get isVisible(){return this.#r.hidden===!1}}class Oy extends Ue{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Xt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class zD extends Ue{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:i}=this,s=this.svgFactory.create(e,i,!0),l=this.#t=this.svgFactory.createElement("svg:line");return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class GD extends Ue{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:i}=this,s=this.svgFactory.create(e,i,!0),l=t.borderStyle.width,o=this.#t=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",l/2),o.setAttribute("y",l/2),o.setAttribute("width",e-l),o.setAttribute("height",i-l),o.setAttribute("stroke-width",l||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class VD extends Ue{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:i}=this,s=this.svgFactory.create(e,i,!0),l=t.borderStyle.width,o=this.#t=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",e/2),o.setAttribute("cy",i/2),o.setAttribute("rx",e/2-l/2),o.setAttribute("ry",i/2-l/2),o.setAttribute("stroke-width",l||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class My extends Ue{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:i,popupRef:s},width:l,height:o}=this;if(!e)return this.container;const u=this.svgFactory.create(l,o,!0);let f=[];for(let p=0,m=e.length;p<m;p+=2){const v=e[p]-t[0],_=t[3]-e[p+1];f.push(`${v},${_}`)}f=f.join(" ");const d=this.#t=this.svgFactory.createElement(this.svgElementName);return d.setAttribute("points",f),d.setAttribute("stroke-width",i.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),u.append(d),this.container.append(u),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class jD extends My{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class XD extends Ue{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Qd extends Ue{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Xt.HIGHLIGHT:Xt.INK}#i(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:i,borderStyle:s,popupRef:l}}=this,{transform:o,width:u,height:f}=this.#i(e,t),d=this.svgFactory.create(u,f,!0),p=this.#t=this.svgFactory.createElement("svg:g");d.append(p),p.setAttribute("stroke-width",s.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",o);for(let m=0,v=i.length;m<v;m++){const _=this.svgFactory.createElement(this.svgElementName);this.#e.push(_),_.setAttribute("points",i[m].join(",")),p.append(_)}return!l&&this.hasPopupData&&this._createPopup(),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:i,rect:s}=t,l=this.#t;if(e>=0&&l.setAttribute("stroke-width",e||1),i)for(let o=0,u=this.#e.length;o<u;o++)this.#e[o].setAttribute("points",i[o].join(","));if(s){const{transform:o,width:u,height:f}=this.#i(this.data.rotation,s);l.parentElement.setAttribute("viewBox",`0 0 ${u} ${f}`),l.setAttribute("transform",o)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}get commentButtonPosition(){const{inkLists:t,rect:e}=this.data;if(t?.length>=1){let i=-1/0,s=-1/0;for(const l of t)for(let o=0,u=l.length;o<u;o+=2)l[o+1]>s?(s=l[o+1],i=l[o]):l[o+1]===s&&(i=Math.max(i,l[o]));if(i!==1/0)return[i,s]}return e?[e[2],e[3]]:null}}class Ny extends Ue{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Xt.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class YD extends Ue{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class qD extends Ue{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class WD extends Ue{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),t){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class Ly extends Ue{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Xt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class $D extends Ue{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||e.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#e.bind(this)),this.#t=i;const{isMac:s}=_i.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(s?l.metaKey:l.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Zd{#t=null;#e=null;#i=new Map;#n=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:s,page:l,viewport:o,structTreeLayer:u}){this.div=t,this.#t=e,this.#e=i,this.#n=u||null,this.page=l,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return this.#i.size>0}async#s(t,e,i){const s=t.firstChild||t,l=s.id=`${Hd}${e}`,o=await this.#n?.getAriaAttributes(l);if(o)for(const[u,f]of o)s.setAttribute(u,f);i?i.at(-1).container.after(t):(this.div.append(t),this.#t?.moveElementInDOM(this.div,t,s,!1))}async render(t){const{annotations:e}=t,i=this.div;Hs(i,this.viewport);const s=new Map,l={data:null,layer:i,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Gu,annotationStorage:t.annotationStorage||new Xd,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const o of e){if(o.noHTML)continue;const u=o.annotationType===je.POPUP;if(u){const p=s.get(o.id);if(!p)continue;l.elements=p}else if(o.rect[2]===o.rect[0]||o.rect[3]===o.rect[1])continue;l.data=o;const f=_x.create(l);if(!f.isRenderable)continue;if(!u&&o.popupRef){const p=s.get(o.popupRef);p?p.push(f):s.set(o.popupRef,[f])}const d=f.render();o.hidden&&(d.style.visibility="hidden"),await this.#s(d,o.id,l.elements),f._isEditable&&(this.#i.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}this.#r()}async addLinkAnnotations(t,e){const i={data:null,layer:this.div,linkService:e,svgFactory:new Gu,parent:this};for(const s of t){s.borderStyle||=Zd._defaultBorderStyle,i.data=s;const l=_x.create(i);if(!l.isRenderable)continue;const o=l.render();await this.#s(o,s.id,null)}}update({viewport:t}){const e=this.div;this.viewport=t,Hs(e,{rotation:t.rotation}),this.#r(),e.hidden=!1}#r(){if(!this.#e)return;const t=this.div;for(const[e,i]of this.#e){const s=t.querySelector(`[data-annotation-id="${e}"]`);if(!s)continue;i.className="annotationContent";const{firstChild:l}=s;l?l.nodeName==="CANVAS"?l.replaceWith(i):l.classList.contains("annotationContent")?l.after(i):l.before(i):s.append(i);const o=this.#i.get(e);o&&(o._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,s.id,i),o._hasNoCanvas=!1):o.canvas=i)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(t){return this.#i.get(t)}static get _defaultBorderStyle(){return Zt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Ba.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const yu=/\r\n?|\n/g;class ni extends Ut{#t;#e="";#i=`${this.id}-editor`;#n=null;#s;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=ni.prototype,e=l=>l.isEmpty(),i=os.TRANSLATE_SMALL,s=os.TRANSLATE_BIG;return Zt(this,"_keyboardManager",new zo([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:e}]]))}static _type="freetext";static _editorType=Xt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.#t=t.color||ni._defaultColor||Ut._defaultLineColor,this.#s=t.fontSize||ni._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(t,e){Ut.initialize(t,e);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case ie.FREETEXT_SIZE:ni._defaultFontSize=e;break;case ie.FREETEXT_COLOR:ni._defaultColor=e;break}}updateParams(t,e){switch(t){case ie.FREETEXT_SIZE:this.#r(e);break;case ie.FREETEXT_COLOR:this.#a(e);break}}static get defaultPropertiesToUpdate(){return[[ie.FREETEXT_SIZE,ni._defaultFontSize],[ie.FREETEXT_COLOR,ni._defaultColor||Ut._defaultLineColor]]}get propertiesToUpdate(){return[[ie.FREETEXT_SIZE,this.#s],[ie.FREETEXT_COLOR,this.#t]]}get toolbarButtons(){return this._colorPicker||=new Mo(this),[["colorPicker",this._colorPicker]]}get colorType(){return ie.FREETEXT_COLOR}get colorValue(){return this.#t}#r(t){const e=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-this.#s)*this.parentScale),this.#s=s,this.#o()},i=this.#s;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ie.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#a(t){const e=s=>{this.#t=this.editorDiv.style.color=s,this._colorPicker?.update(s)},i=this.#t;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ie.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-ni._internalPadding*t,-(ni._internalPadding+this.#s)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const t=this._uiManager.combinedSignal(this.#n);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#i),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#l(){const t=[];this.editorDiv.normalize();let e=null;for(const i of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(ni.#c(i)),e=i);return t.join(`
`)}#o(){const[t,e]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:s,div:l}=this,o=l.style.display,u=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",s.div.append(this.div),i=l.getBoundingClientRect(),l.remove(),l.style.display=o,l.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/e):(this.width=i.height/t,this.height=i.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#e,e=this.#e=this.#l().trimEnd();if(t===e)return;const i=s=>{if(this.#e=s,!s){this.remove();return}this.#f(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){ni._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#i),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,i.color=this.#t,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,l]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[u,f]=this.getInitialTranslation();[u,f]=this.pageTranslationToScreen(u,f);const[d,p]=this.pageDimensions,[m,v]=this.pageTranslation;let _,A;switch(this.rotation){case 0:_=t+(o[0]-m)/d,A=e+this.height-(o[1]-v)/p;break;case 90:_=t+(o[0]-m)/d,A=e-(o[1]-v)/p,[u,f]=[f,-u];break;case 180:_=t-this.width+(o[0]-m)/d,A=e-(o[1]-v)/p,[u,f]=[-u,-f];break;case 270:_=t+(o[0]-m-this.height*p)/d,A=e+(o[1]-v-this.width*d)/p,[u,f]=[-f,u];break}this.setAt(_*s,A*l,u,f)}else this._moveAfterPaste(t,e);this.#f(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(yu,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:i}=e;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const s=ni.#d(e.getData("text")||"").replaceAll(yu,`
`);if(!s)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const o=l.getRangeAt(0);if(!s.includes(`
`)){o.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:u,startOffset:f}=o,d=[],p=[];if(u.nodeType===Node.TEXT_NODE){const _=u.parentElement;if(p.push(u.nodeValue.slice(f).replaceAll(yu,"")),_!==this.editorDiv){let A=d;for(const y of this.editorDiv.childNodes){if(y===_){A=p;continue}A.push(ni.#c(y))}}d.push(u.nodeValue.slice(0,f).replaceAll(yu,""))}else if(u===this.editorDiv){let _=d,A=0;for(const y of this.editorDiv.childNodes)A++===f&&(_=p),_.push(ni.#c(y))}this.#e=`${d.join(`
`)}${s}${p.join(`
`)}`,this.#f();const m=new Range;let v=Math.sumPrecise(d.map(_=>_.length));for(const{firstChild:_}of this.editorDiv.childNodes)if(_.nodeType===Node.TEXT_NODE){const A=_.nodeValue.length;if(v<=A){m.setStart(_,v),m.setEnd(_,v);break}v-=A}l.removeAllRanges(),l.addRange(m)}#f(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const t of this.#e.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#u(){return this.#e.replaceAll(" "," ")}static#d(t){return t.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=ni._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,i){let s=null;if(t instanceof Oy){const{data:{defaultAppearanceData:{fontSize:o,fontColor:u},rect:f,rotation:d,id:p,popupRef:m,contentsObj:v},textContent:_,textPosition:A,parent:{page:{pageNumber:y}}}=t;if(!_||_.length===0)return null;s=t={annotationType:Xt.FREETEXT,color:Array.from(u),fontSize:o,value:_.join(`
`),position:A,pageIndex:y-1,rect:f.slice(0),rotation:d,annotationElementId:p,id:p,deleted:!1,popupRef:m,comment:v?.str||null}}const l=await super.deserialize(t,e,i);return l.#s=t.fontSize,l.#t=kt.makeHexColor(...t.color),l.#e=ni.#d(t.value),l._initialData=s,t.comment&&l.setCommentData(t.comment),l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=this.getPDFRect(),i=Ut._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#t),s={annotationType:Xt.FREETEXT,color:i,fontSize:this.#s,value:this.#u(),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!this.#g(s)?null:(s.id=this.annotationElementId,s)}#g(t){const{value:e,fontSize:i,color:s,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==i||t.color.some((o,u)=>o!==s[u])||t.pageIndex!==l}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:i}=e;i.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,i.color=this.#t,e.replaceChildren();for(const l of this.#e.split(`
`)){const o=document.createElement("div");o.append(l?document.createTextNode(l):document.createElement("br")),e.append(o)}const s={rect:this.getPDFRect()};return s.popup=this.hasEditedComment?this.comment:{text:this.#e},t.updateEdited(s),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class Lt{static PRECISION=1e-4;toSVGPath(){Ae("Abstract method `toSVGPath` must be implemented.")}get box(){Ae("Abstract getter `box` must be implemented.")}serialize(t,e){Ae("Abstract method `serialize` must be implemented.")}static _rescale(t,e,i,s,l,o){o||=new Float32Array(t.length);for(let u=0,f=t.length;u<f;u+=2)o[u]=e+t[u]*s,o[u+1]=i+t[u+1]*l;return o}static _rescaleAndSwap(t,e,i,s,l,o){o||=new Float32Array(t.length);for(let u=0,f=t.length;u<f;u+=2)o[u]=e+t[u+1]*s,o[u+1]=i+t[u]*l;return o}static _translate(t,e,i,s){s||=new Float32Array(t.length);for(let l=0,o=t.length;l<o;l+=2)s[l]=e+t[l],s[l+1]=i+t[l+1];return s}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,i,s,l){switch(l){case 90:return[1-e/i,t/s];case 180:return[1-t/i,1-e/s];case 270:return[e/i,1-t/s];default:return[t/i,e/s]}}static _normalizePagePoint(t,e,i){switch(i){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,i,s,l,o){return[(t+5*i)/6,(e+5*s)/6,(5*i+l)/6,(5*s+o)/6,(i+l)/2,(s+o)/2]}}class Ns{#t;#e=[];#i;#n;#s=[];#r=new Float32Array(18);#a;#l;#o;#c;#f;#u;#d=[];static#g=8;static#p=2;static#h=Ns.#g+Ns.#p;constructor({x:t,y:e},i,s,l,o,u=0){this.#t=i,this.#u=l*s,this.#n=o,this.#r.set([NaN,NaN,NaN,NaN,t,e],6),this.#i=u,this.#c=Ns.#g*s,this.#o=Ns.#h*s,this.#f=s,this.#d.push(t,e)}isEmpty(){return isNaN(this.#r[8])}#m(){const t=this.#r.subarray(4,6),e=this.#r.subarray(16,18),[i,s,l,o]=this.#t;return[(this.#a+(t[0]-e[0])/2-i)/l,(this.#l+(t[1]-e[1])/2-s)/o,(this.#a+(e[0]-t[0])/2-i)/l,(this.#l+(e[1]-t[1])/2-s)/o]}add({x:t,y:e}){this.#a=t,this.#l=e;const[i,s,l,o]=this.#t;let[u,f,d,p]=this.#r.subarray(8,12);const m=t-d,v=e-p,_=Math.hypot(m,v);if(_<this.#o)return!1;const A=_-this.#c,y=A/_,E=y*m,T=y*v;let b=u,w=f;u=d,f=p,d+=E,p+=T,this.#d?.push(t,e);const O=-T/A,F=E/A,z=O*this.#u,L=F*this.#u;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([d+z,p+L],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([d-z,p-L],16),isNaN(this.#r[6])?(this.#s.length===0&&(this.#r.set([u+z,f+L],2),this.#s.push(NaN,NaN,NaN,NaN,(u+z-i)/l,(f+L-s)/o),this.#r.set([u-z,f-L],14),this.#e.push(NaN,NaN,NaN,NaN,(u-z-i)/l,(f-L-s)/o)),this.#r.set([b,w,u,f,d,p],6),!this.isEmpty()):(this.#r.set([b,w,u,f,d,p],6),Math.abs(Math.atan2(w-f,b-u)-Math.atan2(T,E))<Math.PI/2?([u,f,d,p]=this.#r.subarray(2,6),this.#s.push(NaN,NaN,NaN,NaN,((u+d)/2-i)/l,((f+p)/2-s)/o),[u,f,b,w]=this.#r.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((b+u)/2-i)/l,((w+f)/2-s)/o),!0):([b,w,u,f,d,p]=this.#r.subarray(0,6),this.#s.push(((b+5*u)/6-i)/l,((w+5*f)/6-s)/o,((5*u+d)/6-i)/l,((5*f+p)/6-s)/o,((u+d)/2-i)/l,((f+p)/2-s)/o),[d,p,u,f,b,w]=this.#r.subarray(12,18),this.#e.push(((b+5*u)/6-i)/l,((w+5*f)/6-s)/o,((5*u+d)/6-i)/l,((5*f+p)/6-s)/o,((u+d)/2-i)/l,((f+p)/2-s)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#s,e=this.#e;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#_();const i=[];i.push(`M${t[4]} ${t[5]}`);for(let s=6;s<t.length;s+=6)isNaN(t[s])?i.push(`L${t[s+4]} ${t[s+5]}`):i.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);this.#A(i);for(let s=e.length-6;s>=6;s-=6)isNaN(e[s])?i.push(`L${e[s+4]} ${e[s+5]}`):i.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);return this.#v(i),i.join(" ")}#_(){const[t,e,i,s]=this.#t,[l,o,u,f]=this.#m();return`M${(this.#r[2]-t)/i} ${(this.#r[3]-e)/s} L${(this.#r[4]-t)/i} ${(this.#r[5]-e)/s} L${l} ${o} L${u} ${f} L${(this.#r[16]-t)/i} ${(this.#r[17]-e)/s} L${(this.#r[14]-t)/i} ${(this.#r[15]-e)/s} Z`}#v(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#A(t){const[e,i,s,l]=this.#t,o=this.#r.subarray(4,6),u=this.#r.subarray(16,18),[f,d,p,m]=this.#m();t.push(`L${(o[0]-e)/s} ${(o[1]-i)/l} L${f} ${d} L${p} ${m} L${(u[0]-e)/s} ${(u[1]-i)/l}`)}newFreeDrawOutline(t,e,i,s,l,o){return new Fy(t,e,i,s,l,o)}getOutlines(){const t=this.#s,e=this.#e,i=this.#r,[s,l,o,u]=this.#t,f=new Float32Array((this.#d?.length??0)+2);for(let m=0,v=f.length-2;m<v;m+=2)f[m]=(this.#d[m]-s)/o,f[m+1]=(this.#d[m+1]-l)/u;if(f[f.length-2]=(this.#a-s)/o,f[f.length-1]=(this.#l-l)/u,isNaN(i[6])&&!this.isEmpty())return this.#E(f);const d=new Float32Array(this.#s.length+24+this.#e.length);let p=t.length;for(let m=0;m<p;m+=2){if(isNaN(t[m])){d[m]=d[m+1]=NaN;continue}d[m]=t[m],d[m+1]=t[m+1]}p=this.#S(d,p);for(let m=e.length-6;m>=6;m-=6)for(let v=0;v<6;v+=2){if(isNaN(e[m+v])){d[p]=d[p+1]=NaN,p+=2;continue}d[p]=e[m+v],d[p+1]=e[m+v+1],p+=2}return this.#x(d,p),this.newFreeDrawOutline(d,f,this.#t,this.#f,this.#i,this.#n)}#E(t){const e=this.#r,[i,s,l,o]=this.#t,[u,f,d,p]=this.#m(),m=new Float32Array(36);return m.set([NaN,NaN,NaN,NaN,(e[2]-i)/l,(e[3]-s)/o,NaN,NaN,NaN,NaN,(e[4]-i)/l,(e[5]-s)/o,NaN,NaN,NaN,NaN,u,f,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,(e[16]-i)/l,(e[17]-s)/o,NaN,NaN,NaN,NaN,(e[14]-i)/l,(e[15]-s)/o],0),this.newFreeDrawOutline(m,t,this.#t,this.#f,this.#i,this.#n)}#x(t,e){const i=this.#e;return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+=6}#S(t,e){const i=this.#r.subarray(4,6),s=this.#r.subarray(16,18),[l,o,u,f]=this.#t,[d,p,m,v]=this.#m();return t.set([NaN,NaN,NaN,NaN,(i[0]-l)/u,(i[1]-o)/f,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,m,v,NaN,NaN,NaN,NaN,(s[0]-l)/u,(s[1]-o)/f],e),e+=24}}class Fy extends Lt{#t;#e=new Float32Array(4);#i;#n;#s;#r;#a;constructor(t,e,i,s,l,o){super(),this.#a=t,this.#s=e,this.#t=i,this.#r=s,this.#i=l,this.#n=o,this.lastPoint=[NaN,NaN],this.#l(o);const[u,f,d,p]=this.#e;for(let m=0,v=t.length;m<v;m+=2)t[m]=(t[m]-u)/d,t[m+1]=(t[m+1]-f)/p;for(let m=0,v=e.length;m<v;m+=2)e[m]=(e[m]-u)/d,e[m+1]=(e[m+1]-f)/p}toSVGPath(){const t=[`M${this.#a[4]} ${this.#a[5]}`];for(let e=6,i=this.#a.length;e<i;e+=6){if(isNaN(this.#a[e])){t.push(`L${this.#a[e+4]} ${this.#a[e+5]}`);continue}t.push(`C${this.#a[e]} ${this.#a[e+1]} ${this.#a[e+2]} ${this.#a[e+3]} ${this.#a[e+4]} ${this.#a[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,i,s],l){const o=i-t,u=s-e;let f,d;switch(l){case 0:f=Lt._rescale(this.#a,t,s,o,-u),d=Lt._rescale(this.#s,t,s,o,-u);break;case 90:f=Lt._rescaleAndSwap(this.#a,t,e,o,u),d=Lt._rescaleAndSwap(this.#s,t,e,o,u);break;case 180:f=Lt._rescale(this.#a,i,e,-o,u),d=Lt._rescale(this.#s,i,e,-o,u);break;case 270:f=Lt._rescaleAndSwap(this.#a,i,s,-o,-u),d=Lt._rescaleAndSwap(this.#s,i,s,-o,-u);break}return{outline:Array.from(f),points:[Array.from(d)]}}#l(t){const e=this.#a;let i=e[4],s=e[5];const l=[i,s,i,s];let o=i,u=s;const f=t?Math.max:Math.min;for(let p=6,m=e.length;p<m;p+=6){const v=e[p+4],_=e[p+5];if(isNaN(e[p]))kt.pointBoundingBox(v,_,l),u<_?(o=v,u=_):u===_&&(o=f(o,v));else{const A=[1/0,1/0,-1/0,-1/0];kt.bezierBoundingBox(i,s,...e.slice(p,p+6),A),kt.rectBoundingBox(...A,l),u<A[3]?(o=A[2],u=A[3]):u===A[3]&&(o=f(o,A[2]))}i=v,s=_}const d=this.#e;d[0]=l[0]-this.#i,d[1]=l[1]-this.#i,d[2]=l[2]-l[0]+2*this.#i,d[3]=l[3]-l[1]+2*this.#i,this.lastPoint=[o,u]}get box(){return this.#e}newOutliner(t,e,i,s,l,o=0){return new Ns(t,e,i,s,l,o)}getNewOutline(t,e){const[i,s,l,o]=this.#e,[u,f,d,p]=this.#t,m=l*d,v=o*p,_=i*d+u,A=s*p+f,y=this.newOutliner({x:this.#s[0]*m+_,y:this.#s[1]*v+A},this.#t,this.#r,t,this.#n,e??this.#i);for(let E=2;E<this.#s.length;E+=2)y.add({x:this.#s[E]*m+_,y:this.#s[E+1]*v+A});return y.getOutlines()}}class dd{#t;#e;#i=[];#n=[];constructor(t,e=0,i=0,s=!0){const l=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:_,y:A,width:y,height:E}of t){const T=Math.floor((_-e)/o)*o,b=Math.ceil((_+y+e)/o)*o,w=Math.floor((A-e)/o)*o,O=Math.ceil((A+E+e)/o)*o,F=[T,w,O,!0],z=[b,w,O,!1];this.#i.push(F,z),kt.rectBoundingBox(T,w,b,O,l)}const u=l[2]-l[0]+2*i,f=l[3]-l[1]+2*i,d=l[0]-i,p=l[1]-i,m=this.#i.at(s?-1:-2),v=[m[0],m[2]];for(const _ of this.#i){const[A,y,E]=_;_[0]=(A-d)/u,_[1]=(y-p)/f,_[2]=(E-p)/f}this.#t=new Float32Array([d,p,u,f]),this.#e=v}getOutlines(){this.#i.sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of this.#i)e[3]?(t.push(...this.#o(e)),this.#a(e)):(this.#l(e),t.push(...this.#o(e)));return this.#s(t)}#s(t){const e=[],i=new Set;for(const o of t){const[u,f,d]=o;e.push([u,f,o],[u,d,o])}e.sort((o,u)=>o[1]-u[1]||o[0]-u[0]);for(let o=0,u=e.length;o<u;o+=2){const f=e[o][2],d=e[o+1][2];f.push(d),d.push(f),i.add(f),i.add(d)}const s=[];let l;for(;i.size>0;){const o=i.values().next().value;let[u,f,d,p,m]=o;i.delete(o);let v=u,_=f;for(l=[u,d],s.push(l);;){let A;if(i.has(p))A=p;else if(i.has(m))A=m;else break;i.delete(A),[u,f,d,p,m]=A,v!==u&&(l.push(v,_,u,_===f?f:d),v=u),_=_===f?d:f}l.push(v,_)}return new KD(s,this.#t,this.#e)}#r(t){const e=this.#n;let i=0,s=e.length-1;for(;i<=s;){const l=i+s>>1,o=e[l][0];if(o===t)return l;o<t?i=l+1:s=l-1}return s+1}#a([,t,e]){const i=this.#r(t);this.#n.splice(i,0,[t,e])}#l([,t,e]){const i=this.#r(t);for(let s=i;s<this.#n.length;s++){const[l,o]=this.#n[s];if(l!==t)break;if(l===t&&o===e){this.#n.splice(s,1);return}}for(let s=i-1;s>=0;s--){const[l,o]=this.#n[s];if(l!==t)break;if(l===t&&o===e){this.#n.splice(s,1);return}}}#o(t){const[e,i,s]=t,l=[[e,i,s]],o=this.#r(s);for(let u=0;u<o;u++){const[f,d]=this.#n[u];for(let p=0,m=l.length;p<m;p++){const[,v,_]=l[p];if(!(d<=v||_<=f)){if(v>=f){if(_>d)l[p][1]=d;else{if(m===1)return[];l.splice(p,1),p--,m--}continue}l[p][2]=f,_>d&&l.push([e,d,_])}}}return l}}class KD extends Lt{#t;#e;constructor(t,e,i){super(),this.#e=t,this.#t=e,this.lastPoint=i}toSVGPath(){const t=[];for(const e of this.#e){let[i,s]=e;t.push(`M${i} ${s}`);for(let l=2;l<e.length;l+=2){const o=e[l],u=e[l+1];o===i?(t.push(`V${u}`),s=u):u===s&&(t.push(`H${o}`),i=o)}t.push("Z")}return t.join(" ")}serialize([t,e,i,s],l){const o=[],u=i-t,f=s-e;for(const d of this.#e){const p=new Array(d.length);for(let m=0;m<d.length;m+=2)p[m]=t+d[m]*u,p[m+1]=s-d[m+1]*f;o.push(p)}return o}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class pd extends Ns{newFreeDrawOutline(t,e,i,s,l,o){return new QD(t,e,i,s,l,o)}}class QD extends Fy{newOutliner(t,e,i,s,l,o=0){return new pd(t,e,i,s,l,o)}}class Ie extends Ut{#t=null;#e=0;#i;#n=null;#s=null;#r=null;#a=null;#l=0;#o=null;#c=null;#f=null;#u=!1;#d=null;#g;#p=null;#h="";#m;#_="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Xt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=Ie.prototype;return Zt(this,"_keyboardManager",new zo([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||Ie._defaultColor,this.#m=t.thickness||Ie._defaultThickness,this.#g=t.opacity||Ie._defaultOpacity,this.#i=t.boxes||null,this.#_=t.methodOfCreation||"",this.#h=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#u=!0,this.#A(t),this.#b()):this.#i&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#a=t.focusNode,this.#l=t.focusOffset,this.#v(),this.#b(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#m,methodOfCreation:this.#_}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}get commentColor(){return this.color}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#v(){const t=new dd(this.#i,.001);this.#c=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#c.box;const e=new dd(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#r=e.getOutlines();const{lastPoint:i}=this.#r;this.#d=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]}#A({highlightOutlines:t,highlightId:e,clipPathId:i}){this.#c=t;const s=1.5;if(this.#r=t.getNewOutline(this.#m/2+s,.0025),e>=0)this.#f=e,this.#n=i,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},!0);else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#f,{bbox:Ie.#T(this.#c.box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:Ie.#T(this.#r.box,p),path:{d:this.#r.toSVGPath()}})}const[l,o,u,f]=t.box;switch(this.rotation){case 0:this.x=l,this.y=o,this.width=u,this.height=f;break;case 90:{const[p,m]=this.parentDimensions;this.x=o,this.y=1-l,this.width=u*m/p,this.height=f*p/m;break}case 180:this.x=1-l,this.y=1-o,this.width=u,this.height=f;break;case 270:{const[p,m]=this.parentDimensions;this.x=1-o,this.y=l,this.width=u*m/p,this.height=f*p/m;break}}const{lastPoint:d}=this.#r;this.#d=[(d[0]-l)/u,(d[1]-o)/f]}static initialize(t,e){Ut.initialize(t,e),Ie._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case ie.HIGHLIGHT_COLOR:Ie._defaultColor=e;break;case ie.HIGHLIGHT_THICKNESS:Ie._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#d}updateParams(t,e){switch(t){case ie.HIGHLIGHT_COLOR:this.#E(e);break;case ie.HIGHLIGHT_THICKNESS:this.#x(e);break}}static get defaultPropertiesToUpdate(){return[[ie.HIGHLIGHT_COLOR,Ie._defaultColor],[ie.HIGHLIGHT_THICKNESS,Ie._defaultThickness]]}get propertiesToUpdate(){return[[ie.HIGHLIGHT_COLOR,this.color||Ie._defaultColor],[ie.HIGHLIGHT_THICKNESS,this.#m||Ie._defaultThickness],[ie.HIGHLIGHT_FREE,this.#u]]}#E(t){const e=(l,o)=>{this.color=l,this.#g=o,this.parent?.drawLayer.updateProperties(this.#f,{root:{fill:l,"fill-opacity":o}}),this.#s?.updateColor(l)},i=this.color,s=this.#g;this.addCommands({cmd:e.bind(this,t,Ie._defaultOpacity),undo:e.bind(this,i,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ie.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#x(t){const e=this.#m,i=s=>{this.#m=s,this.#S(s)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ie.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#s=new Sn({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#D())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#D())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#R(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#b(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#R():t&&(this.#b(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#S(t){if(!this.#u)return;this.#A({highlightOutlines:this.#c.getNewOutline(t/2)}),this.fixAndSetPosition();const[e,i]=this.parentDimensions;this.setDims(this.width*e,this.height*i)}#R(){this.#f===null||!this.parent||(this.parent.drawLayer.remove(this.#f),this.#f=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#b(t=this.parent){this.#f===null&&({id:this.#f,clipPathId:this.#n}=t.drawLayer.draw({bbox:this.#c.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#g},rootClass:{highlight:!0,free:this.#u},path:{d:this.#c.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},this.#u),this.#o&&(this.#o.style.clipPath=this.#n))}static#T([t,e,i,s],l){switch(l){case 90:return[1-e-s,t,s,i];case 180:return[1-t-i,1-e-s,i,s];case 270:return[e,1-t-i,s,i]}return[t,e,i,s]}rotate(t){const{drawLayer:e}=this.parent;let i;this.#u?(t=(t-this.rotation+360)%360,i=Ie.#T(this.#c.box,t)):i=Ie.#T([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#f,{bbox:i,root:{"data-main-rotation":t}}),e.updateProperties(this.#p,{bbox:Ie.#T(this.#r.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#h&&(t.setAttribute("aria-label",this.#h),t.setAttribute("role","mark")),this.#u?t.classList.add("free"):this.div.addEventListener("keydown",this.#N.bind(this),{signal:this._uiManager._signal});const e=this.#o=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#n;const[i,s]=this.parentDimensions;return this.setDims(this.width*i,this.height*s),cy(this,this.#o,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#N(t){Ie._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#C(!0);break;case 1:case 3:this.#C(!1);break}}#C(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#a,this.#l)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#u||this.#C(!1))}get _mustFixPosition(){return!this.#u}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#f,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#D(){return this.#u?this.rotation:0}#k(){if(this.#u)return null;const[t,e]=this.pageDimensions,[i,s]=this.pageTranslation,l=this.#i,o=new Float32Array(l.length*8);let u=0;for(const{x:f,y:d,width:p,height:m}of l){const v=f*t+i,_=(1-d)*e+s;o[u]=o[u+4]=v,o[u+1]=o[u+3]=_,o[u+2]=o[u+6]=v+p*t,o[u+5]=o[u+7]=_-m*e,u+=8}return o}#L(t){return this.#c.serialize(t,this.#D())}static startHighlighting(t,e,{target:i,x:s,y:l}){const{x:o,y:u,width:f,height:d}=i.getBoundingClientRect(),p=new AbortController,m=t.combinedSignal(p),v=_=>{p.abort(),this.#P(t,_)};window.addEventListener("blur",v,{signal:m}),window.addEventListener("pointerup",v,{signal:m}),window.addEventListener("pointerdown",Xe,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",wn,{signal:m}),i.addEventListener("pointermove",this.#F.bind(this,t),{signal:m}),this._freeHighlight=new pd({x:s,y:l},[o,u,f,d],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#F(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#P(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,i){let s=null;if(t instanceof Ny){const{data:{quadPoints:A,rect:y,rotation:E,id:T,color:b,opacity:w,popupRef:O,contentsObj:F},parent:{page:{pageNumber:z}}}=t;s=t={annotationType:Xt.HIGHLIGHT,color:Array.from(b),opacity:w,quadPoints:A,boxes:null,pageIndex:z-1,rect:y.slice(0),rotation:E,annotationElementId:T,id:T,deleted:!1,popupRef:O,comment:F?.str||null}}else if(t instanceof Qd){const{data:{inkLists:A,rect:y,rotation:E,id:T,color:b,borderStyle:{rawWidth:w},popupRef:O,contentsObj:F},parent:{page:{pageNumber:z}}}=t;s=t={annotationType:Xt.HIGHLIGHT,color:Array.from(b),thickness:w,inkLists:A,boxes:null,pageIndex:z-1,rect:y.slice(0),rotation:E,annotationElementId:T,id:T,deleted:!1,popupRef:O,comment:F?.str||null}}const{color:l,quadPoints:o,inkLists:u,opacity:f}=t,d=await super.deserialize(t,e,i);d.color=kt.makeHexColor(...l),d.#g=f||1,u&&(d.#m=t.thickness),d._initialData=s,t.comment&&d.setCommentData(t.comment);const[p,m]=d.pageDimensions,[v,_]=d.pageTranslation;if(o){const A=d.#i=[];for(let y=0;y<o.length;y+=8)A.push({x:(o[y]-v)/p,y:1-(o[y+1]-_)/m,width:(o[y+2]-o[y])/p,height:(o[y+1]-o[y+5])/m});d.#v(),d.#b(),d.rotate(d.rotation)}else if(u){d.#u=!0;const A=u[0],y={x:A[0]-v,y:m-(A[1]-_)},E=new pd(y,[0,0,p,m],1,d.#m/2,!0,.001);for(let w=0,O=A.length;w<O;w+=2)y.x=A[w]-v,y.y=m-(A[w+1]-_),E.add(y);const{id:T,clipPathId:b}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:E.toSVGPath()}},!0,!0);d.#A({highlightOutlines:E.getOutlines(),highlightId:T,clipPathId:b}),d.#b(),d.rotate(d.parentRotation)}return d}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=this.getPDFRect(),i=Ut._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s={annotationType:Xt.HIGHLIGHT,color:i,opacity:this.#g,thickness:this.#m,quadPoints:this.#k(),outlines:this.#L(e),pageIndex:this.pageIndex,rect:e,rotation:this.#D(),structTreeParentId:this._structTreeParentId};return this.addComment(s),this.annotationElementId&&!this.#M(s)?null:(s.id=this.annotationElementId,s)}#M(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((i,s)=>i!==e[s])}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const e={rect:this.getPDFRect()};return this.hasEditedComment&&(e.popup=this.comment),t.updateEdited(e),null}static canCreateNewEmptyEditor(){return!1}}class ky{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,i]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,i)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Ae("Not implemented")}}class Gt extends Ut{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#i=null;static#n=null;static#s=null;static#r=NaN;static#a=null;static#l=null;static#o=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(this.#c(t),this.#d())}#c({drawOutlines:t,drawId:e,drawingOptions:i}){this.#t=t,this._drawingOptions||=i,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#f(t,this.parent),this.#h(t.box)}#f(t,e){const{id:i}=e.drawLayer.draw(Gt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i}static _mergeSVGProperties(t,e){const i=new Set(Object.keys(t));for(const[s,l]of Object.entries(e))i.has(s)?Object.assign(t[s],l):t[s]=l;return t}static getDefaultDrawingOptions(t){Ae("Not implemented")}static get typesMap(){Ae("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,e),this._currentParent&&(Gt.#i.updateProperty(i,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[i,s]of this.typesMap)t.push([i,e[s]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[i,s]of this.constructor.typesMap)t.push([i,e[s]]);return t}_updateProperty(t,e,i){const s=this._drawingOptions,l=s[e],o=u=>{s.updateProperty(e,u);const f=this.#t.updateProperty(e,u);f&&this.#h(f),this.parent?.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),t===this.colorType&&this._colorPicker?.update(u)};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Gt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#p()),{bbox:this.#m()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Gt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#p()),{bbox:this.#m()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#m()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Gt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#m()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#u(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#d(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#u()):t&&(this._uiManager.addShouldRescale(this),this.#d(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#u(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#d(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#f(this.#t,t)}}#g([t,e,i,s]){const{parentDimensions:[l,o],rotation:u}=this;switch(u){case 90:return[e,1-t,i*(o/l),s*(l/o)];case 180:return[1-t,1-e,i,s];case 270:return[1-e,t,i*(o/l),s*(l/o)];default:return[t,e,i,s]}}#p(){const{x:t,y:e,width:i,height:s,parentDimensions:[l,o],rotation:u}=this;switch(u){case 90:return[1-e,t,i*(l/o),s*(o/l)];case 180:return[1-t,1-e,i,s];case 270:return[e,1-t,i*(l/o),s*(o/l)];default:return[t,e,i,s]}}#h(t){if([this.x,this.y,this.width,this.height]=this.#g(t),this.div){this.fixAndSetPosition();const[e,i]=this.parentDimensions;this.setDims(this.width*e,this.height*i)}this._onResized()}#m(){const{x:t,y:e,width:i,height:s,rotation:l,parentRotation:o,parentDimensions:[u,f]}=this;switch((l*4+o)/90){case 1:return[1-e-s,t,s,i];case 2:return[1-t-i,1-e-s,i,s];case 3:return[e,1-t-i,s,i];case 4:return[t,e-i*(u/f),s*(f/u),i*(u/f)];case 5:return[1-e,t,i*(u/f),s*(f/u)];case 6:return[1-t-s*(f/u),1-e,s*(f/u),i*(u/f)];case 7:return[e-i*(u/f),1-t-s*(f/u),i*(u/f),s*(f/u)];case 8:return[t-i,e-s,i,s];case 9:return[1-e,t-i,s,i];case 10:return[1-t,1-e,i,s];case 11:return[e-s,1-t,s,i];case 12:return[t-s*(f/u),e,s*(f/u),i*(u/f)];case 13:return[1-e-i*(u/f),t-s*(f/u),i*(u/f),s*(f/u)];case 14:return[1-t,1-e-i*(u/f),s*(f/u),i*(u/f)];case 15:return[e,1-t,i*(u/f),s*(f/u)];default:return[t,e,i,s]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Gt._mergeSVGProperties({bbox:this.#m()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const i=super.render();i.classList.add("draw");const s=document.createElement("div");i.append(s),s.setAttribute("aria-hidden","true"),s.className="internal";const[l,o]=this.parentDimensions;return this.setDims(this.width*l,this.height*o),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),i}static createDrawerInstance(t,e,i,s,l){Ae("Not implemented")}static startDrawing(t,e,i,s){const{target:l,offsetX:o,offsetY:u,pointerId:f,pointerType:d}=s;if(Gt.#a&&Gt.#a!==d)return;const{viewport:{rotation:p}}=t,{width:m,height:v}=l.getBoundingClientRect(),_=Gt.#n=new AbortController,A=t.combinedSignal(_);if(Gt.#r||=f,Gt.#a??=d,window.addEventListener("pointerup",y=>{Gt.#r===y.pointerId?this._endDraw(y):Gt.#l?.delete(y.pointerId)},{signal:A}),window.addEventListener("pointercancel",y=>{Gt.#r===y.pointerId?this._currentParent.endDrawingSession():Gt.#l?.delete(y.pointerId)},{signal:A}),window.addEventListener("pointerdown",y=>{Gt.#a===y.pointerType&&((Gt.#l||=new Set).add(y.pointerId),Gt.#i.isCancellable()&&(Gt.#i.removeLastElement(),Gt.#i.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:A}),window.addEventListener("contextmenu",wn,{signal:A}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:A}),l.addEventListener("touchmove",y=>{y.timeStamp===Gt.#o&&Xe(y)},{signal:A}),t.toggleDrawing(),e._editorUndoBar?.hide(),Gt.#i){t.drawLayer.updateProperties(this._currentDrawId,Gt.#i.startNew(o,u,m,v,p));return}e.updateUIForDefaultProperties(this),Gt.#i=this.createDrawerInstance(o,u,m,v,p),Gt.#s=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Gt.#s.toSVGProperties(),Gt.#i.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Gt.#o=-1,!Gt.#i)return;const{offsetX:e,offsetY:i,pointerId:s}=t;if(Gt.#r===s){if(Gt.#l?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Gt.#i.add(e,i)),Gt.#o=t.timeStamp,Xe(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Gt.#i=null,Gt.#s=null,Gt.#a=null,Gt.#o=NaN),Gt.#n&&(Gt.#n.abort(),Gt.#n=null,Gt.#r=NaN,Gt.#l=null)}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,Gt.#i.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=Gt.#i,s=this._currentDrawId,l=i.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(s,i.setLastElement(l))},undo:()=>{e.drawLayer.updateProperties(s,i.removeLastElement())},mustExec:!1,type:ie.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(ie.DRAW_STEP),!Gt.#i.isEmpty()){const{pageDimensions:[i,s],scale:l}=e,o=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Gt.#i.getOutlines(i*l,s*l,l,this._INNER_MARGIN),drawingOptions:Gt.#s,mustBeCommitted:!t});return this._cleanup(!0),o}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,i,s,l,o){Ae("Not implemented")}static async deserialize(t,e,i){const{rawDims:{pageWidth:s,pageHeight:l,pageX:o,pageY:u}}=e.viewport,f=this.deserializeDraw(o,u,s,l,this._INNER_MARGIN,t),d=await super.deserialize(t,e,i);return d.createDrawingOptions(t),d.#c({drawOutlines:f}),d.#d(),d.onScaleChanging(),d.rotate(),d}serializeDraw(t){const[e,i]=this.pageTranslation,[s,l]=this.pageDimensions;return this.#t.serialize([e,i,s,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class ZD{#t=new Float64Array(6);#e;#i;#n;#s;#r;#a="";#l=0;#o=new Vo;#c;#f;constructor(t,e,i,s,l,o){this.#c=i,this.#f=s,this.#n=l,this.#s=o,[t,e]=this.#u(t,e);const u=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e],this.#i=[{line:u,points:this.#r}],this.#t.set(u,0)}updateProperty(t,e){t==="stroke-width"&&(this.#s=e)}#u(t,e){return Lt._normalizePoint(t,e,this.#c,this.#f,this.#n)}isEmpty(){return!this.#i||this.#i.length===0}isCancellable(){return this.#r.length<=10}add(t,e){[t,e]=this.#u(t,e);const[i,s,l,o]=this.#t.subarray(2,6),u=t-l,f=e-o;return Math.hypot(this.#c*u,this.#f*f)<=2?null:(this.#r.push(t,e),isNaN(i)?(this.#t.set([l,o,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([i,s,l,o,t,e],0),this.#e.push(...Lt.createBezierPoints(i,s,l,o,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const i=this.add(t,e);return i||(this.#r.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,i,s,l){this.#c=i,this.#f=s,this.#n=l,[t,e]=this.#u(t,e);const o=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e];const u=this.#i.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#i.push({line:o,points:this.#r}),this.#t.set(o,0),this.#l=0,this.toSVGPath(),null}getLastElement(){return this.#i.at(-1)}setLastElement(t){return this.#i?(this.#i.push(t),this.#e=t.line,this.#r=t.points,this.#l=0,{path:{d:this.toSVGPath()}}):this.#o.setLastElement(t)}removeLastElement(){if(!this.#i)return this.#o.removeLastElement();this.#i.pop(),this.#a="";for(let t=0,e=this.#i.length;t<e;t++){const{line:i,points:s}=this.#i[t];this.#e=i,this.#r=s,this.#l=0,this.toSVGPath()}return{path:{d:this.#a}}}toSVGPath(){const t=Lt.svgRound(this.#e[4]),e=Lt.svgRound(this.#e[5]);if(this.#r.length===2)return this.#a=`${this.#a} M ${t} ${e} Z`,this.#a;if(this.#r.length<=6){const s=this.#a.lastIndexOf("M");this.#a=`${this.#a.slice(0,s)} M ${t} ${e}`,this.#l=6}if(this.#r.length===4){const s=Lt.svgRound(this.#e[10]),l=Lt.svgRound(this.#e[11]);return this.#a=`${this.#a} L ${s} ${l}`,this.#l=12,this.#a}const i=[];this.#l===0&&(i.push(`M ${t} ${e}`),this.#l=6);for(let s=this.#l,l=this.#e.length;s<l;s+=6){const[o,u,f,d,p,m]=this.#e.slice(s,s+6).map(Lt.svgRound);i.push(`C${o} ${u} ${f} ${d} ${p} ${m}`)}return this.#a+=i.join(" "),this.#l=this.#e.length,this.#a}getOutlines(t,e,i,s){const l=this.#i.at(-1);return l.line=new Float32Array(l.line),l.points=new Float32Array(l.points),this.#o.build(this.#i,t,e,i,this.#n,this.#s,s),this.#t=null,this.#e=null,this.#i=null,this.#a=null,this.#o}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Vo extends Lt{#t;#e=0;#i;#n;#s;#r;#a;#l;#o;build(t,e,i,s,l,o,u){this.#s=e,this.#r=i,this.#a=s,this.#l=l,this.#o=o,this.#i=u??0,this.#n=t,this.#u()}get thickness(){return this.#o}setLastElement(t){return this.#n.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#n){if(t.push(`M${Lt.svgRound(e[4])} ${Lt.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${Lt.svgRound(e[10])} ${Lt.svgRound(e[11])}`);continue}for(let i=6,s=e.length;i<s;i+=6){const[l,o,u,f,d,p]=e.subarray(i,i+6).map(Lt.svgRound);t.push(`C${l} ${o} ${u} ${f} ${d} ${p}`)}}return t.join("")}serialize([t,e,i,s],l){const o=[],u=[],[f,d,p,m]=this.#f();let v,_,A,y,E,T,b,w,O;switch(this.#l){case 0:O=Lt._rescale,v=t,_=e+s,A=i,y=-s,E=t+f*i,T=e+(1-d-m)*s,b=t+(f+p)*i,w=e+(1-d)*s;break;case 90:O=Lt._rescaleAndSwap,v=t,_=e,A=i,y=s,E=t+d*i,T=e+f*s,b=t+(d+m)*i,w=e+(f+p)*s;break;case 180:O=Lt._rescale,v=t+i,_=e,A=-i,y=s,E=t+(1-f-p)*i,T=e+d*s,b=t+(1-f)*i,w=e+(d+m)*s;break;case 270:O=Lt._rescaleAndSwap,v=t+i,_=e+s,A=-i,y=-s,E=t+(1-d-m)*i,T=e+(1-f-p)*s,b=t+(1-d)*i,w=e+(1-f)*s;break}for(const{line:F,points:z}of this.#n)o.push(O(F,v,_,A,y,l?new Array(F.length):null)),u.push(O(z,v,_,A,y,l?new Array(z.length):null));return{lines:o,points:u,rect:[E,T,b,w]}}static deserialize(t,e,i,s,l,{paths:{lines:o,points:u},rotation:f,thickness:d}){const p=[];let m,v,_,A,y;switch(f){case 0:y=Lt._rescale,m=-t/i,v=e/s+1,_=1/i,A=-1/s;break;case 90:y=Lt._rescaleAndSwap,m=-e/s,v=-t/i,_=1/s,A=1/i;break;case 180:y=Lt._rescale,m=t/i+1,v=-e/s,_=-1/i,A=1/s;break;case 270:y=Lt._rescaleAndSwap,m=e/s+1,v=t/i+1,_=-1/s,A=-1/i;break}if(!o){o=[];for(const T of u){const b=T.length;if(b===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,T[0],T[1]]));continue}if(b===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,T[0],T[1],NaN,NaN,NaN,NaN,T[2],T[3]]));continue}const w=new Float32Array(3*(b-2));o.push(w);let[O,F,z,L]=T.subarray(0,4);w.set([NaN,NaN,NaN,NaN,O,F],0);for(let G=4;G<b;G+=2){const V=T[G],Q=T[G+1];w.set(Lt.createBezierPoints(O,F,z,L,V,Q),(G-2)*3),[O,F,z,L]=[z,L,V,Q]}}}for(let T=0,b=o.length;T<b;T++)p.push({line:y(o[T].map(w=>w??NaN),m,v,_,A),points:y(u[T].map(w=>w??NaN),m,v,_,A)});const E=new this.prototype.constructor;return E.build(p,i,s,1,f,d,l),E}#c(t=this.#o){const e=this.#i+t/2*this.#a;return this.#l%180===0?[e/this.#s,e/this.#r]:[e/this.#r,e/this.#s]}#f(){const[t,e,i,s]=this.#t,[l,o]=this.#c(0);return[t+l,e+o,i-2*l,s-2*o]}#u(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:s}of this.#n){if(s.length<=12){for(let u=4,f=s.length;u<f;u+=6)kt.pointBoundingBox(s[u],s[u+1],t);continue}let l=s[4],o=s[5];for(let u=6,f=s.length;u<f;u+=6){const[d,p,m,v,_,A]=s.subarray(u,u+6);kt.bezierBoundingBox(l,o,d,p,m,v,_,A,t),l=_,o=A}}const[e,i]=this.#c();t[0]=Oi(t[0]-e,0,1),t[1]=Oi(t[1]-i,0,1),t[2]=Oi(t[2]+e,0,1),t[3]=Oi(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#d(e):null}#d(t){const[e,i]=this.#c();this.#o=t;const[s,l]=this.#c(),[o,u]=[s-e,l-i],f=this.#t;return f[0]-=o,f[1]-=u,f[2]+=2*o,f[3]+=2*u,f}updateParentDimensions([t,e],i){const[s,l]=this.#c();this.#s=t,this.#r=e,this.#a=i;const[o,u]=this.#c(),f=o-s,d=u-l,p=this.#t;return p[0]-=f,p[1]-=d,p[2]+=2*f,p[3]+=2*d,p}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(Lt.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Lt.svgRound(t)} ${Lt.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let i=0,s=0,l=0,o=0,u=0,f=0;switch(this.#e){case 90:s=e/t,l=-t/e,u=t;break;case 180:i=-1,o=-1,u=t,f=e;break;case 270:s=-e/t,l=t/e,f=e;break;default:return""}return`matrix(${i} ${s} ${l} ${o} ${Lt.svgRound(u)} ${Lt.svgRound(f)})`}getPathResizingSVGProperties([t,e,i,s]){const[l,o]=this.#c(),[u,f,d,p]=this.#t;if(Math.abs(d-l)<=Lt.PRECISION||Math.abs(p-o)<=Lt.PRECISION){const y=t+i/2-(u+d/2),E=e+s/2-(f+p/2);return{path:{"transform-origin":`${Lt.svgRound(t)} ${Lt.svgRound(e)}`,transform:`${this.rotationTransform} translate(${y} ${E})`}}}const m=(i-2*l)/(d-2*l),v=(s-2*o)/(p-2*o),_=d/i,A=p/s;return{path:{"transform-origin":`${Lt.svgRound(u)} ${Lt.svgRound(f)}`,transform:`${this.rotationTransform} scale(${_} ${A}) translate(${Lt.svgRound(l)} ${Lt.svgRound(o)}) scale(${m} ${v}) translate(${Lt.svgRound(-l)} ${Lt.svgRound(-o)})`}}}getPathResizedSVGProperties([t,e,i,s]){const[l,o]=this.#c(),u=this.#t,[f,d,p,m]=u;if(u[0]=t,u[1]=e,u[2]=i,u[3]=s,Math.abs(p-l)<=Lt.PRECISION||Math.abs(m-o)<=Lt.PRECISION){const E=t+i/2-(f+p/2),T=e+s/2-(d+m/2);for(const{line:b,points:w}of this.#n)Lt._translate(b,E,T,b),Lt._translate(w,E,T,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Lt.svgRound(t)} ${Lt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const v=(i-2*l)/(p-2*l),_=(s-2*o)/(m-2*o),A=-v*(f+l)+t+l,y=-_*(d+o)+e+o;if(v!==1||_!==1||A!==0||y!==0)for(const{line:E,points:T}of this.#n)Lt._rescale(E,A,y,v,_,E),Lt._rescale(T,A,y,v,_,T);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Lt.svgRound(t)} ${Lt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],i){const[s,l]=i,o=this.#t,u=t-o[0],f=e-o[1];if(this.#s===s&&this.#r===l)for(const{line:d,points:p}of this.#n)Lt._translate(d,u,f,d),Lt._translate(p,u,f,p);else{const d=this.#s/s,p=this.#r/l;this.#s=s,this.#r=l;for(const{line:m,points:v}of this.#n)Lt._rescale(m,u,f,d,p,m),Lt._rescale(v,u,f,d,p,v);o[2]*=d,o[3]*=p}return o[0]=t,o[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Lt.svgRound(t)} ${Lt.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Lt.svgRound(t[0])} ${Lt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class sh extends ky{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Ut._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new sh(this._viewParameters);return t.updateAll(this),t}}class Jd extends Gt{static _type="ink";static _editorType=Xt.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){Ut.initialize(t,e),this._defaultDrawingOptions=new sh(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return Zt(this,"typesMap",new Map([[ie.INK_THICKNESS,"stroke-width"],[ie.INK_COLOR,"stroke"],[ie.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,i,s,l){return new ZD(t,e,i,s,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,i,s,l,o){return Vo.deserialize(t,e,i,s,l,o)}static async deserialize(t,e,i){let s=null;if(t instanceof Qd){const{data:{inkLists:o,rect:u,rotation:f,id:d,color:p,opacity:m,borderStyle:{rawWidth:v},popupRef:_,contentsObj:A},parent:{page:{pageNumber:y}}}=t;s=t={annotationType:Xt.INK,color:Array.from(p),thickness:v,opacity:m,paths:{points:o},boxes:null,pageIndex:y-1,rect:u.slice(0),rotation:f,annotationElementId:d,id:d,deleted:!1,popupRef:_,comment:A?.str||null}}const l=await super.deserialize(t,e,i);return l._initialData=s,t.comment&&l.setCommentData(t.comment),l}get toolbarButtons(){return this._colorPicker||=new Mo(this),[["colorPicker",this._colorPicker]]}get colorType(){return ie.INK_COLOR}get colorValue(){return this._drawingOptions.stroke}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:i}=this;e.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:i}){this._drawingOptions=Jd.getDefaultDrawingOptions({stroke:kt.makeHexColor(...t),"stroke-width":e,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:i,rect:s}=this.serializeDraw(t),{_drawingOptions:{stroke:l,"stroke-opacity":o,"stroke-width":u}}=this,f={annotationType:Xt.INK,color:Ut._colorManager.convert(l),opacity:o,thickness:u,paths:{lines:e,points:i},pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(f),t?(f.isCopy=!0,f):this.annotationElementId&&!this.#t(f)?null:(f.id=this.annotationElementId,f)}#t(t){const{color:e,thickness:i,opacity:s,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((o,u)=>o!==e[u])||t.thickness!==i||t.opacity!==s||t.pageIndex!==l}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:i}=this.serializeDraw(!1),s={rect:i,thickness:this._drawingOptions["stroke-width"],points:e};return this.hasEditedComment&&(s.popup=this.comment),t.updateEdited(s),null}}class gd extends Vo{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const Au=8,oo=3;class Ua{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,i,s){return i-=t,s-=e,i===0?s>0?0:4:i===1?s+6:2-s}static#i=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(t,e,i,s,l,o,u){const f=this.#e(i,s,l,o);for(let d=0;d<8;d++){const p=(-d+f-u+16)%8,m=this.#i[2*p],v=this.#i[2*p+1];if(t[(i+m)*e+(s+v)]!==0)return p}return-1}static#s(t,e,i,s,l,o,u){const f=this.#e(i,s,l,o);for(let d=0;d<8;d++){const p=(d+f+u+16)%8,m=this.#i[2*p],v=this.#i[2*p+1];if(t[(i+m)*e+(s+v)]!==0)return p}return-1}static#r(t,e,i,s){const l=t.length,o=new Int32Array(l);for(let p=0;p<l;p++)o[p]=t[p]<=s?1:0;for(let p=1;p<i-1;p++)o[p*e]=o[p*e+e-1]=0;for(let p=0;p<e;p++)o[p]=o[e*i-1-p]=0;let u=1,f;const d=[];for(let p=1;p<i-1;p++){f=1;for(let m=1;m<e-1;m++){const v=p*e+m,_=o[v];if(_===0)continue;let A=p,y=m;if(_===1&&o[v-1]===0)u+=1,y-=1;else if(_>=1&&o[v+1]===0)u+=1,y+=1,_>1&&(f=_);else{_!==1&&(f=Math.abs(_));continue}const E=[m,p],T=y===m+1,b={isHole:T,points:E,id:u,parent:0};d.push(b);let w;for(const K of d)if(K.id===f){w=K;break}w?w.isHole?b.parent=T?w.parent:f:b.parent=T?f:w.parent:b.parent=T?f:0;const O=this.#n(o,e,p,m,A,y,0);if(O===-1){o[v]=-u,o[v]!==1&&(f=Math.abs(o[v]));continue}let F=this.#i[2*O],z=this.#i[2*O+1];const L=p+F,G=m+z;A=L,y=G;let V=p,Q=m;for(;;){const K=this.#s(o,e,V,Q,A,y,1);F=this.#i[2*K],z=this.#i[2*K+1];const ut=V+F,ht=Q+z;E.push(ht,ut);const bt=V*e+Q;if(o[bt+1]===0?o[bt]=-u:o[bt]===1&&(o[bt]=u),ut===p&&ht===m&&V===L&&Q===G){o[v]!==1&&(f=Math.abs(o[v]));break}else A=V,y=Q,V=ut,Q=ht}}}return d}static#a(t,e,i,s){if(i-e<=4){for(let L=e;L<i-2;L+=2)s.push(t[L],t[L+1]);return}const l=t[e],o=t[e+1],u=t[i-4]-l,f=t[i-3]-o,d=Math.hypot(u,f),p=u/d,m=f/d,v=p*o-m*l,_=f/u,A=1/d,y=Math.atan(_),E=Math.cos(y),T=Math.sin(y),b=A*(Math.abs(E)+Math.abs(T)),w=A*(1-b+b**2),O=Math.max(Math.atan(Math.abs(T+E)*w),Math.atan(Math.abs(T-E)*w));let F=0,z=e;for(let L=e+2;L<i-2;L+=2){const G=Math.abs(v-p*t[L+1]+m*t[L]);G>F&&(z=L,F=G)}F>(d*O)**2?(this.#a(t,e,z+2,s),this.#a(t,z,i,s)):s.push(l,o)}static#l(t){const e=[],i=t.length;return this.#a(t,0,i,e),e.push(t[i-2],t[i-1]),e.length<=4?null:e}static#o(t,e,i,s,l,o){const u=new Float32Array(o**2),f=-2*s**2,d=o>>1;for(let y=0;y<o;y++){const E=(y-d)**2;for(let T=0;T<o;T++)u[y*o+T]=Math.exp((E+(T-d)**2)/f)}const p=new Float32Array(256),m=-2*l**2;for(let y=0;y<256;y++)p[y]=Math.exp(y**2/m);const v=t.length,_=new Uint8Array(v),A=new Uint32Array(256);for(let y=0;y<i;y++)for(let E=0;E<e;E++){const T=y*e+E,b=t[T];let w=0,O=0;for(let z=0;z<o;z++){const L=y+z-d;if(!(L<0||L>=i))for(let G=0;G<o;G++){const V=E+G-d;if(V<0||V>=e)continue;const Q=t[L*e+V],K=u[z*o+G]*p[Math.abs(Q-b)];w+=Q*K,O+=K}}const F=_[T]=Math.round(w/O);A[F]++}return[_,A]}static#c(t){const e=new Uint32Array(256);for(const i of t)e[i]++;return e}static#f(t){const e=t.length,i=new Uint8ClampedArray(e>>2);let s=-1/0,l=1/0;for(let u=0,f=i.length;u<f;u++){const d=i[u]=t[u<<2];s=Math.max(s,d),l=Math.min(l,d)}const o=255/(s-l);for(let u=0,f=i.length;u<f;u++)i[u]=(i[u]-l)*o;return i}static#u(t){let e,i=-1/0,s=-1/0;const l=t.findIndex(f=>f!==0);let o=l,u=l;for(e=l;e<256;e++){const f=t[e];f>i&&(e-o>s&&(s=e-o,u=e-1),i=f,o=e)}for(e=u-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#d(t){const e=t,{width:i,height:s}=t,{maxDim:l}=this.#t;let o=i,u=s;if(i>l||s>l){let v=i,_=s,A=Math.log2(Math.max(i,s)/l);const y=Math.floor(A);A=A===y?y-1:y;for(let T=0;T<A;T++){o=Math.ceil(v/2),u=Math.ceil(_/2);const b=new OffscreenCanvas(o,u);b.getContext("2d").drawImage(t,0,0,v,_,0,0,o,u),v=o,_=u,t!==e&&t.close(),t=b.transferToImageBitmap()}const E=Math.min(l/o,l/u);o=Math.round(o*E),u=Math.round(u*E)}const d=new OffscreenCanvas(o,u).getContext("2d",{willReadFrequently:!0});d.fillStyle="white",d.fillRect(0,0,o,u),d.filter="grayscale(1)",d.drawImage(t,0,0,t.width,t.height,0,0,o,u);const p=d.getImageData(0,0,o,u).data;return[this.#f(p),o,u]}static extractContoursFromText(t,{fontFamily:e,fontStyle:i,fontWeight:s},l,o,u,f){let d=new OffscreenCanvas(1,1),p=d.getContext("2d",{alpha:!1});const m=200,v=p.font=`${i} ${s} ${m}px ${e}`,{actualBoundingBoxLeft:_,actualBoundingBoxRight:A,actualBoundingBoxAscent:y,actualBoundingBoxDescent:E,fontBoundingBoxAscent:T,fontBoundingBoxDescent:b,width:w}=p.measureText(t),O=1.5,F=Math.ceil(Math.max(Math.abs(_)+Math.abs(A)||0,w)*O),z=Math.ceil(Math.max(Math.abs(y)+Math.abs(E)||m,Math.abs(T)+Math.abs(b)||m)*O);d=new OffscreenCanvas(F,z),p=d.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=v,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,F,z),p.fillStyle="black",p.fillText(t,F*(O-1)/2,z*(3-O)/2);const L=this.#f(p.getImageData(0,0,F,z).data),G=this.#c(L),V=this.#u(G),Q=this.#r(L,F,z,V);return this.processDrawnLines({lines:{curves:Q,width:F,height:z},pageWidth:l,pageHeight:o,rotation:u,innerMargin:f,mustSmooth:!0,areContours:!0})}static process(t,e,i,s,l){const[o,u,f]=this.#d(t),[d,p]=this.#o(o,u,f,Math.hypot(u,f)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),m=this.#u(p),v=this.#r(d,u,f,m);return this.processDrawnLines({lines:{curves:v,width:u,height:f},pageWidth:e,pageHeight:i,rotation:s,innerMargin:l,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:s,innerMargin:l,mustSmooth:o,areContours:u}){s%180!==0&&([e,i]=[i,e]);const{curves:f,width:d,height:p}=t,m=t.thickness??0,v=[],_=Math.min(e/d,i/p),A=_/e,y=_/i,E=[];for(const{points:b}of f){const w=o?this.#l(b):b;if(!w)continue;E.push(w);const O=w.length,F=new Float32Array(O),z=new Float32Array(3*(O===2?2:O-2));if(v.push({line:z,points:F}),O===2){F[0]=w[0]*A,F[1]=w[1]*y,z.set([NaN,NaN,NaN,NaN,F[0],F[1]],0);continue}let[L,G,V,Q]=w;L*=A,G*=y,V*=A,Q*=y,F.set([L,G,V,Q],0),z.set([NaN,NaN,NaN,NaN,L,G],0);for(let K=4;K<O;K+=2){const ut=F[K]=w[K]*A,ht=F[K+1]=w[K+1]*y;z.set(Lt.createBezierPoints(L,G,V,Q,ut,ht),(K-2)*3),[L,G,V,Q]=[V,Q,ut,ht]}}if(v.length===0)return null;const T=u?new gd:new Vo;return T.build(v,e,i,1,s,u?0:m,l),{outline:T,newCurves:E,areContours:u,thickness:m,width:d,height:p}}static async compressSignature({outlines:t,areContours:e,thickness:i,width:s,height:l}){let o=1/0,u=-1/0,f=0;for(const w of t){f+=w.length;for(let O=2,F=w.length;O<F;O++){const z=w[O]-w[O-2];o=Math.min(o,z),u=Math.max(u,z)}}let d;o>=-128&&u<=127?d=Int8Array:o>=-32768&&u<=32767?d=Int16Array:d=Int32Array;const p=t.length,m=Au+oo*p,v=new Uint32Array(m);let _=0;v[_++]=m*Uint32Array.BYTES_PER_ELEMENT+(f-2*p)*d.BYTES_PER_ELEMENT,v[_++]=0,v[_++]=s,v[_++]=l,v[_++]=e?0:1,v[_++]=Math.max(0,Math.floor(i??0)),v[_++]=p,v[_++]=d.BYTES_PER_ELEMENT;for(const w of t)v[_++]=w.length-2,v[_++]=w[0],v[_++]=w[1];const A=new CompressionStream("deflate-raw"),y=A.writable.getWriter();await y.ready,y.write(v);const E=d.prototype.constructor;for(const w of t){const O=new E(w.length-2);for(let F=2,z=w.length;F<z;F++)O[F-2]=w[F]-w[F-2];y.write(O)}y.close();const T=await new Response(A.readable).arrayBuffer(),b=new Uint8Array(T);return oy(b)}static async decompressSignature(t){try{const e=y3(t),{readable:i,writable:s}=new DecompressionStream("deflate-raw"),l=s.getWriter();await l.ready,l.write(e).then(async()=>{await l.ready,await l.close()}).catch(()=>{});let o=null,u=0;for await(const w of i)o||=new Uint8Array(new Uint32Array(w.buffer,0,4)[0]),o.set(w,u),u+=w.length;const f=new Uint32Array(o.buffer,0,o.length>>2),d=f[1];if(d!==0)throw new Error(`Invalid version: ${d}`);const p=f[2],m=f[3],v=f[4]===0,_=f[5],A=f[6],y=f[7],E=[],T=(Au+oo*A)*Uint32Array.BYTES_PER_ELEMENT;let b;switch(y){case Int8Array.BYTES_PER_ELEMENT:b=new Int8Array(o.buffer,T);break;case Int16Array.BYTES_PER_ELEMENT:b=new Int16Array(o.buffer,T);break;case Int32Array.BYTES_PER_ELEMENT:b=new Int32Array(o.buffer,T);break}u=0;for(let w=0;w<A;w++){const O=f[oo*w+Au],F=new Float32Array(O+2);E.push(F);for(let z=0;z<oo-1;z++)F[z]=f[oo*w+Au+z+1];for(let z=0;z<O;z++)F[z+2]=F[z]+b[u++]}return{areContours:v,thickness:_,outlines:E,width:p,height:m}}catch(e){return qt(`decompressSignature: ${e}`),null}}}class tp extends ky{constructor(){super(),super.updateProperties({fill:Ut._defaultLineColor,"stroke-width":0})}clone(){const t=new tp;return t.updateAll(this),t}}class ep extends sh{constructor(t){super(t),super.updateProperties({stroke:Ut._defaultLineColor,"stroke-width":1})}clone(){const t=new ep(this._viewParameters);return t.updateAll(this),t}}class Jn extends Gt{#t=!1;#e=null;#i=null;#n=null;static _type="signature";static _editorType=Xt.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#i=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){Ut.initialize(t,e),this._defaultDrawingOptions=new tp,this._defaultDrawnSignatureOptions=new ep(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return Zt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#i){const{lines:s,mustSmooth:l,areContours:o,description:u,uuid:f,heightInPage:d}=this.#i,{rawDims:{pageWidth:p,pageHeight:m},rotation:v}=this.parent.viewport,_=Ua.processDrawnLines({lines:s,pageWidth:p,pageHeight:m,rotation:v,innerMargin:Jn._INNER_MARGIN,mustSmooth:l,areContours:o});this.addSignature(_,d,u,f)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#n=t,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:i,width:s,height:l}=this.#i,o=Math.max(s,l),u=Ua.processDrawnLines({lines:{curves:t.map(f=>({points:f})),thickness:i,width:s,height:l},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,i,s){const{x:l,y:o}=this,{outline:u}=this.#i=t;this.#t=u instanceof gd,this.description=i;let f;this.#t?f=Jn.getDefaultDrawingOptions():(f=Jn._defaultDrawnSignatureOptions.clone(),f.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:f});const[d,p]=this.parentDimensions,[,m]=this.pageDimensions;let v=e/m;v=v>=1?.5:v,this.width*=v/this.height,this.width>=1&&(v*=.9/this.width,this.width=.9),this.height=v,this.setDims(d*this.width,p*this.height),this.x=l,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:s}=this.parent.viewport;return Ua.process(t,e,i,s,Jn._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:i,pageHeight:s},rotation:l}=this.parent.viewport;return Ua.extractContoursFromText(t,e,i,s,l,Jn._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:s}=this.parent.viewport;return Ua.processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:s,innerMargin:Jn._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=Jn.getDefaultDrawingOptions():(this._drawingOptions=Jn._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:i,rect:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":l}}=this,o={annotationType:Xt.SIGNATURE,isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:l,pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(o),t?(o.paths={lines:e,points:i},o.uuid=this.#n,o.isCopy=!0):o.lines=e,this.#e&&(o.accessibilityData={type:"Figure",alt:this.#e}),o}static deserializeDraw(t,e,i,s,l,o){return o.areContours?gd.deserialize(t,e,i,s,l,o):Vo.deserialize(t,e,i,s,l,o)}static async deserialize(t,e,i){const s=await super.deserialize(t,e,i);return s.#t=t.areContours,s.description=t.accessibilityData?.alt||"",s.#n=t.uuid,s}}class JD extends Ut{#t=null;#e=null;#i=null;#n=null;#s=null;#r="";#a=null;#l=!1;#o=null;#c=!1;#f=!1;static _type="stamp";static _editorType=Xt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#n=t.bitmapUrl,this.#s=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){Ut.initialize(t,e)}static isHandlingMimeForPasting(t){return od.includes(t)}static paste(t,e){e.pasteEditor({mode:Xt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#u(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#c=t.isSvg),t.file&&(this.#r=t.file.name),this.#p()}#d(){if(this.#i=null,this._uiManager.enableWaiting(!1),!!this.#a){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:l,height:o}=t||this.copyCanvas(null,null,!0).imageData,u=await i.guess({name:"altText",request:{data:s,width:l,height:o,channels:s.length/(l*o)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const f=u.output;return await this.setGuessedAltText(f),e&&!this.hasAltTextData()&&(this.altTextData={alt:f,decorative:!1}),f}#g(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(i=>this.#u(i,!0)).finally(()=>this.#d());return}if(this.#n){const i=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(i).then(s=>this.#u(s)).finally(()=>this.#d());return}if(this.#s){const i=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(i).then(s=>this.#u(s)).finally(()=>this.#d());return}const t=document.createElement("input");t.type="file",t.accept=od.join(",");const e=this._uiManager._signal;this.#i=new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#u(s)}i()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:e})}).finally(()=>this.#d()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#a?.remove(),this.#a=null,this.#o&&(clearTimeout(this.#o),this.#o=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#g();return}super.rebuild(),this.div!==null&&(this.#e&&this.#a===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#i||this.#t||this.#n||this.#s||this.#e||this.#l)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#l||(this.#t?this.#p():this.#g()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:i,bitmap:s}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(this.#e=i,s&&(this.#t=s),this.#l=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#o!==null&&clearTimeout(this.#o);const t=200;this.#o=setTimeout(()=>{this.#o=null,this.#m()},t)}#p(){const{div:t}=this;let{width:e,height:i}=this.#t;const[s,l]=this.pageDimensions,o=.75;if(this.width)e=this.width*s,i=this.height*l;else if(e>o*s||i>o*l){const p=Math.min(o*s/e,o*l/i);e*=p,i*=p}const[u,f]=this.parentDimensions;this.setDims(e*u/s,i*f/l),this._uiManager.enableWaiting(!1);const d=this.#a=document.createElement("canvas");d.setAttribute("role","img"),this.addContainer(d),this.width=e/s,this.height=i/l,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#m(),this.#f||(this.parent.addUndoableEditor(this),this.#f=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&this.div.setAttribute("aria-description",this.#r),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,i=!1){t||(t=224);const{width:s,height:l}=this.#t,o=new ir;let u=this.#t,f=s,d=l,p=null;if(e){if(s>e||l>e){const z=Math.min(e/s,e/l);f=Math.floor(s*z),d=Math.floor(l*z)}p=document.createElement("canvas");const v=p.width=Math.ceil(f*o.sx),_=p.height=Math.ceil(d*o.sy);this.#c||(u=this.#h(v,_));const A=p.getContext("2d");A.filter=this._uiManager.hcmFilter;let y="white",E="#cfcfd8";this._uiManager.hcmFilter!=="none"?E="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(y="#8f8f9d",E="#42414d");const T=15,b=T*o.sx,w=T*o.sy,O=new OffscreenCanvas(b*2,w*2),F=O.getContext("2d");F.fillStyle=y,F.fillRect(0,0,b*2,w*2),F.fillStyle=E,F.fillRect(0,0,b,w),F.fillRect(b,w,b,w),A.fillStyle=A.createPattern(O,"repeat"),A.fillRect(0,0,v,_),A.drawImage(u,0,0,u.width,u.height,0,0,v,_)}let m=null;if(i){let v,_;if(o.symmetric&&u.width<t&&u.height<t)v=u.width,_=u.height;else if(u=this.#t,s>t||l>t){const E=Math.min(t/s,t/l);v=Math.floor(s*E),_=Math.floor(l*E),this.#c||(u=this.#h(v,_))}const y=new OffscreenCanvas(v,_).getContext("2d",{willReadFrequently:!0});y.drawImage(u,0,0,u.width,u.height,0,0,v,_),m={width:v,height:_,data:y.getImageData(0,0,v,_).data}}return{canvas:p,width:f,height:d,imageData:m}}#h(t,e){const{width:i,height:s}=this.#t;let l=i,o=s,u=this.#t;for(;l>2*t||o>2*e;){const f=l,d=o;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const p=new OffscreenCanvas(l,o);p.getContext("2d").drawImage(u,0,0,f,d,0,0,l,o),u=p.transferToImageBitmap()}return u}#m(){const[t,e]=this.parentDimensions,{width:i,height:s}=this,l=new ir,o=Math.ceil(i*t*l.sx),u=Math.ceil(s*e*l.sy),f=this.#a;if(!f||f.width===o&&f.height===u)return;f.width=o,f.height=u;const d=this.#c?this.#t:this.#h(o,u),p=f.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(d,0,0,d.width,d.height,0,0,o,u)}#_(t){if(t){if(this.#c){const s=this._uiManager.imageManager.getSvgUrl(this.#e);if(s)return s}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#c){const[e,i]=this.pageDimensions,s=Math.round(this.width*e*Qa.PDF_TO_CSS_UNITS),l=Math.round(this.height*i*Qa.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(s,l);return o.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,s,l),o.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,i){let s=null,l=!1;if(t instanceof Ly){const{data:{rect:y,rotation:E,id:T,structParent:b,popupRef:w,contentsObj:O},container:F,parent:{page:{pageNumber:z}},canvas:L}=t;let G,V;L?(delete t.canvas,{id:G,bitmap:V}=i.imageManager.getFromCanvas(F.id,L),L.remove()):(l=!0,t._hasNoCanvas=!0);const Q=(await e._structTree.getAriaAttributes(`${Hd}${T}`))?.get("aria-label")||"";s=t={annotationType:Xt.STAMP,bitmapId:G,bitmap:V,pageIndex:z-1,rect:y.slice(0),rotation:E,annotationElementId:T,id:T,deleted:!1,accessibilityData:{decorative:!1,altText:Q},isSvg:!1,structParent:b,popupRef:w,comment:O?.str||null}}const o=await super.deserialize(t,e,i),{rect:u,bitmap:f,bitmapUrl:d,bitmapId:p,isSvg:m,accessibilityData:v}=t;l?(i.addMissingCanvas(t.id,o),o.#l=!0):p&&i.imageManager.isValidId(p)?(o.#e=p,f&&(o.#t=f)):o.#n=d,o.#c=m;const[_,A]=o.pageDimensions;return o.width=(u[2]-u[0])/_,o.height=(u[3]-u[1])/A,v&&(o.altTextData=v),o._initialData=s,t.comment&&o.setCommentData(t.comment),o.#f=!!s,o}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:Xt.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(this.addComment(i),t)return i.bitmapUrl=this.#_(!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:s,altText:l}=this.serializeAltText(!1);if(!s&&l&&(i.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const u=this.#v(i);if(u.isSame)return null;u.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,e===null)return i;e.stamps||=new Map;const o=this.#c?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:o,serialized:i}),i.bitmap=this.#_(!1);else if(this.#c){const u=e.stamps.get(this.#e);o>u.area&&(u.area=o,u.serialized.bitmap.close(),u.serialized.bitmap=this.#_(!1))}return i}#v(t){const{pageIndex:e,accessibilityData:{altText:i}}=this._initialData,s=t.pageIndex===e,l=(t.accessibilityData?.alt||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&l,isSameAltText:l}}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const e={rect:this.getPDFRect()};return this.hasEditedComment&&(e.popup=this.comment),t.updateEdited(e),null}}class Ar{#t;#e=!1;#i=null;#n=null;#s=null;#r=new Map;#a=!1;#l=!1;#o=!1;#c=null;#f=null;#u=null;#d=null;#g=null;#p=-1;#h;static _initialized=!1;static#m=new Map([ni,Jd,JD,Ie,Jn].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:i,structTreeLayer:s,accessibilityManager:l,annotationLayer:o,drawLayer:u,textLayer:f,viewport:d,l10n:p}){const m=[...Ar.#m.values()];if(!Ar._initialized){Ar._initialized=!0;for(const v of m)v.initialize(p,t)}t.registerEditorTypes(m),this.#h=t,this.pageIndex=e,this.div=i,this.#t=l,this.#i=o,this.viewport=d,this.#u=f,this.drawLayer=u,this._structTree=s,this.#h.addLayer(this)}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#h.getMode()===Xt.NONE}updateToolbar(t){this.#h.updateToolbar(t)}updateMode(t=this.#h.getMode()){switch(this.#x(),t){case Xt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Xt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Xt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const i of Ar.#m.values())e.toggle(`${i._type}Editing`,t===i._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#u?.div}setEditingState(t){this.#h.setEditingState(t)}addCommands(t){this.#h.addCommands(t)}cleanUndoStack(t){this.#h.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#i?.div.classList.toggle("disabled",!t)}async enable(){this.#o=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.#g?.abort(),this.#g=null;const t=new Set;for(const i of this.#r.values())i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#h.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));if(!this.#i){this.#o=!1;return}const e=this.#i.getEditableAnnotations();for(const i of e){if(i.hide(),this.#h.isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const s=await this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}this.#o=!1}disable(){if(this.#l=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.#u&&!this.#g){this.#g=new AbortController;const s=this.#h.combinedSignal(this.#g);this.#u.div.addEventListener("pointerdown",l=>{const{clientX:u,clientY:f,timeStamp:d}=l,p=this.#p;if(d-p>500){this.#p=d;return}this.#p=-1;const{classList:m}=this.div;m.toggle("getElements",!0);const v=document.elementsFromPoint(u,f);if(m.toggle("getElements",!1),!this.div.contains(v[0]))return;let _;const A=new RegExp(`^${ny}[0-9]+$`);for(const E of v)if(A.test(E.id)){_=E.id;break}if(!_)return;const y=this.#r.get(_);y?.annotationElementId===null&&(l.stopPropagation(),l.preventDefault(),y.dblclick())},{signal:s,capture:!0})}const t=new Map,e=new Map;for(const s of this.#r.values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){t.set(s.annotationElementId,s);continue}else e.set(s.annotationElementId,s);this.getEditableAnnotation(s.annotationElementId)?.show(),s.remove()}if(this.#i){const s=this.#i.getEditableAnnotations();for(const l of s){const{id:o}=l.data;if(this.#h.isDeletedAnnotationElement(o)){l.updateEdited({deleted:!0});continue}let u=e.get(o);if(u){u.resetAnnotationElement(l),u.show(!1),l.show();continue}u=t.get(o),u&&(this.#h.addChangedExistingAnnotation(u),u.renderAnnotationElement(l)&&u.show(!1)),l.show()}}this.#x(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const s of Ar.#m.values())i.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#l=!1}getEditableAnnotation(t){return this.#i?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#h.getActive()!==t&&this.#h.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#d){this.#d=new AbortController;const t=this.#h.combinedSignal(this.#d);this.#u.div.addEventListener("pointerdown",this.#_.bind(this),{signal:t}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#d&&(this.#d.abort(),this.#d=null,this.#u.div.classList.remove("highlighting"))}#_(t){this.#h.unselectAll();const{target:e}=t;if(e===this.#u.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#u.div.contains(e)){const{isMac:i}=_i.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#h.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),Ie.startHighlighting(this,this.#h.direction==="ltr",{target:this.#u.div,x:t.x,y:t.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#h._signal}),t.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const t=this.#h.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#n?.abort(),this.#n=null}attach(t){this.#r.set(t.id,t);const{annotationElementId:e}=t;e&&this.#h.isDeletedAnnotationElement(e)&&this.#h.removeDeletedAnnotationElement(t)}detach(t){this.#r.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#l&&t.annotationElementId&&this.#h.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#h.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#h.addDeletedAnnotationElement(t.annotationElementId),Ut.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#h.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#o),this.#h.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#s&&(t._focusEventsAllowed=!1,this.#s=setTimeout(()=>{this.#s=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#h._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getNextId(){return this.#h.getId()}get#v(){return Ar.#m.get(this.#h.getMode())}combinedSignal(t){return this.#h.combinedSignal(t)}#A(t){const e=this.#v;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#v?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#h.updateMode(t.mode);const{offsetX:i,offsetY:s}=this.#E(),l=this.getNextId(),o=this.#A({parent:this,id:l,x:i,y:s,uiManager:this.#h,isCentered:!0,...e});o&&this.add(o)}async deserialize(t){return await Ar.#m.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#h)||null}createAndAddNewEditor(t,e,i={}){const s=this.getNextId(),l=this.#A({parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:this.#h,isCentered:e,...i});return l&&this.add(l),l}#E(){const{x:t,y:e,width:i,height:s}=this.div.getBoundingClientRect(),l=Math.max(0,t),o=Math.max(0,e),u=Math.min(window.innerWidth,t+i),f=Math.min(window.innerHeight,e+s),d=(l+u)/2-t,p=(o+f)/2-e,[m,v]=this.viewport.rotation%180===0?[d,p]:[p,d];return{offsetX:m,offsetY:v}}addNewEditor(t={}){this.createAndAddNewEditor(this.#E(),!0,t)}setSelected(t){this.#h.setSelected(t)}toggleSelected(t){this.#h.toggleSelected(t)}unselect(t){this.#h.unselect(t)}pointerup(t){const{isMac:e}=_i.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#a||(this.#a=!1,this.#v?.isDrawer&&this.#v.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const i=this.#h.getMode();if(i===Xt.STAMP||i===Xt.SIGNATURE){this.#h.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#h.getMode()===Xt.HIGHLIGHT&&this.enableTextSelection(),this.#a){this.#a=!1;return}const{isMac:e}=_i.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#a=!0,this.#v?.isDrawer){this.startDrawingSession(t);return}const i=this.#h.getActive();this.#e=!i||i.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#c){this.#v.startDrawing(this,this.#h,!1,t);return}this.#h.setCurrentDrawingSession(this),this.#c=new AbortController;const e=this.#h.combinedSignal(this.#c);this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(this.#f=null,this.commitOrRemove())},{signal:e}),this.#v.startDrawing(this,this.#h,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#f=e);return}this.#f&&setTimeout(()=>{this.#f?.focus(),this.#f=null},0)}endDrawingSession(t=!1){return this.#c?(this.#h.setCurrentDrawingSession(null),this.#c.abort(),this.#c=null,this.#f=null,this.#v.endDrawing(t)):null}findNewParent(t,e,i){const s=this.#h.findParent(e,i);return s===null||s===this?!1:(s.changeParent(t),!0)}commitOrRemove(){return this.#c?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#c&&this.#v.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#h.getActive()?.parent===this&&(this.#h.commitOrRemove(),this.#h.setActiveEditor(null)),this.#s&&(clearTimeout(this.#s),this.#s=null);for(const t of this.#r.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#r.clear(),this.#h.removeLayer(this)}#x(){for(const t of this.#r.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,Hs(this.div,t);for(const e of this.#h.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#h.commitOrRemove(),this.#x();const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,Hs(this.div,{rotation:i}),e!==i)for(const s of this.#r.values())s.rotate(i)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#h.viewParameters.realScale}}class di{#t=null;#e=new Map;#i=new Map;static#n=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return Zt(this,"_svgFactory",new Gu)}static#s(t,[e,i,s,l]){const{style:o}=t;o.top=`${100*i}%`,o.left=`${100*e}%`,o.width=`${100*s}%`,o.height=`${100*l}%`}#r(){const t=di._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#a(t,e){const i=di._svgFactory.createElement("clipPath");t.append(i);const s=`clip_${e}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");const l=di._svgFactory.createElement("use");return i.append(l),l.setAttribute("href",`#${e}`),l.classList.add("clip"),s}#l(t,e){for(const[i,s]of Object.entries(e))s===null?t.removeAttribute(i):t.setAttribute(i,s)}draw(t,e=!1,i=!1){const s=di.#n++,l=this.#r(),o=di._svgFactory.createElement("defs");l.append(o);const u=di._svgFactory.createElement("path");o.append(u);const f=`path_p${this.pageIndex}_${s}`;u.setAttribute("id",f),u.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#i.set(s,u);const d=i?this.#a(o,f):null,p=di._svgFactory.createElement("use");return l.append(p),p.setAttribute("href",`#${f}`),this.updateProperties(l,t),this.#e.set(s,l),{id:s,clipPathId:`url(#${d})`}}drawOutline(t,e){const i=di.#n++,s=this.#r(),l=di._svgFactory.createElement("defs");s.append(l);const o=di._svgFactory.createElement("path");l.append(o);const u=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",u),o.setAttribute("vector-effect","non-scaling-stroke");let f;if(e){const m=di._svgFactory.createElement("mask");l.append(m),f=`mask_p${this.pageIndex}_${i}`,m.setAttribute("id",f),m.setAttribute("maskUnits","objectBoundingBox");const v=di._svgFactory.createElement("rect");m.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const _=di._svgFactory.createElement("use");m.append(_),_.setAttribute("href",`#${u}`),_.setAttribute("stroke","none"),_.setAttribute("fill","black"),_.setAttribute("fill-rule","nonzero"),_.classList.add("mask")}const d=di._svgFactory.createElement("use");s.append(d),d.setAttribute("href",`#${u}`),f&&d.setAttribute("mask",`url(#${f})`);const p=d.cloneNode();return s.append(p),d.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(s,t),this.#e.set(i,s),i}finalizeDraw(t,e){this.#i.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:i,bbox:s,rootClass:l,path:o}=e,u=typeof t=="number"?this.#e.get(t):t;if(u){if(i&&this.#l(u,i),s&&di.#s(u,s),l){const{classList:f}=u;for(const[d,p]of Object.entries(l))f.toggle(d,p)}if(o){const d=u.firstChild.firstChild;this.#l(d,o)}}}updateParent(t,e){if(e===this)return;const i=this.#e.get(t);i&&(e.#t.append(i),this.#e.delete(t),e.#e.set(t,i))}remove(t){this.#i.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#i.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:dd};globalThis.pdfjsLib={AbortException:ls,AnnotationEditorLayer:Ar,AnnotationEditorParamsType:ie,AnnotationEditorType:Xt,AnnotationEditorUIManager:os,AnnotationLayer:Zd,AnnotationMode:ts,AnnotationType:je,build:OD,ColorPicker:Sn,createValidAbsoluteUrl:ry,DOMSVGFactory:Gu,DrawLayer:di,FeatureTest:_i,fetchData:Uo,getDocument:Ty,getFilenameFromUrl:A3,getPdfFilenameFromUrl:E3,getRGB:ih,getUuid:ly,getXfaPageViewport:T3,GlobalWorkerOptions:Wa,ImageKind:Eu,InvalidPDFException:ad,isDataScheme:eh,isPdfFile:Gd,isValidExplicitDest:k3,MathClamp:Oi,noContextMenu:wn,normalizeUnicode:x3,OPS:Ro,OutputScale:ir,PasswordResponses:c3,PDFDataRangeTransport:wy,PDFDateString:ld,PDFWorker:Oo,PermissionFlag:o3,PixelsPerInch:Qa,RenderingCancelledException:zd,ResponseException:Hu,setLayerDimensions:Hs,shadow:Zt,SignatureExtractor:Ua,stopEvent:Xe,SupportedImageMimeTypes:od,TextLayer:Ri,TouchManager:nh,updateUrlHash:sy,Util:kt,VerbosityLevel:Zu,version:DD,XfaLayer:Ry};const tO="/ShmyakDocOcr/assets/pdf.worker-BQQyum15.mjs";Wa.workerSrc=tO;function eO(){const[n,t]=_r.useState(""),[e,i]=_r.useState(0),[s,l]=_r.useState(!1),[o,u]=_r.useState(""),f=_r.useRef(),[d,p]=_r.useState(""),m=async O=>{const F=O.target.files[0];if(!F)return;u(F.name),t(""),i(0),l(!0),p("");let z="";if(F.type==="application/pdf"){const{usedOcr:L}=await _(F,!0);z=L?"OCR":"Text Extraction"}else if(F.type==="text/html"||F.name.endsWith(".html"))await v(F),z="Text Extraction";else{t("Unsupported file type."),l(!1),p("");return}p(z),l(!1)},v=async O=>{const F=await O.text(),z=new DOMParser().parseFromString(F,"text/html"),L=Array.from(z.querySelectorAll("table"));if(L.length>0){const G=L.map(V=>Array.from(V.rows).map(Q=>Array.from(Q.cells).map(K=>K.textContent.trim())));return E(G),b(!0),i(100),"Table(s) extracted from HTML."}else{const G=z.body.textContent||"";return b(!1),i(100),G}},_=async(O,F=!1)=>{try{const z=await O.arrayBuffer(),L=await Ty({data:z}).promise;let G=[],V=!1;for(let Q=1;Q<=L.numPages;Q++){const K=await L.getPage(Q),ut=await K.getTextContent();if(ut.items&&ut.items.length>0&&ut.items.some(ht=>ht.str&&ht.str.trim()!=="")){const ht={};ut.items.forEach(Et=>{const Y=Math.round(Et.transform[5]);ht[Y]||(ht[Y]=[]),ht[Y].push(Et)});const bt=Object.values(ht).sort((Et,Y)=>Y[0].transform[5]-Et[0].transform[5]).map(Et=>Et.sort((Y,nt)=>Y.transform[4]-nt.transform[4])).map(Et=>Et.map(Y=>Y.str));G=G.concat(bt)}else{V=!0;const ht=K.getViewport({scale:2}),bt=document.createElement("canvas");bt.width=ht.width,bt.height=ht.height;const Et=bt.getContext("2d");await K.render({canvasContext:Et,viewport:ht}).promise;const Y=bt.toDataURL("image/png"),Tt=(await A(Y,Q,L.numPages)).split(`
`).map(st=>[st]);G=G.concat(Tt)}i(Math.round(Q/L.numPages*100))}return E([G]),b(!0),t(G.map(Q=>Q.join(" ")).join(`
`)),{usedOcr:V}}catch(z){return t("PDF parsing error: "+z.message),l(!1),b(!1),{usedOcr:!1}}},A=async(O,F,z)=>new Promise(L=>{xE.recognize(O,"eng",{logger:G=>{G.status==="recognizing text"&&i(Math.round((G.progress+(F-1))/z*100))}}).then(({data:{text:G}})=>{L(G)})}),[y,E]=_r.useState([]),[T,b]=_r.useState(!1),w=()=>{const O=ro.book_new();if(T&&y.length>0)y.forEach((F,z)=>{const L=ro.aoa_to_sheet(F);ro.book_append_sheet(O,L,`Table${z+1}`)});else{const F=ro.aoa_to_sheet([[n]]);ro.book_append_sheet(O,F,"OCR Text")}$R(O,"ocr_result.xlsx")};return Le.jsxs("div",{style:{minHeight:"100vh",width:"100vw",background:"#f4f6fa",display:"flex",flexDirection:"column",alignItems:"center"},children:[Le.jsxs("div",{style:{width:"100%",maxWidth:1200,display:"flex",flexDirection:"column",alignItems:"center",marginTop:"2rem"},children:[Le.jsx("h1",{children:"Document OCR to Excel"}),Le.jsx("input",{type:"file",accept:".pdf,.html,application/pdf,text/html",ref:f,onChange:m,disabled:s}),o&&Le.jsxs("p",{children:["Selected file: ",o]}),s&&Le.jsxs("div",{children:[Le.jsxs("p",{children:["Processing... ",e,"%"]}),Le.jsx("progress",{value:e,max:"100"})]})]}),n&&!s&&Le.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center",margin:"2rem 0"},children:Le.jsxs("div",{style:{width:"95vw",maxWidth:1200,background:"#fff",borderRadius:18,boxShadow:"0 4px 24px rgba(0,0,0,0.10)",padding:"2.5rem 2rem",display:"flex",flexDirection:"column",alignItems:"center"},children:[Le.jsx("h2",{style:{marginTop:0,fontWeight:600,fontSize:"2rem",color:"#222"},children:"Result"}),d&&Le.jsxs("p",{style:{margin:"0 0 1.5rem 0",color:"#666"},children:[Le.jsx("strong",{children:"Extraction Method:"})," ",d]}),Le.jsx("button",{onClick:w,style:{marginBottom:"2rem",padding:"0.75rem 2rem",fontSize:"1.1rem",fontWeight:600,background:"#2563eb",color:"#fff",border:"none",borderRadius:8,boxShadow:"0 2px 8px rgba(37,99,235,0.08)",cursor:"pointer",transition:"background 0.2s"},onMouseOver:O=>O.target.style.background="#1741a6",onMouseOut:O=>O.target.style.background="#2563eb",children:"Export to Excel"}),T&&y.length>0?Le.jsx("div",{style:{overflowX:"auto",width:"100%"},children:y.map((O,F)=>Le.jsx("table",{style:{marginBottom:"2rem",width:"100%",borderCollapse:"collapse",background:"#fafbfc",borderRadius:10,overflow:"hidden",boxShadow:"0 1px 4px rgba(0,0,0,0.04)"},children:Le.jsx("tbody",{children:O.map((z,L)=>Le.jsx("tr",{children:z.map((G,V)=>Le.jsx("td",{style:{whiteSpace:"pre-wrap",padding:"0.5rem 1rem",border:"1px solid #e0e3ea",fontSize:"1rem",color:"#222"},children:G},V))},L))})},F))}):Le.jsx("textarea",{value:n,readOnly:!0,rows:12,style:{width:"100%",minHeight:200,borderRadius:10,border:"1px solid #e0e3ea",padding:"1rem",fontSize:"1.1rem",background:"#fafbfc",color:"#222",boxShadow:"0 1px 4px rgba(0,0,0,0.04)",resize:"vertical"}})]})})]})}Q2.createRoot(document.getElementById("root")).render(Le.jsx(_r.StrictMode,{children:Le.jsx(eO,{})}));
